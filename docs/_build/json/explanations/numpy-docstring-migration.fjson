{"parents": [{"link": "../", "title": "Explanations"}], "prev": {"link": "../251025_FAISS_whl_overview/", "title": "Updated cuVS Addendum"}, "next": {"link": "../../autoapi/", "title": "API Reference"}, "title": "Migration: Strict NumPy Docstring Compliance", "meta": {"myst_slugs": {"migration-strict-numpy-docstring-compliance": [1, "migration-strict-numpy-docstring-compliance", "Migration: Strict NumPy Docstring Compliance"], "summary-of-changes": [7, "summary-of-changes", "Summary of Changes"], "performance": [20, "performance", "Performance"], "what-contributors-need-to-do": [26, "what-contributors-need-to-do", "What Contributors Need to Do"], "rollback-strategy": [46, "rollback-strategy", "Rollback Strategy"]}, "wordcount": {"words": 223, "minutes": 1}}, "body": "<section id=\"migration-strict-numpy-docstring-compliance\">\n<h1>Migration: Strict NumPy Docstring Compliance<a class=\"headerlink\" href=\"#migration-strict-numpy-docstring-compliance\" title=\"Link to this heading\">#</a></h1>\n<p>This change removes legacy <code class=\"docutils literal notranslate\"><span class=\"pre\">NavMap:</span></code> blocks from module docstrings and enables\nfull NumPy-style validation across the documentation pipeline. Use this guide to\nunderstand the impact and to verify your environment.</p>\n<section id=\"summary-of-changes\">\n<h2>Summary of Changes<a class=\"headerlink\" href=\"#summary-of-changes\" title=\"Link to this heading\">#</a></h2>\n<ul class=\"simple\">\n<li><p>Sphinx now loads the <code class=\"docutils literal notranslate\"><span class=\"pre\">numpydoc</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">numpydoc_validation</span></code> extensions and treats\n<code class=\"docutils literal notranslate\"><span class=\"pre\">GL01</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">SS01</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">ES01</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">RT01</span></code>, and <code class=\"docutils literal notranslate\"><span class=\"pre\">PR01</span></code> violations as build failures (<code class=\"docutils literal notranslate\"><span class=\"pre\">nitpicky</span> <span class=\"pre\">=</span> <span class=\"pre\">True</span></code>).</p></li>\n<li><p>Custom doq templates generate NumPy-compliant docstrings (including <code class=\"docutils literal notranslate\"><span class=\"pre\">Raises</span></code> and\n<code class=\"docutils literal notranslate\"><span class=\"pre\">Examples</span></code> sections) for functions, classes, and modules.</p></li>\n<li><p><code class=\"docutils literal notranslate\"><span class=\"pre\">tools/auto_docstrings.py</span></code> rewrites missing or placeholder docstrings to include\n<code class=\"docutils literal notranslate\"><span class=\"pre\">Parameters</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">Returns</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">Raises</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">Examples</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">See</span> <span class=\"pre\">Also</span></code>, and <code class=\"docutils literal notranslate\"><span class=\"pre\">Notes</span></code> sections.</p></li>\n<li><p><code class=\"docutils literal notranslate\"><span class=\"pre\">tools/update_navmaps.py</span></code> is now a validator that aborts if any docstring still\ncontains a <code class=\"docutils literal notranslate\"><span class=\"pre\">NavMap:</span></code> section.</p></li>\n<li><p>Pre-commit gains a <code class=\"docutils literal notranslate\"><span class=\"pre\">pydoclint</span> <span class=\"pre\">--style</span> <span class=\"pre\">numpy</span> <span class=\"pre\">src</span></code> step that enforces parameter/return parity.</p></li>\n<li><p><code class=\"docutils literal notranslate\"><span class=\"pre\">.numpydoc</span></code> configures repository-wide validation checks during Sphinx builds.</p></li>\n</ul>\n<section id=\"performance\">\n<h3>Performance<a class=\"headerlink\" href=\"#performance\" title=\"Link to this heading\">#</a></h3>\n<p>Docstring regeneration now triggers additional validation (numpydoc + pydoclint).\nOn a clean checkout this adds roughly a few seconds to <code class=\"docutils literal notranslate\"><span class=\"pre\">make</span> <span class=\"pre\">docstrings</span></code>; monitor\n<code class=\"docutils literal notranslate\"><span class=\"pre\">tools/update_docs.sh</span></code> runtimes after large refactors and adjust tooling caches if needed.</p>\n</section>\n</section>\n<section id=\"what-contributors-need-to-do\">\n<h2>What Contributors Need to Do<a class=\"headerlink\" href=\"#what-contributors-need-to-do\" title=\"Link to this heading\">#</a></h2>\n<ol class=\"arabic\">\n<li><p>Regenerate docstrings after modifying public APIs:</p>\n<div class=\"highlight-bash notranslate\"><div class=\"highlight\"><pre><span></span>make<span class=\"w\"> </span>docstrings\n</pre></div>\n</div>\n</li>\n<li><p>Run the documentation pipeline to confirm there are no warnings:</p>\n<div class=\"highlight-bash notranslate\"><div class=\"highlight\"><pre><span></span>tools/update_docs.sh\n</pre></div>\n</div>\n</li>\n<li><p>Execute the doctest suite to ensure <code class=\"docutils literal notranslate\"><span class=\"pre\">Examples</span></code> sections remain runnable:</p>\n<div class=\"highlight-bash notranslate\"><div class=\"highlight\"><pre><span></span>pytest<span class=\"w\"> </span>--doctest-modules<span class=\"w\"> </span>src\n</pre></div>\n</div>\n</li>\n<li><p>If pre-commit is not installed, install it and run all hooks:</p>\n<div class=\"highlight-bash notranslate\"><div class=\"highlight\"><pre><span></span>pre-commit<span class=\"w\"> </span>install\npre-commit<span class=\"w\"> </span>run<span class=\"w\"> </span>--all-files\n</pre></div>\n</div>\n</li>\n</ol>\n</section>\n<section id=\"rollback-strategy\">\n<h2>Rollback Strategy<a class=\"headerlink\" href=\"#rollback-strategy\" title=\"Link to this heading\">#</a></h2>\n<p>To revert to the previous behaviour:</p>\n<ol class=\"arabic simple\">\n<li><p>Remove the <code class=\"docutils literal notranslate\"><span class=\"pre\">numpydoc</span></code> extensions from <code class=\"docutils literal notranslate\"><span class=\"pre\">docs/conf.py</span></code> and restore the Napoleon defaults.</p></li>\n<li><p>Delete <code class=\"docutils literal notranslate\"><span class=\"pre\">.numpydoc</span></code> and revert the docstring templates in <code class=\"docutils literal notranslate\"><span class=\"pre\">tools/doq_templates/numpy/</span></code>.</p></li>\n<li><p>Restore <code class=\"docutils literal notranslate\"><span class=\"pre\">tools/update_navmaps.py</span></code> to inject <code class=\"docutils literal notranslate\"><span class=\"pre\">NavMap:</span></code> sections (and rerun the script).</p></li>\n<li><p>Drop the <code class=\"docutils literal notranslate\"><span class=\"pre\">pydoclint</span></code> dependency and hook from <code class=\"docutils literal notranslate\"><span class=\"pre\">pyproject.toml</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">.pre-commit-config.yaml</span></code>.</p></li>\n</ol>\n<p>Rolling back should be accompanied by regenerating docstrings (<code class=\"docutils literal notranslate\"><span class=\"pre\">make</span> <span class=\"pre\">docstrings</span></code>) so\nthat older Google-style docstrings can be reintroduced if necessary.</p>\n</section>\n</section>\n", "metatags": "<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["autoapi/index", "API Reference", "N", "next"], ["explanations/251025_FAISS_whl_overview", "Updated cuVS Addendum", "P", "previous"]], "sourcename": "explanations/numpy-docstring-migration.md.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Migration: Strict NumPy Docstring Compliance</a><ul>\n<li><a class=\"reference internal\" href=\"#summary-of-changes\">Summary of Changes</a><ul>\n<li><a class=\"reference internal\" href=\"#performance\">Performance</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#what-contributors-need-to-do\">What Contributors Need to Do</a></li>\n<li><a class=\"reference internal\" href=\"#rollback-strategy\">Rollback Strategy</a></li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".md", "has_maths_elements": false, "current_page_name": "explanations/numpy-docstring-migration", "sidebars": ["sidebar-nav-bs.html"], "alabaster_version": "1.0.0", "alabaster_version_info": [1, 0, 0], "theme_show_toc_level": 1, "generate_toctree_html": "<functools._lru_cache_wrapper object at 0x7628d61075e0>", "generate_toc_html": "<functools._lru_cache_wrapper object at 0x7628d6106b90>", "theme_version": "0.16.1", "theme_logo": {"image_relative": {}}}
