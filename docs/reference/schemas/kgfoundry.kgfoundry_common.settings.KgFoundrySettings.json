{
  "$defs": {
    "FaissConfig": {
      "additionalProperties": false,
      "description": "FAISS index configuration (``KGFOUNDRY_FAISS_*`` namespace).",
      "properties": {
        "cuvs": {
          "default": true,
          "description": "Enable cuVS support",
          "title": "Cuvs",
          "type": "boolean"
        },
        "gpu": {
          "default": true,
          "description": "Enable GPU acceleration",
          "title": "Gpu",
          "type": "boolean"
        },
        "index_factory": {
          "default": "OPQ64,IVF8192,PQ64",
          "description": "FAISS index factory string",
          "title": "Index Factory",
          "type": "string"
        },
        "index_path": {
          "default": "./_indices/faiss/shard_000.idx",
          "description": "FAISS index file path",
          "title": "Index Path",
          "type": "string"
        },
        "nprobe": {
          "default": 64,
          "description": "Number of probes for IVF indexes",
          "title": "Nprobe",
          "type": "integer"
        }
      },
      "title": "FaissConfig",
      "type": "object"
    },
    "ObservabilityConfig": {
      "additionalProperties": false,
      "description": "Logging and telemetry toggles (``KGFOUNDRY_*`` namespace).",
      "properties": {
        "log_level": {
          "default": "INFO",
          "description": "Logging level (DEBUG, INFO, WARNING, ERROR)",
          "title": "Log Level",
          "type": "string"
        },
        "metrics_enabled": {
          "default": true,
          "description": "Enable Prometheus metrics export",
          "title": "Metrics Enabled",
          "type": "boolean"
        },
        "metrics_port": {
          "default": 9090,
          "description": "Port for Prometheus metrics endpoint",
          "title": "Metrics Port",
          "type": "integer"
        },
        "traces_enabled": {
          "default": false,
          "description": "Enable OpenTelemetry tracing",
          "title": "Traces Enabled",
          "type": "boolean"
        }
      },
      "title": "ObservabilityConfig",
      "type": "object"
    },
    "SearchConfig": {
      "additionalProperties": false,
      "description": "Configuration for the hybrid search service (``KGFOUNDRY_SEARCH_*``).",
      "properties": {
        "api_url": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Search API base URL (required if search features are used)",
          "title": "Api Url"
        },
        "dense_candidates": {
          "default": 200,
          "description": "Number of dense candidates for hybrid search",
          "title": "Dense Candidates",
          "type": "integer"
        },
        "k": {
          "default": 10,
          "description": "Default number of results to return",
          "title": "K",
          "type": "integer"
        },
        "kg_boosts_direct": {
          "default": 0.08,
          "description": "Direct KG boost weight",
          "title": "Kg Boosts Direct",
          "type": "number"
        },
        "kg_boosts_one_hop": {
          "default": 0.04,
          "description": "One-hop KG boost weight",
          "title": "Kg Boosts One Hop",
          "type": "number"
        },
        "rrf_k": {
          "default": 60,
          "description": "Reciprocal Rank Fusion parameter",
          "title": "Rrf K",
          "type": "integer"
        },
        "sparse_backend": {
          "default": "lucene",
          "description": "Sparse backend type ('lucene' or 'pure')",
          "title": "Sparse Backend",
          "type": "string"
        },
        "sparse_candidates": {
          "default": 200,
          "description": "Number of sparse candidates for hybrid search",
          "title": "Sparse Candidates",
          "type": "integer"
        },
        "validate_responses": {
          "default": false,
          "description": "Enable response schema validation (dev/staging only)",
          "title": "Validate Responses",
          "type": "boolean"
        }
      },
      "title": "SearchConfig",
      "type": "object"
    },
    "SparseEmbeddingConfig": {
      "additionalProperties": false,
      "description": "Sparse embedding configuration (``KGFOUNDRY_SPARSE_EMBEDDING_*``).",
      "properties": {
        "bm25_b": {
          "default": 0.4,
          "description": "BM25 b parameter",
          "title": "Bm25 B",
          "type": "number"
        },
        "bm25_index_dir": {
          "default": "./_indices/bm25",
          "description": "BM25 index directory path",
          "title": "Bm25 Index Dir",
          "type": "string"
        },
        "bm25_k1": {
          "default": 0.9,
          "description": "BM25 k1 parameter",
          "title": "Bm25 K1",
          "type": "number"
        },
        "splade_index_dir": {
          "default": "./_indices/splade_impact",
          "description": "SPLADE index directory path",
          "title": "Splade Index Dir",
          "type": "string"
        },
        "splade_query_encoder": {
          "default": "naver/splade-v3-distilbert",
          "description": "SPLADE query encoder model name",
          "title": "Splade Query Encoder",
          "type": "string"
        }
      },
      "title": "SparseEmbeddingConfig",
      "type": "object"
    }
  },
  "$id": "https://kgfoundry.dev/schemas/kgfoundry.kgfoundry_common.settings.KgFoundrySettings.json#",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "additionalProperties": false,
  "description": "Aggregate runtime configuration loaded from environment variables.\n\nInitialises settings with fail-fast validation. Settings are loaded from\nenvironment variables with the KGFOUNDRY_ prefix and validated according\nto the nested configuration schemas.\n\nParameters\n----------\n**overrides : object\n    Settings overrides to apply during initialization.\n\nAttributes\n----------\nmodel_config : ClassVar[SettingsConfigDict]\n    Pydantic model configuration dictionary (class variable).\nsearch : SearchConfig\n    Search service configuration.\nobservability : ObservabilityConfig\n    Observability configuration.\nsparse_embedding : SparseEmbeddingConfig\n    Sparse embedding configuration.\nfaiss : FaissConfig\n    FAISS index configuration.\n\nRaises\n------\nSettingsError\n    If settings validation fails.",
  "examples": [
    {
      "faiss": null,
      "observability": null,
      "search": null,
      "sparse_embedding": null
    }
  ],
  "properties": {
    "faiss": {
      "$ref": "#/$defs/FaissConfig",
      "description": "FAISS index configuration"
    },
    "observability": {
      "$ref": "#/$defs/ObservabilityConfig",
      "description": "Observability configuration"
    },
    "search": {
      "$ref": "#/$defs/SearchConfig",
      "description": "Search service configuration"
    },
    "sparse_embedding": {
      "$ref": "#/$defs/SparseEmbeddingConfig",
      "description": "Sparse embedding configuration"
    }
  },
  "title": "RuntimeSettings",
  "type": "object"
}
