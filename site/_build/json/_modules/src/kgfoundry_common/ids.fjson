{"parents": [{"link": "../../../", "title": "Module code"}], "title": "src.kgfoundry_common.ids", "body": "<h1>Source code for src.kgfoundry_common.ids</h1><div class=\"highlight\"><pre>\n<span></span><span class=\"linenos\">  1</span><span class=\"sd\">&quot;&quot;&quot;Overview of ids.</span>\n<span class=\"linenos\">  2</span>\n<span class=\"linenos\">  3</span><span class=\"sd\">This module bundles ids logic for the kgfoundry stack. It groups related helpers so downstream</span>\n<span class=\"linenos\">  4</span><span class=\"sd\">packages can import a single cohesive namespace. Refer to the functions and classes below for</span>\n<span class=\"linenos\">  5</span><span class=\"sd\">implementation specifics.</span>\n<span class=\"linenos\">  6</span><span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"linenos\">  7</span>\n<span class=\"linenos\">  8</span><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">__future__</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">annotations</span>\n<span class=\"linenos\">  9</span>\n<span class=\"linenos\"> 10</span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">base64</span>\n<span class=\"linenos\"> 11</span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">hashlib</span>\n<span class=\"linenos\"> 12</span><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">typing</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">Final</span>\n<span class=\"linenos\"> 13</span>\n<span class=\"linenos\"> 14</span><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">kgfoundry_common.navmap_types</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">NavMap</span>\n<span class=\"linenos\"> 15</span>\n<span class=\"linenos\"> 16</span><span class=\"n\">__all__</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s2\">&quot;urn_chunk&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;urn_doc_from_text&quot;</span><span class=\"p\">]</span>\n<span class=\"linenos\"> 17</span>\n<span class=\"linenos\"> 18</span><span class=\"n\">__navmap__</span><span class=\"p\">:</span> <span class=\"n\">Final</span><span class=\"p\">[</span><span class=\"n\">NavMap</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n<span class=\"linenos\"> 19</span>    <span class=\"s2\">&quot;title&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;kgfoundry_common.ids&quot;</span><span class=\"p\">,</span>\n<span class=\"linenos\"> 20</span>    <span class=\"s2\">&quot;synopsis&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Helpers for generating deterministic URNs&quot;</span><span class=\"p\">,</span>\n<span class=\"linenos\"> 21</span>    <span class=\"s2\">&quot;exports&quot;</span><span class=\"p\">:</span> <span class=\"n\">__all__</span><span class=\"p\">,</span>\n<span class=\"linenos\"> 22</span>    <span class=\"s2\">&quot;sections&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n<span class=\"linenos\"> 23</span>        <span class=\"p\">{</span>\n<span class=\"linenos\"> 24</span>            <span class=\"s2\">&quot;id&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;public-api&quot;</span><span class=\"p\">,</span>\n<span class=\"linenos\"> 25</span>            <span class=\"s2\">&quot;title&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Public API&quot;</span><span class=\"p\">,</span>\n<span class=\"linenos\"> 26</span>            <span class=\"s2\">&quot;symbols&quot;</span><span class=\"p\">:</span> <span class=\"n\">__all__</span><span class=\"p\">,</span>\n<span class=\"linenos\"> 27</span>        <span class=\"p\">},</span>\n<span class=\"linenos\"> 28</span>    <span class=\"p\">],</span>\n<span class=\"linenos\"> 29</span>    <span class=\"s2\">&quot;module_meta&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n<span class=\"linenos\"> 30</span>        <span class=\"s2\">&quot;owner&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;@kgfoundry-common&quot;</span><span class=\"p\">,</span>\n<span class=\"linenos\"> 31</span>        <span class=\"s2\">&quot;stability&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;stable&quot;</span><span class=\"p\">,</span>\n<span class=\"linenos\"> 32</span>        <span class=\"s2\">&quot;since&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;0.1.0&quot;</span><span class=\"p\">,</span>\n<span class=\"linenos\"> 33</span>    <span class=\"p\">},</span>\n<span class=\"linenos\"> 34</span>    <span class=\"s2\">&quot;symbols&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n<span class=\"linenos\"> 35</span>        <span class=\"s2\">&quot;urn_doc_from_text&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n<span class=\"linenos\"> 36</span>            <span class=\"s2\">&quot;owner&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;@kgfoundry-common&quot;</span><span class=\"p\">,</span>\n<span class=\"linenos\"> 37</span>            <span class=\"s2\">&quot;stability&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;stable&quot;</span><span class=\"p\">,</span>\n<span class=\"linenos\"> 38</span>            <span class=\"s2\">&quot;since&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;0.1.0&quot;</span><span class=\"p\">,</span>\n<span class=\"linenos\"> 39</span>        <span class=\"p\">},</span>\n<span class=\"linenos\"> 40</span>        <span class=\"s2\">&quot;urn_chunk&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n<span class=\"linenos\"> 41</span>            <span class=\"s2\">&quot;owner&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;@kgfoundry-common&quot;</span><span class=\"p\">,</span>\n<span class=\"linenos\"> 42</span>            <span class=\"s2\">&quot;stability&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;stable&quot;</span><span class=\"p\">,</span>\n<span class=\"linenos\"> 43</span>            <span class=\"s2\">&quot;since&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;0.1.0&quot;</span><span class=\"p\">,</span>\n<span class=\"linenos\"> 44</span>        <span class=\"p\">},</span>\n<span class=\"linenos\"> 45</span>    <span class=\"p\">},</span>\n<span class=\"linenos\"> 46</span><span class=\"p\">}</span>\n<span class=\"linenos\"> 47</span>\n<span class=\"linenos\"> 48</span>\n<span class=\"linenos\"> 49</span><span class=\"c1\"># [nav:anchor urn_doc_from_text]</span>\n<div class=\"viewcode-block\" id=\"urn_doc_from_text\">\n<a class=\"viewcode-back\" href=\"../../../../autoapi/src/kgfoundry_common/ids/#src.kgfoundry_common.ids.urn_doc_from_text\">[docs]</a>\n<span class=\"linenos\"> 50</span><span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">urn_doc_from_text</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"p\">:</span> <span class=\"nb\">str</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"nb\">str</span><span class=\"p\">:</span>\n<span class=\"linenos\"> 51</span><span class=\"w\">    </span><span class=\"sd\">&quot;&quot;&quot;Compute urn doc from text.</span>\n<span class=\"linenos\"> 52</span>\n<span class=\"linenos\"> 53</span><span class=\"sd\">    Carry out the urn doc from text operation for the surrounding component. Generated documentation highlights how this helper collaborates with neighbouring utilities. Callers rely on the routine to remain stable across releases.</span>\n<span class=\"linenos\"> 54</span><span class=\"sd\">    </span>\n<span class=\"linenos\"> 55</span><span class=\"sd\">    Parameters</span>\n<span class=\"linenos\"> 56</span><span class=\"sd\">    ----------</span>\n<span class=\"linenos\"> 57</span><span class=\"sd\">    text : str</span>\n<span class=\"linenos\"> 58</span><span class=\"sd\">        Description for ``text``.</span>\n<span class=\"linenos\"> 59</span><span class=\"sd\">    </span>\n<span class=\"linenos\"> 60</span><span class=\"sd\">    Returns</span>\n<span class=\"linenos\"> 61</span><span class=\"sd\">    -------</span>\n<span class=\"linenos\"> 62</span><span class=\"sd\">    str</span>\n<span class=\"linenos\"> 63</span><span class=\"sd\">        Description of return value.</span>\n<span class=\"linenos\"> 64</span><span class=\"sd\">    </span>\n<span class=\"linenos\"> 65</span><span class=\"sd\">    Examples</span>\n<span class=\"linenos\"> 66</span><span class=\"sd\">    --------</span>\n<span class=\"linenos\"> 67</span><span class=\"sd\">    &gt;&gt;&gt; from kgfoundry_common.ids import urn_doc_from_text</span>\n<span class=\"linenos\"> 68</span><span class=\"sd\">    &gt;&gt;&gt; result = urn_doc_from_text(...)</span>\n<span class=\"linenos\"> 69</span><span class=\"sd\">    &gt;&gt;&gt; result  # doctest: +ELLIPSIS</span>\n<span class=\"linenos\"> 70</span><span class=\"sd\">    ...</span>\n<span class=\"linenos\"> 71</span><span class=\"sd\">    &quot;&quot;&quot;</span>\n<span class=\"linenos\"> 72</span>    \n<span class=\"linenos\"> 73</span>    <span class=\"n\">h</span> <span class=\"o\">=</span> <span class=\"n\">hashlib</span><span class=\"o\">.</span><span class=\"n\">sha256</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"o\">.</span><span class=\"n\">encode</span><span class=\"p\">(</span><span class=\"s2\">&quot;utf-8&quot;</span><span class=\"p\">))</span><span class=\"o\">.</span><span class=\"n\">digest</span><span class=\"p\">()[:</span><span class=\"mi\">16</span><span class=\"p\">]</span>\n<span class=\"linenos\"> 74</span>    <span class=\"n\">b32</span> <span class=\"o\">=</span> <span class=\"n\">base64</span><span class=\"o\">.</span><span class=\"n\">b32encode</span><span class=\"p\">(</span><span class=\"n\">h</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">decode</span><span class=\"p\">(</span><span class=\"s2\">&quot;ascii&quot;</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">strip</span><span class=\"p\">(</span><span class=\"s2\">&quot;=&quot;</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">lower</span><span class=\"p\">()</span>\n<span class=\"linenos\"> 75</span>    <span class=\"k\">return</span> <span class=\"sa\">f</span><span class=\"s2\">&quot;urn:doc:sha256:</span><span class=\"si\">{</span><span class=\"n\">b32</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span></div>\n\n<span class=\"linenos\"> 76</span>\n<span class=\"linenos\"> 77</span>\n<span class=\"linenos\"> 78</span><span class=\"c1\"># [nav:anchor urn_chunk]</span>\n<div class=\"viewcode-block\" id=\"urn_chunk\">\n<a class=\"viewcode-back\" href=\"../../../../autoapi/src/kgfoundry_common/ids/#src.kgfoundry_common.ids.urn_chunk\">[docs]</a>\n<span class=\"linenos\"> 79</span><span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">urn_chunk</span><span class=\"p\">(</span><span class=\"n\">doc_hash</span><span class=\"p\">:</span> <span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"n\">start</span><span class=\"p\">:</span> <span class=\"nb\">int</span><span class=\"p\">,</span> <span class=\"n\">end</span><span class=\"p\">:</span> <span class=\"nb\">int</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"nb\">str</span><span class=\"p\">:</span>\n<span class=\"linenos\"> 80</span><span class=\"w\">    </span><span class=\"sd\">&quot;&quot;&quot;Compute urn chunk.</span>\n<span class=\"linenos\"> 81</span>\n<span class=\"linenos\"> 82</span><span class=\"sd\">    Carry out the urn chunk operation for the surrounding component. Generated documentation highlights how this helper collaborates with neighbouring utilities. Callers rely on the routine to remain stable across releases.</span>\n<span class=\"linenos\"> 83</span><span class=\"sd\">    </span>\n<span class=\"linenos\"> 84</span><span class=\"sd\">    Parameters</span>\n<span class=\"linenos\"> 85</span><span class=\"sd\">    ----------</span>\n<span class=\"linenos\"> 86</span><span class=\"sd\">    doc_hash : str</span>\n<span class=\"linenos\"> 87</span><span class=\"sd\">        Description for ``doc_hash``.</span>\n<span class=\"linenos\"> 88</span><span class=\"sd\">    start : int</span>\n<span class=\"linenos\"> 89</span><span class=\"sd\">        Description for ``start``.</span>\n<span class=\"linenos\"> 90</span><span class=\"sd\">    end : int</span>\n<span class=\"linenos\"> 91</span><span class=\"sd\">        Description for ``end``.</span>\n<span class=\"linenos\"> 92</span><span class=\"sd\">    </span>\n<span class=\"linenos\"> 93</span><span class=\"sd\">    Returns</span>\n<span class=\"linenos\"> 94</span><span class=\"sd\">    -------</span>\n<span class=\"linenos\"> 95</span><span class=\"sd\">    str</span>\n<span class=\"linenos\"> 96</span><span class=\"sd\">        Description of return value.</span>\n<span class=\"linenos\"> 97</span><span class=\"sd\">    </span>\n<span class=\"linenos\"> 98</span><span class=\"sd\">    Examples</span>\n<span class=\"linenos\"> 99</span><span class=\"sd\">    --------</span>\n<span class=\"linenos\">100</span><span class=\"sd\">    &gt;&gt;&gt; from kgfoundry_common.ids import urn_chunk</span>\n<span class=\"linenos\">101</span><span class=\"sd\">    &gt;&gt;&gt; result = urn_chunk(..., ..., ...)</span>\n<span class=\"linenos\">102</span><span class=\"sd\">    &gt;&gt;&gt; result  # doctest: +ELLIPSIS</span>\n<span class=\"linenos\">103</span><span class=\"sd\">    ...</span>\n<span class=\"linenos\">104</span><span class=\"sd\">    &quot;&quot;&quot;</span>\n<span class=\"linenos\">105</span>    \n<span class=\"linenos\">106</span>    <span class=\"k\">return</span> <span class=\"sa\">f</span><span class=\"s2\">&quot;urn:chunk:</span><span class=\"si\">{</span><span class=\"n\">doc_hash</span><span class=\"o\">.</span><span class=\"n\">split</span><span class=\"p\">(</span><span class=\"s1\">&#39;:&#39;</span><span class=\"p\">)[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"si\">}</span><span class=\"s2\">:</span><span class=\"si\">{</span><span class=\"n\">start</span><span class=\"si\">}</span><span class=\"s2\">-</span><span class=\"si\">{</span><span class=\"n\">end</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span></div>\n\n</pre></div>", "current_page_name": "_modules/src/kgfoundry_common/ids", "sidebars": ["sidebar-nav-bs.html"], "alabaster_version": "1.0.0", "alabaster_version_info": [1, 0, 0], "theme_show_toc_level": 1, "generate_toctree_html": "<functools._lru_cache_wrapper object at 0x7628d5732f00>", "generate_toc_html": "<functools._lru_cache_wrapper object at 0x7628d5733110>", "theme_version": "0.16.1", "theme_logo": {"image_relative": {}}}
