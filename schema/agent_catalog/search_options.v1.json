{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://kgfoundry.dev/schemas/agent_catalog/search_options.v1.json",
  "title": "SearchOptions Configuration",
  "description": "Configuration options for hybrid lexical-vector search against the agent catalog. All fields are optional; sensible defaults are applied by helper factories (build_default_search_options, build_faceted_search_options, build_embedding_aware_search_options).",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "alpha": {
      "description": "Hybrid search mixing parameter: 0.0 = pure lexical, 1.0 = pure vector, 0.6 = default balanced.",
      "type": "number",
      "minimum": 0.0,
      "maximum": 1.0,
      "default": 0.6,
      "examples": [0.0, 0.5, 1.0]
    },
    "candidate_pool": {
      "description": "Pre-filtering candidate pool size for re-ranking. Must be >= k (number of final results). Default 100.",
      "type": "integer",
      "minimum": 0,
      "default": 100,
      "examples": [50, 100, 200]
    },
    "batch_size": {
      "description": "Batch size for embedding model encoding. Default 32.",
      "type": "integer",
      "minimum": 1,
      "default": 32,
      "examples": [32, 64, 128]
    },
    "embedding_model": {
      "description": "Name or path of the embedding model to use (e.g., 'all-MiniLM-L6-v2'). If omitted, falls back to semantic index metadata.",
      "type": ["string", "null"],
      "examples": ["all-MiniLM-L6-v2", "bge-base-en-v1.5"]
    },
    "facets": {
      "description": "Optional facet filters for result narrowing. Only recognized facet keys are allowed: package, module, kind, stability.",
      "type": ["object", "null"],
      "additionalProperties": {
        "type": "string"
      },
      "properties": {
        "package": {
          "description": "Filter results to symbols from this package.",
          "type": "string",
          "examples": ["kgfoundry", "search_api"]
        },
        "module": {
          "description": "Filter results to symbols from this module.",
          "type": "string",
          "examples": ["kgfoundry.agent_catalog.search"]
        },
        "kind": {
          "description": "Filter results to symbols of this kind.",
          "type": "string",
          "enum": ["class", "function", "module", "method", "property", "attribute", "type", "protocol"]
        },
        "stability": {
          "description": "Filter results by stability level.",
          "type": "string",
          "enum": ["stable", "experimental", "deprecated"]
        }
      }
    }
  },
  "$defs": {
    "BuildDefaultExample": {
      "description": "Example: build_default_search_options(alpha=0.5, candidate_pool=75)",
      "type": "object",
      "properties": {
        "alpha": 0.5,
        "candidate_pool": 75,
        "batch_size": 32,
        "embedding_model": null,
        "facets": null
      }
    },
    "BuildFacetedExample": {
      "description": "Example: build_faceted_search_options(facets={'package': 'kgfoundry', 'kind': 'class'})",
      "type": "object",
      "properties": {
        "alpha": 0.6,
        "candidate_pool": 100,
        "batch_size": 32,
        "facets": {
          "package": "kgfoundry",
          "kind": "class"
        }
      }
    }
  },
  "examples": [
    {
      "alpha": 0.6,
      "candidate_pool": 100,
      "batch_size": 32,
      "embedding_model": null,
      "facets": null
    },
    {
      "alpha": 0.5,
      "candidate_pool": 50,
      "batch_size": 64,
      "embedding_model": "all-MiniLM-L6-v2",
      "facets": {
        "package": "kgfoundry",
        "kind": "function"
      }
    }
  ],
  "x-version": "1.0.0",
  "x-compatibility-notes": "Initial version. Helper factories enforce validation: alpha âˆˆ [0.0, 1.0], candidate_pool >= 0, facet keys in allow-list."
}
