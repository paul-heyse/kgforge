# Import-linter Configuration for kgfoundry
#
# This file defines two contracts:
# 1. `layers` - Enforces layered architecture (Domain → Application → Interface → Infrastructure)
# 2. `typing-facade-only` - Enforces typing gate boundaries (Phase 2 of typing gates holistic initiative)
#
# The `typing-facade-only` contract ensures that all packages use the designated typing facades
# (kgfoundry_common.typing, docs.typing, tools.typing) instead of importing directly from
# private modules (docs._types, docs._cache). This is part of Phase 2 typing gates enforcement.
# See AGENTS.md and docs/typing_migration_guide.md for more details.

[import-linter]
root_package = kgfoundry

[import-linter:contract:layers]
name = Domain → Application → Interface → Infrastructure layers
type = layers
layers =
    kgfoundry_common
    kg_builder, orchestration
    search_api
    embeddings_dense, embeddings_sparse, ontology, registry, download, docling, linking, vectorstore_faiss
ignore_imports =
    # Allow common utilities to be imported by all layers
    kgfoundry_common.*
    # Allow observability to be imported by all layers
    observability.*

[import-linter:contract:typing-facade-only]
name = Type-only imports must use designated facades
type = forbidden
source_modules =
    kgfoundry_common
    kgfoundry
    search_api
    orchestration
    kg_builder
    embeddings_dense
    embeddings_sparse
    ontology
    registry
    download
    docling
    linking
    vectorstore_faiss
forbidden_modules =
    docs._types
    docs._cache
ignore_imports =
    # Façade modules are allowed to import from private modules
    docs.types -> docs._types
    kgfoundry_common.typing -> kgfoundry_common.typing
    docs.typing -> docs._types
    tools.typing -> kgfoundry_common.typing

