Module(body=[ImportFrom(module='__future__', names=[alias(name='annotations', lineno=1, col_offset=23, end_lineno=1, end_col_offset=34)], level=0, lineno=1, col_offset=0, end_lineno=1, end_col_offset=34), ImportFrom(module='collections.abc', names=[alias(name='Iterable', lineno=3, col_offset=28, end_lineno=3, end_col_offset=36), alias(name='Iterator', lineno=3, col_offset=38, end_lineno=3, end_col_offset=46)], level=0, lineno=3, col_offset=0, end_lineno=3, end_col_offset=46), Import(names=[alias(name='pytest', lineno=5, col_offset=7, end_lineno=5, end_col_offset=13)], lineno=5, col_offset=0, end_lineno=5, end_col_offset=13), ImportFrom(module='kgfoundry_common.navmap_loader', names=[alias(name='NavMetadataModel', lineno=8, col_offset=4, end_lineno=8, end_col_offset=20), alias(name='clear_navmap_caches', lineno=9, col_offset=4, end_lineno=9, end_col_offset=23), alias(name='load_nav_metadata', lineno=10, col_offset=4, end_lineno=10, end_col_offset=21)], level=0, lineno=7, col_offset=0, end_lineno=11, end_col_offset=1), FunctionDef(name='_reset_navmap_caches', args=arguments(), body=[Expr(value=Call(func=Name(id='clear_navmap_caches', ctx=Load(), lineno=16, col_offset=4, end_lineno=16, end_col_offset=23), lineno=16, col_offset=4, end_lineno=16, end_col_offset=25), lineno=16, col_offset=4, end_lineno=16, end_col_offset=25), Expr(value=Yield(lineno=17, col_offset=4, end_lineno=17, end_col_offset=9), lineno=17, col_offset=4, end_lineno=17, end_col_offset=9), Expr(value=Call(func=Name(id='clear_navmap_caches', ctx=Load(), lineno=18, col_offset=4, end_lineno=18, end_col_offset=23), lineno=18, col_offset=4, end_lineno=18, end_col_offset=25), lineno=18, col_offset=4, end_lineno=18, end_col_offset=25)], decorator_list=[Call(func=Attribute(value=Name(id='pytest', ctx=Load(), lineno=14, col_offset=1, end_lineno=14, end_col_offset=7), attr='fixture', ctx=Load(), lineno=14, col_offset=1, end_lineno=14, end_col_offset=15), keywords=[keyword(arg='autouse', value=Constant(value=True, lineno=14, col_offset=24, end_lineno=14, end_col_offset=28), lineno=14, col_offset=16, end_lineno=14, end_col_offset=28)], lineno=14, col_offset=1, end_lineno=14, end_col_offset=29)], returns=Subscript(value=Name(id='Iterator', ctx=Load(), lineno=15, col_offset=30, end_lineno=15, end_col_offset=38), slice=Constant(value=None, lineno=15, col_offset=39, end_lineno=15, end_col_offset=43), ctx=Load(), lineno=15, col_offset=30, end_lineno=15, end_col_offset=44), lineno=15, col_offset=0, end_lineno=18, end_col_offset=25), FunctionDef(name='_symbol_names', args=arguments(args=[arg(arg='sections', annotation=Name(id='object', ctx=Load(), lineno=21, col_offset=28, end_lineno=21, end_col_offset=34), lineno=21, col_offset=18, end_lineno=21, end_col_offset=34)]), body=[AnnAssign(target=Name(id='names', ctx=Store(), lineno=22, col_offset=4, end_lineno=22, end_col_offset=9), annotation=Subscript(value=Name(id='set', ctx=Load(), lineno=22, col_offset=11, end_lineno=22, end_col_offset=14), slice=Name(id='str', ctx=Load(), lineno=22, col_offset=15, end_lineno=22, end_col_offset=18), ctx=Load(), lineno=22, col_offset=11, end_lineno=22, end_col_offset=19), value=Call(func=Name(id='set', ctx=Load(), lineno=22, col_offset=22, end_lineno=22, end_col_offset=25), lineno=22, col_offset=22, end_lineno=22, end_col_offset=27), simple=1, lineno=22, col_offset=4, end_lineno=22, end_col_offset=27), If(test=Compare(left=Name(id='sections', ctx=Load(), lineno=23, col_offset=7, end_lineno=23, end_col_offset=15), ops=[Is()], comparators=[Constant(value=None, lineno=23, col_offset=19, end_lineno=23, end_col_offset=23)], lineno=23, col_offset=7, end_lineno=23, end_col_offset=23), body=[Return(value=Name(id='names', ctx=Load(), lineno=24, col_offset=15, end_lineno=24, end_col_offset=20), lineno=24, col_offset=8, end_lineno=24, end_col_offset=20)], lineno=23, col_offset=4, end_lineno=24, end_col_offset=20), If(test=BoolOp(op=And(), values=[Call(func=Name(id='isinstance', ctx=Load(), lineno=25, col_offset=7, end_lineno=25, end_col_offset=17), args=[Name(id='sections', ctx=Load(), lineno=25, col_offset=18, end_lineno=25, end_col_offset=26), Name(id='Iterable', ctx=Load(), lineno=25, col_offset=28, end_lineno=25, end_col_offset=36)], lineno=25, col_offset=7, end_lineno=25, end_col_offset=37), UnaryOp(op=Not(), operand=Call(func=Name(id='isinstance', ctx=Load(), lineno=25, col_offset=46, end_lineno=25, end_col_offset=56), args=[Name(id='sections', ctx=Load(), lineno=25, col_offset=57, end_lineno=25, end_col_offset=65), Tuple(elts=[Name(id='str', ctx=Load(), lineno=25, col_offset=68, end_lineno=25, end_col_offset=71), Name(id='bytes', ctx=Load(), lineno=25, col_offset=73, end_lineno=25, end_col_offset=78)], ctx=Load(), lineno=25, col_offset=67, end_lineno=25, end_col_offset=79)], lineno=25, col_offset=46, end_lineno=25, end_col_offset=80), lineno=25, col_offset=42, end_lineno=25, end_col_offset=80)], lineno=25, col_offset=7, end_lineno=25, end_col_offset=80), body=[For(target=Name(id='section', ctx=Store(), lineno=26, col_offset=12, end_lineno=26, end_col_offset=19), iter=Name(id='sections', ctx=Load(), lineno=26, col_offset=23, end_lineno=26, end_col_offset=31), body=[Assign(targets=[Name(id='symbols', ctx=Store(), lineno=27, col_offset=12, end_lineno=27, end_col_offset=19)], value=IfExp(test=Call(func=Name(id='isinstance', ctx=Load(), lineno=27, col_offset=52, end_lineno=27, end_col_offset=62), args=[Name(id='section', ctx=Load(), lineno=27, col_offset=63, end_lineno=27, end_col_offset=70), Name(id='dict', ctx=Load(), lineno=27, col_offset=72, end_lineno=27, end_col_offset=76)], lineno=27, col_offset=52, end_lineno=27, end_col_offset=77), body=Call(func=Attribute(value=Name(id='section', ctx=Load(), lineno=27, col_offset=22, end_lineno=27, end_col_offset=29), attr='get', ctx=Load(), lineno=27, col_offset=22, end_lineno=27, end_col_offset=33), args=[Constant(value='symbols', lineno=27, col_offset=34, end_lineno=27, end_col_offset=43), List(ctx=Load(), lineno=27, col_offset=45, end_lineno=27, end_col_offset=47)], lineno=27, col_offset=22, end_lineno=27, end_col_offset=48), orelse=List(ctx=Load(), lineno=27, col_offset=83, end_lineno=27, end_col_offset=85), lineno=27, col_offset=22, end_lineno=27, end_col_offset=85), lineno=27, col_offset=12, end_lineno=27, end_col_offset=85), If(test=Call(func=Name(id='isinstance', ctx=Load(), lineno=28, col_offset=15, end_lineno=28, end_col_offset=25), args=[Name(id='symbols', ctx=Load(), lineno=28, col_offset=26, end_lineno=28, end_col_offset=33), Name(id='Iterable', ctx=Load(), lineno=28, col_offset=35, end_lineno=28, end_col_offset=43)], lineno=28, col_offset=15, end_lineno=28, end_col_offset=44), body=[For(target=Name(id='symbol', ctx=Store(), lineno=29, col_offset=20, end_lineno=29, end_col_offset=26), iter=Name(id='symbols', ctx=Load(), lineno=29, col_offset=30, end_lineno=29, end_col_offset=37), body=[If(test=Call(func=Name(id='isinstance', ctx=Load(), lineno=30, col_offset=23, end_lineno=30, end_col_offset=33), args=[Name(id='symbol', ctx=Load(), lineno=30, col_offset=34, end_lineno=30, end_col_offset=40), Name(id='str', ctx=Load(), lineno=30, col_offset=42, end_lineno=30, end_col_offset=45)], lineno=30, col_offset=23, end_lineno=30, end_col_offset=46), body=[Expr(value=Call(func=Attribute(value=Name(id='names', ctx=Load(), lineno=31, col_offset=24, end_lineno=31, end_col_offset=29), attr='add', ctx=Load(), lineno=31, col_offset=24, end_lineno=31, end_col_offset=33), args=[Name(id='symbol', ctx=Load(), lineno=31, col_offset=34, end_lineno=31, end_col_offset=40)], lineno=31, col_offset=24, end_lineno=31, end_col_offset=41), lineno=31, col_offset=24, end_lineno=31, end_col_offset=41)], lineno=30, col_offset=20, end_lineno=31, end_col_offset=41)], lineno=29, col_offset=16, end_lineno=31, end_col_offset=41)], lineno=28, col_offset=12, end_lineno=31, end_col_offset=41)], lineno=26, col_offset=8, end_lineno=31, end_col_offset=41)], lineno=25, col_offset=4, end_lineno=31, end_col_offset=41), Return(value=Name(id='names', ctx=Load(), lineno=32, col_offset=11, end_lineno=32, end_col_offset=16), lineno=32, col_offset=4, end_lineno=32, end_col_offset=16)], returns=Subscript(value=Name(id='set', ctx=Load(), lineno=21, col_offset=39, end_lineno=21, end_col_offset=42), slice=Name(id='str', ctx=Load(), lineno=21, col_offset=43, end_lineno=21, end_col_offset=46), ctx=Load(), lineno=21, col_offset=39, end_lineno=21, end_col_offset=47), lineno=21, col_offset=0, end_lineno=32, end_col_offset=16), FunctionDef(name='test_cli_nav_metadata_derives_from_cli_contracts', args=arguments(), body=[Assign(targets=[Name(id='metadata', ctx=Store(), lineno=36, col_offset=4, end_lineno=36, end_col_offset=12)], value=Call(func=Name(id='load_nav_metadata', ctx=Load(), lineno=36, col_offset=15, end_lineno=36, end_col_offset=32), args=[Constant(value='download.cli', lineno=36, col_offset=33, end_lineno=36, end_col_offset=47), Tuple(elts=[Constant(value='app', lineno=36, col_offset=50, end_lineno=36, end_col_offset=55), Constant(value='harvest', lineno=36, col_offset=57, end_lineno=36, end_col_offset=66)], ctx=Load(), lineno=36, col_offset=49, end_lineno=36, end_col_offset=67)], lineno=36, col_offset=15, end_lineno=36, end_col_offset=68), lineno=36, col_offset=4, end_lineno=36, end_col_offset=68), Assert(test=Call(func=Name(id='isinstance', ctx=Load(), lineno=37, col_offset=11, end_lineno=37, end_col_offset=21), args=[Name(id='metadata', ctx=Load(), lineno=37, col_offset=22, end_lineno=37, end_col_offset=30), Name(id='NavMetadataModel', ctx=Load(), lineno=37, col_offset=32, end_lineno=37, end_col_offset=48)], lineno=37, col_offset=11, end_lineno=37, end_col_offset=49), lineno=37, col_offset=4, end_lineno=37, end_col_offset=49), Assert(test=Compare(left=Attribute(value=Attribute(value=Name(id='metadata', ctx=Load(), lineno=38, col_offset=11, end_lineno=38, end_col_offset=19), attr='module_meta', ctx=Load(), lineno=38, col_offset=11, end_lineno=38, end_col_offset=31), attr='owner', ctx=Load(), lineno=38, col_offset=11, end_lineno=38, end_col_offset=37), ops=[Eq()], comparators=[Constant(value='@data-platform', lineno=38, col_offset=41, end_lineno=38, end_col_offset=57)], lineno=38, col_offset=11, end_lineno=38, end_col_offset=57), lineno=38, col_offset=4, end_lineno=38, end_col_offset=57), Assert(test=Compare(left=Attribute(value=Subscript(value=Attribute(value=Name(id='metadata', ctx=Load(), lineno=39, col_offset=11, end_lineno=39, end_col_offset=19), attr='symbols', ctx=Load(), lineno=39, col_offset=11, end_lineno=39, end_col_offset=27), slice=Constant(value='harvest', lineno=39, col_offset=28, end_lineno=39, end_col_offset=37), ctx=Load(), lineno=39, col_offset=11, end_lineno=39, end_col_offset=38), attr='handler', ctx=Load(), lineno=39, col_offset=11, end_lineno=39, end_col_offset=46), ops=[IsNot()], comparators=[Constant(value=None, lineno=39, col_offset=54, end_lineno=39, end_col_offset=58)], lineno=39, col_offset=11, end_lineno=39, end_col_offset=58), lineno=39, col_offset=4, end_lineno=39, end_col_offset=58), Assign(targets=[Name(id='section_symbol_names', ctx=Store(), lineno=41, col_offset=4, end_lineno=41, end_col_offset=24)], value=Call(func=Name(id='_symbol_names', ctx=Load(), lineno=41, col_offset=27, end_lineno=41, end_col_offset=40), args=[Subscript(value=Name(id='metadata', ctx=Load(), lineno=41, col_offset=41, end_lineno=41, end_col_offset=49), slice=Constant(value='sections', lineno=41, col_offset=50, end_lineno=41, end_col_offset=60), ctx=Load(), lineno=41, col_offset=41, end_lineno=41, end_col_offset=61)], lineno=41, col_offset=27, end_lineno=41, end_col_offset=62), lineno=41, col_offset=4, end_lineno=41, end_col_offset=62), Assert(test=Compare(left=Constant(value='harvest', lineno=42, col_offset=11, end_lineno=42, end_col_offset=20), ops=[In()], comparators=[Name(id='section_symbol_names', ctx=Load(), lineno=42, col_offset=24, end_lineno=42, end_col_offset=44)], lineno=42, col_offset=11, end_lineno=42, end_col_offset=44), lineno=42, col_offset=4, end_lineno=42, end_col_offset=44)], returns=Constant(value=None, lineno=35, col_offset=58, end_lineno=35, end_col_offset=62), lineno=35, col_offset=0, end_lineno=42, end_col_offset=44), FunctionDef(name='test_sidecar_metadata_validates', args=arguments(), body=[Assign(targets=[Name(id='metadata', ctx=Store(), lineno=46, col_offset=4, end_lineno=46, end_col_offset=12)], value=Call(func=Name(id='load_nav_metadata', ctx=Load(), lineno=46, col_offset=15, end_lineno=46, end_col_offset=32), args=[Constant(value='registry.helper', lineno=46, col_offset=33, end_lineno=46, end_col_offset=50), Tuple(elts=[Constant(value='DuckDBRegistryHelper', lineno=46, col_offset=53, end_lineno=46, end_col_offset=75)], ctx=Load(), lineno=46, col_offset=52, end_lineno=46, end_col_offset=77)], lineno=46, col_offset=15, end_lineno=46, end_col_offset=78), lineno=46, col_offset=4, end_lineno=46, end_col_offset=78), Assert(test=Call(func=Name(id='isinstance', ctx=Load(), lineno=47, col_offset=11, end_lineno=47, end_col_offset=21), args=[Name(id='metadata', ctx=Load(), lineno=47, col_offset=22, end_lineno=47, end_col_offset=30), Name(id='NavMetadataModel', ctx=Load(), lineno=47, col_offset=32, end_lineno=47, end_col_offset=48)], lineno=47, col_offset=11, end_lineno=47, end_col_offset=49), lineno=47, col_offset=4, end_lineno=47, end_col_offset=49), Assert(test=Compare(left=Attribute(value=Attribute(value=Name(id='metadata', ctx=Load(), lineno=48, col_offset=11, end_lineno=48, end_col_offset=19), attr='module_meta', ctx=Load(), lineno=48, col_offset=11, end_lineno=48, end_col_offset=31), attr='owner', ctx=Load(), lineno=48, col_offset=11, end_lineno=48, end_col_offset=37), ops=[Eq()], comparators=[Constant(value='@registry', lineno=48, col_offset=41, end_lineno=48, end_col_offset=52)], lineno=48, col_offset=11, end_lineno=48, end_col_offset=52), lineno=48, col_offset=4, end_lineno=48, end_col_offset=52), Assert(test=Compare(left=Constant(value='DuckDBRegistryHelper', lineno=49, col_offset=11, end_lineno=49, end_col_offset=33), ops=[In()], comparators=[Attribute(value=Name(id='metadata', ctx=Load(), lineno=49, col_offset=37, end_lineno=49, end_col_offset=45), attr='symbols', ctx=Load(), lineno=49, col_offset=37, end_lineno=49, end_col_offset=53)], lineno=49, col_offset=11, end_lineno=49, end_col_offset=53), lineno=49, col_offset=4, end_lineno=49, end_col_offset=53)], returns=Constant(value=None, lineno=45, col_offset=41, end_lineno=45, end_col_offset=45), lineno=45, col_offset=0, end_lineno=49, end_col_offset=53)])