Module(body=[Expr(value=Constant(value='Overview of schemas.\n\nThis module bundles schemas logic for the kgfoundry stack. It groups related helpers so downstream\npackages can import a single cohesive namespace. Refer to the functions and classes below for\nimplementation specifics.\n', lineno=1, col_offset=0, end_lineno=6, end_col_offset=3), lineno=1, col_offset=0, end_lineno=6, end_col_offset=3), ImportFrom(module='__future__', names=[alias(name='annotations', lineno=10, col_offset=23, end_lineno=10, end_col_offset=34)], level=0, lineno=10, col_offset=0, end_lineno=10, end_col_offset=34), Import(names=[alias(name='importlib', lineno=12, col_offset=7, end_lineno=12, end_col_offset=16)], lineno=12, col_offset=0, end_lineno=12, end_col_offset=16), ImportFrom(module='typing', names=[alias(name='TYPE_CHECKING', lineno=13, col_offset=19, end_lineno=13, end_col_offset=32), alias(name='ClassVar', lineno=13, col_offset=34, end_lineno=13, end_col_offset=42)], level=0, lineno=13, col_offset=0, end_lineno=13, end_col_offset=42), ImportFrom(module='pydantic', names=[alias(name='ConfigDict', lineno=15, col_offset=21, end_lineno=15, end_col_offset=31), alias(name='Field', lineno=15, col_offset=33, end_lineno=15, end_col_offset=38)], level=0, lineno=15, col_offset=0, end_lineno=15, end_col_offset=38), ImportFrom(module='kgfoundry_common.navmap_loader', names=[alias(name='load_nav_metadata', lineno=17, col_offset=43, end_lineno=17, end_col_offset=60)], level=0, lineno=17, col_offset=0, end_lineno=17, end_col_offset=60), ImportFrom(module='kgfoundry_common.pydantic', names=[alias(name='BaseModel', lineno=18, col_offset=38, end_lineno=18, end_col_offset=47)], level=0, lineno=18, col_offset=0, end_lineno=18, end_col_offset=47), If(test=Name(id='TYPE_CHECKING', ctx=Load(), lineno=20, col_offset=3, end_lineno=20, end_col_offset=16), body=[ImportFrom(module='kgfoundry_common.types', names=[alias(name='JsonValue', lineno=21, col_offset=39, end_lineno=21, end_col_offset=48)], level=0, lineno=21, col_offset=4, end_lineno=21, end_col_offset=48)], orelse=[Assign(targets=[Name(id='JsonValue', ctx=Store(), lineno=23, col_offset=4, end_lineno=23, end_col_offset=13)], value=Attribute(value=Call(func=Attribute(value=Name(id='importlib', ctx=Load(), lineno=23, col_offset=16, end_lineno=23, end_col_offset=25), attr='import_module', ctx=Load(), lineno=23, col_offset=16, end_lineno=23, end_col_offset=39), args=[Constant(value='kgfoundry_common.types', lineno=23, col_offset=40, end_lineno=23, end_col_offset=64)], lineno=23, col_offset=16, end_lineno=23, end_col_offset=65), attr='JsonValue', ctx=Load(), lineno=23, col_offset=16, end_lineno=23, end_col_offset=75), lineno=23, col_offset=4, end_lineno=23, end_col_offset=75)], lineno=20, col_offset=0, end_lineno=23, end_col_offset=75), Assign(targets=[Name(id='__all__', ctx=Store(), lineno=25, col_offset=0, end_lineno=25, end_col_offset=7)], value=List(elts=[Constant(value='SearchRequest', lineno=26, col_offset=4, end_lineno=26, end_col_offset=19), Constant(value='SearchResponse', lineno=27, col_offset=4, end_lineno=27, end_col_offset=20), Constant(value='SearchResult', lineno=28, col_offset=4, end_lineno=28, end_col_offset=18)], ctx=Load(), lineno=25, col_offset=10, end_lineno=29, end_col_offset=1), lineno=25, col_offset=0, end_lineno=29, end_col_offset=1), Assign(targets=[Name(id='__navmap__', ctx=Store(), lineno=30, col_offset=0, end_lineno=30, end_col_offset=10)], value=Call(func=Name(id='load_nav_metadata', ctx=Load(), lineno=30, col_offset=13, end_lineno=30, end_col_offset=30), args=[Name(id='__name__', ctx=Load(), lineno=30, col_offset=31, end_lineno=30, end_col_offset=39), Call(func=Name(id='tuple', ctx=Load(), lineno=30, col_offset=41, end_lineno=30, end_col_offset=46), args=[Name(id='__all__', ctx=Load(), lineno=30, col_offset=47, end_lineno=30, end_col_offset=54)], lineno=30, col_offset=41, end_lineno=30, end_col_offset=55)], lineno=30, col_offset=13, end_lineno=30, end_col_offset=56), lineno=30, col_offset=0, end_lineno=30, end_col_offset=56), ClassDef(name='SearchResponse', bases=[Name(id='BaseModel', ctx=Load(), lineno=34, col_offset=21, end_lineno=34, end_col_offset=30)], body=[Expr(value=Constant(value='Search API response envelope containing ordered results.', lineno=35, col_offset=4, end_lineno=35, end_col_offset=66), lineno=35, col_offset=4, end_lineno=35, end_col_offset=66), AnnAssign(target=Name(id='model_config', ctx=Store(), lineno=37, col_offset=4, end_lineno=37, end_col_offset=16), annotation=Subscript(value=Name(id='ClassVar', ctx=Load(), lineno=37, col_offset=18, end_lineno=37, end_col_offset=26), slice=Name(id='object', ctx=Load(), lineno=37, col_offset=27, end_lineno=37, end_col_offset=33), ctx=Load(), lineno=37, col_offset=18, end_lineno=37, end_col_offset=34), value=Call(func=Name(id='ConfigDict', ctx=Load(), lineno=37, col_offset=37, end_lineno=37, end_col_offset=47), keywords=[keyword(arg='extra', value=Constant(value='forbid', lineno=37, col_offset=54, end_lineno=37, end_col_offset=62), lineno=37, col_offset=48, end_lineno=37, end_col_offset=62)], lineno=37, col_offset=37, end_lineno=37, end_col_offset=63), simple=1, lineno=37, col_offset=4, end_lineno=37, end_col_offset=63), Expr(value=Constant(value='Pydantic configuration forbidding unexpected fields.', lineno=38, col_offset=4, end_lineno=38, end_col_offset=62), lineno=38, col_offset=4, end_lineno=38, end_col_offset=62), AnnAssign(target=Name(id='results', ctx=Store(), lineno=40, col_offset=4, end_lineno=40, end_col_offset=11), annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=40, col_offset=13, end_lineno=40, end_col_offset=17), slice=Name(id='SearchResult', ctx=Load(), lineno=40, col_offset=18, end_lineno=40, end_col_offset=30), ctx=Load(), lineno=40, col_offset=13, end_lineno=40, end_col_offset=31), value=Call(func=Name(id='Field', ctx=Load(), lineno=40, col_offset=34, end_lineno=40, end_col_offset=39), keywords=[keyword(arg='default_factory', value=Name(id='list', ctx=Load(), lineno=40, col_offset=56, end_lineno=40, end_col_offset=60), lineno=40, col_offset=40, end_lineno=40, end_col_offset=60)], lineno=40, col_offset=34, end_lineno=40, end_col_offset=61), simple=1, lineno=40, col_offset=4, end_lineno=40, end_col_offset=61), Expr(value=Constant(value='Ordered search results.\n\n    Alias: none; name ``results``.\n    ', lineno=41, col_offset=4, end_lineno=44, end_col_offset=7), lineno=41, col_offset=4, end_lineno=44, end_col_offset=7)], lineno=34, col_offset=0, end_lineno=44, end_col_offset=7), ClassDef(name='SearchRequest', bases=[Name(id='BaseModel', ctx=Load(), lineno=48, col_offset=20, end_lineno=48, end_col_offset=29)], body=[Expr(value=Constant(value='Search API request payload with optional filters and explain flag.\n\n    Attributes\n    ----------\n    model_config : ClassVar[object]\n        Pydantic configuration forbidding extra parameters.\n    query : str\n        Search query string (at least one character).\n    k : int\n        Number of results to return.\n    filters : dict[str, JsonValue] | None\n        Optional filters keyed by field.\n    explain : bool\n        Include explanation metadata flag.\n\n    Examples\n    --------\n    >>> from pathlib import Path\n    >>> from kgfoundry_common.schema_helpers import assert_model_roundtrip\n    >>> example_path = (\n    ...     Path(__file__).parent.parent.parent\n    ...     / "schema"\n    ...     / "examples"\n    ...     / "search_api"\n    ...     / "search_request.v1.json"\n    ... )\n    >>> assert_model_roundtrip(SearchRequest, example_path)\n    ', lineno=49, col_offset=4, end_lineno=76, end_col_offset=7), lineno=49, col_offset=4, end_lineno=76, end_col_offset=7), AnnAssign(target=Name(id='model_config', ctx=Store(), lineno=78, col_offset=4, end_lineno=78, end_col_offset=16), annotation=Subscript(value=Name(id='ClassVar', ctx=Load(), lineno=78, col_offset=18, end_lineno=78, end_col_offset=26), slice=Name(id='object', ctx=Load(), lineno=78, col_offset=27, end_lineno=78, end_col_offset=33), ctx=Load(), lineno=78, col_offset=18, end_lineno=78, end_col_offset=34), value=Call(func=Name(id='ConfigDict', ctx=Load(), lineno=78, col_offset=37, end_lineno=78, end_col_offset=47), keywords=[keyword(arg='extra', value=Constant(value='forbid', lineno=78, col_offset=54, end_lineno=78, end_col_offset=62), lineno=78, col_offset=48, end_lineno=78, end_col_offset=62)], lineno=78, col_offset=37, end_lineno=78, end_col_offset=63), simple=1, lineno=78, col_offset=4, end_lineno=78, end_col_offset=63), Expr(value=Constant(value='Pydantic configuration forbidding extra parameters.', lineno=79, col_offset=4, end_lineno=79, end_col_offset=61), lineno=79, col_offset=4, end_lineno=79, end_col_offset=61), AnnAssign(target=Name(id='query', ctx=Store(), lineno=81, col_offset=4, end_lineno=81, end_col_offset=9), annotation=Name(id='str', ctx=Load(), lineno=81, col_offset=11, end_lineno=81, end_col_offset=14), value=Call(func=Name(id='Field', ctx=Load(), lineno=81, col_offset=17, end_lineno=81, end_col_offset=22), keywords=[keyword(arg='min_length', value=Constant(value=1, lineno=81, col_offset=34, end_lineno=81, end_col_offset=35), lineno=81, col_offset=23, end_lineno=81, end_col_offset=35)], lineno=81, col_offset=17, end_lineno=81, end_col_offset=36), simple=1, lineno=81, col_offset=4, end_lineno=81, end_col_offset=36), Expr(value=Constant(value='Search query string (at least one character).\n\n    Alias: none; name ``query``.\n    ', lineno=82, col_offset=4, end_lineno=85, end_col_offset=7), lineno=82, col_offset=4, end_lineno=85, end_col_offset=7), AnnAssign(target=Name(id='k', ctx=Store(), lineno=86, col_offset=4, end_lineno=86, end_col_offset=5), annotation=Name(id='int', ctx=Load(), lineno=86, col_offset=7, end_lineno=86, end_col_offset=10), value=Constant(value=10, lineno=86, col_offset=13, end_lineno=86, end_col_offset=15), simple=1, lineno=86, col_offset=4, end_lineno=86, end_col_offset=15), Expr(value=Constant(value='Number of results to return.\n\n    Alias: none; name ``k``.\n    ', lineno=87, col_offset=4, end_lineno=90, end_col_offset=7), lineno=87, col_offset=4, end_lineno=90, end_col_offset=7), AnnAssign(target=Name(id='filters', ctx=Store(), lineno=91, col_offset=4, end_lineno=91, end_col_offset=11), annotation=BinOp(left=Subscript(value=Name(id='dict', ctx=Load(), lineno=91, col_offset=13, end_lineno=91, end_col_offset=17), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=91, col_offset=18, end_lineno=91, end_col_offset=21), Name(id='JsonValue', ctx=Load(), lineno=91, col_offset=23, end_lineno=91, end_col_offset=32)], ctx=Load(), lineno=91, col_offset=18, end_lineno=91, end_col_offset=32), ctx=Load(), lineno=91, col_offset=13, end_lineno=91, end_col_offset=33), op=BitOr(), right=Constant(value=None, lineno=91, col_offset=36, end_lineno=91, end_col_offset=40), lineno=91, col_offset=13, end_lineno=91, end_col_offset=40), value=Constant(value=None, lineno=91, col_offset=43, end_lineno=91, end_col_offset=47), simple=1, lineno=91, col_offset=4, end_lineno=91, end_col_offset=47), Expr(value=Constant(value='Optional filters keyed by field.\n\n    Alias: none; name ``filters``.\n    ', lineno=92, col_offset=4, end_lineno=95, end_col_offset=7), lineno=92, col_offset=4, end_lineno=95, end_col_offset=7), AnnAssign(target=Name(id='explain', ctx=Store(), lineno=96, col_offset=4, end_lineno=96, end_col_offset=11), annotation=Name(id='bool', ctx=Load(), lineno=96, col_offset=13, end_lineno=96, end_col_offset=17), value=Constant(value=False, lineno=96, col_offset=20, end_lineno=96, end_col_offset=25), simple=1, lineno=96, col_offset=4, end_lineno=96, end_col_offset=25), Expr(value=Constant(value='Include explanation metadata flag.\n\n    Alias: none; name ``explain``.\n    ', lineno=97, col_offset=4, end_lineno=100, end_col_offset=7), lineno=97, col_offset=4, end_lineno=100, end_col_offset=7)], lineno=48, col_offset=0, end_lineno=100, end_col_offset=7), ClassDef(name='SearchResult', bases=[Name(id='BaseModel', ctx=Load(), lineno=104, col_offset=19, end_lineno=104, end_col_offset=28)], body=[Expr(value=Constant(value='Search result model combining identifiers, score, and auxiliary signals.\n\n    Attributes\n    ----------\n    model_config : ClassVar[object]\n        Pydantic configuration forbidding extra fields.\n    doc_id : str\n        Document identifier.\n    chunk_id : str\n        Chunk identifier.\n    title : str\n        Document title.\n    section : str\n        Section label.\n    score : float\n        Relevance score.\n    signals : dict[str, float]\n        Signal scores (dense, sparse, kg).\n    spans : dict[str, int]\n        Character spans associated with the result.\n    concepts : list[dict[str, str]]\n        Linked concept metadata.\n\n    Examples\n    --------\n    >>> from pathlib import Path\n    >>> from kgfoundry_common.schema_helpers import assert_model_roundtrip\n    >>> example_path = (\n    ...     Path(__file__).parent.parent.parent\n    ...     / "schema"\n    ...     / "examples"\n    ...     / "search_api"\n    ...     / "search_result.v1.json"\n    ... )\n    >>> assert_model_roundtrip(SearchResult, example_path)\n    ', lineno=105, col_offset=4, end_lineno=140, end_col_offset=7), lineno=105, col_offset=4, end_lineno=140, end_col_offset=7), AnnAssign(target=Name(id='model_config', ctx=Store(), lineno=142, col_offset=4, end_lineno=142, end_col_offset=16), annotation=Subscript(value=Name(id='ClassVar', ctx=Load(), lineno=142, col_offset=18, end_lineno=142, end_col_offset=26), slice=Name(id='object', ctx=Load(), lineno=142, col_offset=27, end_lineno=142, end_col_offset=33), ctx=Load(), lineno=142, col_offset=18, end_lineno=142, end_col_offset=34), value=Call(func=Name(id='ConfigDict', ctx=Load(), lineno=142, col_offset=37, end_lineno=142, end_col_offset=47), keywords=[keyword(arg='extra', value=Constant(value='forbid', lineno=142, col_offset=54, end_lineno=142, end_col_offset=62), lineno=142, col_offset=48, end_lineno=142, end_col_offset=62)], lineno=142, col_offset=37, end_lineno=142, end_col_offset=63), simple=1, lineno=142, col_offset=4, end_lineno=142, end_col_offset=63), Expr(value=Constant(value='Pydantic configuration forbidding extra fields.', lineno=143, col_offset=4, end_lineno=143, end_col_offset=57), lineno=143, col_offset=4, end_lineno=143, end_col_offset=57), AnnAssign(target=Name(id='doc_id', ctx=Store(), lineno=145, col_offset=4, end_lineno=145, end_col_offset=10), annotation=Name(id='str', ctx=Load(), lineno=145, col_offset=12, end_lineno=145, end_col_offset=15), simple=1, lineno=145, col_offset=4, end_lineno=145, end_col_offset=15), Expr(value=Constant(value='Document identifier.\n\n    Alias: none; name ``doc_id``.\n    ', lineno=146, col_offset=4, end_lineno=149, end_col_offset=7), lineno=146, col_offset=4, end_lineno=149, end_col_offset=7), AnnAssign(target=Name(id='chunk_id', ctx=Store(), lineno=150, col_offset=4, end_lineno=150, end_col_offset=12), annotation=Name(id='str', ctx=Load(), lineno=150, col_offset=14, end_lineno=150, end_col_offset=17), simple=1, lineno=150, col_offset=4, end_lineno=150, end_col_offset=17), Expr(value=Constant(value='Chunk identifier.\n\n    Alias: none; name ``chunk_id``.\n    ', lineno=151, col_offset=4, end_lineno=154, end_col_offset=7), lineno=151, col_offset=4, end_lineno=154, end_col_offset=7), AnnAssign(target=Name(id='title', ctx=Store(), lineno=155, col_offset=4, end_lineno=155, end_col_offset=9), annotation=Name(id='str', ctx=Load(), lineno=155, col_offset=11, end_lineno=155, end_col_offset=14), simple=1, lineno=155, col_offset=4, end_lineno=155, end_col_offset=14), Expr(value=Constant(value='Document title.\n\n    Alias: none; name ``title``.\n    ', lineno=156, col_offset=4, end_lineno=159, end_col_offset=7), lineno=156, col_offset=4, end_lineno=159, end_col_offset=7), AnnAssign(target=Name(id='section', ctx=Store(), lineno=160, col_offset=4, end_lineno=160, end_col_offset=11), annotation=Name(id='str', ctx=Load(), lineno=160, col_offset=13, end_lineno=160, end_col_offset=16), simple=1, lineno=160, col_offset=4, end_lineno=160, end_col_offset=16), Expr(value=Constant(value='Section label.\n\n    Alias: none; name ``section``.\n    ', lineno=161, col_offset=4, end_lineno=164, end_col_offset=7), lineno=161, col_offset=4, end_lineno=164, end_col_offset=7), AnnAssign(target=Name(id='score', ctx=Store(), lineno=165, col_offset=4, end_lineno=165, end_col_offset=9), annotation=Name(id='float', ctx=Load(), lineno=165, col_offset=11, end_lineno=165, end_col_offset=16), simple=1, lineno=165, col_offset=4, end_lineno=165, end_col_offset=16), Expr(value=Constant(value='Relevance score.\n\n    Alias: none; name ``score``.\n    ', lineno=166, col_offset=4, end_lineno=169, end_col_offset=7), lineno=166, col_offset=4, end_lineno=169, end_col_offset=7), AnnAssign(target=Name(id='signals', ctx=Store(), lineno=170, col_offset=4, end_lineno=170, end_col_offset=11), annotation=Subscript(value=Name(id='dict', ctx=Load(), lineno=170, col_offset=13, end_lineno=170, end_col_offset=17), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=170, col_offset=18, end_lineno=170, end_col_offset=21), Name(id='float', ctx=Load(), lineno=170, col_offset=23, end_lineno=170, end_col_offset=28)], ctx=Load(), lineno=170, col_offset=18, end_lineno=170, end_col_offset=28), ctx=Load(), lineno=170, col_offset=13, end_lineno=170, end_col_offset=29), value=Call(func=Name(id='Field', ctx=Load(), lineno=170, col_offset=32, end_lineno=170, end_col_offset=37), keywords=[keyword(arg='default_factory', value=Name(id='dict', ctx=Load(), lineno=170, col_offset=54, end_lineno=170, end_col_offset=58), lineno=170, col_offset=38, end_lineno=170, end_col_offset=58)], lineno=170, col_offset=32, end_lineno=170, end_col_offset=59), simple=1, lineno=170, col_offset=4, end_lineno=170, end_col_offset=59), Expr(value=Constant(value='Signal scores (dense, sparse, kg).\n\n    Alias: none; name ``signals``.\n    ', lineno=171, col_offset=4, end_lineno=174, end_col_offset=7), lineno=171, col_offset=4, end_lineno=174, end_col_offset=7), AnnAssign(target=Name(id='spans', ctx=Store(), lineno=175, col_offset=4, end_lineno=175, end_col_offset=9), annotation=Subscript(value=Name(id='dict', ctx=Load(), lineno=175, col_offset=11, end_lineno=175, end_col_offset=15), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=175, col_offset=16, end_lineno=175, end_col_offset=19), Name(id='int', ctx=Load(), lineno=175, col_offset=21, end_lineno=175, end_col_offset=24)], ctx=Load(), lineno=175, col_offset=16, end_lineno=175, end_col_offset=24), ctx=Load(), lineno=175, col_offset=11, end_lineno=175, end_col_offset=25), value=Call(func=Name(id='Field', ctx=Load(), lineno=175, col_offset=28, end_lineno=175, end_col_offset=33), keywords=[keyword(arg='default_factory', value=Name(id='dict', ctx=Load(), lineno=175, col_offset=50, end_lineno=175, end_col_offset=54), lineno=175, col_offset=34, end_lineno=175, end_col_offset=54)], lineno=175, col_offset=28, end_lineno=175, end_col_offset=55), simple=1, lineno=175, col_offset=4, end_lineno=175, end_col_offset=55), Expr(value=Constant(value='Character spans associated with the result.\n\n    Alias: none; name ``spans``.\n    ', lineno=176, col_offset=4, end_lineno=179, end_col_offset=7), lineno=176, col_offset=4, end_lineno=179, end_col_offset=7), AnnAssign(target=Name(id='concepts', ctx=Store(), lineno=180, col_offset=4, end_lineno=180, end_col_offset=12), annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=180, col_offset=14, end_lineno=180, end_col_offset=18), slice=Subscript(value=Name(id='dict', ctx=Load(), lineno=180, col_offset=19, end_lineno=180, end_col_offset=23), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=180, col_offset=24, end_lineno=180, end_col_offset=27), Name(id='str', ctx=Load(), lineno=180, col_offset=29, end_lineno=180, end_col_offset=32)], ctx=Load(), lineno=180, col_offset=24, end_lineno=180, end_col_offset=32), ctx=Load(), lineno=180, col_offset=19, end_lineno=180, end_col_offset=33), ctx=Load(), lineno=180, col_offset=14, end_lineno=180, end_col_offset=34), value=Call(func=Name(id='Field', ctx=Load(), lineno=180, col_offset=37, end_lineno=180, end_col_offset=42), keywords=[keyword(arg='default_factory', value=Name(id='list', ctx=Load(), lineno=180, col_offset=59, end_lineno=180, end_col_offset=63), lineno=180, col_offset=43, end_lineno=180, end_col_offset=63)], lineno=180, col_offset=37, end_lineno=180, end_col_offset=64), simple=1, lineno=180, col_offset=4, end_lineno=180, end_col_offset=64), Expr(value=Constant(value='Linked concept metadata.\n\n    Alias: none; name ``concepts``.\n    ', lineno=181, col_offset=4, end_lineno=184, end_col_offset=7), lineno=181, col_offset=4, end_lineno=184, end_col_offset=7)], lineno=104, col_offset=0, end_lineno=184, end_col_offset=7)])