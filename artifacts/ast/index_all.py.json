Module(body=[Expr(value=Constant(value='One-shot indexing: SCIP → chunk → embed → Parquet → FAISS.\n\nThis script orchestrates the full indexing pipeline:\n1. Parse SCIP index for symbol definitions\n2. Chunk files using cAST (SCIP-based)\n3. Embed chunks with vLLM\n4. Write to Parquet with embeddings\n5. Build FAISS index with adaptive type selection\n\nThe FAISS index type is automatically selected based on corpus size:\n- Small (<5K vectors): Flat index (exact search, fast training)\n- Medium (5K-50K vectors): IVFFlat (balanced training/recall)\n- Large (>50K vectors): IVF-PQ (memory efficient, fast search)\n', lineno=2, col_offset=0, end_lineno=15, end_col_offset=3), lineno=2, col_offset=0, end_lineno=15, end_col_offset=3), ImportFrom(module='__future__', names=[alias(name='annotations', lineno=17, col_offset=23, end_lineno=17, end_col_offset=34)], level=0, lineno=17, col_offset=0, end_lineno=17, end_col_offset=34), Import(names=[alias(name='argparse', lineno=19, col_offset=7, end_lineno=19, end_col_offset=15)], lineno=19, col_offset=0, end_lineno=19, end_col_offset=15), Import(names=[alias(name='logging', lineno=20, col_offset=7, end_lineno=20, end_col_offset=14)], lineno=20, col_offset=0, end_lineno=20, end_col_offset=14), ImportFrom(module='collections', names=[alias(name='defaultdict', lineno=21, col_offset=24, end_lineno=21, end_col_offset=35)], level=0, lineno=21, col_offset=0, end_lineno=21, end_col_offset=35), ImportFrom(module='collections.abc', names=[alias(name='Mapping', lineno=22, col_offset=28, end_lineno=22, end_col_offset=35), alias(name='Sequence', lineno=22, col_offset=37, end_lineno=22, end_col_offset=45)], level=0, lineno=22, col_offset=0, end_lineno=22, end_col_offset=45), ImportFrom(module='dataclasses', names=[alias(name='dataclass', lineno=23, col_offset=24, end_lineno=23, end_col_offset=33)], level=0, lineno=23, col_offset=0, end_lineno=23, end_col_offset=33), ImportFrom(module='pathlib', names=[alias(name='Path', lineno=24, col_offset=20, end_lineno=24, end_col_offset=24)], level=0, lineno=24, col_offset=0, end_lineno=24, end_col_offset=24), Import(names=[alias(name='numpy', asname='np', lineno=26, col_offset=7, end_lineno=26, end_col_offset=18)], lineno=26, col_offset=0, end_lineno=26, end_col_offset=18), ImportFrom(module='codeintel_rev.config.settings', names=[alias(name='IndexConfig', lineno=29, col_offset=4, end_lineno=29, end_col_offset=15), alias(name='Settings', lineno=30, col_offset=4, end_lineno=30, end_col_offset=12), alias(name='VLLMConfig', lineno=31, col_offset=4, end_lineno=31, end_col_offset=14), alias(name='load_settings', lineno=32, col_offset=4, end_lineno=32, end_col_offset=17)], level=0, lineno=28, col_offset=0, end_lineno=33, end_col_offset=1), ImportFrom(module='codeintel_rev.indexing.cast_chunker', names=[alias(name='Chunk', lineno=34, col_offset=48, end_lineno=34, end_col_offset=53), alias(name='ChunkOptions', lineno=34, col_offset=55, end_lineno=34, end_col_offset=67), alias(name='chunk_file', lineno=34, col_offset=69, end_lineno=34, end_col_offset=79)], level=0, lineno=34, col_offset=0, end_lineno=34, end_col_offset=79), ImportFrom(module='codeintel_rev.indexing.scip_reader', names=[alias(name='SCIPIndex', lineno=36, col_offset=4, end_lineno=36, end_col_offset=13), alias(name='SymbolDef', lineno=37, col_offset=4, end_lineno=37, end_col_offset=13), alias(name='extract_definitions', lineno=38, col_offset=4, end_lineno=38, end_col_offset=23), alias(name='get_top_level_definitions', lineno=39, col_offset=4, end_lineno=39, end_col_offset=29), alias(name='parse_scip_json', lineno=40, col_offset=4, end_lineno=40, end_col_offset=19)], level=0, lineno=35, col_offset=0, end_lineno=41, end_col_offset=1), ImportFrom(module='codeintel_rev.io.duckdb_catalog', names=[alias(name='DuckDBCatalog', lineno=42, col_offset=44, end_lineno=42, end_col_offset=57)], level=0, lineno=42, col_offset=0, end_lineno=42, end_col_offset=57), ImportFrom(module='codeintel_rev.io.duckdb_manager', names=[alias(name='DuckDBManager', lineno=43, col_offset=44, end_lineno=43, end_col_offset=57)], level=0, lineno=43, col_offset=0, end_lineno=43, end_col_offset=57), ImportFrom(module='codeintel_rev.io.faiss_manager', names=[alias(name='FAISSManager', lineno=44, col_offset=43, end_lineno=44, end_col_offset=55)], level=0, lineno=44, col_offset=0, end_lineno=44, end_col_offset=55), ImportFrom(module='codeintel_rev.io.parquet_store', names=[alias(name='ParquetWriteOptions', lineno=45, col_offset=43, end_lineno=45, end_col_offset=62), alias(name='write_chunks_parquet', lineno=45, col_offset=64, end_lineno=45, end_col_offset=84)], level=0, lineno=45, col_offset=0, end_lineno=45, end_col_offset=84), ImportFrom(module='codeintel_rev.io.symbol_catalog', names=[alias(name='SymbolCatalog', lineno=47, col_offset=4, end_lineno=47, end_col_offset=17), alias(name='SymbolDefRow', lineno=48, col_offset=4, end_lineno=48, end_col_offset=16), alias(name='SymbolOccurrenceRow', lineno=49, col_offset=4, end_lineno=49, end_col_offset=23)], level=0, lineno=46, col_offset=0, end_lineno=50, end_col_offset=1), ImportFrom(module='codeintel_rev.io.vllm_client', names=[alias(name='VLLMClient', lineno=51, col_offset=41, end_lineno=51, end_col_offset=51)], level=0, lineno=51, col_offset=0, end_lineno=51, end_col_offset=51), Expr(value=Call(func=Attribute(value=Name(id='logging', ctx=Load(), lineno=53, col_offset=0, end_lineno=53, end_col_offset=7), attr='basicConfig', ctx=Load(), lineno=53, col_offset=0, end_lineno=53, end_col_offset=19), keywords=[keyword(arg='level', value=Attribute(value=Name(id='logging', ctx=Load(), lineno=53, col_offset=26, end_lineno=53, end_col_offset=33), attr='INFO', ctx=Load(), lineno=53, col_offset=26, end_lineno=53, end_col_offset=38), lineno=53, col_offset=20, end_lineno=53, end_col_offset=38)], lineno=53, col_offset=0, end_lineno=53, end_col_offset=39), lineno=53, col_offset=0, end_lineno=53, end_col_offset=39), Assign(targets=[Name(id='logger', ctx=Store(), lineno=54, col_offset=0, end_lineno=54, end_col_offset=6)], value=Call(func=Attribute(value=Name(id='logging', ctx=Load(), lineno=54, col_offset=9, end_lineno=54, end_col_offset=16), attr='getLogger', ctx=Load(), lineno=54, col_offset=9, end_lineno=54, end_col_offset=26), args=[Name(id='__name__', ctx=Load(), lineno=54, col_offset=27, end_lineno=54, end_col_offset=35)], lineno=54, col_offset=9, end_lineno=54, end_col_offset=36), lineno=54, col_offset=0, end_lineno=54, end_col_offset=36), Assign(targets=[Name(id='EMBED_PREVIEW_CHARS', ctx=Store(), lineno=56, col_offset=0, end_lineno=56, end_col_offset=19)], value=Constant(value=1000, lineno=56, col_offset=22, end_lineno=56, end_col_offset=26), lineno=56, col_offset=0, end_lineno=56, end_col_offset=26), Assign(targets=[Name(id='TRAINING_LIMIT', ctx=Store(), lineno=57, col_offset=0, end_lineno=57, end_col_offset=14)], value=Constant(value=10000, lineno=57, col_offset=17, end_lineno=57, end_col_offset=23), lineno=57, col_offset=0, end_lineno=57, end_col_offset=23), ClassDef(name='PipelinePaths', body=[Expr(value=Constant(value='Resolved filesystem paths for the indexing pipeline.', lineno=62, col_offset=4, end_lineno=62, end_col_offset=62), lineno=62, col_offset=4, end_lineno=62, end_col_offset=62), AnnAssign(target=Name(id='repo_root', ctx=Store(), lineno=64, col_offset=4, end_lineno=64, end_col_offset=13), annotation=Name(id='Path', ctx=Load(), lineno=64, col_offset=15, end_lineno=64, end_col_offset=19), simple=1, lineno=64, col_offset=4, end_lineno=64, end_col_offset=19), AnnAssign(target=Name(id='scip_index', ctx=Store(), lineno=65, col_offset=4, end_lineno=65, end_col_offset=14), annotation=Name(id='Path', ctx=Load(), lineno=65, col_offset=16, end_lineno=65, end_col_offset=20), simple=1, lineno=65, col_offset=4, end_lineno=65, end_col_offset=20), AnnAssign(target=Name(id='vectors_dir', ctx=Store(), lineno=66, col_offset=4, end_lineno=66, end_col_offset=15), annotation=Name(id='Path', ctx=Load(), lineno=66, col_offset=17, end_lineno=66, end_col_offset=21), simple=1, lineno=66, col_offset=4, end_lineno=66, end_col_offset=21), AnnAssign(target=Name(id='faiss_index', ctx=Store(), lineno=67, col_offset=4, end_lineno=67, end_col_offset=15), annotation=Name(id='Path', ctx=Load(), lineno=67, col_offset=17, end_lineno=67, end_col_offset=21), simple=1, lineno=67, col_offset=4, end_lineno=67, end_col_offset=21), AnnAssign(target=Name(id='duckdb_path', ctx=Store(), lineno=68, col_offset=4, end_lineno=68, end_col_offset=15), annotation=Name(id='Path', ctx=Load(), lineno=68, col_offset=17, end_lineno=68, end_col_offset=21), simple=1, lineno=68, col_offset=4, end_lineno=68, end_col_offset=21)], decorator_list=[Call(func=Name(id='dataclass', ctx=Load(), lineno=60, col_offset=1, end_lineno=60, end_col_offset=10), keywords=[keyword(arg='frozen', value=Constant(value=True, lineno=60, col_offset=18, end_lineno=60, end_col_offset=22), lineno=60, col_offset=11, end_lineno=60, end_col_offset=22)], lineno=60, col_offset=1, end_lineno=60, end_col_offset=23)], lineno=61, col_offset=0, end_lineno=68, end_col_offset=21), FunctionDef(name='main', args=arguments(), body=[Expr(value=Constant(value='Run the end-to-end indexing pipeline.\n\n    Supports both full rebuild (default) and incremental update modes.\n    Use --incremental to add new chunks to an existing index instead of rebuilding.\n    ', lineno=72, col_offset=4, end_lineno=76, end_col_offset=7), lineno=72, col_offset=4, end_lineno=76, end_col_offset=7), Assign(targets=[Name(id='parser', ctx=Store(), lineno=77, col_offset=4, end_lineno=77, end_col_offset=10)], value=Call(func=Attribute(value=Name(id='argparse', ctx=Load(), lineno=77, col_offset=13, end_lineno=77, end_col_offset=21), attr='ArgumentParser', ctx=Load(), lineno=77, col_offset=13, end_lineno=77, end_col_offset=36), keywords=[keyword(arg='description', value=Constant(value='Index repository: SCIP → chunk → embed → Parquet → FAISS', lineno=78, col_offset=20, end_lineno=78, end_col_offset=86), lineno=78, col_offset=8, end_lineno=78, end_col_offset=86), keyword(arg='formatter_class', value=Attribute(value=Name(id='argparse', ctx=Load(), lineno=79, col_offset=24, end_lineno=79, end_col_offset=32), attr='RawDescriptionHelpFormatter', ctx=Load(), lineno=79, col_offset=24, end_lineno=79, end_col_offset=60), lineno=79, col_offset=8, end_lineno=79, end_col_offset=60)], lineno=77, col_offset=13, end_lineno=80, end_col_offset=5), lineno=77, col_offset=4, end_lineno=80, end_col_offset=5), Expr(value=Call(func=Attribute(value=Name(id='parser', ctx=Load(), lineno=81, col_offset=4, end_lineno=81, end_col_offset=10), attr='add_argument', ctx=Load(), lineno=81, col_offset=4, end_lineno=81, end_col_offset=23), args=[Constant(value='--incremental', lineno=82, col_offset=8, end_lineno=82, end_col_offset=23)], keywords=[keyword(arg='action', value=Constant(value='store_true', lineno=83, col_offset=15, end_lineno=83, end_col_offset=27), lineno=83, col_offset=8, end_lineno=83, end_col_offset=27), keyword(arg='help', value=Constant(value='Add new chunks to existing index instead of rebuilding (fast incremental updates)', lineno=84, col_offset=13, end_lineno=84, end_col_offset=96), lineno=84, col_offset=8, end_lineno=84, end_col_offset=96)], lineno=81, col_offset=4, end_lineno=85, end_col_offset=5), lineno=81, col_offset=4, end_lineno=85, end_col_offset=5), Assign(targets=[Name(id='args', ctx=Store(), lineno=86, col_offset=4, end_lineno=86, end_col_offset=8)], value=Call(func=Attribute(value=Name(id='parser', ctx=Load(), lineno=86, col_offset=11, end_lineno=86, end_col_offset=17), attr='parse_args', ctx=Load(), lineno=86, col_offset=11, end_lineno=86, end_col_offset=28), lineno=86, col_offset=11, end_lineno=86, end_col_offset=30), lineno=86, col_offset=4, end_lineno=86, end_col_offset=30), Assign(targets=[Name(id='settings', ctx=Store(), lineno=88, col_offset=4, end_lineno=88, end_col_offset=12)], value=Call(func=Name(id='load_settings', ctx=Load(), lineno=88, col_offset=15, end_lineno=88, end_col_offset=28), lineno=88, col_offset=15, end_lineno=88, end_col_offset=30), lineno=88, col_offset=4, end_lineno=88, end_col_offset=30), Assign(targets=[Name(id='paths', ctx=Store(), lineno=89, col_offset=4, end_lineno=89, end_col_offset=9)], value=Call(func=Name(id='_resolve_paths', ctx=Load(), lineno=89, col_offset=12, end_lineno=89, end_col_offset=26), args=[Name(id='settings', ctx=Load(), lineno=89, col_offset=27, end_lineno=89, end_col_offset=35)], lineno=89, col_offset=12, end_lineno=89, end_col_offset=36), lineno=89, col_offset=4, end_lineno=89, end_col_offset=36), Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=91, col_offset=4, end_lineno=91, end_col_offset=10), attr='info', ctx=Load(), lineno=91, col_offset=4, end_lineno=91, end_col_offset=15), args=[Constant(value='Starting indexing for repo root %s', lineno=91, col_offset=16, end_lineno=91, end_col_offset=52), Attribute(value=Name(id='paths', ctx=Load(), lineno=91, col_offset=54, end_lineno=91, end_col_offset=59), attr='repo_root', ctx=Load(), lineno=91, col_offset=54, end_lineno=91, end_col_offset=69)], lineno=91, col_offset=4, end_lineno=91, end_col_offset=70), lineno=91, col_offset=4, end_lineno=91, end_col_offset=70), Assign(targets=[Name(id='scip_index', ctx=Store(), lineno=92, col_offset=4, end_lineno=92, end_col_offset=14)], value=Call(func=Name(id='_load_scip_index', ctx=Load(), lineno=92, col_offset=17, end_lineno=92, end_col_offset=33), args=[Name(id='paths', ctx=Load(), lineno=92, col_offset=34, end_lineno=92, end_col_offset=39)], lineno=92, col_offset=17, end_lineno=92, end_col_offset=40), lineno=92, col_offset=4, end_lineno=92, end_col_offset=40), Assign(targets=[Name(id='grouped_defs', ctx=Store(), lineno=93, col_offset=4, end_lineno=93, end_col_offset=16)], value=Call(func=Name(id='_group_definitions_by_file', ctx=Load(), lineno=93, col_offset=19, end_lineno=93, end_col_offset=45), args=[Name(id='scip_index', ctx=Load(), lineno=93, col_offset=46, end_lineno=93, end_col_offset=56)], lineno=93, col_offset=19, end_lineno=93, end_col_offset=57), lineno=93, col_offset=4, end_lineno=93, end_col_offset=57), Assign(targets=[Name(id='chunks', ctx=Store(), lineno=94, col_offset=4, end_lineno=94, end_col_offset=10)], value=Call(func=Name(id='_chunk_repository', ctx=Load(), lineno=94, col_offset=13, end_lineno=94, end_col_offset=30), args=[Name(id='paths', ctx=Load(), lineno=94, col_offset=31, end_lineno=94, end_col_offset=36), Name(id='grouped_defs', ctx=Load(), lineno=94, col_offset=38, end_lineno=94, end_col_offset=50), Attribute(value=Attribute(value=Name(id='settings', ctx=Load(), lineno=94, col_offset=52, end_lineno=94, end_col_offset=60), attr='index', ctx=Load(), lineno=94, col_offset=52, end_lineno=94, end_col_offset=66), attr='chunk_budget', ctx=Load(), lineno=94, col_offset=52, end_lineno=94, end_col_offset=79)], lineno=94, col_offset=13, end_lineno=94, end_col_offset=80), lineno=94, col_offset=4, end_lineno=94, end_col_offset=80), If(test=UnaryOp(op=Not(), operand=Name(id='chunks', ctx=Load(), lineno=96, col_offset=11, end_lineno=96, end_col_offset=17), lineno=96, col_offset=7, end_lineno=96, end_col_offset=17), body=[Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=97, col_offset=8, end_lineno=97, end_col_offset=14), attr='error', ctx=Load(), lineno=97, col_offset=8, end_lineno=97, end_col_offset=20), args=[Constant(value='No chunks were produced; aborting pipeline', lineno=97, col_offset=21, end_lineno=97, end_col_offset=65)], lineno=97, col_offset=8, end_lineno=97, end_col_offset=66), lineno=97, col_offset=8, end_lineno=97, end_col_offset=66), Return(lineno=98, col_offset=8, end_lineno=98, end_col_offset=14)], lineno=96, col_offset=4, end_lineno=98, end_col_offset=14), Assign(targets=[Name(id='embeddings', ctx=Store(), lineno=100, col_offset=4, end_lineno=100, end_col_offset=14)], value=Call(func=Name(id='_embed_chunks', ctx=Load(), lineno=100, col_offset=17, end_lineno=100, end_col_offset=30), args=[Name(id='chunks', ctx=Load(), lineno=100, col_offset=31, end_lineno=100, end_col_offset=37), Attribute(value=Name(id='settings', ctx=Load(), lineno=100, col_offset=39, end_lineno=100, end_col_offset=47), attr='vllm', ctx=Load(), lineno=100, col_offset=39, end_lineno=100, end_col_offset=52)], lineno=100, col_offset=17, end_lineno=100, end_col_offset=53), lineno=100, col_offset=4, end_lineno=100, end_col_offset=53), Assign(targets=[Name(id='parquet_path', ctx=Store(), lineno=101, col_offset=4, end_lineno=101, end_col_offset=16)], value=Call(func=Name(id='_write_parquet', ctx=Load(), lineno=101, col_offset=19, end_lineno=101, end_col_offset=33), args=[Name(id='chunks', ctx=Load(), lineno=102, col_offset=8, end_lineno=102, end_col_offset=14), Name(id='embeddings', ctx=Load(), lineno=103, col_offset=8, end_lineno=103, end_col_offset=18), Name(id='paths', ctx=Load(), lineno=104, col_offset=8, end_lineno=104, end_col_offset=13), Attribute(value=Attribute(value=Name(id='settings', ctx=Load(), lineno=105, col_offset=8, end_lineno=105, end_col_offset=16), attr='index', ctx=Load(), lineno=105, col_offset=8, end_lineno=105, end_col_offset=22), attr='vec_dim', ctx=Load(), lineno=105, col_offset=8, end_lineno=105, end_col_offset=30), Attribute(value=Attribute(value=Name(id='settings', ctx=Load(), lineno=106, col_offset=8, end_lineno=106, end_col_offset=16), attr='index', ctx=Load(), lineno=106, col_offset=8, end_lineno=106, end_col_offset=22), attr='preview_max_chars', ctx=Load(), lineno=106, col_offset=8, end_lineno=106, end_col_offset=40)], lineno=101, col_offset=19, end_lineno=107, end_col_offset=5), lineno=101, col_offset=4, end_lineno=107, end_col_offset=5), If(test=Attribute(value=Name(id='args', ctx=Load(), lineno=109, col_offset=7, end_lineno=109, end_col_offset=11), attr='incremental', ctx=Load(), lineno=109, col_offset=7, end_lineno=109, end_col_offset=23), body=[Expr(value=Call(func=Name(id='_update_faiss_index_incremental', ctx=Load(), lineno=110, col_offset=8, end_lineno=110, end_col_offset=39), args=[Name(id='chunks', ctx=Load(), lineno=110, col_offset=40, end_lineno=110, end_col_offset=46), Name(id='embeddings', ctx=Load(), lineno=110, col_offset=48, end_lineno=110, end_col_offset=58), Name(id='paths', ctx=Load(), lineno=110, col_offset=60, end_lineno=110, end_col_offset=65), Attribute(value=Name(id='settings', ctx=Load(), lineno=110, col_offset=67, end_lineno=110, end_col_offset=75), attr='index', ctx=Load(), lineno=110, col_offset=67, end_lineno=110, end_col_offset=81)], lineno=110, col_offset=8, end_lineno=110, end_col_offset=82), lineno=110, col_offset=8, end_lineno=110, end_col_offset=82)], orelse=[Expr(value=Call(func=Name(id='_build_faiss_index', ctx=Load(), lineno=112, col_offset=8, end_lineno=112, end_col_offset=26), args=[Name(id='embeddings', ctx=Load(), lineno=112, col_offset=27, end_lineno=112, end_col_offset=37), Name(id='paths', ctx=Load(), lineno=112, col_offset=39, end_lineno=112, end_col_offset=44), Attribute(value=Name(id='settings', ctx=Load(), lineno=112, col_offset=46, end_lineno=112, end_col_offset=54), attr='index', ctx=Load(), lineno=112, col_offset=46, end_lineno=112, end_col_offset=60)], lineno=112, col_offset=8, end_lineno=112, end_col_offset=61), lineno=112, col_offset=8, end_lineno=112, end_col_offset=61)], lineno=109, col_offset=4, end_lineno=112, end_col_offset=61), Assign(targets=[Name(id='catalog_count', ctx=Store(), lineno=114, col_offset=4, end_lineno=114, end_col_offset=17)], value=Call(func=Name(id='_initialize_duckdb', ctx=Load(), lineno=114, col_offset=20, end_lineno=114, end_col_offset=38), args=[Name(id='paths', ctx=Load(), lineno=115, col_offset=8, end_lineno=115, end_col_offset=13)], keywords=[keyword(arg='materialize', value=Attribute(value=Attribute(value=Name(id='settings', ctx=Load(), lineno=116, col_offset=20, end_lineno=116, end_col_offset=28), attr='index', ctx=Load(), lineno=116, col_offset=20, end_lineno=116, end_col_offset=34), attr='duckdb_materialize', ctx=Load(), lineno=116, col_offset=20, end_lineno=116, end_col_offset=53), lineno=116, col_offset=8, end_lineno=116, end_col_offset=53)], lineno=114, col_offset=20, end_lineno=117, end_col_offset=5), lineno=114, col_offset=4, end_lineno=117, end_col_offset=5), Expr(value=Call(func=Name(id='_write_symbols', ctx=Load(), lineno=118, col_offset=4, end_lineno=118, end_col_offset=18), args=[Name(id='paths', ctx=Load(), lineno=118, col_offset=19, end_lineno=118, end_col_offset=24), Name(id='scip_index', ctx=Load(), lineno=118, col_offset=26, end_lineno=118, end_col_offset=36), Name(id='chunks', ctx=Load(), lineno=118, col_offset=38, end_lineno=118, end_col_offset=44)], lineno=118, col_offset=4, end_lineno=118, end_col_offset=45), lineno=118, col_offset=4, end_lineno=118, end_col_offset=45), Assign(targets=[Name(id='mode_str', ctx=Store(), lineno=120, col_offset=4, end_lineno=120, end_col_offset=12)], value=IfExp(test=Attribute(value=Name(id='args', ctx=Load(), lineno=120, col_offset=32, end_lineno=120, end_col_offset=36), attr='incremental', ctx=Load(), lineno=120, col_offset=32, end_lineno=120, end_col_offset=48), body=Constant(value='incremental', lineno=120, col_offset=15, end_lineno=120, end_col_offset=28), orelse=Constant(value='full rebuild', lineno=120, col_offset=54, end_lineno=120, end_col_offset=68), lineno=120, col_offset=15, end_lineno=120, end_col_offset=68), lineno=120, col_offset=4, end_lineno=120, end_col_offset=68), Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=121, col_offset=4, end_lineno=121, end_col_offset=10), attr='info', ctx=Load(), lineno=121, col_offset=4, end_lineno=121, end_col_offset=15), args=[Constant(value='Indexing pipeline complete (%s); chunks=%s embeddings=%s parquet=%s faiss_index=%s duckdb_rows=%s', lineno=122, col_offset=8, end_lineno=123, end_col_offset=39), Name(id='mode_str', ctx=Load(), lineno=124, col_offset=8, end_lineno=124, end_col_offset=16), Call(func=Name(id='len', ctx=Load(), lineno=125, col_offset=8, end_lineno=125, end_col_offset=11), args=[Name(id='chunks', ctx=Load(), lineno=125, col_offset=12, end_lineno=125, end_col_offset=18)], lineno=125, col_offset=8, end_lineno=125, end_col_offset=19), Call(func=Name(id='len', ctx=Load(), lineno=126, col_offset=8, end_lineno=126, end_col_offset=11), args=[Name(id='embeddings', ctx=Load(), lineno=126, col_offset=12, end_lineno=126, end_col_offset=22)], lineno=126, col_offset=8, end_lineno=126, end_col_offset=23), Name(id='parquet_path', ctx=Load(), lineno=127, col_offset=8, end_lineno=127, end_col_offset=20), Attribute(value=Name(id='paths', ctx=Load(), lineno=128, col_offset=8, end_lineno=128, end_col_offset=13), attr='faiss_index', ctx=Load(), lineno=128, col_offset=8, end_lineno=128, end_col_offset=25), Name(id='catalog_count', ctx=Load(), lineno=129, col_offset=8, end_lineno=129, end_col_offset=21)], lineno=121, col_offset=4, end_lineno=130, end_col_offset=5), lineno=121, col_offset=4, end_lineno=130, end_col_offset=5)], returns=Constant(value=None, lineno=71, col_offset=14, end_lineno=71, end_col_offset=18), lineno=71, col_offset=0, end_lineno=130, end_col_offset=5), FunctionDef(name='_resolve_paths', args=arguments(args=[arg(arg='settings', annotation=Name(id='Settings', ctx=Load(), lineno=133, col_offset=29, end_lineno=133, end_col_offset=37), lineno=133, col_offset=19, end_lineno=133, end_col_offset=37)]), body=[Expr(value=Constant(value='Resolve and normalize key filesystem paths.\n\n    Parameters\n    ----------\n    settings : Settings\n        Application settings containing path configuration.\n\n    Returns\n    -------\n    PipelinePaths\n        Absolute paths for all filesystem locations used by the pipeline.\n    ', lineno=134, col_offset=4, end_lineno=145, end_col_offset=7), lineno=134, col_offset=4, end_lineno=145, end_col_offset=7), Assign(targets=[Name(id='repo_root', ctx=Store(), lineno=146, col_offset=4, end_lineno=146, end_col_offset=13)], value=Call(func=Attribute(value=Call(func=Attribute(value=Call(func=Name(id='Path', ctx=Load(), lineno=146, col_offset=16, end_lineno=146, end_col_offset=20), args=[Attribute(value=Attribute(value=Name(id='settings', ctx=Load(), lineno=146, col_offset=21, end_lineno=146, end_col_offset=29), attr='paths', ctx=Load(), lineno=146, col_offset=21, end_lineno=146, end_col_offset=35), attr='repo_root', ctx=Load(), lineno=146, col_offset=21, end_lineno=146, end_col_offset=45)], lineno=146, col_offset=16, end_lineno=146, end_col_offset=46), attr='expanduser', ctx=Load(), lineno=146, col_offset=16, end_lineno=146, end_col_offset=57), lineno=146, col_offset=16, end_lineno=146, end_col_offset=59), attr='resolve', ctx=Load(), lineno=146, col_offset=16, end_lineno=146, end_col_offset=67), lineno=146, col_offset=16, end_lineno=146, end_col_offset=69), lineno=146, col_offset=4, end_lineno=146, end_col_offset=69), FunctionDef(name='_resolve', args=arguments(args=[arg(arg='path_str', annotation=Name(id='str', ctx=Load(), lineno=148, col_offset=27, end_lineno=148, end_col_offset=30), lineno=148, col_offset=17, end_lineno=148, end_col_offset=30)]), body=[Assign(targets=[Name(id='path', ctx=Store(), lineno=149, col_offset=8, end_lineno=149, end_col_offset=12)], value=Call(func=Name(id='Path', ctx=Load(), lineno=149, col_offset=15, end_lineno=149, end_col_offset=19), args=[Name(id='path_str', ctx=Load(), lineno=149, col_offset=20, end_lineno=149, end_col_offset=28)], lineno=149, col_offset=15, end_lineno=149, end_col_offset=29), lineno=149, col_offset=8, end_lineno=149, end_col_offset=29), If(test=Call(func=Attribute(value=Name(id='path', ctx=Load(), lineno=150, col_offset=11, end_lineno=150, end_col_offset=15), attr='is_absolute', ctx=Load(), lineno=150, col_offset=11, end_lineno=150, end_col_offset=27), lineno=150, col_offset=11, end_lineno=150, end_col_offset=29), body=[Return(value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='path', ctx=Load(), lineno=151, col_offset=19, end_lineno=151, end_col_offset=23), attr='expanduser', ctx=Load(), lineno=151, col_offset=19, end_lineno=151, end_col_offset=34), lineno=151, col_offset=19, end_lineno=151, end_col_offset=36), attr='resolve', ctx=Load(), lineno=151, col_offset=19, end_lineno=151, end_col_offset=44), lineno=151, col_offset=19, end_lineno=151, end_col_offset=46), lineno=151, col_offset=12, end_lineno=151, end_col_offset=46)], lineno=150, col_offset=8, end_lineno=151, end_col_offset=46), Return(value=Call(func=Attribute(value=BinOp(left=Name(id='repo_root', ctx=Load(), lineno=152, col_offset=16, end_lineno=152, end_col_offset=25), op=Div(), right=Name(id='path', ctx=Load(), lineno=152, col_offset=28, end_lineno=152, end_col_offset=32), lineno=152, col_offset=16, end_lineno=152, end_col_offset=32), attr='resolve', ctx=Load(), lineno=152, col_offset=15, end_lineno=152, end_col_offset=41), lineno=152, col_offset=15, end_lineno=152, end_col_offset=43), lineno=152, col_offset=8, end_lineno=152, end_col_offset=43)], returns=Name(id='Path', ctx=Load(), lineno=148, col_offset=35, end_lineno=148, end_col_offset=39), lineno=148, col_offset=4, end_lineno=152, end_col_offset=43), Return(value=Call(func=Name(id='PipelinePaths', ctx=Load(), lineno=154, col_offset=11, end_lineno=154, end_col_offset=24), keywords=[keyword(arg='repo_root', value=Name(id='repo_root', ctx=Load(), lineno=155, col_offset=18, end_lineno=155, end_col_offset=27), lineno=155, col_offset=8, end_lineno=155, end_col_offset=27), keyword(arg='scip_index', value=Call(func=Name(id='_resolve', ctx=Load(), lineno=156, col_offset=19, end_lineno=156, end_col_offset=27), args=[Attribute(value=Attribute(value=Name(id='settings', ctx=Load(), lineno=156, col_offset=28, end_lineno=156, end_col_offset=36), attr='paths', ctx=Load(), lineno=156, col_offset=28, end_lineno=156, end_col_offset=42), attr='scip_index', ctx=Load(), lineno=156, col_offset=28, end_lineno=156, end_col_offset=53)], lineno=156, col_offset=19, end_lineno=156, end_col_offset=54), lineno=156, col_offset=8, end_lineno=156, end_col_offset=54), keyword(arg='vectors_dir', value=Call(func=Name(id='_resolve', ctx=Load(), lineno=157, col_offset=20, end_lineno=157, end_col_offset=28), args=[Attribute(value=Attribute(value=Name(id='settings', ctx=Load(), lineno=157, col_offset=29, end_lineno=157, end_col_offset=37), attr='paths', ctx=Load(), lineno=157, col_offset=29, end_lineno=157, end_col_offset=43), attr='vectors_dir', ctx=Load(), lineno=157, col_offset=29, end_lineno=157, end_col_offset=55)], lineno=157, col_offset=20, end_lineno=157, end_col_offset=56), lineno=157, col_offset=8, end_lineno=157, end_col_offset=56), keyword(arg='faiss_index', value=Call(func=Name(id='_resolve', ctx=Load(), lineno=158, col_offset=20, end_lineno=158, end_col_offset=28), args=[Attribute(value=Attribute(value=Name(id='settings', ctx=Load(), lineno=158, col_offset=29, end_lineno=158, end_col_offset=37), attr='paths', ctx=Load(), lineno=158, col_offset=29, end_lineno=158, end_col_offset=43), attr='faiss_index', ctx=Load(), lineno=158, col_offset=29, end_lineno=158, end_col_offset=55)], lineno=158, col_offset=20, end_lineno=158, end_col_offset=56), lineno=158, col_offset=8, end_lineno=158, end_col_offset=56), keyword(arg='duckdb_path', value=Call(func=Name(id='_resolve', ctx=Load(), lineno=159, col_offset=20, end_lineno=159, end_col_offset=28), args=[Attribute(value=Attribute(value=Name(id='settings', ctx=Load(), lineno=159, col_offset=29, end_lineno=159, end_col_offset=37), attr='paths', ctx=Load(), lineno=159, col_offset=29, end_lineno=159, end_col_offset=43), attr='duckdb_path', ctx=Load(), lineno=159, col_offset=29, end_lineno=159, end_col_offset=55)], lineno=159, col_offset=20, end_lineno=159, end_col_offset=56), lineno=159, col_offset=8, end_lineno=159, end_col_offset=56)], lineno=154, col_offset=11, end_lineno=160, end_col_offset=5), lineno=154, col_offset=4, end_lineno=160, end_col_offset=5)], returns=Name(id='PipelinePaths', ctx=Load(), lineno=133, col_offset=42, end_lineno=133, end_col_offset=55), lineno=133, col_offset=0, end_lineno=160, end_col_offset=5), FunctionDef(name='_load_scip_index', args=arguments(args=[arg(arg='paths', annotation=Name(id='PipelinePaths', ctx=Load(), lineno=163, col_offset=28, end_lineno=163, end_col_offset=41), lineno=163, col_offset=21, end_lineno=163, end_col_offset=41)]), body=[Expr(value=Constant(value='Load and parse the SCIP index from disk.\n\n    Parameters\n    ----------\n    paths : PipelinePaths\n        Pipeline paths configuration containing SCIP index location.\n\n    Returns\n    -------\n    SCIPIndex\n        Parsed SCIP index containing all documents and occurrences.\n\n    Raises\n    ------\n    FileNotFoundError\n        If the configured SCIP index file does not exist.\n    ', lineno=164, col_offset=4, end_lineno=180, end_col_offset=7), lineno=164, col_offset=4, end_lineno=180, end_col_offset=7), If(test=UnaryOp(op=Not(), operand=Call(func=Attribute(value=Attribute(value=Name(id='paths', ctx=Load(), lineno=181, col_offset=11, end_lineno=181, end_col_offset=16), attr='scip_index', ctx=Load(), lineno=181, col_offset=11, end_lineno=181, end_col_offset=27), attr='exists', ctx=Load(), lineno=181, col_offset=11, end_lineno=181, end_col_offset=34), lineno=181, col_offset=11, end_lineno=181, end_col_offset=36), lineno=181, col_offset=7, end_lineno=181, end_col_offset=36), body=[Assign(targets=[Name(id='msg', ctx=Store(), lineno=182, col_offset=8, end_lineno=182, end_col_offset=11)], value=JoinedStr(values=[Constant(value='SCIP index not found at ', lineno=182, col_offset=16, end_lineno=182, end_col_offset=40), FormattedValue(value=Attribute(value=Name(id='paths', ctx=Load(), lineno=182, col_offset=41, end_lineno=182, end_col_offset=46), attr='scip_index', ctx=Load(), lineno=182, col_offset=41, end_lineno=182, end_col_offset=57), conversion=-1, lineno=182, col_offset=40, end_lineno=182, end_col_offset=58)], lineno=182, col_offset=14, end_lineno=182, end_col_offset=59), lineno=182, col_offset=8, end_lineno=182, end_col_offset=59), Raise(exc=Call(func=Name(id='FileNotFoundError', ctx=Load(), lineno=183, col_offset=14, end_lineno=183, end_col_offset=31), args=[Name(id='msg', ctx=Load(), lineno=183, col_offset=32, end_lineno=183, end_col_offset=35)], lineno=183, col_offset=14, end_lineno=183, end_col_offset=36), lineno=183, col_offset=8, end_lineno=183, end_col_offset=36)], lineno=181, col_offset=4, end_lineno=183, end_col_offset=36), Assign(targets=[Name(id='index', ctx=Store(), lineno=185, col_offset=4, end_lineno=185, end_col_offset=9)], value=Call(func=Name(id='parse_scip_json', ctx=Load(), lineno=185, col_offset=12, end_lineno=185, end_col_offset=27), args=[Attribute(value=Name(id='paths', ctx=Load(), lineno=185, col_offset=28, end_lineno=185, end_col_offset=33), attr='scip_index', ctx=Load(), lineno=185, col_offset=28, end_lineno=185, end_col_offset=44)], lineno=185, col_offset=12, end_lineno=185, end_col_offset=45), lineno=185, col_offset=4, end_lineno=185, end_col_offset=45), Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=186, col_offset=4, end_lineno=186, end_col_offset=10), attr='info', ctx=Load(), lineno=186, col_offset=4, end_lineno=186, end_col_offset=15), args=[Constant(value='Parsed %s documents from SCIP index', lineno=186, col_offset=16, end_lineno=186, end_col_offset=53), Call(func=Name(id='len', ctx=Load(), lineno=186, col_offset=55, end_lineno=186, end_col_offset=58), args=[Attribute(value=Name(id='index', ctx=Load(), lineno=186, col_offset=59, end_lineno=186, end_col_offset=64), attr='documents', ctx=Load(), lineno=186, col_offset=59, end_lineno=186, end_col_offset=74)], lineno=186, col_offset=55, end_lineno=186, end_col_offset=75)], lineno=186, col_offset=4, end_lineno=186, end_col_offset=76), lineno=186, col_offset=4, end_lineno=186, end_col_offset=76), Return(value=Name(id='index', ctx=Load(), lineno=187, col_offset=11, end_lineno=187, end_col_offset=16), lineno=187, col_offset=4, end_lineno=187, end_col_offset=16)], returns=Name(id='SCIPIndex', ctx=Load(), lineno=163, col_offset=46, end_lineno=163, end_col_offset=55), lineno=163, col_offset=0, end_lineno=187, end_col_offset=16), FunctionDef(name='_group_definitions_by_file', args=arguments(args=[arg(arg='index', annotation=Name(id='SCIPIndex', ctx=Load(), lineno=190, col_offset=38, end_lineno=190, end_col_offset=47), lineno=190, col_offset=31, end_lineno=190, end_col_offset=47)]), body=[Expr(value=Constant(value='Group symbol definitions by their relative file path.\n\n    Parameters\n    ----------\n    index : SCIPIndex\n        SCIP index containing symbol definitions.\n\n    Returns\n    -------\n    Mapping[str, list[SymbolDef]]\n        Definitions grouped by file path for downstream chunking.\n    ', lineno=191, col_offset=4, end_lineno=202, end_col_offset=7), lineno=191, col_offset=4, end_lineno=202, end_col_offset=7), AnnAssign(target=Name(id='grouped', ctx=Store(), lineno=203, col_offset=4, end_lineno=203, end_col_offset=11), annotation=Subscript(value=Name(id='dict', ctx=Load(), lineno=203, col_offset=13, end_lineno=203, end_col_offset=17), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=203, col_offset=18, end_lineno=203, end_col_offset=21), Subscript(value=Name(id='list', ctx=Load(), lineno=203, col_offset=23, end_lineno=203, end_col_offset=27), slice=Name(id='SymbolDef', ctx=Load(), lineno=203, col_offset=28, end_lineno=203, end_col_offset=37), ctx=Load(), lineno=203, col_offset=23, end_lineno=203, end_col_offset=38)], ctx=Load(), lineno=203, col_offset=18, end_lineno=203, end_col_offset=38), ctx=Load(), lineno=203, col_offset=13, end_lineno=203, end_col_offset=39), value=Call(func=Name(id='defaultdict', ctx=Load(), lineno=203, col_offset=42, end_lineno=203, end_col_offset=53), args=[Name(id='list', ctx=Load(), lineno=203, col_offset=54, end_lineno=203, end_col_offset=58)], lineno=203, col_offset=42, end_lineno=203, end_col_offset=59), simple=1, lineno=203, col_offset=4, end_lineno=203, end_col_offset=59), For(target=Name(id='definition', ctx=Store(), lineno=204, col_offset=8, end_lineno=204, end_col_offset=18), iter=Call(func=Name(id='extract_definitions', ctx=Load(), lineno=204, col_offset=22, end_lineno=204, end_col_offset=41), args=[Name(id='index', ctx=Load(), lineno=204, col_offset=42, end_lineno=204, end_col_offset=47)], lineno=204, col_offset=22, end_lineno=204, end_col_offset=48), body=[Expr(value=Call(func=Attribute(value=Subscript(value=Name(id='grouped', ctx=Load(), lineno=205, col_offset=8, end_lineno=205, end_col_offset=15), slice=Attribute(value=Name(id='definition', ctx=Load(), lineno=205, col_offset=16, end_lineno=205, end_col_offset=26), attr='path', ctx=Load(), lineno=205, col_offset=16, end_lineno=205, end_col_offset=31), ctx=Load(), lineno=205, col_offset=8, end_lineno=205, end_col_offset=32), attr='append', ctx=Load(), lineno=205, col_offset=8, end_lineno=205, end_col_offset=39), args=[Name(id='definition', ctx=Load(), lineno=205, col_offset=40, end_lineno=205, end_col_offset=50)], lineno=205, col_offset=8, end_lineno=205, end_col_offset=51), lineno=205, col_offset=8, end_lineno=205, end_col_offset=51)], lineno=204, col_offset=4, end_lineno=205, end_col_offset=51), Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=207, col_offset=4, end_lineno=207, end_col_offset=10), attr='info', ctx=Load(), lineno=207, col_offset=4, end_lineno=207, end_col_offset=15), args=[Constant(value='Found definitions in %s files', lineno=207, col_offset=16, end_lineno=207, end_col_offset=47), Call(func=Name(id='len', ctx=Load(), lineno=207, col_offset=49, end_lineno=207, end_col_offset=52), args=[Name(id='grouped', ctx=Load(), lineno=207, col_offset=53, end_lineno=207, end_col_offset=60)], lineno=207, col_offset=49, end_lineno=207, end_col_offset=61)], lineno=207, col_offset=4, end_lineno=207, end_col_offset=62), lineno=207, col_offset=4, end_lineno=207, end_col_offset=62), Return(value=Name(id='grouped', ctx=Load(), lineno=208, col_offset=11, end_lineno=208, end_col_offset=18), lineno=208, col_offset=4, end_lineno=208, end_col_offset=18)], returns=Subscript(value=Name(id='Mapping', ctx=Load(), lineno=190, col_offset=52, end_lineno=190, end_col_offset=59), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=190, col_offset=60, end_lineno=190, end_col_offset=63), Subscript(value=Name(id='list', ctx=Load(), lineno=190, col_offset=65, end_lineno=190, end_col_offset=69), slice=Name(id='SymbolDef', ctx=Load(), lineno=190, col_offset=70, end_lineno=190, end_col_offset=79), ctx=Load(), lineno=190, col_offset=65, end_lineno=190, end_col_offset=80)], ctx=Load(), lineno=190, col_offset=60, end_lineno=190, end_col_offset=80), ctx=Load(), lineno=190, col_offset=52, end_lineno=190, end_col_offset=81), lineno=190, col_offset=0, end_lineno=208, end_col_offset=18), FunctionDef(name='_chunk_repository', args=arguments(args=[arg(arg='paths', annotation=Name(id='PipelinePaths', ctx=Load(), lineno=212, col_offset=11, end_lineno=212, end_col_offset=24), lineno=212, col_offset=4, end_lineno=212, end_col_offset=24), arg(arg='definitions_by_file', annotation=Subscript(value=Name(id='Mapping', ctx=Load(), lineno=213, col_offset=25, end_lineno=213, end_col_offset=32), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=213, col_offset=33, end_lineno=213, end_col_offset=36), Subscript(value=Name(id='Sequence', ctx=Load(), lineno=213, col_offset=38, end_lineno=213, end_col_offset=46), slice=Name(id='SymbolDef', ctx=Load(), lineno=213, col_offset=47, end_lineno=213, end_col_offset=56), ctx=Load(), lineno=213, col_offset=38, end_lineno=213, end_col_offset=57)], ctx=Load(), lineno=213, col_offset=33, end_lineno=213, end_col_offset=57), ctx=Load(), lineno=213, col_offset=25, end_lineno=213, end_col_offset=58), lineno=213, col_offset=4, end_lineno=213, end_col_offset=58), arg(arg='budget', annotation=Name(id='int', ctx=Load(), lineno=214, col_offset=12, end_lineno=214, end_col_offset=15), lineno=214, col_offset=4, end_lineno=214, end_col_offset=15)]), body=[Expr(value=Constant(value='Chunk all files referenced by the SCIP index.\n\n    Parameters\n    ----------\n    paths : PipelinePaths\n        Pipeline paths configuration.\n    definitions_by_file : Mapping[str, Sequence[SymbolDef]]\n        Symbol definitions grouped by file path.\n    budget : int\n        Character budget per chunk.\n\n    Returns\n    -------\n    list[Chunk]\n        Collection of generated chunks across the repository.\n    ', lineno=216, col_offset=4, end_lineno=231, end_col_offset=7), lineno=216, col_offset=4, end_lineno=231, end_col_offset=7), AnnAssign(target=Name(id='chunks', ctx=Store(), lineno=232, col_offset=4, end_lineno=232, end_col_offset=10), annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=232, col_offset=12, end_lineno=232, end_col_offset=16), slice=Name(id='Chunk', ctx=Load(), lineno=232, col_offset=17, end_lineno=232, end_col_offset=22), ctx=Load(), lineno=232, col_offset=12, end_lineno=232, end_col_offset=23), value=List(ctx=Load(), lineno=232, col_offset=26, end_lineno=232, end_col_offset=28), simple=1, lineno=232, col_offset=4, end_lineno=232, end_col_offset=28), For(target=Tuple(elts=[Name(id='relative_path', ctx=Store(), lineno=233, col_offset=8, end_lineno=233, end_col_offset=21), Name(id='defs', ctx=Store(), lineno=233, col_offset=23, end_lineno=233, end_col_offset=27)], ctx=Store(), lineno=233, col_offset=8, end_lineno=233, end_col_offset=27), iter=Call(func=Attribute(value=Name(id='definitions_by_file', ctx=Load(), lineno=233, col_offset=31, end_lineno=233, end_col_offset=50), attr='items', ctx=Load(), lineno=233, col_offset=31, end_lineno=233, end_col_offset=56), lineno=233, col_offset=31, end_lineno=233, end_col_offset=58), body=[Assign(targets=[Name(id='full_path', ctx=Store(), lineno=234, col_offset=8, end_lineno=234, end_col_offset=17)], value=BinOp(left=Attribute(value=Name(id='paths', ctx=Load(), lineno=234, col_offset=20, end_lineno=234, end_col_offset=25), attr='repo_root', ctx=Load(), lineno=234, col_offset=20, end_lineno=234, end_col_offset=35), op=Div(), right=Name(id='relative_path', ctx=Load(), lineno=234, col_offset=38, end_lineno=234, end_col_offset=51), lineno=234, col_offset=20, end_lineno=234, end_col_offset=51), lineno=234, col_offset=8, end_lineno=234, end_col_offset=51), If(test=UnaryOp(op=Not(), operand=Call(func=Attribute(value=Name(id='full_path', ctx=Load(), lineno=235, col_offset=15, end_lineno=235, end_col_offset=24), attr='exists', ctx=Load(), lineno=235, col_offset=15, end_lineno=235, end_col_offset=31), lineno=235, col_offset=15, end_lineno=235, end_col_offset=33), lineno=235, col_offset=11, end_lineno=235, end_col_offset=33), body=[Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=236, col_offset=12, end_lineno=236, end_col_offset=18), attr='warning', ctx=Load(), lineno=236, col_offset=12, end_lineno=236, end_col_offset=26), args=[Constant(value='Skipping missing file %s', lineno=236, col_offset=27, end_lineno=236, end_col_offset=53), Name(id='full_path', ctx=Load(), lineno=236, col_offset=55, end_lineno=236, end_col_offset=64)], lineno=236, col_offset=12, end_lineno=236, end_col_offset=65), lineno=236, col_offset=12, end_lineno=236, end_col_offset=65), Continue(lineno=237, col_offset=12, end_lineno=237, end_col_offset=20)], lineno=235, col_offset=8, end_lineno=237, end_col_offset=20), Try(body=[Assign(targets=[Name(id='text', ctx=Store(), lineno=240, col_offset=12, end_lineno=240, end_col_offset=16)], value=Call(func=Attribute(value=Name(id='full_path', ctx=Load(), lineno=240, col_offset=19, end_lineno=240, end_col_offset=28), attr='read_text', ctx=Load(), lineno=240, col_offset=19, end_lineno=240, end_col_offset=38), keywords=[keyword(arg='encoding', value=Constant(value='utf-8', lineno=240, col_offset=48, end_lineno=240, end_col_offset=55), lineno=240, col_offset=39, end_lineno=240, end_col_offset=55)], lineno=240, col_offset=19, end_lineno=240, end_col_offset=56), lineno=240, col_offset=12, end_lineno=240, end_col_offset=56)], handlers=[ExceptHandler(type=Tuple(elts=[Name(id='OSError', ctx=Load(), lineno=241, col_offset=16, end_lineno=241, end_col_offset=23), Name(id='UnicodeDecodeError', ctx=Load(), lineno=241, col_offset=25, end_lineno=241, end_col_offset=43)], ctx=Load(), lineno=241, col_offset=15, end_lineno=241, end_col_offset=44), name='exc', body=[Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=242, col_offset=12, end_lineno=242, end_col_offset=18), attr='warning', ctx=Load(), lineno=242, col_offset=12, end_lineno=242, end_col_offset=26), args=[Constant(value='Unable to read %s: %s', lineno=242, col_offset=27, end_lineno=242, end_col_offset=50), Name(id='full_path', ctx=Load(), lineno=242, col_offset=52, end_lineno=242, end_col_offset=61), Name(id='exc', ctx=Load(), lineno=242, col_offset=63, end_lineno=242, end_col_offset=66)], lineno=242, col_offset=12, end_lineno=242, end_col_offset=67), lineno=242, col_offset=12, end_lineno=242, end_col_offset=67), Continue(lineno=243, col_offset=12, end_lineno=243, end_col_offset=20)], lineno=241, col_offset=8, end_lineno=243, end_col_offset=20)], lineno=239, col_offset=8, end_lineno=243, end_col_offset=20), Assign(targets=[Name(id='def_list', ctx=Store(), lineno=245, col_offset=8, end_lineno=245, end_col_offset=16)], value=Call(func=Name(id='list', ctx=Load(), lineno=245, col_offset=19, end_lineno=245, end_col_offset=23), args=[Name(id='defs', ctx=Load(), lineno=245, col_offset=24, end_lineno=245, end_col_offset=28)], lineno=245, col_offset=19, end_lineno=245, end_col_offset=29), lineno=245, col_offset=8, end_lineno=245, end_col_offset=29), Assign(targets=[Name(id='top_level_defs', ctx=Store(), lineno=246, col_offset=8, end_lineno=246, end_col_offset=22)], value=Call(func=Name(id='get_top_level_definitions', ctx=Load(), lineno=246, col_offset=25, end_lineno=246, end_col_offset=50), args=[Name(id='def_list', ctx=Load(), lineno=246, col_offset=51, end_lineno=246, end_col_offset=59)], lineno=246, col_offset=25, end_lineno=246, end_col_offset=60), lineno=246, col_offset=8, end_lineno=246, end_col_offset=60), If(test=UnaryOp(op=Not(), operand=Name(id='top_level_defs', ctx=Load(), lineno=247, col_offset=15, end_lineno=247, end_col_offset=29), lineno=247, col_offset=11, end_lineno=247, end_col_offset=29), body=[Continue(lineno=248, col_offset=12, end_lineno=248, end_col_offset=20)], lineno=247, col_offset=8, end_lineno=248, end_col_offset=20), Assign(targets=[Name(id='file_language', ctx=Store(), lineno=250, col_offset=8, end_lineno=250, end_col_offset=21)], value=IfExp(test=Name(id='top_level_defs', ctx=Load(), lineno=250, col_offset=54, end_lineno=250, end_col_offset=68), body=Attribute(value=Subscript(value=Name(id='top_level_defs', ctx=Load(), lineno=250, col_offset=24, end_lineno=250, end_col_offset=38), slice=Constant(value=0, lineno=250, col_offset=39, end_lineno=250, end_col_offset=40), ctx=Load(), lineno=250, col_offset=24, end_lineno=250, end_col_offset=41), attr='language', ctx=Load(), lineno=250, col_offset=24, end_lineno=250, end_col_offset=50), orelse=Constant(value='', lineno=250, col_offset=74, end_lineno=250, end_col_offset=76), lineno=250, col_offset=24, end_lineno=250, end_col_offset=76), lineno=250, col_offset=8, end_lineno=250, end_col_offset=76), Assign(targets=[Name(id='file_chunks', ctx=Store(), lineno=251, col_offset=8, end_lineno=251, end_col_offset=19)], value=Call(func=Name(id='chunk_file', ctx=Load(), lineno=251, col_offset=22, end_lineno=251, end_col_offset=32), args=[Name(id='full_path', ctx=Load(), lineno=252, col_offset=12, end_lineno=252, end_col_offset=21), Name(id='text', ctx=Load(), lineno=253, col_offset=12, end_lineno=253, end_col_offset=16), Name(id='top_level_defs', ctx=Load(), lineno=254, col_offset=12, end_lineno=254, end_col_offset=26)], keywords=[keyword(arg='options', value=Call(func=Name(id='ChunkOptions', ctx=Load(), lineno=255, col_offset=20, end_lineno=255, end_col_offset=32), keywords=[keyword(arg='budget', value=Name(id='budget', ctx=Load(), lineno=255, col_offset=40, end_lineno=255, end_col_offset=46), lineno=255, col_offset=33, end_lineno=255, end_col_offset=46), keyword(arg='language', value=Name(id='file_language', ctx=Load(), lineno=255, col_offset=57, end_lineno=255, end_col_offset=70), lineno=255, col_offset=48, end_lineno=255, end_col_offset=70)], lineno=255, col_offset=20, end_lineno=255, end_col_offset=71), lineno=255, col_offset=12, end_lineno=255, end_col_offset=71)], lineno=251, col_offset=22, end_lineno=256, end_col_offset=9), lineno=251, col_offset=8, end_lineno=256, end_col_offset=9), Expr(value=Call(func=Attribute(value=Name(id='chunks', ctx=Load(), lineno=257, col_offset=8, end_lineno=257, end_col_offset=14), attr='extend', ctx=Load(), lineno=257, col_offset=8, end_lineno=257, end_col_offset=21), args=[Name(id='file_chunks', ctx=Load(), lineno=257, col_offset=22, end_lineno=257, end_col_offset=33)], lineno=257, col_offset=8, end_lineno=257, end_col_offset=34), lineno=257, col_offset=8, end_lineno=257, end_col_offset=34)], lineno=233, col_offset=4, end_lineno=257, end_col_offset=34), Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=259, col_offset=4, end_lineno=259, end_col_offset=10), attr='info', ctx=Load(), lineno=259, col_offset=4, end_lineno=259, end_col_offset=15), args=[Constant(value='Chunked %s files into %s chunks', lineno=259, col_offset=16, end_lineno=259, end_col_offset=49), Call(func=Name(id='len', ctx=Load(), lineno=259, col_offset=51, end_lineno=259, end_col_offset=54), args=[Name(id='definitions_by_file', ctx=Load(), lineno=259, col_offset=55, end_lineno=259, end_col_offset=74)], lineno=259, col_offset=51, end_lineno=259, end_col_offset=75), Call(func=Name(id='len', ctx=Load(), lineno=259, col_offset=77, end_lineno=259, end_col_offset=80), args=[Name(id='chunks', ctx=Load(), lineno=259, col_offset=81, end_lineno=259, end_col_offset=87)], lineno=259, col_offset=77, end_lineno=259, end_col_offset=88)], lineno=259, col_offset=4, end_lineno=259, end_col_offset=89), lineno=259, col_offset=4, end_lineno=259, end_col_offset=89), Return(value=Name(id='chunks', ctx=Load(), lineno=260, col_offset=11, end_lineno=260, end_col_offset=17), lineno=260, col_offset=4, end_lineno=260, end_col_offset=17)], returns=Subscript(value=Name(id='list', ctx=Load(), lineno=215, col_offset=5, end_lineno=215, end_col_offset=9), slice=Name(id='Chunk', ctx=Load(), lineno=215, col_offset=10, end_lineno=215, end_col_offset=15), ctx=Load(), lineno=215, col_offset=5, end_lineno=215, end_col_offset=16), lineno=211, col_offset=0, end_lineno=260, end_col_offset=17), FunctionDef(name='_embed_chunks', args=arguments(args=[arg(arg='chunks', annotation=Subscript(value=Name(id='Sequence', ctx=Load(), lineno=263, col_offset=26, end_lineno=263, end_col_offset=34), slice=Name(id='Chunk', ctx=Load(), lineno=263, col_offset=35, end_lineno=263, end_col_offset=40), ctx=Load(), lineno=263, col_offset=26, end_lineno=263, end_col_offset=41), lineno=263, col_offset=18, end_lineno=263, end_col_offset=41), arg(arg='config', annotation=Name(id='VLLMConfig', ctx=Load(), lineno=263, col_offset=51, end_lineno=263, end_col_offset=61), lineno=263, col_offset=43, end_lineno=263, end_col_offset=61)]), body=[Expr(value=Constant(value='Generate embeddings for the supplied chunks using vLLM.\n\n    Parameters\n    ----------\n    chunks : Sequence[Chunk]\n        Chunks to embed.\n    config : VLLMConfig\n        vLLM client configuration.\n\n    Returns\n    -------\n    np.ndarray\n        Embedding matrix aligned with the chunk order.\n    ', lineno=264, col_offset=4, end_lineno=277, end_col_offset=7), lineno=264, col_offset=4, end_lineno=277, end_col_offset=7), Assign(targets=[Name(id='client', ctx=Store(), lineno=278, col_offset=4, end_lineno=278, end_col_offset=10)], value=Call(func=Name(id='VLLMClient', ctx=Load(), lineno=278, col_offset=13, end_lineno=278, end_col_offset=23), args=[Name(id='config', ctx=Load(), lineno=278, col_offset=24, end_lineno=278, end_col_offset=30)], lineno=278, col_offset=13, end_lineno=278, end_col_offset=31), lineno=278, col_offset=4, end_lineno=278, end_col_offset=31), Assign(targets=[Name(id='texts', ctx=Store(), lineno=279, col_offset=4, end_lineno=279, end_col_offset=9)], value=ListComp(elt=Subscript(value=Attribute(value=Name(id='chunk', ctx=Load(), lineno=279, col_offset=13, end_lineno=279, end_col_offset=18), attr='text', ctx=Load(), lineno=279, col_offset=13, end_lineno=279, end_col_offset=23), slice=Slice(upper=Name(id='EMBED_PREVIEW_CHARS', ctx=Load(), lineno=279, col_offset=25, end_lineno=279, end_col_offset=44), lineno=279, col_offset=24, end_lineno=279, end_col_offset=44), ctx=Load(), lineno=279, col_offset=13, end_lineno=279, end_col_offset=45), generators=[comprehension(target=Name(id='chunk', ctx=Store(), lineno=279, col_offset=50, end_lineno=279, end_col_offset=55), iter=Name(id='chunks', ctx=Load(), lineno=279, col_offset=59, end_lineno=279, end_col_offset=65), is_async=0)], lineno=279, col_offset=12, end_lineno=279, end_col_offset=66), lineno=279, col_offset=4, end_lineno=279, end_col_offset=66), Assign(targets=[Name(id='vectors', ctx=Store(), lineno=280, col_offset=4, end_lineno=280, end_col_offset=11)], value=Call(func=Attribute(value=Name(id='client', ctx=Load(), lineno=280, col_offset=14, end_lineno=280, end_col_offset=20), attr='embed_chunks', ctx=Load(), lineno=280, col_offset=14, end_lineno=280, end_col_offset=33), args=[Name(id='texts', ctx=Load(), lineno=280, col_offset=34, end_lineno=280, end_col_offset=39)], keywords=[keyword(arg='batch_size', value=Attribute(value=Name(id='config', ctx=Load(), lineno=280, col_offset=52, end_lineno=280, end_col_offset=58), attr='batch_size', ctx=Load(), lineno=280, col_offset=52, end_lineno=280, end_col_offset=69), lineno=280, col_offset=41, end_lineno=280, end_col_offset=69)], lineno=280, col_offset=14, end_lineno=280, end_col_offset=70), lineno=280, col_offset=4, end_lineno=280, end_col_offset=70), Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=281, col_offset=4, end_lineno=281, end_col_offset=10), attr='info', ctx=Load(), lineno=281, col_offset=4, end_lineno=281, end_col_offset=15), args=[Constant(value='Generated %s embeddings', lineno=281, col_offset=16, end_lineno=281, end_col_offset=41), Call(func=Name(id='len', ctx=Load(), lineno=281, col_offset=43, end_lineno=281, end_col_offset=46), args=[Name(id='vectors', ctx=Load(), lineno=281, col_offset=47, end_lineno=281, end_col_offset=54)], lineno=281, col_offset=43, end_lineno=281, end_col_offset=55)], lineno=281, col_offset=4, end_lineno=281, end_col_offset=56), lineno=281, col_offset=4, end_lineno=281, end_col_offset=56), Return(value=Name(id='vectors', ctx=Load(), lineno=282, col_offset=11, end_lineno=282, end_col_offset=18), lineno=282, col_offset=4, end_lineno=282, end_col_offset=18)], returns=Attribute(value=Name(id='np', ctx=Load(), lineno=263, col_offset=66, end_lineno=263, end_col_offset=68), attr='ndarray', ctx=Load(), lineno=263, col_offset=66, end_lineno=263, end_col_offset=76), lineno=263, col_offset=0, end_lineno=282, end_col_offset=18), FunctionDef(name='_write_parquet', args=arguments(args=[arg(arg='chunks', annotation=Subscript(value=Name(id='Sequence', ctx=Load(), lineno=286, col_offset=12, end_lineno=286, end_col_offset=20), slice=Name(id='Chunk', ctx=Load(), lineno=286, col_offset=21, end_lineno=286, end_col_offset=26), ctx=Load(), lineno=286, col_offset=12, end_lineno=286, end_col_offset=27), lineno=286, col_offset=4, end_lineno=286, end_col_offset=27), arg(arg='embeddings', annotation=Attribute(value=Name(id='np', ctx=Load(), lineno=287, col_offset=16, end_lineno=287, end_col_offset=18), attr='ndarray', ctx=Load(), lineno=287, col_offset=16, end_lineno=287, end_col_offset=26), lineno=287, col_offset=4, end_lineno=287, end_col_offset=26), arg(arg='paths', annotation=Name(id='PipelinePaths', ctx=Load(), lineno=288, col_offset=11, end_lineno=288, end_col_offset=24), lineno=288, col_offset=4, end_lineno=288, end_col_offset=24), arg(arg='vec_dim', annotation=Name(id='int', ctx=Load(), lineno=289, col_offset=13, end_lineno=289, end_col_offset=16), lineno=289, col_offset=4, end_lineno=289, end_col_offset=16), arg(arg='preview_max_chars', annotation=Name(id='int', ctx=Load(), lineno=290, col_offset=23, end_lineno=290, end_col_offset=26), lineno=290, col_offset=4, end_lineno=290, end_col_offset=26)]), body=[Expr(value=Constant(value='Persist chunk metadata and embeddings to Parquet.\n\n    Parameters\n    ----------\n    chunks : Sequence[Chunk]\n        Chunks to persist.\n    embeddings : np.ndarray\n        Embedding vectors aligned with chunks.\n    paths : PipelinePaths\n        Pipeline paths configuration.\n    vec_dim : int\n        Embedding vector dimension.\n    preview_max_chars : int\n        Maximum number of characters to persist in chunk previews.\n\n    Returns\n    -------\n    Path\n        Path to the written Parquet file containing chunk data.\n    ', lineno=292, col_offset=4, end_lineno=311, end_col_offset=7), lineno=292, col_offset=4, end_lineno=311, end_col_offset=7), Assign(targets=[Name(id='output_path', ctx=Store(), lineno=312, col_offset=4, end_lineno=312, end_col_offset=15)], value=BinOp(left=Attribute(value=Name(id='paths', ctx=Load(), lineno=312, col_offset=18, end_lineno=312, end_col_offset=23), attr='vectors_dir', ctx=Load(), lineno=312, col_offset=18, end_lineno=312, end_col_offset=35), op=Div(), right=Constant(value='part-000.parquet', lineno=312, col_offset=38, end_lineno=312, end_col_offset=56), lineno=312, col_offset=18, end_lineno=312, end_col_offset=56), lineno=312, col_offset=4, end_lineno=312, end_col_offset=56), Expr(value=Call(func=Name(id='write_chunks_parquet', ctx=Load(), lineno=313, col_offset=4, end_lineno=313, end_col_offset=24), keywords=[keyword(arg='output_path', value=Name(id='output_path', ctx=Load(), lineno=314, col_offset=20, end_lineno=314, end_col_offset=31), lineno=314, col_offset=8, end_lineno=314, end_col_offset=31), keyword(arg='chunks', value=Name(id='chunks', ctx=Load(), lineno=315, col_offset=15, end_lineno=315, end_col_offset=21), lineno=315, col_offset=8, end_lineno=315, end_col_offset=21), keyword(arg='embeddings', value=Name(id='embeddings', ctx=Load(), lineno=316, col_offset=19, end_lineno=316, end_col_offset=29), lineno=316, col_offset=8, end_lineno=316, end_col_offset=29), keyword(arg='options', value=Call(func=Name(id='ParquetWriteOptions', ctx=Load(), lineno=317, col_offset=16, end_lineno=317, end_col_offset=35), keywords=[keyword(arg='start_id', value=Constant(value=0, lineno=318, col_offset=21, end_lineno=318, end_col_offset=22), lineno=318, col_offset=12, end_lineno=318, end_col_offset=22), keyword(arg='vec_dim', value=Name(id='vec_dim', ctx=Load(), lineno=319, col_offset=20, end_lineno=319, end_col_offset=27), lineno=319, col_offset=12, end_lineno=319, end_col_offset=27), keyword(arg='preview_max_chars', value=Name(id='preview_max_chars', ctx=Load(), lineno=320, col_offset=30, end_lineno=320, end_col_offset=47), lineno=320, col_offset=12, end_lineno=320, end_col_offset=47)], lineno=317, col_offset=16, end_lineno=321, end_col_offset=9), lineno=317, col_offset=8, end_lineno=321, end_col_offset=9)], lineno=313, col_offset=4, end_lineno=322, end_col_offset=5), lineno=313, col_offset=4, end_lineno=322, end_col_offset=5), Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=323, col_offset=4, end_lineno=323, end_col_offset=10), attr='info', ctx=Load(), lineno=323, col_offset=4, end_lineno=323, end_col_offset=15), args=[Constant(value='Wrote Parquet dataset to %s', lineno=323, col_offset=16, end_lineno=323, end_col_offset=45), Name(id='output_path', ctx=Load(), lineno=323, col_offset=47, end_lineno=323, end_col_offset=58)], lineno=323, col_offset=4, end_lineno=323, end_col_offset=59), lineno=323, col_offset=4, end_lineno=323, end_col_offset=59), Return(value=Name(id='output_path', ctx=Load(), lineno=324, col_offset=11, end_lineno=324, end_col_offset=22), lineno=324, col_offset=4, end_lineno=324, end_col_offset=22)], returns=Name(id='Path', ctx=Load(), lineno=291, col_offset=5, end_lineno=291, end_col_offset=9), lineno=285, col_offset=0, end_lineno=324, end_col_offset=22), FunctionDef(name='_build_faiss_index', args=arguments(args=[arg(arg='embeddings', annotation=Attribute(value=Name(id='np', ctx=Load(), lineno=328, col_offset=16, end_lineno=328, end_col_offset=18), attr='ndarray', ctx=Load(), lineno=328, col_offset=16, end_lineno=328, end_col_offset=26), lineno=328, col_offset=4, end_lineno=328, end_col_offset=26), arg(arg='paths', annotation=Name(id='PipelinePaths', ctx=Load(), lineno=329, col_offset=11, end_lineno=329, end_col_offset=24), lineno=329, col_offset=4, end_lineno=329, end_col_offset=24), arg(arg='index_config', annotation=Name(id='IndexConfig', ctx=Load(), lineno=330, col_offset=18, end_lineno=330, end_col_offset=29), lineno=330, col_offset=4, end_lineno=330, end_col_offset=29)]), body=[Expr(value=Constant(value='Train and persist the FAISS index with adaptive type selection.\n\n    The index type is automatically selected based on corpus size for optimal\n    performance. Small corpora use flat indexes (fast training), medium corpora\n    use IVFFlat (balanced), and large corpora use IVF-PQ (memory efficient).\n\n    Parameters\n    ----------\n    embeddings : np.ndarray\n        Embedding vectors to index.\n    paths : PipelinePaths\n        Pipeline paths configuration.\n    index_config : IndexConfig\n        FAISS index configuration.\n\n    Raises\n    ------\n    RuntimeError\n        If embeddings are empty and the index cannot be trained.\n    ', lineno=332, col_offset=4, end_lineno=351, end_col_offset=7), lineno=332, col_offset=4, end_lineno=351, end_col_offset=7), If(test=Compare(left=Attribute(value=Name(id='embeddings', ctx=Load(), lineno=352, col_offset=7, end_lineno=352, end_col_offset=17), attr='size', ctx=Load(), lineno=352, col_offset=7, end_lineno=352, end_col_offset=22), ops=[Eq()], comparators=[Constant(value=0, lineno=352, col_offset=26, end_lineno=352, end_col_offset=27)], lineno=352, col_offset=7, end_lineno=352, end_col_offset=27), body=[Assign(targets=[Name(id='msg', ctx=Store(), lineno=353, col_offset=8, end_lineno=353, end_col_offset=11)], value=Constant(value='No embeddings available to build FAISS index', lineno=353, col_offset=14, end_lineno=353, end_col_offset=60), lineno=353, col_offset=8, end_lineno=353, end_col_offset=60), Raise(exc=Call(func=Name(id='RuntimeError', ctx=Load(), lineno=354, col_offset=14, end_lineno=354, end_col_offset=26), args=[Name(id='msg', ctx=Load(), lineno=354, col_offset=27, end_lineno=354, end_col_offset=30)], lineno=354, col_offset=14, end_lineno=354, end_col_offset=31), lineno=354, col_offset=8, end_lineno=354, end_col_offset=31)], lineno=352, col_offset=4, end_lineno=354, end_col_offset=31), Assign(targets=[Name(id='n_vectors', ctx=Store(), lineno=356, col_offset=4, end_lineno=356, end_col_offset=13)], value=Call(func=Name(id='len', ctx=Load(), lineno=356, col_offset=16, end_lineno=356, end_col_offset=19), args=[Name(id='embeddings', ctx=Load(), lineno=356, col_offset=20, end_lineno=356, end_col_offset=30)], lineno=356, col_offset=16, end_lineno=356, end_col_offset=31), lineno=356, col_offset=4, end_lineno=356, end_col_offset=31), Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=357, col_offset=4, end_lineno=357, end_col_offset=10), attr='info', ctx=Load(), lineno=357, col_offset=4, end_lineno=357, end_col_offset=15), args=[Constant(value='Building FAISS index for %s vectors (adaptive type selection)', lineno=357, col_offset=16, end_lineno=357, end_col_offset=79), Name(id='n_vectors', ctx=Load(), lineno=357, col_offset=81, end_lineno=357, end_col_offset=90)], lineno=357, col_offset=4, end_lineno=357, end_col_offset=91), lineno=357, col_offset=4, end_lineno=357, end_col_offset=91), Assign(targets=[Name(id='faiss_mgr', ctx=Store(), lineno=359, col_offset=4, end_lineno=359, end_col_offset=13)], value=Call(func=Name(id='FAISSManager', ctx=Load(), lineno=359, col_offset=16, end_lineno=359, end_col_offset=28), keywords=[keyword(arg='index_path', value=Attribute(value=Name(id='paths', ctx=Load(), lineno=360, col_offset=19, end_lineno=360, end_col_offset=24), attr='faiss_index', ctx=Load(), lineno=360, col_offset=19, end_lineno=360, end_col_offset=36), lineno=360, col_offset=8, end_lineno=360, end_col_offset=36), keyword(arg='vec_dim', value=Attribute(value=Name(id='index_config', ctx=Load(), lineno=361, col_offset=16, end_lineno=361, end_col_offset=28), attr='vec_dim', ctx=Load(), lineno=361, col_offset=16, end_lineno=361, end_col_offset=36), lineno=361, col_offset=8, end_lineno=361, end_col_offset=36), keyword(arg='nlist', value=Attribute(value=Name(id='index_config', ctx=Load(), lineno=362, col_offset=14, end_lineno=362, end_col_offset=26), attr='faiss_nlist', ctx=Load(), lineno=362, col_offset=14, end_lineno=362, end_col_offset=38), lineno=362, col_offset=8, end_lineno=362, end_col_offset=38), keyword(arg='use_cuvs', value=Attribute(value=Name(id='index_config', ctx=Load(), lineno=363, col_offset=17, end_lineno=363, end_col_offset=29), attr='use_cuvs', ctx=Load(), lineno=363, col_offset=17, end_lineno=363, end_col_offset=38), lineno=363, col_offset=8, end_lineno=363, end_col_offset=38)], lineno=359, col_offset=16, end_lineno=364, end_col_offset=5), lineno=359, col_offset=4, end_lineno=364, end_col_offset=5), Assign(targets=[Name(id='mem_est', ctx=Store(), lineno=367, col_offset=4, end_lineno=367, end_col_offset=11)], value=Call(func=Attribute(value=Name(id='faiss_mgr', ctx=Load(), lineno=367, col_offset=14, end_lineno=367, end_col_offset=23), attr='estimate_memory_usage', ctx=Load(), lineno=367, col_offset=14, end_lineno=367, end_col_offset=45), args=[Name(id='n_vectors', ctx=Load(), lineno=367, col_offset=46, end_lineno=367, end_col_offset=55)], lineno=367, col_offset=14, end_lineno=367, end_col_offset=56), lineno=367, col_offset=4, end_lineno=367, end_col_offset=56), Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=368, col_offset=4, end_lineno=368, end_col_offset=10), attr='info', ctx=Load(), lineno=368, col_offset=4, end_lineno=368, end_col_offset=15), args=[Constant(value='Estimated memory usage: CPU=%.2f GB, GPU=%.2f GB, Total=%.2f GB', lineno=369, col_offset=8, end_lineno=369, end_col_offset=73), BinOp(left=Subscript(value=Name(id='mem_est', ctx=Load(), lineno=370, col_offset=8, end_lineno=370, end_col_offset=15), slice=Constant(value='cpu_index_bytes', lineno=370, col_offset=16, end_lineno=370, end_col_offset=33), ctx=Load(), lineno=370, col_offset=8, end_lineno=370, end_col_offset=34), op=Div(), right=Constant(value=1000000000.0, lineno=370, col_offset=37, end_lineno=370, end_col_offset=40), lineno=370, col_offset=8, end_lineno=370, end_col_offset=40), BinOp(left=Subscript(value=Name(id='mem_est', ctx=Load(), lineno=371, col_offset=8, end_lineno=371, end_col_offset=15), slice=Constant(value='gpu_index_bytes', lineno=371, col_offset=16, end_lineno=371, end_col_offset=33), ctx=Load(), lineno=371, col_offset=8, end_lineno=371, end_col_offset=34), op=Div(), right=Constant(value=1000000000.0, lineno=371, col_offset=37, end_lineno=371, end_col_offset=40), lineno=371, col_offset=8, end_lineno=371, end_col_offset=40), BinOp(left=Subscript(value=Name(id='mem_est', ctx=Load(), lineno=372, col_offset=8, end_lineno=372, end_col_offset=15), slice=Constant(value='total_bytes', lineno=372, col_offset=16, end_lineno=372, end_col_offset=29), ctx=Load(), lineno=372, col_offset=8, end_lineno=372, end_col_offset=30), op=Div(), right=Constant(value=1000000000.0, lineno=372, col_offset=33, end_lineno=372, end_col_offset=36), lineno=372, col_offset=8, end_lineno=372, end_col_offset=36)], lineno=368, col_offset=4, end_lineno=373, end_col_offset=5), lineno=368, col_offset=4, end_lineno=373, end_col_offset=5), Assign(targets=[Name(id='train_limit', ctx=Store(), lineno=375, col_offset=4, end_lineno=375, end_col_offset=15)], value=Call(func=Name(id='min', ctx=Load(), lineno=375, col_offset=18, end_lineno=375, end_col_offset=21), args=[Call(func=Name(id='len', ctx=Load(), lineno=375, col_offset=22, end_lineno=375, end_col_offset=25), args=[Name(id='embeddings', ctx=Load(), lineno=375, col_offset=26, end_lineno=375, end_col_offset=36)], lineno=375, col_offset=22, end_lineno=375, end_col_offset=37), Name(id='TRAINING_LIMIT', ctx=Load(), lineno=375, col_offset=39, end_lineno=375, end_col_offset=53)], lineno=375, col_offset=18, end_lineno=375, end_col_offset=54), lineno=375, col_offset=4, end_lineno=375, end_col_offset=54), Assign(targets=[Name(id='training_vectors', ctx=Store(), lineno=376, col_offset=4, end_lineno=376, end_col_offset=20)], value=Subscript(value=Name(id='embeddings', ctx=Load(), lineno=376, col_offset=23, end_lineno=376, end_col_offset=33), slice=Slice(upper=Name(id='train_limit', ctx=Load(), lineno=376, col_offset=35, end_lineno=376, end_col_offset=46), lineno=376, col_offset=34, end_lineno=376, end_col_offset=46), ctx=Load(), lineno=376, col_offset=23, end_lineno=376, end_col_offset=47), lineno=376, col_offset=4, end_lineno=376, end_col_offset=47), Expr(value=Call(func=Attribute(value=Name(id='faiss_mgr', ctx=Load(), lineno=377, col_offset=4, end_lineno=377, end_col_offset=13), attr='build_index', ctx=Load(), lineno=377, col_offset=4, end_lineno=377, end_col_offset=25), args=[Name(id='training_vectors', ctx=Load(), lineno=377, col_offset=26, end_lineno=377, end_col_offset=42)], lineno=377, col_offset=4, end_lineno=377, end_col_offset=43), lineno=377, col_offset=4, end_lineno=377, end_col_offset=43), Assign(targets=[Name(id='ids', ctx=Store(), lineno=380, col_offset=4, end_lineno=380, end_col_offset=7)], value=Call(func=Attribute(value=Name(id='np', ctx=Load(), lineno=380, col_offset=10, end_lineno=380, end_col_offset=12), attr='arange', ctx=Load(), lineno=380, col_offset=10, end_lineno=380, end_col_offset=19), args=[Call(func=Name(id='len', ctx=Load(), lineno=380, col_offset=20, end_lineno=380, end_col_offset=23), args=[Name(id='embeddings', ctx=Load(), lineno=380, col_offset=24, end_lineno=380, end_col_offset=34)], lineno=380, col_offset=20, end_lineno=380, end_col_offset=35)], keywords=[keyword(arg='dtype', value=Attribute(value=Name(id='np', ctx=Load(), lineno=380, col_offset=43, end_lineno=380, end_col_offset=45), attr='int64', ctx=Load(), lineno=380, col_offset=43, end_lineno=380, end_col_offset=51), lineno=380, col_offset=37, end_lineno=380, end_col_offset=51)], lineno=380, col_offset=10, end_lineno=380, end_col_offset=52), lineno=380, col_offset=4, end_lineno=380, end_col_offset=52), Expr(value=Call(func=Attribute(value=Name(id='faiss_mgr', ctx=Load(), lineno=381, col_offset=4, end_lineno=381, end_col_offset=13), attr='add_vectors', ctx=Load(), lineno=381, col_offset=4, end_lineno=381, end_col_offset=25), args=[Name(id='embeddings', ctx=Load(), lineno=381, col_offset=26, end_lineno=381, end_col_offset=36), Name(id='ids', ctx=Load(), lineno=381, col_offset=38, end_lineno=381, end_col_offset=41)], lineno=381, col_offset=4, end_lineno=381, end_col_offset=42), lineno=381, col_offset=4, end_lineno=381, end_col_offset=42), Expr(value=Call(func=Attribute(value=Name(id='faiss_mgr', ctx=Load(), lineno=382, col_offset=4, end_lineno=382, end_col_offset=13), attr='save_cpu_index', ctx=Load(), lineno=382, col_offset=4, end_lineno=382, end_col_offset=28), lineno=382, col_offset=4, end_lineno=382, end_col_offset=30), lineno=382, col_offset=4, end_lineno=382, end_col_offset=30), Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=383, col_offset=4, end_lineno=383, end_col_offset=10), attr='info', ctx=Load(), lineno=383, col_offset=4, end_lineno=383, end_col_offset=15), args=[Constant(value='Persisted FAISS index to %s', lineno=383, col_offset=16, end_lineno=383, end_col_offset=45), Attribute(value=Name(id='paths', ctx=Load(), lineno=383, col_offset=47, end_lineno=383, end_col_offset=52), attr='faiss_index', ctx=Load(), lineno=383, col_offset=47, end_lineno=383, end_col_offset=64)], lineno=383, col_offset=4, end_lineno=383, end_col_offset=65), lineno=383, col_offset=4, end_lineno=383, end_col_offset=65)], returns=Constant(value=None, lineno=331, col_offset=5, end_lineno=331, end_col_offset=9), lineno=327, col_offset=0, end_lineno=383, end_col_offset=65), FunctionDef(name='_update_faiss_index_incremental', args=arguments(args=[arg(arg='chunks', annotation=Subscript(value=Name(id='Sequence', ctx=Load(), lineno=387, col_offset=12, end_lineno=387, end_col_offset=20), slice=Name(id='Chunk', ctx=Load(), lineno=387, col_offset=21, end_lineno=387, end_col_offset=26), ctx=Load(), lineno=387, col_offset=12, end_lineno=387, end_col_offset=27), lineno=387, col_offset=4, end_lineno=387, end_col_offset=27), arg(arg='embeddings', annotation=Attribute(value=Name(id='np', ctx=Load(), lineno=388, col_offset=16, end_lineno=388, end_col_offset=18), attr='ndarray', ctx=Load(), lineno=388, col_offset=16, end_lineno=388, end_col_offset=26), lineno=388, col_offset=4, end_lineno=388, end_col_offset=26), arg(arg='paths', annotation=Name(id='PipelinePaths', ctx=Load(), lineno=389, col_offset=11, end_lineno=389, end_col_offset=24), lineno=389, col_offset=4, end_lineno=389, end_col_offset=24), arg(arg='index_config', annotation=Name(id='IndexConfig', ctx=Load(), lineno=390, col_offset=18, end_lineno=390, end_col_offset=29), lineno=390, col_offset=4, end_lineno=390, end_col_offset=29)]), body=[Expr(value=Constant(value="Update FAISS index incrementally by adding new chunks to secondary index.\n\n    Loads existing primary index and identifies new chunks that aren't already\n    indexed. Adds new chunks to the secondary flat index for fast incremental\n    updates without rebuilding the primary index.\n\n    Parameters\n    ----------\n    chunks : Sequence[Chunk]\n        All chunks from the current indexing run.\n    embeddings : np.ndarray\n        Embedding vectors aligned with chunks.\n    paths : PipelinePaths\n        Pipeline paths configuration.\n    index_config : IndexConfig\n        FAISS index configuration.\n\n    Raises\n    ------\n    FileNotFoundError\n        If the primary index does not exist. Use full rebuild mode first.\n    RuntimeError\n        If embeddings are empty or index loading fails.\n    ", lineno=392, col_offset=4, end_lineno=415, end_col_offset=7), lineno=392, col_offset=4, end_lineno=415, end_col_offset=7), If(test=Compare(left=Attribute(value=Name(id='embeddings', ctx=Load(), lineno=416, col_offset=7, end_lineno=416, end_col_offset=17), attr='size', ctx=Load(), lineno=416, col_offset=7, end_lineno=416, end_col_offset=22), ops=[Eq()], comparators=[Constant(value=0, lineno=416, col_offset=26, end_lineno=416, end_col_offset=27)], lineno=416, col_offset=7, end_lineno=416, end_col_offset=27), body=[Assign(targets=[Name(id='msg', ctx=Store(), lineno=417, col_offset=8, end_lineno=417, end_col_offset=11)], value=Constant(value='No embeddings available for incremental update', lineno=417, col_offset=14, end_lineno=417, end_col_offset=62), lineno=417, col_offset=8, end_lineno=417, end_col_offset=62), Raise(exc=Call(func=Name(id='RuntimeError', ctx=Load(), lineno=418, col_offset=14, end_lineno=418, end_col_offset=26), args=[Name(id='msg', ctx=Load(), lineno=418, col_offset=27, end_lineno=418, end_col_offset=30)], lineno=418, col_offset=14, end_lineno=418, end_col_offset=31), lineno=418, col_offset=8, end_lineno=418, end_col_offset=31)], lineno=416, col_offset=4, end_lineno=418, end_col_offset=31), Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=420, col_offset=4, end_lineno=420, end_col_offset=10), attr='info', ctx=Load(), lineno=420, col_offset=4, end_lineno=420, end_col_offset=15), args=[Constant(value='Incremental indexing mode: adding new chunks to existing index', lineno=420, col_offset=16, end_lineno=420, end_col_offset=80)], lineno=420, col_offset=4, end_lineno=420, end_col_offset=81), lineno=420, col_offset=4, end_lineno=420, end_col_offset=81), Assign(targets=[Name(id='faiss_mgr', ctx=Store(), lineno=422, col_offset=4, end_lineno=422, end_col_offset=13)], value=Call(func=Name(id='FAISSManager', ctx=Load(), lineno=422, col_offset=16, end_lineno=422, end_col_offset=28), keywords=[keyword(arg='index_path', value=Attribute(value=Name(id='paths', ctx=Load(), lineno=423, col_offset=19, end_lineno=423, end_col_offset=24), attr='faiss_index', ctx=Load(), lineno=423, col_offset=19, end_lineno=423, end_col_offset=36), lineno=423, col_offset=8, end_lineno=423, end_col_offset=36), keyword(arg='vec_dim', value=Attribute(value=Name(id='index_config', ctx=Load(), lineno=424, col_offset=16, end_lineno=424, end_col_offset=28), attr='vec_dim', ctx=Load(), lineno=424, col_offset=16, end_lineno=424, end_col_offset=36), lineno=424, col_offset=8, end_lineno=424, end_col_offset=36), keyword(arg='nlist', value=Attribute(value=Name(id='index_config', ctx=Load(), lineno=425, col_offset=14, end_lineno=425, end_col_offset=26), attr='faiss_nlist', ctx=Load(), lineno=425, col_offset=14, end_lineno=425, end_col_offset=38), lineno=425, col_offset=8, end_lineno=425, end_col_offset=38), keyword(arg='use_cuvs', value=Attribute(value=Name(id='index_config', ctx=Load(), lineno=426, col_offset=17, end_lineno=426, end_col_offset=29), attr='use_cuvs', ctx=Load(), lineno=426, col_offset=17, end_lineno=426, end_col_offset=38), lineno=426, col_offset=8, end_lineno=426, end_col_offset=38)], lineno=422, col_offset=16, end_lineno=427, end_col_offset=5), lineno=422, col_offset=4, end_lineno=427, end_col_offset=5), Try(body=[Expr(value=Call(func=Attribute(value=Name(id='faiss_mgr', ctx=Load(), lineno=431, col_offset=8, end_lineno=431, end_col_offset=17), attr='load_cpu_index', ctx=Load(), lineno=431, col_offset=8, end_lineno=431, end_col_offset=32), lineno=431, col_offset=8, end_lineno=431, end_col_offset=34), lineno=431, col_offset=8, end_lineno=431, end_col_offset=34), Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=432, col_offset=8, end_lineno=432, end_col_offset=14), attr='info', ctx=Load(), lineno=432, col_offset=8, end_lineno=432, end_col_offset=19), args=[Constant(value='Loaded existing primary index from %s', lineno=432, col_offset=20, end_lineno=432, end_col_offset=59), Attribute(value=Name(id='paths', ctx=Load(), lineno=432, col_offset=61, end_lineno=432, end_col_offset=66), attr='faiss_index', ctx=Load(), lineno=432, col_offset=61, end_lineno=432, end_col_offset=78)], lineno=432, col_offset=8, end_lineno=432, end_col_offset=79), lineno=432, col_offset=8, end_lineno=432, end_col_offset=79)], handlers=[ExceptHandler(type=Name(id='FileNotFoundError', ctx=Load(), lineno=433, col_offset=11, end_lineno=433, end_col_offset=28), name='exc', body=[Assign(targets=[Name(id='msg', ctx=Store(), lineno=434, col_offset=8, end_lineno=434, end_col_offset=11)], value=JoinedStr(values=[Constant(value='Primary index not found at ', lineno=435, col_offset=14, end_lineno=435, end_col_offset=41), FormattedValue(value=Attribute(value=Name(id='paths', ctx=Load(), lineno=435, col_offset=42, end_lineno=435, end_col_offset=47), attr='faiss_index', ctx=Load(), lineno=435, col_offset=42, end_lineno=435, end_col_offset=59), conversion=-1, lineno=435, col_offset=41, end_lineno=435, end_col_offset=60), Constant(value='. Run without --incremental flag first to create the initial index.', lineno=435, col_offset=60, end_lineno=436, end_col_offset=79)], lineno=435, col_offset=12, end_lineno=436, end_col_offset=79), lineno=434, col_offset=8, end_lineno=437, end_col_offset=9), Raise(exc=Call(func=Name(id='FileNotFoundError', ctx=Load(), lineno=438, col_offset=14, end_lineno=438, end_col_offset=31), args=[Name(id='msg', ctx=Load(), lineno=438, col_offset=32, end_lineno=438, end_col_offset=35)], lineno=438, col_offset=14, end_lineno=438, end_col_offset=36), cause=Name(id='exc', ctx=Load(), lineno=438, col_offset=42, end_lineno=438, end_col_offset=45), lineno=438, col_offset=8, end_lineno=438, end_col_offset=45)], lineno=433, col_offset=4, end_lineno=438, end_col_offset=45)], lineno=430, col_offset=4, end_lineno=438, end_col_offset=45), Try(body=[Expr(value=Call(func=Attribute(value=Name(id='faiss_mgr', ctx=Load(), lineno=442, col_offset=8, end_lineno=442, end_col_offset=17), attr='load_secondary_index', ctx=Load(), lineno=442, col_offset=8, end_lineno=442, end_col_offset=38), lineno=442, col_offset=8, end_lineno=442, end_col_offset=40), lineno=442, col_offset=8, end_lineno=442, end_col_offset=40), Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=443, col_offset=8, end_lineno=443, end_col_offset=14), attr='info', ctx=Load(), lineno=443, col_offset=8, end_lineno=443, end_col_offset=19), args=[Constant(value='Loaded existing secondary index with %s vectors', lineno=444, col_offset=12, end_lineno=444, end_col_offset=61), Call(func=Name(id='len', ctx=Load(), lineno=445, col_offset=12, end_lineno=445, end_col_offset=15), args=[Attribute(value=Name(id='faiss_mgr', ctx=Load(), lineno=445, col_offset=16, end_lineno=445, end_col_offset=25), attr='incremental_ids', ctx=Load(), lineno=445, col_offset=16, end_lineno=445, end_col_offset=41)], lineno=445, col_offset=12, end_lineno=445, end_col_offset=42)], lineno=443, col_offset=8, end_lineno=446, end_col_offset=9), lineno=443, col_offset=8, end_lineno=446, end_col_offset=9)], handlers=[ExceptHandler(type=Name(id='FileNotFoundError', ctx=Load(), lineno=447, col_offset=11, end_lineno=447, end_col_offset=28), body=[Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=448, col_offset=8, end_lineno=448, end_col_offset=14), attr='info', ctx=Load(), lineno=448, col_offset=8, end_lineno=448, end_col_offset=19), args=[Constant(value='No existing secondary index found; will create new one', lineno=448, col_offset=20, end_lineno=448, end_col_offset=76)], lineno=448, col_offset=8, end_lineno=448, end_col_offset=77), lineno=448, col_offset=8, end_lineno=448, end_col_offset=77)], lineno=447, col_offset=4, end_lineno=448, end_col_offset=77)], lineno=441, col_offset=4, end_lineno=448, end_col_offset=77), Assign(targets=[Name(id='chunk_ids', ctx=Store(), lineno=452, col_offset=4, end_lineno=452, end_col_offset=13)], value=Call(func=Attribute(value=Name(id='np', ctx=Load(), lineno=452, col_offset=16, end_lineno=452, end_col_offset=18), attr='arange', ctx=Load(), lineno=452, col_offset=16, end_lineno=452, end_col_offset=25), args=[Call(func=Name(id='len', ctx=Load(), lineno=452, col_offset=26, end_lineno=452, end_col_offset=29), args=[Name(id='chunks', ctx=Load(), lineno=452, col_offset=30, end_lineno=452, end_col_offset=36)], lineno=452, col_offset=26, end_lineno=452, end_col_offset=37)], keywords=[keyword(arg='dtype', value=Attribute(value=Name(id='np', ctx=Load(), lineno=452, col_offset=45, end_lineno=452, end_col_offset=47), attr='int64', ctx=Load(), lineno=452, col_offset=45, end_lineno=452, end_col_offset=53), lineno=452, col_offset=39, end_lineno=452, end_col_offset=53)], lineno=452, col_offset=16, end_lineno=452, end_col_offset=54), lineno=452, col_offset=4, end_lineno=452, end_col_offset=54), Assign(targets=[Name(id='existing_ids', ctx=Store(), lineno=453, col_offset=4, end_lineno=453, end_col_offset=16)], value=Call(func=Name(id='set', ctx=Load(), lineno=453, col_offset=19, end_lineno=453, end_col_offset=22), args=[Attribute(value=Name(id='faiss_mgr', ctx=Load(), lineno=453, col_offset=23, end_lineno=453, end_col_offset=32), attr='incremental_ids', ctx=Load(), lineno=453, col_offset=23, end_lineno=453, end_col_offset=48)], lineno=453, col_offset=19, end_lineno=453, end_col_offset=49), lineno=453, col_offset=4, end_lineno=453, end_col_offset=49), If(test=Compare(left=Attribute(value=Name(id='faiss_mgr', ctx=Load(), lineno=456, col_offset=7, end_lineno=456, end_col_offset=16), attr='cpu_index', ctx=Load(), lineno=456, col_offset=7, end_lineno=456, end_col_offset=26), ops=[IsNot()], comparators=[Constant(value=None, lineno=456, col_offset=34, end_lineno=456, end_col_offset=38)], lineno=456, col_offset=7, end_lineno=456, end_col_offset=38), body=[Try(body=[Assign(targets=[Name(id='primary_n', ctx=Store(), lineno=458, col_offset=12, end_lineno=458, end_col_offset=21)], value=Attribute(value=Attribute(value=Name(id='faiss_mgr', ctx=Load(), lineno=458, col_offset=24, end_lineno=458, end_col_offset=33), attr='cpu_index', ctx=Load(), lineno=458, col_offset=24, end_lineno=458, end_col_offset=43), attr='ntotal', ctx=Load(), lineno=458, col_offset=24, end_lineno=458, end_col_offset=50), lineno=458, col_offset=12, end_lineno=458, end_col_offset=50), If(test=Call(func=Name(id='hasattr', ctx=Load(), lineno=459, col_offset=15, end_lineno=459, end_col_offset=22), args=[Attribute(value=Name(id='faiss_mgr', ctx=Load(), lineno=459, col_offset=23, end_lineno=459, end_col_offset=32), attr='cpu_index', ctx=Load(), lineno=459, col_offset=23, end_lineno=459, end_col_offset=42), Constant(value='id_map', lineno=459, col_offset=44, end_lineno=459, end_col_offset=52)], lineno=459, col_offset=15, end_lineno=459, end_col_offset=53), body=[Assign(targets=[Name(id='primary_ids', ctx=Store(), lineno=460, col_offset=16, end_lineno=460, end_col_offset=27)], value=SetComp(elt=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='faiss_mgr', ctx=Load(), lineno=461, col_offset=20, end_lineno=461, end_col_offset=29), attr='cpu_index', ctx=Load(), lineno=461, col_offset=20, end_lineno=461, end_col_offset=39), attr='id_map', ctx=Load(), lineno=461, col_offset=20, end_lineno=461, end_col_offset=46), attr='at', ctx=Load(), lineno=461, col_offset=20, end_lineno=461, end_col_offset=49), args=[Name(id='i', ctx=Load(), lineno=461, col_offset=50, end_lineno=461, end_col_offset=51)], lineno=461, col_offset=20, end_lineno=461, end_col_offset=52), generators=[comprehension(target=Name(id='i', ctx=Store(), lineno=462, col_offset=24, end_lineno=462, end_col_offset=25), iter=Call(func=Name(id='range', ctx=Load(), lineno=462, col_offset=29, end_lineno=462, end_col_offset=34), args=[Name(id='primary_n', ctx=Load(), lineno=462, col_offset=35, end_lineno=462, end_col_offset=44)], lineno=462, col_offset=29, end_lineno=462, end_col_offset=45), is_async=0)], lineno=460, col_offset=30, end_lineno=463, end_col_offset=17), lineno=460, col_offset=16, end_lineno=463, end_col_offset=17), Expr(value=Call(func=Attribute(value=Name(id='existing_ids', ctx=Load(), lineno=464, col_offset=16, end_lineno=464, end_col_offset=28), attr='update', ctx=Load(), lineno=464, col_offset=16, end_lineno=464, end_col_offset=35), args=[Name(id='primary_ids', ctx=Load(), lineno=464, col_offset=36, end_lineno=464, end_col_offset=47)], lineno=464, col_offset=16, end_lineno=464, end_col_offset=48), lineno=464, col_offset=16, end_lineno=464, end_col_offset=48)], lineno=459, col_offset=12, end_lineno=464, end_col_offset=48)], handlers=[ExceptHandler(type=Tuple(elts=[Name(id='AttributeError', ctx=Load(), lineno=465, col_offset=16, end_lineno=465, end_col_offset=30), Name(id='RuntimeError', ctx=Load(), lineno=465, col_offset=32, end_lineno=465, end_col_offset=44)], ctx=Load(), lineno=465, col_offset=15, end_lineno=465, end_col_offset=45), name='exc', body=[Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=466, col_offset=12, end_lineno=466, end_col_offset=18), attr='warning', ctx=Load(), lineno=466, col_offset=12, end_lineno=466, end_col_offset=26), args=[Constant(value='Could not extract IDs from primary index: %s', lineno=466, col_offset=27, end_lineno=466, end_col_offset=73), Name(id='exc', ctx=Load(), lineno=466, col_offset=75, end_lineno=466, end_col_offset=78)], lineno=466, col_offset=12, end_lineno=466, end_col_offset=79), lineno=466, col_offset=12, end_lineno=466, end_col_offset=79)], lineno=465, col_offset=8, end_lineno=466, end_col_offset=79)], lineno=457, col_offset=8, end_lineno=466, end_col_offset=79)], lineno=456, col_offset=4, end_lineno=466, end_col_offset=79), Assign(targets=[Name(id='new_mask', ctx=Store(), lineno=469, col_offset=4, end_lineno=469, end_col_offset=12)], value=Call(func=Attribute(value=Name(id='np', ctx=Load(), lineno=469, col_offset=15, end_lineno=469, end_col_offset=17), attr='array', ctx=Load(), lineno=469, col_offset=15, end_lineno=469, end_col_offset=23), args=[ListComp(elt=Compare(left=Name(id='chunk_id', ctx=Load(), lineno=469, col_offset=25, end_lineno=469, end_col_offset=33), ops=[NotIn()], comparators=[Name(id='existing_ids', ctx=Load(), lineno=469, col_offset=41, end_lineno=469, end_col_offset=53)], lineno=469, col_offset=25, end_lineno=469, end_col_offset=53), generators=[comprehension(target=Name(id='chunk_id', ctx=Store(), lineno=469, col_offset=58, end_lineno=469, end_col_offset=66), iter=Name(id='chunk_ids', ctx=Load(), lineno=469, col_offset=70, end_lineno=469, end_col_offset=79), is_async=0)], lineno=469, col_offset=24, end_lineno=469, end_col_offset=80)], lineno=469, col_offset=15, end_lineno=469, end_col_offset=81), lineno=469, col_offset=4, end_lineno=469, end_col_offset=81), Assign(targets=[Name(id='new_indices', ctx=Store(), lineno=470, col_offset=4, end_lineno=470, end_col_offset=15)], value=Subscript(value=Call(func=Attribute(value=Name(id='np', ctx=Load(), lineno=470, col_offset=18, end_lineno=470, end_col_offset=20), attr='where', ctx=Load(), lineno=470, col_offset=18, end_lineno=470, end_col_offset=26), args=[Name(id='new_mask', ctx=Load(), lineno=470, col_offset=27, end_lineno=470, end_col_offset=35)], lineno=470, col_offset=18, end_lineno=470, end_col_offset=36), slice=Constant(value=0, lineno=470, col_offset=37, end_lineno=470, end_col_offset=38), ctx=Load(), lineno=470, col_offset=18, end_lineno=470, end_col_offset=39), lineno=470, col_offset=4, end_lineno=470, end_col_offset=39), If(test=Compare(left=Call(func=Name(id='len', ctx=Load(), lineno=472, col_offset=7, end_lineno=472, end_col_offset=10), args=[Name(id='new_indices', ctx=Load(), lineno=472, col_offset=11, end_lineno=472, end_col_offset=22)], lineno=472, col_offset=7, end_lineno=472, end_col_offset=23), ops=[Eq()], comparators=[Constant(value=0, lineno=472, col_offset=27, end_lineno=472, end_col_offset=28)], lineno=472, col_offset=7, end_lineno=472, end_col_offset=28), body=[Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=473, col_offset=8, end_lineno=473, end_col_offset=14), attr='info', ctx=Load(), lineno=473, col_offset=8, end_lineno=473, end_col_offset=19), args=[Constant(value='All %s chunks already indexed; no incremental update needed', lineno=473, col_offset=20, end_lineno=473, end_col_offset=81), Call(func=Name(id='len', ctx=Load(), lineno=473, col_offset=83, end_lineno=473, end_col_offset=86), args=[Name(id='chunks', ctx=Load(), lineno=473, col_offset=87, end_lineno=473, end_col_offset=93)], lineno=473, col_offset=83, end_lineno=473, end_col_offset=94)], lineno=473, col_offset=8, end_lineno=473, end_col_offset=95), lineno=473, col_offset=8, end_lineno=473, end_col_offset=95), Return(lineno=474, col_offset=8, end_lineno=474, end_col_offset=14)], lineno=472, col_offset=4, end_lineno=474, end_col_offset=14), Assign(targets=[Name(id='new_chunks', ctx=Store(), lineno=476, col_offset=4, end_lineno=476, end_col_offset=14)], value=ListComp(elt=Subscript(value=Name(id='chunks', ctx=Load(), lineno=476, col_offset=18, end_lineno=476, end_col_offset=24), slice=Name(id='i', ctx=Load(), lineno=476, col_offset=25, end_lineno=476, end_col_offset=26), ctx=Load(), lineno=476, col_offset=18, end_lineno=476, end_col_offset=27), generators=[comprehension(target=Name(id='i', ctx=Store(), lineno=476, col_offset=32, end_lineno=476, end_col_offset=33), iter=Name(id='new_indices', ctx=Load(), lineno=476, col_offset=37, end_lineno=476, end_col_offset=48), is_async=0)], lineno=476, col_offset=17, end_lineno=476, end_col_offset=49), lineno=476, col_offset=4, end_lineno=476, end_col_offset=49), Assign(targets=[Name(id='new_embeddings', ctx=Store(), lineno=477, col_offset=4, end_lineno=477, end_col_offset=18)], value=Subscript(value=Name(id='embeddings', ctx=Load(), lineno=477, col_offset=21, end_lineno=477, end_col_offset=31), slice=Name(id='new_indices', ctx=Load(), lineno=477, col_offset=32, end_lineno=477, end_col_offset=43), ctx=Load(), lineno=477, col_offset=21, end_lineno=477, end_col_offset=44), lineno=477, col_offset=4, end_lineno=477, end_col_offset=44), Assign(targets=[Name(id='new_ids', ctx=Store(), lineno=478, col_offset=4, end_lineno=478, end_col_offset=11)], value=Subscript(value=Name(id='chunk_ids', ctx=Load(), lineno=478, col_offset=14, end_lineno=478, end_col_offset=23), slice=Name(id='new_indices', ctx=Load(), lineno=478, col_offset=24, end_lineno=478, end_col_offset=35), ctx=Load(), lineno=478, col_offset=14, end_lineno=478, end_col_offset=36), lineno=478, col_offset=4, end_lineno=478, end_col_offset=36), Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=480, col_offset=4, end_lineno=480, end_col_offset=10), attr='info', ctx=Load(), lineno=480, col_offset=4, end_lineno=480, end_col_offset=15), args=[Constant(value='Adding %s new chunks to secondary index (%s already indexed)', lineno=481, col_offset=8, end_lineno=481, end_col_offset=70), Call(func=Name(id='len', ctx=Load(), lineno=482, col_offset=8, end_lineno=482, end_col_offset=11), args=[Name(id='new_chunks', ctx=Load(), lineno=482, col_offset=12, end_lineno=482, end_col_offset=22)], lineno=482, col_offset=8, end_lineno=482, end_col_offset=23), BinOp(left=Call(func=Name(id='len', ctx=Load(), lineno=483, col_offset=8, end_lineno=483, end_col_offset=11), args=[Name(id='chunks', ctx=Load(), lineno=483, col_offset=12, end_lineno=483, end_col_offset=18)], lineno=483, col_offset=8, end_lineno=483, end_col_offset=19), op=Sub(), right=Call(func=Name(id='len', ctx=Load(), lineno=483, col_offset=22, end_lineno=483, end_col_offset=25), args=[Name(id='new_chunks', ctx=Load(), lineno=483, col_offset=26, end_lineno=483, end_col_offset=36)], lineno=483, col_offset=22, end_lineno=483, end_col_offset=37), lineno=483, col_offset=8, end_lineno=483, end_col_offset=37)], lineno=480, col_offset=4, end_lineno=484, end_col_offset=5), lineno=480, col_offset=4, end_lineno=484, end_col_offset=5), Expr(value=Call(func=Attribute(value=Name(id='faiss_mgr', ctx=Load(), lineno=487, col_offset=4, end_lineno=487, end_col_offset=13), attr='update_index', ctx=Load(), lineno=487, col_offset=4, end_lineno=487, end_col_offset=26), args=[Name(id='new_embeddings', ctx=Load(), lineno=487, col_offset=27, end_lineno=487, end_col_offset=41), Name(id='new_ids', ctx=Load(), lineno=487, col_offset=43, end_lineno=487, end_col_offset=50)], lineno=487, col_offset=4, end_lineno=487, end_col_offset=51), lineno=487, col_offset=4, end_lineno=487, end_col_offset=51), Expr(value=Call(func=Attribute(value=Name(id='faiss_mgr', ctx=Load(), lineno=490, col_offset=4, end_lineno=490, end_col_offset=13), attr='save_cpu_index', ctx=Load(), lineno=490, col_offset=4, end_lineno=490, end_col_offset=28), lineno=490, col_offset=4, end_lineno=490, end_col_offset=30), lineno=490, col_offset=4, end_lineno=490, end_col_offset=30), Expr(value=Call(func=Attribute(value=Name(id='faiss_mgr', ctx=Load(), lineno=491, col_offset=4, end_lineno=491, end_col_offset=13), attr='save_secondary_index', ctx=Load(), lineno=491, col_offset=4, end_lineno=491, end_col_offset=34), lineno=491, col_offset=4, end_lineno=491, end_col_offset=36), lineno=491, col_offset=4, end_lineno=491, end_col_offset=36), Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=493, col_offset=4, end_lineno=493, end_col_offset=10), attr='info', ctx=Load(), lineno=493, col_offset=4, end_lineno=493, end_col_offset=15), args=[Constant(value='Incremental update complete: %s new vectors added to secondary index', lineno=494, col_offset=8, end_lineno=494, end_col_offset=78), Call(func=Name(id='len', ctx=Load(), lineno=495, col_offset=8, end_lineno=495, end_col_offset=11), args=[Name(id='new_ids', ctx=Load(), lineno=495, col_offset=12, end_lineno=495, end_col_offset=19)], lineno=495, col_offset=8, end_lineno=495, end_col_offset=20)], lineno=493, col_offset=4, end_lineno=496, end_col_offset=5), lineno=493, col_offset=4, end_lineno=496, end_col_offset=5)], returns=Constant(value=None, lineno=391, col_offset=5, end_lineno=391, end_col_offset=9), lineno=386, col_offset=0, end_lineno=496, end_col_offset=5), FunctionDef(name='_initialize_duckdb', args=arguments(args=[arg(arg='paths', annotation=Name(id='PipelinePaths', ctx=Load(), lineno=499, col_offset=30, end_lineno=499, end_col_offset=43), lineno=499, col_offset=23, end_lineno=499, end_col_offset=43)], kwonlyargs=[arg(arg='materialize', annotation=Name(id='bool', ctx=Load(), lineno=499, col_offset=61, end_lineno=499, end_col_offset=65), lineno=499, col_offset=48, end_lineno=499, end_col_offset=65)], kw_defaults=[None]), body=[Expr(value=Constant(value='Create or refresh the DuckDB catalog and return the chunk count.\n\n    Parameters\n    ----------\n    paths : PipelinePaths\n        Pipeline paths configuration.\n    materialize : bool\n        Whether to materialize Parquet data into a DuckDB table with indexes.\n\n    Returns\n    -------\n    int\n        Number of chunk records registered in the catalog.\n    ', lineno=500, col_offset=4, end_lineno=513, end_col_offset=7), lineno=500, col_offset=4, end_lineno=513, end_col_offset=7), With(items=[withitem(context_expr=Call(func=Name(id='DuckDBCatalog', ctx=Load(), lineno=514, col_offset=9, end_lineno=514, end_col_offset=22), args=[Attribute(value=Name(id='paths', ctx=Load(), lineno=515, col_offset=8, end_lineno=515, end_col_offset=13), attr='duckdb_path', ctx=Load(), lineno=515, col_offset=8, end_lineno=515, end_col_offset=25), Attribute(value=Name(id='paths', ctx=Load(), lineno=516, col_offset=8, end_lineno=516, end_col_offset=13), attr='vectors_dir', ctx=Load(), lineno=516, col_offset=8, end_lineno=516, end_col_offset=25)], keywords=[keyword(arg='materialize', value=Name(id='materialize', ctx=Load(), lineno=517, col_offset=20, end_lineno=517, end_col_offset=31), lineno=517, col_offset=8, end_lineno=517, end_col_offset=31)], lineno=514, col_offset=9, end_lineno=518, end_col_offset=5), optional_vars=Name(id='catalog', ctx=Store(), lineno=518, col_offset=9, end_lineno=518, end_col_offset=16))], body=[Assign(targets=[Name(id='count', ctx=Store(), lineno=519, col_offset=8, end_lineno=519, end_col_offset=13)], value=Call(func=Attribute(value=Name(id='catalog', ctx=Load(), lineno=519, col_offset=16, end_lineno=519, end_col_offset=23), attr='count_chunks', ctx=Load(), lineno=519, col_offset=16, end_lineno=519, end_col_offset=36), lineno=519, col_offset=16, end_lineno=519, end_col_offset=38), lineno=519, col_offset=8, end_lineno=519, end_col_offset=38)], lineno=514, col_offset=4, end_lineno=519, end_col_offset=38), Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=520, col_offset=4, end_lineno=520, end_col_offset=10), attr='info', ctx=Load(), lineno=520, col_offset=4, end_lineno=520, end_col_offset=15), args=[Constant(value='DuckDB catalog initialized at %s (rows=%s, materialize=%s)', lineno=521, col_offset=8, end_lineno=521, end_col_offset=68), Attribute(value=Name(id='paths', ctx=Load(), lineno=522, col_offset=8, end_lineno=522, end_col_offset=13), attr='duckdb_path', ctx=Load(), lineno=522, col_offset=8, end_lineno=522, end_col_offset=25), Name(id='count', ctx=Load(), lineno=523, col_offset=8, end_lineno=523, end_col_offset=13), Name(id='materialize', ctx=Load(), lineno=524, col_offset=8, end_lineno=524, end_col_offset=19)], lineno=520, col_offset=4, end_lineno=525, end_col_offset=5), lineno=520, col_offset=4, end_lineno=525, end_col_offset=5), Return(value=Name(id='count', ctx=Load(), lineno=526, col_offset=11, end_lineno=526, end_col_offset=16), lineno=526, col_offset=4, end_lineno=526, end_col_offset=16)], returns=Name(id='int', ctx=Load(), lineno=499, col_offset=70, end_lineno=499, end_col_offset=73), lineno=499, col_offset=0, end_lineno=526, end_col_offset=16), FunctionDef(name='_write_symbols', args=arguments(args=[arg(arg='paths', annotation=Name(id='PipelinePaths', ctx=Load(), lineno=529, col_offset=26, end_lineno=529, end_col_offset=39), lineno=529, col_offset=19, end_lineno=529, end_col_offset=39), arg(arg='index', annotation=Name(id='SCIPIndex', ctx=Load(), lineno=529, col_offset=48, end_lineno=529, end_col_offset=57), lineno=529, col_offset=41, end_lineno=529, end_col_offset=57), arg(arg='chunks', annotation=Subscript(value=Name(id='Sequence', ctx=Load(), lineno=529, col_offset=67, end_lineno=529, end_col_offset=75), slice=Name(id='Chunk', ctx=Load(), lineno=529, col_offset=76, end_lineno=529, end_col_offset=81), ctx=Load(), lineno=529, col_offset=67, end_lineno=529, end_col_offset=82), lineno=529, col_offset=59, end_lineno=529, end_col_offset=82)]), body=[Expr(value=Constant(value='Derive symbol tables and persist them into DuckDB.', lineno=530, col_offset=4, end_lineno=530, end_col_offset=60), lineno=530, col_offset=4, end_lineno=530, end_col_offset=60), Assign(targets=[Name(id='manager', ctx=Store(), lineno=531, col_offset=4, end_lineno=531, end_col_offset=11)], value=Call(func=Name(id='DuckDBManager', ctx=Load(), lineno=531, col_offset=14, end_lineno=531, end_col_offset=27), args=[Attribute(value=Name(id='paths', ctx=Load(), lineno=531, col_offset=28, end_lineno=531, end_col_offset=33), attr='duckdb_path', ctx=Load(), lineno=531, col_offset=28, end_lineno=531, end_col_offset=45)], lineno=531, col_offset=14, end_lineno=531, end_col_offset=46), lineno=531, col_offset=4, end_lineno=531, end_col_offset=46), Assign(targets=[Name(id='sym', ctx=Store(), lineno=532, col_offset=4, end_lineno=532, end_col_offset=7)], value=Call(func=Name(id='SymbolCatalog', ctx=Load(), lineno=532, col_offset=10, end_lineno=532, end_col_offset=23), args=[Name(id='manager', ctx=Load(), lineno=532, col_offset=24, end_lineno=532, end_col_offset=31)], lineno=532, col_offset=10, end_lineno=532, end_col_offset=32), lineno=532, col_offset=4, end_lineno=532, end_col_offset=32), Expr(value=Call(func=Attribute(value=Name(id='sym', ctx=Load(), lineno=533, col_offset=4, end_lineno=533, end_col_offset=7), attr='ensure_schema', ctx=Load(), lineno=533, col_offset=4, end_lineno=533, end_col_offset=21), lineno=533, col_offset=4, end_lineno=533, end_col_offset=23), lineno=533, col_offset=4, end_lineno=533, end_col_offset=23), AnnAssign(target=Name(id='by_file', ctx=Store(), lineno=535, col_offset=4, end_lineno=535, end_col_offset=11), annotation=Subscript(value=Name(id='dict', ctx=Load(), lineno=535, col_offset=13, end_lineno=535, end_col_offset=17), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=535, col_offset=18, end_lineno=535, end_col_offset=21), Subscript(value=Name(id='list', ctx=Load(), lineno=535, col_offset=23, end_lineno=535, end_col_offset=27), slice=Subscript(value=Name(id='tuple', ctx=Load(), lineno=535, col_offset=28, end_lineno=535, end_col_offset=33), slice=Tuple(elts=[Name(id='int', ctx=Load(), lineno=535, col_offset=34, end_lineno=535, end_col_offset=37), Name(id='int', ctx=Load(), lineno=535, col_offset=39, end_lineno=535, end_col_offset=42), Name(id='int', ctx=Load(), lineno=535, col_offset=44, end_lineno=535, end_col_offset=47)], ctx=Load(), lineno=535, col_offset=34, end_lineno=535, end_col_offset=47), ctx=Load(), lineno=535, col_offset=28, end_lineno=535, end_col_offset=48), ctx=Load(), lineno=535, col_offset=23, end_lineno=535, end_col_offset=49)], ctx=Load(), lineno=535, col_offset=18, end_lineno=535, end_col_offset=49), ctx=Load(), lineno=535, col_offset=13, end_lineno=535, end_col_offset=50), value=Dict(lineno=535, col_offset=53, end_lineno=535, end_col_offset=55), simple=1, lineno=535, col_offset=4, end_lineno=535, end_col_offset=55), For(target=Tuple(elts=[Name(id='chunk_id', ctx=Store(), lineno=536, col_offset=8, end_lineno=536, end_col_offset=16), Name(id='chunk', ctx=Store(), lineno=536, col_offset=18, end_lineno=536, end_col_offset=23)], ctx=Store(), lineno=536, col_offset=8, end_lineno=536, end_col_offset=23), iter=Call(func=Name(id='enumerate', ctx=Load(), lineno=536, col_offset=27, end_lineno=536, end_col_offset=36), args=[Name(id='chunks', ctx=Load(), lineno=536, col_offset=37, end_lineno=536, end_col_offset=43)], lineno=536, col_offset=27, end_lineno=536, end_col_offset=44), body=[Expr(value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='by_file', ctx=Load(), lineno=537, col_offset=8, end_lineno=537, end_col_offset=15), attr='setdefault', ctx=Load(), lineno=537, col_offset=8, end_lineno=537, end_col_offset=26), args=[Attribute(value=Name(id='chunk', ctx=Load(), lineno=537, col_offset=27, end_lineno=537, end_col_offset=32), attr='uri', ctx=Load(), lineno=537, col_offset=27, end_lineno=537, end_col_offset=36), List(ctx=Load(), lineno=537, col_offset=38, end_lineno=537, end_col_offset=40)], lineno=537, col_offset=8, end_lineno=537, end_col_offset=41), attr='append', ctx=Load(), lineno=537, col_offset=8, end_lineno=537, end_col_offset=48), args=[Tuple(elts=[Name(id='chunk_id', ctx=Load(), lineno=537, col_offset=50, end_lineno=537, end_col_offset=58), Attribute(value=Name(id='chunk', ctx=Load(), lineno=537, col_offset=60, end_lineno=537, end_col_offset=65), attr='start_line', ctx=Load(), lineno=537, col_offset=60, end_lineno=537, end_col_offset=76), Attribute(value=Name(id='chunk', ctx=Load(), lineno=537, col_offset=78, end_lineno=537, end_col_offset=83), attr='end_line', ctx=Load(), lineno=537, col_offset=78, end_lineno=537, end_col_offset=92)], ctx=Load(), lineno=537, col_offset=49, end_lineno=537, end_col_offset=93)], lineno=537, col_offset=8, end_lineno=537, end_col_offset=94), lineno=537, col_offset=8, end_lineno=537, end_col_offset=94)], lineno=536, col_offset=4, end_lineno=537, end_col_offset=94), FunctionDef(name='_chunk_for', args=arguments(args=[arg(arg='uri', annotation=Name(id='str', ctx=Load(), lineno=539, col_offset=24, end_lineno=539, end_col_offset=27), lineno=539, col_offset=19, end_lineno=539, end_col_offset=27), arg(arg='line', annotation=Name(id='int', ctx=Load(), lineno=539, col_offset=35, end_lineno=539, end_col_offset=38), lineno=539, col_offset=29, end_lineno=539, end_col_offset=38)]), body=[For(target=Tuple(elts=[Name(id='cid', ctx=Store(), lineno=540, col_offset=12, end_lineno=540, end_col_offset=15), Name(id='start', ctx=Store(), lineno=540, col_offset=17, end_lineno=540, end_col_offset=22), Name(id='end', ctx=Store(), lineno=540, col_offset=24, end_lineno=540, end_col_offset=27)], ctx=Store(), lineno=540, col_offset=12, end_lineno=540, end_col_offset=27), iter=Call(func=Attribute(value=Name(id='by_file', ctx=Load(), lineno=540, col_offset=31, end_lineno=540, end_col_offset=38), attr='get', ctx=Load(), lineno=540, col_offset=31, end_lineno=540, end_col_offset=42), args=[Name(id='uri', ctx=Load(), lineno=540, col_offset=43, end_lineno=540, end_col_offset=46), List(ctx=Load(), lineno=540, col_offset=48, end_lineno=540, end_col_offset=50)], lineno=540, col_offset=31, end_lineno=540, end_col_offset=51), body=[If(test=Compare(left=Name(id='start', ctx=Load(), lineno=541, col_offset=15, end_lineno=541, end_col_offset=20), ops=[LtE(), LtE()], comparators=[Name(id='line', ctx=Load(), lineno=541, col_offset=24, end_lineno=541, end_col_offset=28), Name(id='end', ctx=Load(), lineno=541, col_offset=32, end_lineno=541, end_col_offset=35)], lineno=541, col_offset=15, end_lineno=541, end_col_offset=35), body=[Return(value=Name(id='cid', ctx=Load(), lineno=542, col_offset=23, end_lineno=542, end_col_offset=26), lineno=542, col_offset=16, end_lineno=542, end_col_offset=26)], lineno=541, col_offset=12, end_lineno=542, end_col_offset=26)], lineno=540, col_offset=8, end_lineno=542, end_col_offset=26), Return(value=UnaryOp(op=USub(), operand=Constant(value=1, lineno=543, col_offset=16, end_lineno=543, end_col_offset=17), lineno=543, col_offset=15, end_lineno=543, end_col_offset=17), lineno=543, col_offset=8, end_lineno=543, end_col_offset=17)], returns=Name(id='int', ctx=Load(), lineno=539, col_offset=43, end_lineno=539, end_col_offset=46), lineno=539, col_offset=4, end_lineno=543, end_col_offset=17), AnnAssign(target=Name(id='occ_rows', ctx=Store(), lineno=545, col_offset=4, end_lineno=545, end_col_offset=12), annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=545, col_offset=14, end_lineno=545, end_col_offset=18), slice=Name(id='SymbolOccurrenceRow', ctx=Load(), lineno=545, col_offset=19, end_lineno=545, end_col_offset=38), ctx=Load(), lineno=545, col_offset=14, end_lineno=545, end_col_offset=39), value=List(ctx=Load(), lineno=545, col_offset=42, end_lineno=545, end_col_offset=44), simple=1, lineno=545, col_offset=4, end_lineno=545, end_col_offset=44), AnnAssign(target=Name(id='def_rows', ctx=Store(), lineno=546, col_offset=4, end_lineno=546, end_col_offset=12), annotation=Subscript(value=Name(id='dict', ctx=Load(), lineno=546, col_offset=14, end_lineno=546, end_col_offset=18), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=546, col_offset=19, end_lineno=546, end_col_offset=22), Name(id='SymbolDefRow', ctx=Load(), lineno=546, col_offset=24, end_lineno=546, end_col_offset=36)], ctx=Load(), lineno=546, col_offset=19, end_lineno=546, end_col_offset=36), ctx=Load(), lineno=546, col_offset=14, end_lineno=546, end_col_offset=37), value=Dict(lineno=546, col_offset=40, end_lineno=546, end_col_offset=42), simple=1, lineno=546, col_offset=4, end_lineno=546, end_col_offset=42), AnnAssign(target=Name(id='chunk_pairs', ctx=Store(), lineno=547, col_offset=4, end_lineno=547, end_col_offset=15), annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=547, col_offset=17, end_lineno=547, end_col_offset=21), slice=Subscript(value=Name(id='tuple', ctx=Load(), lineno=547, col_offset=22, end_lineno=547, end_col_offset=27), slice=Tuple(elts=[Name(id='int', ctx=Load(), lineno=547, col_offset=28, end_lineno=547, end_col_offset=31), Name(id='str', ctx=Load(), lineno=547, col_offset=33, end_lineno=547, end_col_offset=36)], ctx=Load(), lineno=547, col_offset=28, end_lineno=547, end_col_offset=36), ctx=Load(), lineno=547, col_offset=22, end_lineno=547, end_col_offset=37), ctx=Load(), lineno=547, col_offset=17, end_lineno=547, end_col_offset=38), value=List(ctx=Load(), lineno=547, col_offset=41, end_lineno=547, end_col_offset=43), simple=1, lineno=547, col_offset=4, end_lineno=547, end_col_offset=43), For(target=Name(id='doc', ctx=Store(), lineno=549, col_offset=8, end_lineno=549, end_col_offset=11), iter=Attribute(value=Name(id='index', ctx=Load(), lineno=549, col_offset=15, end_lineno=549, end_col_offset=20), attr='documents', ctx=Load(), lineno=549, col_offset=15, end_lineno=549, end_col_offset=30), body=[Assign(targets=[Name(id='uri', ctx=Store(), lineno=550, col_offset=8, end_lineno=550, end_col_offset=11)], value=Call(func=Name(id='str', ctx=Load(), lineno=550, col_offset=14, end_lineno=550, end_col_offset=17), args=[Call(func=Attribute(value=BinOp(left=Attribute(value=Name(id='paths', ctx=Load(), lineno=550, col_offset=19, end_lineno=550, end_col_offset=24), attr='repo_root', ctx=Load(), lineno=550, col_offset=19, end_lineno=550, end_col_offset=34), op=Div(), right=Attribute(value=Name(id='doc', ctx=Load(), lineno=550, col_offset=37, end_lineno=550, end_col_offset=40), attr='relative_path', ctx=Load(), lineno=550, col_offset=37, end_lineno=550, end_col_offset=54), lineno=550, col_offset=19, end_lineno=550, end_col_offset=54), attr='resolve', ctx=Load(), lineno=550, col_offset=18, end_lineno=550, end_col_offset=63), lineno=550, col_offset=18, end_lineno=550, end_col_offset=65)], lineno=550, col_offset=14, end_lineno=550, end_col_offset=66), lineno=550, col_offset=8, end_lineno=550, end_col_offset=66), Assign(targets=[Name(id='lang', ctx=Store(), lineno=551, col_offset=8, end_lineno=551, end_col_offset=12)], value=BoolOp(op=Or(), values=[Attribute(value=Name(id='doc', ctx=Load(), lineno=551, col_offset=15, end_lineno=551, end_col_offset=18), attr='language', ctx=Load(), lineno=551, col_offset=15, end_lineno=551, end_col_offset=27), Constant(value='', lineno=551, col_offset=31, end_lineno=551, end_col_offset=33)], lineno=551, col_offset=15, end_lineno=551, end_col_offset=33), lineno=551, col_offset=8, end_lineno=551, end_col_offset=33), For(target=Name(id='occ', ctx=Store(), lineno=552, col_offset=12, end_lineno=552, end_col_offset=15), iter=Attribute(value=Name(id='doc', ctx=Load(), lineno=552, col_offset=19, end_lineno=552, end_col_offset=22), attr='occurrences', ctx=Load(), lineno=552, col_offset=19, end_lineno=552, end_col_offset=34), body=[Assign(targets=[Tuple(elts=[Name(id='sl', ctx=Store(), lineno=553, col_offset=12, end_lineno=553, end_col_offset=14), Name(id='sc', ctx=Store(), lineno=553, col_offset=16, end_lineno=553, end_col_offset=18), Name(id='el', ctx=Store(), lineno=553, col_offset=20, end_lineno=553, end_col_offset=22), Name(id='ec', ctx=Store(), lineno=553, col_offset=24, end_lineno=553, end_col_offset=26)], ctx=Store(), lineno=553, col_offset=12, end_lineno=553, end_col_offset=26)], value=Attribute(value=Name(id='occ', ctx=Load(), lineno=553, col_offset=29, end_lineno=553, end_col_offset=32), attr='range', ctx=Load(), lineno=553, col_offset=29, end_lineno=553, end_col_offset=38), lineno=553, col_offset=12, end_lineno=553, end_col_offset=38), Assign(targets=[Name(id='chunk_id', ctx=Store(), lineno=554, col_offset=12, end_lineno=554, end_col_offset=20)], value=Call(func=Name(id='_chunk_for', ctx=Load(), lineno=554, col_offset=23, end_lineno=554, end_col_offset=33), args=[Name(id='uri', ctx=Load(), lineno=554, col_offset=34, end_lineno=554, end_col_offset=37), Name(id='sl', ctx=Load(), lineno=554, col_offset=39, end_lineno=554, end_col_offset=41)], lineno=554, col_offset=23, end_lineno=554, end_col_offset=42), lineno=554, col_offset=12, end_lineno=554, end_col_offset=42), Assign(targets=[Name(id='roles', ctx=Store(), lineno=555, col_offset=12, end_lineno=555, end_col_offset=17)], value=Call(func=Name(id='int', ctx=Load(), lineno=555, col_offset=20, end_lineno=555, end_col_offset=23), args=[BoolOp(op=Or(), values=[Attribute(value=Name(id='occ', ctx=Load(), lineno=555, col_offset=24, end_lineno=555, end_col_offset=27), attr='roles', ctx=Load(), lineno=555, col_offset=24, end_lineno=555, end_col_offset=33), Constant(value=0, lineno=555, col_offset=37, end_lineno=555, end_col_offset=38)], lineno=555, col_offset=24, end_lineno=555, end_col_offset=38)], lineno=555, col_offset=20, end_lineno=555, end_col_offset=39), lineno=555, col_offset=12, end_lineno=555, end_col_offset=39), Expr(value=Call(func=Attribute(value=Name(id='occ_rows', ctx=Load(), lineno=556, col_offset=12, end_lineno=556, end_col_offset=20), attr='append', ctx=Load(), lineno=556, col_offset=12, end_lineno=556, end_col_offset=27), args=[Call(func=Name(id='SymbolOccurrenceRow', ctx=Load(), lineno=557, col_offset=16, end_lineno=557, end_col_offset=35), keywords=[keyword(arg='symbol', value=Attribute(value=Name(id='occ', ctx=Load(), lineno=558, col_offset=27, end_lineno=558, end_col_offset=30), attr='symbol', ctx=Load(), lineno=558, col_offset=27, end_lineno=558, end_col_offset=37), lineno=558, col_offset=20, end_lineno=558, end_col_offset=37), keyword(arg='uri', value=Name(id='uri', ctx=Load(), lineno=559, col_offset=24, end_lineno=559, end_col_offset=27), lineno=559, col_offset=20, end_lineno=559, end_col_offset=27), keyword(arg='start_line', value=Name(id='sl', ctx=Load(), lineno=560, col_offset=31, end_lineno=560, end_col_offset=33), lineno=560, col_offset=20, end_lineno=560, end_col_offset=33), keyword(arg='start_col', value=Name(id='sc', ctx=Load(), lineno=561, col_offset=30, end_lineno=561, end_col_offset=32), lineno=561, col_offset=20, end_lineno=561, end_col_offset=32), keyword(arg='end_line', value=Name(id='el', ctx=Load(), lineno=562, col_offset=29, end_lineno=562, end_col_offset=31), lineno=562, col_offset=20, end_lineno=562, end_col_offset=31), keyword(arg='end_col', value=Name(id='ec', ctx=Load(), lineno=563, col_offset=28, end_lineno=563, end_col_offset=30), lineno=563, col_offset=20, end_lineno=563, end_col_offset=30), keyword(arg='roles', value=Name(id='roles', ctx=Load(), lineno=564, col_offset=26, end_lineno=564, end_col_offset=31), lineno=564, col_offset=20, end_lineno=564, end_col_offset=31), keyword(arg='kind', value=Constant(value=None, lineno=565, col_offset=25, end_lineno=565, end_col_offset=29), lineno=565, col_offset=20, end_lineno=565, end_col_offset=29), keyword(arg='language', value=Name(id='lang', ctx=Load(), lineno=566, col_offset=29, end_lineno=566, end_col_offset=33), lineno=566, col_offset=20, end_lineno=566, end_col_offset=33), keyword(arg='chunk_id', value=Name(id='chunk_id', ctx=Load(), lineno=567, col_offset=29, end_lineno=567, end_col_offset=37), lineno=567, col_offset=20, end_lineno=567, end_col_offset=37)], lineno=557, col_offset=16, end_lineno=568, end_col_offset=17)], lineno=556, col_offset=12, end_lineno=569, end_col_offset=13), lineno=556, col_offset=12, end_lineno=569, end_col_offset=13), If(test=BinOp(left=Name(id='roles', ctx=Load(), lineno=570, col_offset=15, end_lineno=570, end_col_offset=20), op=BitAnd(), right=Constant(value=1, lineno=570, col_offset=23, end_lineno=570, end_col_offset=24), lineno=570, col_offset=15, end_lineno=570, end_col_offset=24), body=[Assign(targets=[Name(id='display_name', ctx=Store(), lineno=571, col_offset=16, end_lineno=571, end_col_offset=28)], value=Subscript(value=Call(func=Attribute(value=Subscript(value=Call(func=Attribute(value=Attribute(value=Name(id='occ', ctx=Load(), lineno=571, col_offset=31, end_lineno=571, end_col_offset=34), attr='symbol', ctx=Load(), lineno=571, col_offset=31, end_lineno=571, end_col_offset=41), attr='split', ctx=Load(), lineno=571, col_offset=31, end_lineno=571, end_col_offset=47), args=[Constant(value='#', lineno=571, col_offset=48, end_lineno=571, end_col_offset=51)], lineno=571, col_offset=31, end_lineno=571, end_col_offset=52), slice=UnaryOp(op=USub(), operand=Constant(value=1, lineno=571, col_offset=54, end_lineno=571, end_col_offset=55), lineno=571, col_offset=53, end_lineno=571, end_col_offset=55), ctx=Load(), lineno=571, col_offset=31, end_lineno=571, end_col_offset=56), attr='split', ctx=Load(), lineno=571, col_offset=31, end_lineno=571, end_col_offset=62), args=[Constant(value='.', lineno=571, col_offset=63, end_lineno=571, end_col_offset=66)], lineno=571, col_offset=31, end_lineno=571, end_col_offset=67), slice=UnaryOp(op=USub(), operand=Constant(value=1, lineno=571, col_offset=69, end_lineno=571, end_col_offset=70), lineno=571, col_offset=68, end_lineno=571, end_col_offset=70), ctx=Load(), lineno=571, col_offset=31, end_lineno=571, end_col_offset=71), lineno=571, col_offset=16, end_lineno=571, end_col_offset=71), Expr(value=Call(func=Attribute(value=Name(id='def_rows', ctx=Load(), lineno=572, col_offset=16, end_lineno=572, end_col_offset=24), attr='setdefault', ctx=Load(), lineno=572, col_offset=16, end_lineno=572, end_col_offset=35), args=[Attribute(value=Name(id='occ', ctx=Load(), lineno=573, col_offset=20, end_lineno=573, end_col_offset=23), attr='symbol', ctx=Load(), lineno=573, col_offset=20, end_lineno=573, end_col_offset=30), Call(func=Name(id='SymbolDefRow', ctx=Load(), lineno=574, col_offset=20, end_lineno=574, end_col_offset=32), keywords=[keyword(arg='symbol', value=Attribute(value=Name(id='occ', ctx=Load(), lineno=575, col_offset=31, end_lineno=575, end_col_offset=34), attr='symbol', ctx=Load(), lineno=575, col_offset=31, end_lineno=575, end_col_offset=41), lineno=575, col_offset=24, end_lineno=575, end_col_offset=41), keyword(arg='display_name', value=Name(id='display_name', ctx=Load(), lineno=576, col_offset=37, end_lineno=576, end_col_offset=49), lineno=576, col_offset=24, end_lineno=576, end_col_offset=49), keyword(arg='kind', value=Constant(value='symbol', lineno=577, col_offset=29, end_lineno=577, end_col_offset=37), lineno=577, col_offset=24, end_lineno=577, end_col_offset=37), keyword(arg='language', value=Name(id='lang', ctx=Load(), lineno=578, col_offset=33, end_lineno=578, end_col_offset=37), lineno=578, col_offset=24, end_lineno=578, end_col_offset=37), keyword(arg='uri', value=Name(id='uri', ctx=Load(), lineno=579, col_offset=28, end_lineno=579, end_col_offset=31), lineno=579, col_offset=24, end_lineno=579, end_col_offset=31), keyword(arg='start_line', value=Name(id='sl', ctx=Load(), lineno=580, col_offset=35, end_lineno=580, end_col_offset=37), lineno=580, col_offset=24, end_lineno=580, end_col_offset=37), keyword(arg='start_col', value=Name(id='sc', ctx=Load(), lineno=581, col_offset=34, end_lineno=581, end_col_offset=36), lineno=581, col_offset=24, end_lineno=581, end_col_offset=36), keyword(arg='end_line', value=Name(id='el', ctx=Load(), lineno=582, col_offset=33, end_lineno=582, end_col_offset=35), lineno=582, col_offset=24, end_lineno=582, end_col_offset=35), keyword(arg='end_col', value=Name(id='ec', ctx=Load(), lineno=583, col_offset=32, end_lineno=583, end_col_offset=34), lineno=583, col_offset=24, end_lineno=583, end_col_offset=34), keyword(arg='chunk_id', value=Name(id='chunk_id', ctx=Load(), lineno=584, col_offset=33, end_lineno=584, end_col_offset=41), lineno=584, col_offset=24, end_lineno=584, end_col_offset=41), keyword(arg='docstring', value=Constant(value=None, lineno=585, col_offset=34, end_lineno=585, end_col_offset=38), lineno=585, col_offset=24, end_lineno=585, end_col_offset=38), keyword(arg='signature', value=Constant(value=None, lineno=586, col_offset=34, end_lineno=586, end_col_offset=38), lineno=586, col_offset=24, end_lineno=586, end_col_offset=38)], lineno=574, col_offset=20, end_lineno=587, end_col_offset=21)], lineno=572, col_offset=16, end_lineno=588, end_col_offset=17), lineno=572, col_offset=16, end_lineno=588, end_col_offset=17)], lineno=570, col_offset=12, end_lineno=588, end_col_offset=17)], lineno=552, col_offset=8, end_lineno=588, end_col_offset=17)], lineno=549, col_offset=4, end_lineno=588, end_col_offset=17), For(target=Tuple(elts=[Name(id='chunk_id', ctx=Store(), lineno=590, col_offset=8, end_lineno=590, end_col_offset=16), Name(id='chunk', ctx=Store(), lineno=590, col_offset=18, end_lineno=590, end_col_offset=23)], ctx=Store(), lineno=590, col_offset=8, end_lineno=590, end_col_offset=23), iter=Call(func=Name(id='enumerate', ctx=Load(), lineno=590, col_offset=27, end_lineno=590, end_col_offset=36), args=[Name(id='chunks', ctx=Load(), lineno=590, col_offset=37, end_lineno=590, end_col_offset=43)], lineno=590, col_offset=27, end_lineno=590, end_col_offset=44), body=[Expr(value=Call(func=Attribute(value=Name(id='chunk_pairs', ctx=Load(), lineno=591, col_offset=8, end_lineno=591, end_col_offset=19), attr='extend', ctx=Load(), lineno=591, col_offset=8, end_lineno=591, end_col_offset=26), args=[GeneratorExp(elt=Tuple(elts=[Name(id='chunk_id', ctx=Load(), lineno=591, col_offset=28, end_lineno=591, end_col_offset=36), Name(id='symbol', ctx=Load(), lineno=591, col_offset=38, end_lineno=591, end_col_offset=44)], ctx=Load(), lineno=591, col_offset=27, end_lineno=591, end_col_offset=45), generators=[comprehension(target=Name(id='symbol', ctx=Store(), lineno=591, col_offset=50, end_lineno=591, end_col_offset=56), iter=Attribute(value=Name(id='chunk', ctx=Load(), lineno=591, col_offset=60, end_lineno=591, end_col_offset=65), attr='symbols', ctx=Load(), lineno=591, col_offset=60, end_lineno=591, end_col_offset=73), is_async=0)], lineno=591, col_offset=26, end_lineno=591, end_col_offset=74)], lineno=591, col_offset=8, end_lineno=591, end_col_offset=74), lineno=591, col_offset=8, end_lineno=591, end_col_offset=74)], lineno=590, col_offset=4, end_lineno=591, end_col_offset=74), Expr(value=Call(func=Attribute(value=Name(id='sym', ctx=Load(), lineno=593, col_offset=4, end_lineno=593, end_col_offset=7), attr='bulk_insert_occurrences', ctx=Load(), lineno=593, col_offset=4, end_lineno=593, end_col_offset=31), args=[Name(id='occ_rows', ctx=Load(), lineno=593, col_offset=32, end_lineno=593, end_col_offset=40)], lineno=593, col_offset=4, end_lineno=593, end_col_offset=41), lineno=593, col_offset=4, end_lineno=593, end_col_offset=41), Expr(value=Call(func=Attribute(value=Name(id='sym', ctx=Load(), lineno=594, col_offset=4, end_lineno=594, end_col_offset=7), attr='upsert_symbol_defs', ctx=Load(), lineno=594, col_offset=4, end_lineno=594, end_col_offset=26), args=[Call(func=Name(id='list', ctx=Load(), lineno=594, col_offset=27, end_lineno=594, end_col_offset=31), args=[Call(func=Attribute(value=Name(id='def_rows', ctx=Load(), lineno=594, col_offset=32, end_lineno=594, end_col_offset=40), attr='values', ctx=Load(), lineno=594, col_offset=32, end_lineno=594, end_col_offset=47), lineno=594, col_offset=32, end_lineno=594, end_col_offset=49)], lineno=594, col_offset=27, end_lineno=594, end_col_offset=50)], lineno=594, col_offset=4, end_lineno=594, end_col_offset=51), lineno=594, col_offset=4, end_lineno=594, end_col_offset=51), Expr(value=Call(func=Attribute(value=Name(id='sym', ctx=Load(), lineno=595, col_offset=4, end_lineno=595, end_col_offset=7), attr='bulk_insert_chunk_symbols', ctx=Load(), lineno=595, col_offset=4, end_lineno=595, end_col_offset=33), args=[Name(id='chunk_pairs', ctx=Load(), lineno=595, col_offset=34, end_lineno=595, end_col_offset=45)], lineno=595, col_offset=4, end_lineno=595, end_col_offset=46), lineno=595, col_offset=4, end_lineno=595, end_col_offset=46)], returns=Constant(value=None, lineno=529, col_offset=87, end_lineno=529, end_col_offset=91), lineno=529, col_offset=0, end_lineno=595, end_col_offset=46), If(test=Compare(left=Name(id='__name__', ctx=Load(), lineno=598, col_offset=3, end_lineno=598, end_col_offset=11), ops=[Eq()], comparators=[Constant(value='__main__', lineno=598, col_offset=15, end_lineno=598, end_col_offset=25)], lineno=598, col_offset=3, end_lineno=598, end_col_offset=25), body=[Expr(value=Call(func=Name(id='main', ctx=Load(), lineno=599, col_offset=4, end_lineno=599, end_col_offset=8), lineno=599, col_offset=4, end_lineno=599, end_col_offset=10), lineno=599, col_offset=4, end_lineno=599, end_col_offset=10)], lineno=598, col_offset=0, end_lineno=599, end_col_offset=10)])