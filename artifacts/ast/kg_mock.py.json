Module(body=[Expr(value=Constant(value='Overview of kg mock.\n\nThis module bundles kg mock logic for the kgfoundry stack. It groups related helpers so downstream\npackages can import a single cohesive namespace. Refer to the functions and classes below for\nimplementation specifics.\n', lineno=1, col_offset=0, end_lineno=6, end_col_offset=3), lineno=1, col_offset=0, end_lineno=6, end_col_offset=3), ImportFrom(module='__future__', names=[alias(name='annotations', lineno=10, col_offset=23, end_lineno=10, end_col_offset=34)], level=0, lineno=10, col_offset=0, end_lineno=10, end_col_offset=34), ImportFrom(module='typing', names=[alias(name='Final', lineno=12, col_offset=19, end_lineno=12, end_col_offset=24), alias(name='TypedDict', lineno=12, col_offset=26, end_lineno=12, end_col_offset=35)], level=0, lineno=12, col_offset=0, end_lineno=12, end_col_offset=35), ImportFrom(module='kgfoundry_common.navmap_loader', names=[alias(name='load_nav_metadata', lineno=14, col_offset=43, end_lineno=14, end_col_offset=60)], level=0, lineno=14, col_offset=0, end_lineno=14, end_col_offset=60), Assign(targets=[Name(id='__all__', ctx=Store(), lineno=16, col_offset=0, end_lineno=16, end_col_offset=7)], value=List(elts=[Constant(value='detect_query_concepts', lineno=17, col_offset=4, end_lineno=17, end_col_offset=27), Constant(value='kg_boost', lineno=18, col_offset=4, end_lineno=18, end_col_offset=14), Constant(value='linked_concepts_for_text', lineno=19, col_offset=4, end_lineno=19, end_col_offset=30)], ctx=Load(), lineno=16, col_offset=10, end_lineno=20, end_col_offset=1), lineno=16, col_offset=0, end_lineno=20, end_col_offset=1), Assign(targets=[Name(id='__navmap__', ctx=Store(), lineno=21, col_offset=0, end_lineno=21, end_col_offset=10)], value=Call(func=Name(id='load_nav_metadata', ctx=Load(), lineno=21, col_offset=13, end_lineno=21, end_col_offset=30), args=[Name(id='__name__', ctx=Load(), lineno=21, col_offset=31, end_lineno=21, end_col_offset=39), Call(func=Name(id='tuple', ctx=Load(), lineno=21, col_offset=41, end_lineno=21, end_col_offset=46), args=[Name(id='__all__', ctx=Load(), lineno=21, col_offset=47, end_lineno=21, end_col_offset=54)], lineno=21, col_offset=41, end_lineno=21, end_col_offset=55)], lineno=21, col_offset=13, end_lineno=21, end_col_offset=56), lineno=21, col_offset=0, end_lineno=21, end_col_offset=56), ClassDef(name='ConceptMeta', bases=[Name(id='TypedDict', ctx=Load(), lineno=24, col_offset=18, end_lineno=24, end_col_offset=27)], body=[Expr(value=Constant(value='Metadata for knowledge graph concepts used by mock scoring.', lineno=25, col_offset=4, end_lineno=25, end_col_offset=69), lineno=25, col_offset=4, end_lineno=25, end_col_offset=69), AnnAssign(target=Name(id='label', ctx=Store(), lineno=27, col_offset=4, end_lineno=27, end_col_offset=9), annotation=Name(id='str', ctx=Load(), lineno=27, col_offset=11, end_lineno=27, end_col_offset=14), simple=1, lineno=27, col_offset=4, end_lineno=27, end_col_offset=14), Expr(value=Constant(value='Human-readable concept label.\n\n    Alias: none; name ``label``.\n    ', lineno=28, col_offset=4, end_lineno=31, end_col_offset=7), lineno=28, col_offset=4, end_lineno=31, end_col_offset=7), AnnAssign(target=Name(id='keywords', ctx=Store(), lineno=32, col_offset=4, end_lineno=32, end_col_offset=12), annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=32, col_offset=14, end_lineno=32, end_col_offset=18), slice=Name(id='str', ctx=Load(), lineno=32, col_offset=19, end_lineno=32, end_col_offset=22), ctx=Load(), lineno=32, col_offset=14, end_lineno=32, end_col_offset=23), simple=1, lineno=32, col_offset=4, end_lineno=32, end_col_offset=23), Expr(value=Constant(value='Keywords associated with the concept.\n\n    Alias: none; name ``keywords``.\n    ', lineno=33, col_offset=4, end_lineno=36, end_col_offset=7), lineno=33, col_offset=4, end_lineno=36, end_col_offset=7)], lineno=24, col_offset=0, end_lineno=36, end_col_offset=7), AnnAssign(target=Name(id='CONCEPTS', ctx=Store(), lineno=39, col_offset=0, end_lineno=39, end_col_offset=8), annotation=Subscript(value=Name(id='Final', ctx=Load(), lineno=39, col_offset=10, end_lineno=39, end_col_offset=15), slice=Subscript(value=Name(id='dict', ctx=Load(), lineno=39, col_offset=16, end_lineno=39, end_col_offset=20), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=39, col_offset=21, end_lineno=39, end_col_offset=24), Name(id='ConceptMeta', ctx=Load(), lineno=39, col_offset=26, end_lineno=39, end_col_offset=37)], ctx=Load(), lineno=39, col_offset=21, end_lineno=39, end_col_offset=37), ctx=Load(), lineno=39, col_offset=16, end_lineno=39, end_col_offset=38), ctx=Load(), lineno=39, col_offset=10, end_lineno=39, end_col_offset=39), value=Dict(keys=[Constant(value='urn:concept:toy:LLM', lineno=40, col_offset=4, end_lineno=40, end_col_offset=25), Constant(value='urn:concept:toy:Alignment', lineno=44, col_offset=4, end_lineno=44, end_col_offset=31)], values=[Dict(keys=[Constant(value='label', lineno=41, col_offset=8, end_lineno=41, end_col_offset=15), Constant(value='keywords', lineno=42, col_offset=8, end_lineno=42, end_col_offset=18)], values=[Constant(value='Large Language Model', lineno=41, col_offset=17, end_lineno=41, end_col_offset=39), List(elts=[Constant(value='llm', lineno=42, col_offset=21, end_lineno=42, end_col_offset=26), Constant(value='language model', lineno=42, col_offset=28, end_lineno=42, end_col_offset=44), Constant(value='transformer', lineno=42, col_offset=46, end_lineno=42, end_col_offset=59)], ctx=Load(), lineno=42, col_offset=20, end_lineno=42, end_col_offset=60)], lineno=40, col_offset=27, end_lineno=43, end_col_offset=5), Dict(keys=[Constant(value='label', lineno=45, col_offset=8, end_lineno=45, end_col_offset=15), Constant(value='keywords', lineno=46, col_offset=8, end_lineno=46, end_col_offset=18)], values=[Constant(value='Alignment', lineno=45, col_offset=17, end_lineno=45, end_col_offset=28), List(elts=[Constant(value='alignment', lineno=46, col_offset=21, end_lineno=46, end_col_offset=32), Constant(value='safety', lineno=46, col_offset=34, end_lineno=46, end_col_offset=42), Constant(value='rlhf', lineno=46, col_offset=44, end_lineno=46, end_col_offset=50)], ctx=Load(), lineno=46, col_offset=20, end_lineno=46, end_col_offset=51)], lineno=44, col_offset=33, end_lineno=47, end_col_offset=5)], lineno=39, col_offset=42, end_lineno=48, end_col_offset=1), simple=1, lineno=39, col_offset=0, end_lineno=48, end_col_offset=1), FunctionDef(name='detect_query_concepts', args=arguments(args=[arg(arg='query', annotation=Name(id='str', ctx=Load(), lineno=52, col_offset=33, end_lineno=52, end_col_offset=36), lineno=52, col_offset=26, end_lineno=52, end_col_offset=36)]), body=[Expr(value=Constant(value='Detect knowledge graph concepts mentioned in a query.\n\n    Searches for concept keywords in the query text and returns matching\n    concept IDs from the mock knowledge graph.\n\n    Parameters\n    ----------\n    query : str\n        Query text to analyze for concept mentions.\n\n    Returns\n    -------\n    set[str]\n        Set of concept IDs that match keywords in the query.\n    ', lineno=53, col_offset=4, end_lineno=67, end_col_offset=7), lineno=53, col_offset=4, end_lineno=67, end_col_offset=7), Assign(targets=[Name(id='lowered', ctx=Store(), lineno=68, col_offset=4, end_lineno=68, end_col_offset=11)], value=Call(func=Attribute(value=Name(id='query', ctx=Load(), lineno=68, col_offset=14, end_lineno=68, end_col_offset=19), attr='lower', ctx=Load(), lineno=68, col_offset=14, end_lineno=68, end_col_offset=25), lineno=68, col_offset=14, end_lineno=68, end_col_offset=27), lineno=68, col_offset=4, end_lineno=68, end_col_offset=27), AnnAssign(target=Name(id='hits', ctx=Store(), lineno=69, col_offset=4, end_lineno=69, end_col_offset=8), annotation=Subscript(value=Name(id='set', ctx=Load(), lineno=69, col_offset=10, end_lineno=69, end_col_offset=13), slice=Name(id='str', ctx=Load(), lineno=69, col_offset=14, end_lineno=69, end_col_offset=17), ctx=Load(), lineno=69, col_offset=10, end_lineno=69, end_col_offset=18), value=Call(func=Name(id='set', ctx=Load(), lineno=69, col_offset=21, end_lineno=69, end_col_offset=24), lineno=69, col_offset=21, end_lineno=69, end_col_offset=26), simple=1, lineno=69, col_offset=4, end_lineno=69, end_col_offset=26), For(target=Tuple(elts=[Name(id='concept_id', ctx=Store(), lineno=70, col_offset=8, end_lineno=70, end_col_offset=18), Name(id='meta', ctx=Store(), lineno=70, col_offset=20, end_lineno=70, end_col_offset=24)], ctx=Store(), lineno=70, col_offset=8, end_lineno=70, end_col_offset=24), iter=Call(func=Attribute(value=Name(id='CONCEPTS', ctx=Load(), lineno=70, col_offset=28, end_lineno=70, end_col_offset=36), attr='items', ctx=Load(), lineno=70, col_offset=28, end_lineno=70, end_col_offset=42), lineno=70, col_offset=28, end_lineno=70, end_col_offset=44), body=[If(test=Call(func=Name(id='any', ctx=Load(), lineno=71, col_offset=11, end_lineno=71, end_col_offset=14), args=[GeneratorExp(elt=Compare(left=Name(id='keyword', ctx=Load(), lineno=71, col_offset=15, end_lineno=71, end_col_offset=22), ops=[In()], comparators=[Name(id='lowered', ctx=Load(), lineno=71, col_offset=26, end_lineno=71, end_col_offset=33)], lineno=71, col_offset=15, end_lineno=71, end_col_offset=33), generators=[comprehension(target=Name(id='keyword', ctx=Store(), lineno=71, col_offset=38, end_lineno=71, end_col_offset=45), iter=Subscript(value=Name(id='meta', ctx=Load(), lineno=71, col_offset=49, end_lineno=71, end_col_offset=53), slice=Constant(value='keywords', lineno=71, col_offset=54, end_lineno=71, end_col_offset=64), ctx=Load(), lineno=71, col_offset=49, end_lineno=71, end_col_offset=65), is_async=0)], lineno=71, col_offset=14, end_lineno=71, end_col_offset=66)], lineno=71, col_offset=11, end_lineno=71, end_col_offset=66), body=[Expr(value=Call(func=Attribute(value=Name(id='hits', ctx=Load(), lineno=72, col_offset=12, end_lineno=72, end_col_offset=16), attr='add', ctx=Load(), lineno=72, col_offset=12, end_lineno=72, end_col_offset=20), args=[Name(id='concept_id', ctx=Load(), lineno=72, col_offset=21, end_lineno=72, end_col_offset=31)], lineno=72, col_offset=12, end_lineno=72, end_col_offset=32), lineno=72, col_offset=12, end_lineno=72, end_col_offset=32)], lineno=71, col_offset=8, end_lineno=72, end_col_offset=32)], lineno=70, col_offset=4, end_lineno=72, end_col_offset=32), Return(value=Name(id='hits', ctx=Load(), lineno=73, col_offset=11, end_lineno=73, end_col_offset=15), lineno=73, col_offset=4, end_lineno=73, end_col_offset=15)], returns=Subscript(value=Name(id='set', ctx=Load(), lineno=52, col_offset=41, end_lineno=52, end_col_offset=44), slice=Name(id='str', ctx=Load(), lineno=52, col_offset=45, end_lineno=52, end_col_offset=48), ctx=Load(), lineno=52, col_offset=41, end_lineno=52, end_col_offset=49), lineno=52, col_offset=0, end_lineno=73, end_col_offset=15), FunctionDef(name='linked_concepts_for_text', args=arguments(args=[arg(arg='text', annotation=Name(id='str', ctx=Load(), lineno=77, col_offset=35, end_lineno=77, end_col_offset=38), lineno=77, col_offset=29, end_lineno=77, end_col_offset=38)]), body=[Expr(value=Constant(value='Find knowledge graph concepts linked to text content.\n\n    Searches for concept keywords in the text and returns matching\n    concept IDs from the mock knowledge graph.\n\n    Parameters\n    ----------\n    text : str\n        Text content to analyze for concept mentions.\n\n    Returns\n    -------\n    list[str]\n        List of concept IDs that match keywords in the text.\n    ', lineno=78, col_offset=4, end_lineno=92, end_col_offset=7), lineno=78, col_offset=4, end_lineno=92, end_col_offset=7), Assign(targets=[Name(id='lowered', ctx=Store(), lineno=93, col_offset=4, end_lineno=93, end_col_offset=11)], value=Call(func=Attribute(value=Name(id='text', ctx=Load(), lineno=93, col_offset=14, end_lineno=93, end_col_offset=18), attr='lower', ctx=Load(), lineno=93, col_offset=14, end_lineno=93, end_col_offset=24), lineno=93, col_offset=14, end_lineno=93, end_col_offset=26), lineno=93, col_offset=4, end_lineno=93, end_col_offset=26), Assign(targets=[Name(id='hits', ctx=Store(), lineno=94, col_offset=4, end_lineno=94, end_col_offset=8)], value=List(ctx=Load(), lineno=94, col_offset=11, end_lineno=94, end_col_offset=13), lineno=94, col_offset=4, end_lineno=94, end_col_offset=13), For(target=Tuple(elts=[Name(id='concept_id', ctx=Store(), lineno=95, col_offset=8, end_lineno=95, end_col_offset=18), Name(id='meta', ctx=Store(), lineno=95, col_offset=20, end_lineno=95, end_col_offset=24)], ctx=Store(), lineno=95, col_offset=8, end_lineno=95, end_col_offset=24), iter=Call(func=Attribute(value=Name(id='CONCEPTS', ctx=Load(), lineno=95, col_offset=28, end_lineno=95, end_col_offset=36), attr='items', ctx=Load(), lineno=95, col_offset=28, end_lineno=95, end_col_offset=42), lineno=95, col_offset=28, end_lineno=95, end_col_offset=44), body=[If(test=Call(func=Name(id='any', ctx=Load(), lineno=96, col_offset=11, end_lineno=96, end_col_offset=14), args=[GeneratorExp(elt=Compare(left=Name(id='keyword', ctx=Load(), lineno=96, col_offset=15, end_lineno=96, end_col_offset=22), ops=[In()], comparators=[Name(id='lowered', ctx=Load(), lineno=96, col_offset=26, end_lineno=96, end_col_offset=33)], lineno=96, col_offset=15, end_lineno=96, end_col_offset=33), generators=[comprehension(target=Name(id='keyword', ctx=Store(), lineno=96, col_offset=38, end_lineno=96, end_col_offset=45), iter=Subscript(value=Name(id='meta', ctx=Load(), lineno=96, col_offset=49, end_lineno=96, end_col_offset=53), slice=Constant(value='keywords', lineno=96, col_offset=54, end_lineno=96, end_col_offset=64), ctx=Load(), lineno=96, col_offset=49, end_lineno=96, end_col_offset=65), is_async=0)], lineno=96, col_offset=14, end_lineno=96, end_col_offset=66)], lineno=96, col_offset=11, end_lineno=96, end_col_offset=66), body=[Expr(value=Call(func=Attribute(value=Name(id='hits', ctx=Load(), lineno=97, col_offset=12, end_lineno=97, end_col_offset=16), attr='append', ctx=Load(), lineno=97, col_offset=12, end_lineno=97, end_col_offset=23), args=[Name(id='concept_id', ctx=Load(), lineno=97, col_offset=24, end_lineno=97, end_col_offset=34)], lineno=97, col_offset=12, end_lineno=97, end_col_offset=35), lineno=97, col_offset=12, end_lineno=97, end_col_offset=35)], lineno=96, col_offset=8, end_lineno=97, end_col_offset=35)], lineno=95, col_offset=4, end_lineno=97, end_col_offset=35), Return(value=Name(id='hits', ctx=Load(), lineno=98, col_offset=11, end_lineno=98, end_col_offset=15), lineno=98, col_offset=4, end_lineno=98, end_col_offset=15)], returns=Subscript(value=Name(id='list', ctx=Load(), lineno=77, col_offset=43, end_lineno=77, end_col_offset=47), slice=Name(id='str', ctx=Load(), lineno=77, col_offset=48, end_lineno=77, end_col_offset=51), ctx=Load(), lineno=77, col_offset=43, end_lineno=77, end_col_offset=52), lineno=77, col_offset=0, end_lineno=98, end_col_offset=15), FunctionDef(name='kg_boost', args=arguments(args=[arg(arg='query_concepts', annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=103, col_offset=20, end_lineno=103, end_col_offset=24), slice=Name(id='str', ctx=Load(), lineno=103, col_offset=25, end_lineno=103, end_col_offset=28), ctx=Load(), lineno=103, col_offset=20, end_lineno=103, end_col_offset=29), lineno=103, col_offset=4, end_lineno=103, end_col_offset=29), arg(arg='chunk_concepts', annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=104, col_offset=20, end_lineno=104, end_col_offset=24), slice=Name(id='str', ctx=Load(), lineno=104, col_offset=25, end_lineno=104, end_col_offset=28), ctx=Load(), lineno=104, col_offset=20, end_lineno=104, end_col_offset=29), lineno=104, col_offset=4, end_lineno=104, end_col_offset=29), arg(arg='direct', annotation=Name(id='float', ctx=Load(), lineno=105, col_offset=12, end_lineno=105, end_col_offset=17), lineno=105, col_offset=4, end_lineno=105, end_col_offset=17), arg(arg='one_hop', annotation=Name(id='float', ctx=Load(), lineno=106, col_offset=13, end_lineno=106, end_col_offset=18), lineno=106, col_offset=4, end_lineno=106, end_col_offset=18)], defaults=[Constant(value=0.08, lineno=105, col_offset=20, end_lineno=105, end_col_offset=24), Constant(value=0.04, lineno=106, col_offset=21, end_lineno=106, end_col_offset=25)]), body=[Expr(value=Constant(value='Calculate knowledge graph boost score for a chunk.\n\n    Computes a boost score based on concept overlap between query and chunk.\n    Returns direct boost if there are direct concept matches, otherwise 0.0.\n    The one_hop parameter is reserved for future graph traversal heuristics.\n\n    Parameters\n    ----------\n    query_concepts : list[str]\n        List of concept IDs extracted from the query.\n    chunk_concepts : list[str]\n        List of concept IDs linked to the chunk.\n    direct : float, optional\n        Boost amount for direct concept matches. Defaults to 0.08.\n    one_hop : float, optional\n        Boost amount for one-hop concept matches (currently unused).\n        Defaults to 0.04.\n\n    Returns\n    -------\n    float\n        Boost score (direct if concepts overlap, otherwise 0.0).\n    ', lineno=108, col_offset=4, end_lineno=130, end_col_offset=7), lineno=108, col_offset=4, end_lineno=130, end_col_offset=7), Assign(targets=[Name(id='_', ctx=Store(), lineno=131, col_offset=4, end_lineno=131, end_col_offset=5)], value=Name(id='one_hop', ctx=Load(), lineno=131, col_offset=8, end_lineno=131, end_col_offset=15), lineno=131, col_offset=4, end_lineno=131, end_col_offset=15), Return(value=IfExp(test=BinOp(left=Call(func=Name(id='set', ctx=Load(), lineno=132, col_offset=21, end_lineno=132, end_col_offset=24), args=[Name(id='query_concepts', ctx=Load(), lineno=132, col_offset=25, end_lineno=132, end_col_offset=39)], lineno=132, col_offset=21, end_lineno=132, end_col_offset=40), op=BitAnd(), right=Call(func=Name(id='set', ctx=Load(), lineno=132, col_offset=43, end_lineno=132, end_col_offset=46), args=[Name(id='chunk_concepts', ctx=Load(), lineno=132, col_offset=47, end_lineno=132, end_col_offset=61)], lineno=132, col_offset=43, end_lineno=132, end_col_offset=62), lineno=132, col_offset=21, end_lineno=132, end_col_offset=62), body=Name(id='direct', ctx=Load(), lineno=132, col_offset=11, end_lineno=132, end_col_offset=17), orelse=Constant(value=0.0, lineno=132, col_offset=68, end_lineno=132, end_col_offset=71), lineno=132, col_offset=11, end_lineno=132, end_col_offset=71), lineno=132, col_offset=4, end_lineno=132, end_col_offset=71)], returns=Name(id='float', ctx=Load(), lineno=107, col_offset=5, end_lineno=107, end_col_offset=10), lineno=102, col_offset=0, end_lineno=132, end_col_offset=71)])