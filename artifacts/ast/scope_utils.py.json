Module(body=[Expr(value=Constant(value='Scope filtering and merging utilities for CodeIntel MCP.\n\nThis module provides helper functions for retrieving session scopes, merging them\nwith explicit adapter parameters, and applying path/language filters to search results.\n\nKey Functions\n-------------\nget_effective_scope : Retrieve session scope from registry\nmerge_scope_filters : Merge session scope with explicit parameters (explicit wins)\napply_path_filters : Filter paths using glob patterns (fnmatch)\napply_language_filter : Filter paths by programming language extension\npath_matches_glob : Test if path matches glob pattern\n\nDesign Principles\n-----------------\n- **Explicit Precedence**: Explicit adapter parameters always override session scope\n- **Fail-Safe**: Missing scope or empty filters return unfiltered results\n- **Cross-Platform**: Normalize path separators for Windows/Unix compatibility\n- **Performance**: Early-exit for empty filters to avoid unnecessary iterations\n\nExample Usage\n-------------\nRetrieve and merge scope in adapter:\n\n>>> from codeintel_rev.mcp_server.scope_utils import get_effective_scope, merge_scope_filters\n>>> session_id = get_session_id()\n>>> scope = get_effective_scope(context, session_id)\n>>> merged = merge_scope_filters(scope, {"include_globs": ["src/**"]})\n>>> # merged["include_globs"] is now ["src/**"] (explicit overrides scope)\n\nFilter paths by glob patterns:\n\n>>> from codeintel_rev.mcp_server.scope_utils import apply_path_filters\n>>> paths = ["src/main.py", "tests/test_main.py", "docs/README.md"]\n>>> filtered = apply_path_filters(paths, include_globs=["**/*.py"], exclude_globs=["**/test_*.py"])\n>>> filtered\n[\'src/main.py\']\n\nFilter paths by language:\n\n>>> from codeintel_rev.mcp_server.scope_utils import apply_language_filter\n>>> paths = ["src/main.py", "src/app.ts", "README.md"]\n>>> filtered = apply_language_filter(paths, ["python"])\n>>> filtered\n[\'src/main.py\']\n\nSee Also\n--------\ncodeintel_rev.app.scope_registry : ScopeRegistry for storing session scopes\ncodeintel_rev.app.middleware : get_session_id for retrieving session ID\n', lineno=1, col_offset=0, end_lineno=51, end_col_offset=3), lineno=1, col_offset=0, end_lineno=51, end_col_offset=3), ImportFrom(module='__future__', names=[alias(name='annotations', lineno=53, col_offset=23, end_lineno=53, end_col_offset=34)], level=0, lineno=53, col_offset=0, end_lineno=53, end_col_offset=34), Import(names=[alias(name='fnmatch', lineno=55, col_offset=7, end_lineno=55, end_col_offset=14)], lineno=55, col_offset=0, end_lineno=55, end_col_offset=14), ImportFrom(module='typing', names=[alias(name='TYPE_CHECKING', lineno=56, col_offset=19, end_lineno=56, end_col_offset=32)], level=0, lineno=56, col_offset=0, end_lineno=56, end_col_offset=32), ImportFrom(module='kgfoundry_common.logging', names=[alias(name='get_logger', lineno=58, col_offset=37, end_lineno=58, end_col_offset=47)], level=0, lineno=58, col_offset=0, end_lineno=58, end_col_offset=47), If(test=Name(id='TYPE_CHECKING', ctx=Load(), lineno=60, col_offset=3, end_lineno=60, end_col_offset=16), body=[ImportFrom(module='codeintel_rev.app.config_context', names=[alias(name='ApplicationContext', lineno=61, col_offset=49, end_lineno=61, end_col_offset=67)], level=0, lineno=61, col_offset=4, end_lineno=61, end_col_offset=67), ImportFrom(module='codeintel_rev.mcp_server.schemas', names=[alias(name='ScopeIn', lineno=62, col_offset=49, end_lineno=62, end_col_offset=56)], level=0, lineno=62, col_offset=4, end_lineno=62, end_col_offset=56)], lineno=60, col_offset=0, end_lineno=62, end_col_offset=56), Assign(targets=[Name(id='LOGGER', ctx=Store(), lineno=64, col_offset=0, end_lineno=64, end_col_offset=6)], value=Call(func=Name(id='get_logger', ctx=Load(), lineno=64, col_offset=9, end_lineno=64, end_col_offset=19), args=[Name(id='__name__', ctx=Load(), lineno=64, col_offset=20, end_lineno=64, end_col_offset=28)], lineno=64, col_offset=9, end_lineno=64, end_col_offset=29), lineno=64, col_offset=0, end_lineno=64, end_col_offset=29), AnnAssign(target=Name(id='LANGUAGE_EXTENSIONS', ctx=Store(), lineno=68, col_offset=0, end_lineno=68, end_col_offset=19), annotation=Subscript(value=Name(id='dict', ctx=Load(), lineno=68, col_offset=21, end_lineno=68, end_col_offset=25), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=68, col_offset=26, end_lineno=68, end_col_offset=29), Subscript(value=Name(id='list', ctx=Load(), lineno=68, col_offset=31, end_lineno=68, end_col_offset=35), slice=Name(id='str', ctx=Load(), lineno=68, col_offset=36, end_lineno=68, end_col_offset=39), ctx=Load(), lineno=68, col_offset=31, end_lineno=68, end_col_offset=40)], ctx=Load(), lineno=68, col_offset=26, end_lineno=68, end_col_offset=40), ctx=Load(), lineno=68, col_offset=21, end_lineno=68, end_col_offset=41), value=Dict(keys=[Constant(value='python', lineno=69, col_offset=4, end_lineno=69, end_col_offset=12), Constant(value='typescript', lineno=70, col_offset=4, end_lineno=70, end_col_offset=16), Constant(value='javascript', lineno=71, col_offset=4, end_lineno=71, end_col_offset=16), Constant(value='rust', lineno=72, col_offset=4, end_lineno=72, end_col_offset=10), Constant(value='go', lineno=73, col_offset=4, end_lineno=73, end_col_offset=8), Constant(value='java', lineno=74, col_offset=4, end_lineno=74, end_col_offset=10), Constant(value='kotlin', lineno=75, col_offset=4, end_lineno=75, end_col_offset=12), Constant(value='scala', lineno=76, col_offset=4, end_lineno=76, end_col_offset=11), Constant(value='cpp', lineno=77, col_offset=4, end_lineno=77, end_col_offset=9), Constant(value='c', lineno=78, col_offset=4, end_lineno=78, end_col_offset=7), Constant(value='csharp', lineno=79, col_offset=4, end_lineno=79, end_col_offset=12), Constant(value='ruby', lineno=80, col_offset=4, end_lineno=80, end_col_offset=10), Constant(value='php', lineno=81, col_offset=4, end_lineno=81, end_col_offset=9), Constant(value='swift', lineno=82, col_offset=4, end_lineno=82, end_col_offset=11), Constant(value='objectivec', lineno=83, col_offset=4, end_lineno=83, end_col_offset=16), Constant(value='bash', lineno=84, col_offset=4, end_lineno=84, end_col_offset=10), Constant(value='powershell', lineno=85, col_offset=4, end_lineno=85, end_col_offset=16), Constant(value='yaml', lineno=86, col_offset=4, end_lineno=86, end_col_offset=10), Constant(value='json', lineno=87, col_offset=4, end_lineno=87, end_col_offset=10), Constant(value='toml', lineno=88, col_offset=4, end_lineno=88, end_col_offset=10), Constant(value='xml', lineno=89, col_offset=4, end_lineno=89, end_col_offset=9), Constant(value='html', lineno=90, col_offset=4, end_lineno=90, end_col_offset=10), Constant(value='css', lineno=91, col_offset=4, end_lineno=91, end_col_offset=9), Constant(value='markdown', lineno=92, col_offset=4, end_lineno=92, end_col_offset=14), Constant(value='sql', lineno=93, col_offset=4, end_lineno=93, end_col_offset=9), Constant(value='r', lineno=94, col_offset=4, end_lineno=94, end_col_offset=7), Constant(value='perl', lineno=95, col_offset=4, end_lineno=95, end_col_offset=10), Constant(value='lua', lineno=96, col_offset=4, end_lineno=96, end_col_offset=9), Constant(value='haskell', lineno=97, col_offset=4, end_lineno=97, end_col_offset=13), Constant(value='elixir', lineno=98, col_offset=4, end_lineno=98, end_col_offset=12), Constant(value='erlang', lineno=99, col_offset=4, end_lineno=99, end_col_offset=12), Constant(value='clojure', lineno=100, col_offset=4, end_lineno=100, end_col_offset=13), Constant(value='dart', lineno=101, col_offset=4, end_lineno=101, end_col_offset=10), Constant(value='vue', lineno=102, col_offset=4, end_lineno=102, end_col_offset=9), Constant(value='svelte', lineno=103, col_offset=4, end_lineno=103, end_col_offset=12)], values=[List(elts=[Constant(value='.py', lineno=69, col_offset=15, end_lineno=69, end_col_offset=20), Constant(value='.pyi', lineno=69, col_offset=22, end_lineno=69, end_col_offset=28), Constant(value='.pyw', lineno=69, col_offset=30, end_lineno=69, end_col_offset=36)], ctx=Load(), lineno=69, col_offset=14, end_lineno=69, end_col_offset=37), List(elts=[Constant(value='.ts', lineno=70, col_offset=19, end_lineno=70, end_col_offset=24), Constant(value='.tsx', lineno=70, col_offset=26, end_lineno=70, end_col_offset=32), Constant(value='.mts', lineno=70, col_offset=34, end_lineno=70, end_col_offset=40), Constant(value='.cts', lineno=70, col_offset=42, end_lineno=70, end_col_offset=48)], ctx=Load(), lineno=70, col_offset=18, end_lineno=70, end_col_offset=49), List(elts=[Constant(value='.js', lineno=71, col_offset=19, end_lineno=71, end_col_offset=24), Constant(value='.jsx', lineno=71, col_offset=26, end_lineno=71, end_col_offset=32), Constant(value='.mjs', lineno=71, col_offset=34, end_lineno=71, end_col_offset=40), Constant(value='.cjs', lineno=71, col_offset=42, end_lineno=71, end_col_offset=48)], ctx=Load(), lineno=71, col_offset=18, end_lineno=71, end_col_offset=49), List(elts=[Constant(value='.rs', lineno=72, col_offset=13, end_lineno=72, end_col_offset=18)], ctx=Load(), lineno=72, col_offset=12, end_lineno=72, end_col_offset=19), List(elts=[Constant(value='.go', lineno=73, col_offset=11, end_lineno=73, end_col_offset=16)], ctx=Load(), lineno=73, col_offset=10, end_lineno=73, end_col_offset=17), List(elts=[Constant(value='.java', lineno=74, col_offset=13, end_lineno=74, end_col_offset=20)], ctx=Load(), lineno=74, col_offset=12, end_lineno=74, end_col_offset=21), List(elts=[Constant(value='.kt', lineno=75, col_offset=15, end_lineno=75, end_col_offset=20), Constant(value='.kts', lineno=75, col_offset=22, end_lineno=75, end_col_offset=28)], ctx=Load(), lineno=75, col_offset=14, end_lineno=75, end_col_offset=29), List(elts=[Constant(value='.scala', lineno=76, col_offset=14, end_lineno=76, end_col_offset=22), Constant(value='.sc', lineno=76, col_offset=24, end_lineno=76, end_col_offset=29)], ctx=Load(), lineno=76, col_offset=13, end_lineno=76, end_col_offset=30), List(elts=[Constant(value='.cpp', lineno=77, col_offset=12, end_lineno=77, end_col_offset=18), Constant(value='.cc', lineno=77, col_offset=20, end_lineno=77, end_col_offset=25), Constant(value='.cxx', lineno=77, col_offset=27, end_lineno=77, end_col_offset=33), Constant(value='.hpp', lineno=77, col_offset=35, end_lineno=77, end_col_offset=41), Constant(value='.hxx', lineno=77, col_offset=43, end_lineno=77, end_col_offset=49), Constant(value='.h', lineno=77, col_offset=51, end_lineno=77, end_col_offset=55)], ctx=Load(), lineno=77, col_offset=11, end_lineno=77, end_col_offset=56), List(elts=[Constant(value='.c', lineno=78, col_offset=10, end_lineno=78, end_col_offset=14), Constant(value='.h', lineno=78, col_offset=16, end_lineno=78, end_col_offset=20)], ctx=Load(), lineno=78, col_offset=9, end_lineno=78, end_col_offset=21), List(elts=[Constant(value='.cs', lineno=79, col_offset=15, end_lineno=79, end_col_offset=20), Constant(value='.csx', lineno=79, col_offset=22, end_lineno=79, end_col_offset=28)], ctx=Load(), lineno=79, col_offset=14, end_lineno=79, end_col_offset=29), List(elts=[Constant(value='.rb', lineno=80, col_offset=13, end_lineno=80, end_col_offset=18), Constant(value='.rake', lineno=80, col_offset=20, end_lineno=80, end_col_offset=27)], ctx=Load(), lineno=80, col_offset=12, end_lineno=80, end_col_offset=28), List(elts=[Constant(value='.php', lineno=81, col_offset=12, end_lineno=81, end_col_offset=18), Constant(value='.phtml', lineno=81, col_offset=20, end_lineno=81, end_col_offset=28)], ctx=Load(), lineno=81, col_offset=11, end_lineno=81, end_col_offset=29), List(elts=[Constant(value='.swift', lineno=82, col_offset=14, end_lineno=82, end_col_offset=22)], ctx=Load(), lineno=82, col_offset=13, end_lineno=82, end_col_offset=23), List(elts=[Constant(value='.m', lineno=83, col_offset=19, end_lineno=83, end_col_offset=23), Constant(value='.mm', lineno=83, col_offset=25, end_lineno=83, end_col_offset=30), Constant(value='.h', lineno=83, col_offset=32, end_lineno=83, end_col_offset=36)], ctx=Load(), lineno=83, col_offset=18, end_lineno=83, end_col_offset=37), List(elts=[Constant(value='.sh', lineno=84, col_offset=13, end_lineno=84, end_col_offset=18), Constant(value='.bash', lineno=84, col_offset=20, end_lineno=84, end_col_offset=27), Constant(value='.zsh', lineno=84, col_offset=29, end_lineno=84, end_col_offset=35)], ctx=Load(), lineno=84, col_offset=12, end_lineno=84, end_col_offset=36), List(elts=[Constant(value='.ps1', lineno=85, col_offset=19, end_lineno=85, end_col_offset=25), Constant(value='.psm1', lineno=85, col_offset=27, end_lineno=85, end_col_offset=34)], ctx=Load(), lineno=85, col_offset=18, end_lineno=85, end_col_offset=35), List(elts=[Constant(value='.yaml', lineno=86, col_offset=13, end_lineno=86, end_col_offset=20), Constant(value='.yml', lineno=86, col_offset=22, end_lineno=86, end_col_offset=28)], ctx=Load(), lineno=86, col_offset=12, end_lineno=86, end_col_offset=29), List(elts=[Constant(value='.json', lineno=87, col_offset=13, end_lineno=87, end_col_offset=20), Constant(value='.jsonc', lineno=87, col_offset=22, end_lineno=87, end_col_offset=30)], ctx=Load(), lineno=87, col_offset=12, end_lineno=87, end_col_offset=31), List(elts=[Constant(value='.toml', lineno=88, col_offset=13, end_lineno=88, end_col_offset=20)], ctx=Load(), lineno=88, col_offset=12, end_lineno=88, end_col_offset=21), List(elts=[Constant(value='.xml', lineno=89, col_offset=12, end_lineno=89, end_col_offset=18), Constant(value='.xsd', lineno=89, col_offset=20, end_lineno=89, end_col_offset=26), Constant(value='.xsl', lineno=89, col_offset=28, end_lineno=89, end_col_offset=34)], ctx=Load(), lineno=89, col_offset=11, end_lineno=89, end_col_offset=35), List(elts=[Constant(value='.html', lineno=90, col_offset=13, end_lineno=90, end_col_offset=20), Constant(value='.htm', lineno=90, col_offset=22, end_lineno=90, end_col_offset=28)], ctx=Load(), lineno=90, col_offset=12, end_lineno=90, end_col_offset=29), List(elts=[Constant(value='.css', lineno=91, col_offset=12, end_lineno=91, end_col_offset=18), Constant(value='.scss', lineno=91, col_offset=20, end_lineno=91, end_col_offset=27), Constant(value='.sass', lineno=91, col_offset=29, end_lineno=91, end_col_offset=36), Constant(value='.less', lineno=91, col_offset=38, end_lineno=91, end_col_offset=45)], ctx=Load(), lineno=91, col_offset=11, end_lineno=91, end_col_offset=46), List(elts=[Constant(value='.md', lineno=92, col_offset=17, end_lineno=92, end_col_offset=22), Constant(value='.markdown', lineno=92, col_offset=24, end_lineno=92, end_col_offset=35), Constant(value='.mdown', lineno=92, col_offset=37, end_lineno=92, end_col_offset=45)], ctx=Load(), lineno=92, col_offset=16, end_lineno=92, end_col_offset=46), List(elts=[Constant(value='.sql', lineno=93, col_offset=12, end_lineno=93, end_col_offset=18), Constant(value='.ddl', lineno=93, col_offset=20, end_lineno=93, end_col_offset=26), Constant(value='.dml', lineno=93, col_offset=28, end_lineno=93, end_col_offset=34)], ctx=Load(), lineno=93, col_offset=11, end_lineno=93, end_col_offset=35), List(elts=[Constant(value='.r', lineno=94, col_offset=10, end_lineno=94, end_col_offset=14), Constant(value='.R', lineno=94, col_offset=16, end_lineno=94, end_col_offset=20)], ctx=Load(), lineno=94, col_offset=9, end_lineno=94, end_col_offset=21), List(elts=[Constant(value='.pl', lineno=95, col_offset=13, end_lineno=95, end_col_offset=18), Constant(value='.pm', lineno=95, col_offset=20, end_lineno=95, end_col_offset=25)], ctx=Load(), lineno=95, col_offset=12, end_lineno=95, end_col_offset=26), List(elts=[Constant(value='.lua', lineno=96, col_offset=12, end_lineno=96, end_col_offset=18)], ctx=Load(), lineno=96, col_offset=11, end_lineno=96, end_col_offset=19), List(elts=[Constant(value='.hs', lineno=97, col_offset=16, end_lineno=97, end_col_offset=21), Constant(value='.lhs', lineno=97, col_offset=23, end_lineno=97, end_col_offset=29)], ctx=Load(), lineno=97, col_offset=15, end_lineno=97, end_col_offset=30), List(elts=[Constant(value='.ex', lineno=98, col_offset=15, end_lineno=98, end_col_offset=20), Constant(value='.exs', lineno=98, col_offset=22, end_lineno=98, end_col_offset=28)], ctx=Load(), lineno=98, col_offset=14, end_lineno=98, end_col_offset=29), List(elts=[Constant(value='.erl', lineno=99, col_offset=15, end_lineno=99, end_col_offset=21), Constant(value='.hrl', lineno=99, col_offset=23, end_lineno=99, end_col_offset=29)], ctx=Load(), lineno=99, col_offset=14, end_lineno=99, end_col_offset=30), List(elts=[Constant(value='.clj', lineno=100, col_offset=16, end_lineno=100, end_col_offset=22), Constant(value='.cljs', lineno=100, col_offset=24, end_lineno=100, end_col_offset=31), Constant(value='.cljc', lineno=100, col_offset=33, end_lineno=100, end_col_offset=40)], ctx=Load(), lineno=100, col_offset=15, end_lineno=100, end_col_offset=41), List(elts=[Constant(value='.dart', lineno=101, col_offset=13, end_lineno=101, end_col_offset=20)], ctx=Load(), lineno=101, col_offset=12, end_lineno=101, end_col_offset=21), List(elts=[Constant(value='.vue', lineno=102, col_offset=12, end_lineno=102, end_col_offset=18)], ctx=Load(), lineno=102, col_offset=11, end_lineno=102, end_col_offset=19), List(elts=[Constant(value='.svelte', lineno=103, col_offset=15, end_lineno=103, end_col_offset=24)], ctx=Load(), lineno=103, col_offset=14, end_lineno=103, end_col_offset=25)], lineno=68, col_offset=44, end_lineno=104, end_col_offset=1), simple=1, lineno=68, col_offset=0, end_lineno=104, end_col_offset=1), FunctionDef(name='get_effective_scope', args=arguments(args=[arg(arg='context', annotation=Name(id='ApplicationContext', ctx=Load(), lineno=107, col_offset=33, end_lineno=107, end_col_offset=51), lineno=107, col_offset=24, end_lineno=107, end_col_offset=51), arg(arg='session_id', annotation=BinOp(left=Name(id='str', ctx=Load(), lineno=107, col_offset=65, end_lineno=107, end_col_offset=68), op=BitOr(), right=Constant(value=None, lineno=107, col_offset=71, end_lineno=107, end_col_offset=75), lineno=107, col_offset=65, end_lineno=107, end_col_offset=75), lineno=107, col_offset=53, end_lineno=107, end_col_offset=75)]), body=[Expr(value=Constant(value='Retrieve session scope from registry.\n\n    Helper function that wraps ScopeRegistry.get_scope with null-safety for\n    missing session IDs. Returns None if session_id is None or scope not found,\n    allowing adapters to gracefully fall back to "no scope" behavior.\n\n    Parameters\n    ----------\n    context : ApplicationContext\n        Application context containing scope registry.\n    session_id : str | None\n        Session identifier to look up. If None, returns None immediately\n        without registry access.\n\n    Returns\n    -------\n    ScopeIn | None\n        Scope dictionary if session exists and has scope, None otherwise.\n\n    Examples\n    --------\n    >>> context = ApplicationContext.create()\n    >>> session_id = "test-session-123"\n    >>> context.scope_registry.set_scope(session_id, {"languages": ["python"]})\n    >>> scope = get_effective_scope(context, session_id)\n    >>> scope\n    {\'languages\': [\'python\']}\n    >>> get_effective_scope(context, None)  # No session ID\n    >>> get_effective_scope(context, "nonexistent")  # No scope set\n\n    Notes\n    -----\n    This function is preferred over direct registry access because it handles\n    the None case explicitly, making adapter code cleaner.\n    ', lineno=108, col_offset=4, end_lineno=142, end_col_offset=7), lineno=108, col_offset=4, end_lineno=142, end_col_offset=7), If(test=Compare(left=Name(id='session_id', ctx=Load(), lineno=143, col_offset=7, end_lineno=143, end_col_offset=17), ops=[Is()], comparators=[Constant(value=None, lineno=143, col_offset=21, end_lineno=143, end_col_offset=25)], lineno=143, col_offset=7, end_lineno=143, end_col_offset=25), body=[Return(value=Constant(value=None, lineno=144, col_offset=15, end_lineno=144, end_col_offset=19), lineno=144, col_offset=8, end_lineno=144, end_col_offset=19)], lineno=143, col_offset=4, end_lineno=144, end_col_offset=19), Return(value=Call(func=Attribute(value=Attribute(value=Name(id='context', ctx=Load(), lineno=145, col_offset=11, end_lineno=145, end_col_offset=18), attr='scope_registry', ctx=Load(), lineno=145, col_offset=11, end_lineno=145, end_col_offset=33), attr='get_scope', ctx=Load(), lineno=145, col_offset=11, end_lineno=145, end_col_offset=43), args=[Name(id='session_id', ctx=Load(), lineno=145, col_offset=44, end_lineno=145, end_col_offset=54)], lineno=145, col_offset=11, end_lineno=145, end_col_offset=55), lineno=145, col_offset=4, end_lineno=145, end_col_offset=55)], returns=BinOp(left=Name(id='ScopeIn', ctx=Load(), lineno=107, col_offset=80, end_lineno=107, end_col_offset=87), op=BitOr(), right=Constant(value=None, lineno=107, col_offset=90, end_lineno=107, end_col_offset=94), lineno=107, col_offset=80, end_lineno=107, end_col_offset=94), lineno=107, col_offset=0, end_lineno=145, end_col_offset=55), FunctionDef(name='merge_scope_filters', args=arguments(args=[arg(arg='scope', annotation=BinOp(left=Name(id='ScopeIn', ctx=Load(), lineno=148, col_offset=31, end_lineno=148, end_col_offset=38), op=BitOr(), right=Constant(value=None, lineno=148, col_offset=41, end_lineno=148, end_col_offset=45), lineno=148, col_offset=31, end_lineno=148, end_col_offset=45), lineno=148, col_offset=24, end_lineno=148, end_col_offset=45), arg(arg='explicit_params', annotation=Name(id='dict', ctx=Load(), lineno=148, col_offset=64, end_lineno=148, end_col_offset=68), lineno=148, col_offset=47, end_lineno=148, end_col_offset=68)]), body=[Expr(value=Constant(value='Merge session scope with explicit adapter parameters.\n\n    Combines scope fields with explicit function parameters, giving precedence\n    to explicit parameters. This allows users to override session scope for\n    individual queries without clearing the scope.\n\n    Merge Rules:\n    - If explicit param is present (not None), use it (override scope).\n    - If explicit param is absent (None), use scope value (default).\n    - If both absent, field is omitted from result.\n\n    Parameters\n    ----------\n    scope : ScopeIn | None\n        Session scope from registry (may be None if no scope set).\n    explicit_params : dict\n        Parameters passed directly to adapter (e.g., {"include_globs": [...]}).\n        Keys match ScopeIn fields. Values of None are treated as "not provided".\n\n    Returns\n    -------\n    dict\n        Merged dictionary with explicit params overriding scope defaults.\n\n    Examples\n    --------\n    Explicit parameter overrides scope:\n\n    >>> scope = {"include_globs": ["**/*.py"], "languages": ["python"]}\n    >>> explicit = {"include_globs": ["src/**"]}\n    >>> merged = merge_scope_filters(scope, explicit)\n    >>> merged\n    {\'include_globs\': [\'src/**\'], \'languages\': [\'python\']}\n\n    Scope provides defaults for unspecified params:\n\n    >>> scope = {"include_globs": ["**/*.py"], "exclude_globs": ["**/test_*"]}\n    >>> explicit = {"include_globs": None, "exclude_globs": None}\n    >>> merged = merge_scope_filters(scope, explicit)\n    >>> merged\n    {\'include_globs\': [\'**/*.py\'], \'exclude_globs\': [\'**/test_*\']}\n\n    No scope (all from explicit params):\n\n    >>> merged = merge_scope_filters(None, {"include_globs": ["**/*.ts"]})\n    >>> merged\n    {\'include_globs\': [\'**/*.ts\']}\n\n    Empty scope and empty params:\n\n    >>> merged = merge_scope_filters(None, {})\n    >>> merged\n    {}\n\n    Notes\n    -----\n    The function does not modify input dictsâ€”it returns a new dict. This\n    ensures thread safety (no shared mutable state).\n    ', lineno=149, col_offset=4, end_lineno=207, end_col_offset=7), lineno=149, col_offset=4, end_lineno=207, end_col_offset=7), AnnAssign(target=Name(id='result', ctx=Store(), lineno=208, col_offset=4, end_lineno=208, end_col_offset=10), annotation=Name(id='dict', ctx=Load(), lineno=208, col_offset=12, end_lineno=208, end_col_offset=16), value=Dict(lineno=208, col_offset=19, end_lineno=208, end_col_offset=21), simple=1, lineno=208, col_offset=4, end_lineno=208, end_col_offset=21), If(test=Name(id='scope', ctx=Load(), lineno=211, col_offset=7, end_lineno=211, end_col_offset=12), body=[Expr(value=Call(func=Attribute(value=Name(id='result', ctx=Load(), lineno=212, col_offset=8, end_lineno=212, end_col_offset=14), attr='update', ctx=Load(), lineno=212, col_offset=8, end_lineno=212, end_col_offset=21), args=[Name(id='scope', ctx=Load(), lineno=212, col_offset=22, end_lineno=212, end_col_offset=27)], lineno=212, col_offset=8, end_lineno=212, end_col_offset=28), lineno=212, col_offset=8, end_lineno=212, end_col_offset=28)], lineno=211, col_offset=4, end_lineno=212, end_col_offset=28), Expr(value=Call(func=Attribute(value=Name(id='result', ctx=Load(), lineno=215, col_offset=4, end_lineno=215, end_col_offset=10), attr='update', ctx=Load(), lineno=215, col_offset=4, end_lineno=215, end_col_offset=17), args=[DictComp(key=Name(id='key', ctx=Load(), lineno=215, col_offset=19, end_lineno=215, end_col_offset=22), value=Name(id='value', ctx=Load(), lineno=215, col_offset=24, end_lineno=215, end_col_offset=29), generators=[comprehension(target=Tuple(elts=[Name(id='key', ctx=Store(), lineno=215, col_offset=34, end_lineno=215, end_col_offset=37), Name(id='value', ctx=Store(), lineno=215, col_offset=39, end_lineno=215, end_col_offset=44)], ctx=Store(), lineno=215, col_offset=34, end_lineno=215, end_col_offset=44), iter=Call(func=Attribute(value=Name(id='explicit_params', ctx=Load(), lineno=215, col_offset=48, end_lineno=215, end_col_offset=63), attr='items', ctx=Load(), lineno=215, col_offset=48, end_lineno=215, end_col_offset=69), lineno=215, col_offset=48, end_lineno=215, end_col_offset=71), ifs=[Compare(left=Name(id='value', ctx=Load(), lineno=215, col_offset=75, end_lineno=215, end_col_offset=80), ops=[IsNot()], comparators=[Constant(value=None, lineno=215, col_offset=88, end_lineno=215, end_col_offset=92)], lineno=215, col_offset=75, end_lineno=215, end_col_offset=92)], is_async=0)], lineno=215, col_offset=18, end_lineno=215, end_col_offset=93)], lineno=215, col_offset=4, end_lineno=215, end_col_offset=94), lineno=215, col_offset=4, end_lineno=215, end_col_offset=94), Return(value=Name(id='result', ctx=Load(), lineno=217, col_offset=11, end_lineno=217, end_col_offset=17), lineno=217, col_offset=4, end_lineno=217, end_col_offset=17)], returns=Name(id='dict', ctx=Load(), lineno=148, col_offset=73, end_lineno=148, end_col_offset=77), lineno=148, col_offset=0, end_lineno=217, end_col_offset=17), FunctionDef(name='apply_path_filters', args=arguments(args=[arg(arg='paths', annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=221, col_offset=11, end_lineno=221, end_col_offset=15), slice=Name(id='str', ctx=Load(), lineno=221, col_offset=16, end_lineno=221, end_col_offset=19), ctx=Load(), lineno=221, col_offset=11, end_lineno=221, end_col_offset=20), lineno=221, col_offset=4, end_lineno=221, end_col_offset=20), arg(arg='include_globs', annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=221, col_offset=37, end_lineno=221, end_col_offset=41), slice=Name(id='str', ctx=Load(), lineno=221, col_offset=42, end_lineno=221, end_col_offset=45), ctx=Load(), lineno=221, col_offset=37, end_lineno=221, end_col_offset=46), lineno=221, col_offset=22, end_lineno=221, end_col_offset=46), arg(arg='exclude_globs', annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=221, col_offset=63, end_lineno=221, end_col_offset=67), slice=Name(id='str', ctx=Load(), lineno=221, col_offset=68, end_lineno=221, end_col_offset=71), ctx=Load(), lineno=221, col_offset=63, end_lineno=221, end_col_offset=72), lineno=221, col_offset=48, end_lineno=221, end_col_offset=72)]), body=[Expr(value=Constant(value='Filter paths using glob patterns.\n\n    Applies include and exclude glob patterns to a list of file paths. Paths\n    must match at least one include pattern AND no exclude patterns to be kept.\n\n    Matching is done using fnmatch (Unix shell-style globs):\n    - `*` matches anything (including `/` in our implementation)\n    - `?` matches any single character\n    - `[seq]` matches any character in seq\n    - `[!seq]` matches any character not in seq\n\n    Parameters\n    ----------\n    paths : list[str]\n        File paths to filter (typically relative to repo root).\n    include_globs : list[str]\n        Glob patterns to include. Paths must match at least one pattern.\n        Empty list means "include all" (no filtering).\n    exclude_globs : list[str]\n        Glob patterns to exclude. Paths matching any pattern are removed.\n        Empty list means "exclude none".\n\n    Returns\n    -------\n    list[str]\n        Filtered paths list (order preserved from input).\n\n    Examples\n    --------\n    Include only Python files:\n\n    >>> paths = ["src/main.py", "src/app.ts", "README.md"]\n    >>> filtered = apply_path_filters(paths, include_globs=["**/*.py"], exclude_globs=[])\n    >>> filtered\n    [\'src/main.py\']\n\n    Exclude test files:\n\n    >>> paths = ["src/main.py", "tests/test_main.py", "src/utils.py"]\n    >>> filtered = apply_path_filters(paths, include_globs=["**/*.py"], exclude_globs=["**/test_*"])\n    >>> filtered\n    [\'src/main.py\', \'src/utils.py\']\n\n    Empty include globs (include all):\n\n    >>> filtered = apply_path_filters(paths, include_globs=[], exclude_globs=["**/test_*"])\n    >>> # All paths except test files\n\n    Notes\n    -----\n    Path separators are normalized to forward slashes (/) before matching to\n    ensure Windows paths (backslash) match Unix-style glob patterns.\n\n    Performance: O(n * m) where n = len(paths), m = max(len(include), len(exclude)).\n    For large path lists, consider pre-filtering during directory traversal\n    instead of post-filtering.\n    ', lineno=223, col_offset=4, end_lineno=279, end_col_offset=7), lineno=223, col_offset=4, end_lineno=279, end_col_offset=7), If(test=BoolOp(op=And(), values=[UnaryOp(op=Not(), operand=Name(id='include_globs', ctx=Load(), lineno=280, col_offset=11, end_lineno=280, end_col_offset=24), lineno=280, col_offset=7, end_lineno=280, end_col_offset=24), UnaryOp(op=Not(), operand=Name(id='exclude_globs', ctx=Load(), lineno=280, col_offset=33, end_lineno=280, end_col_offset=46), lineno=280, col_offset=29, end_lineno=280, end_col_offset=46)], lineno=280, col_offset=7, end_lineno=280, end_col_offset=46), body=[Return(value=Name(id='paths', ctx=Load(), lineno=281, col_offset=15, end_lineno=281, end_col_offset=20), lineno=281, col_offset=8, end_lineno=281, end_col_offset=20)], lineno=280, col_offset=4, end_lineno=281, end_col_offset=20), AnnAssign(target=Name(id='filtered', ctx=Store(), lineno=283, col_offset=4, end_lineno=283, end_col_offset=12), annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=283, col_offset=14, end_lineno=283, end_col_offset=18), slice=Name(id='str', ctx=Load(), lineno=283, col_offset=19, end_lineno=283, end_col_offset=22), ctx=Load(), lineno=283, col_offset=14, end_lineno=283, end_col_offset=23), value=List(ctx=Load(), lineno=283, col_offset=26, end_lineno=283, end_col_offset=28), simple=1, lineno=283, col_offset=4, end_lineno=283, end_col_offset=28), For(target=Name(id='path', ctx=Store(), lineno=285, col_offset=8, end_lineno=285, end_col_offset=12), iter=Name(id='paths', ctx=Load(), lineno=285, col_offset=16, end_lineno=285, end_col_offset=21), body=[Assign(targets=[Name(id='normalized_path', ctx=Store(), lineno=287, col_offset=8, end_lineno=287, end_col_offset=23)], value=Call(func=Attribute(value=Name(id='path', ctx=Load(), lineno=287, col_offset=26, end_lineno=287, end_col_offset=30), attr='replace', ctx=Load(), lineno=287, col_offset=26, end_lineno=287, end_col_offset=38), args=[Constant(value='\\', lineno=287, col_offset=39, end_lineno=287, end_col_offset=43), Constant(value='/', lineno=287, col_offset=45, end_lineno=287, end_col_offset=48)], lineno=287, col_offset=26, end_lineno=287, end_col_offset=49), lineno=287, col_offset=8, end_lineno=287, end_col_offset=49), If(test=BoolOp(op=And(), values=[Name(id='include_globs', ctx=Load(), lineno=290, col_offset=11, end_lineno=290, end_col_offset=24), UnaryOp(op=Not(), operand=Call(func=Name(id='any', ctx=Load(), lineno=290, col_offset=33, end_lineno=290, end_col_offset=36), args=[GeneratorExp(elt=Call(func=Name(id='path_matches_glob', ctx=Load(), lineno=291, col_offset=12, end_lineno=291, end_col_offset=29), args=[Name(id='normalized_path', ctx=Load(), lineno=291, col_offset=30, end_lineno=291, end_col_offset=45), Name(id='pattern', ctx=Load(), lineno=291, col_offset=47, end_lineno=291, end_col_offset=54)], lineno=291, col_offset=12, end_lineno=291, end_col_offset=55), generators=[comprehension(target=Name(id='pattern', ctx=Store(), lineno=291, col_offset=60, end_lineno=291, end_col_offset=67), iter=Name(id='include_globs', ctx=Load(), lineno=291, col_offset=71, end_lineno=291, end_col_offset=84), is_async=0)], lineno=290, col_offset=36, end_lineno=292, end_col_offset=9)], lineno=290, col_offset=33, end_lineno=292, end_col_offset=9), lineno=290, col_offset=29, end_lineno=292, end_col_offset=9)], lineno=290, col_offset=11, end_lineno=292, end_col_offset=9), body=[Continue(lineno=293, col_offset=12, end_lineno=293, end_col_offset=20)], lineno=290, col_offset=8, end_lineno=293, end_col_offset=20), If(test=BoolOp(op=And(), values=[Name(id='exclude_globs', ctx=Load(), lineno=296, col_offset=11, end_lineno=296, end_col_offset=24), Call(func=Name(id='any', ctx=Load(), lineno=296, col_offset=29, end_lineno=296, end_col_offset=32), args=[GeneratorExp(elt=Call(func=Name(id='path_matches_glob', ctx=Load(), lineno=297, col_offset=12, end_lineno=297, end_col_offset=29), args=[Name(id='normalized_path', ctx=Load(), lineno=297, col_offset=30, end_lineno=297, end_col_offset=45), Name(id='pattern', ctx=Load(), lineno=297, col_offset=47, end_lineno=297, end_col_offset=54)], lineno=297, col_offset=12, end_lineno=297, end_col_offset=55), generators=[comprehension(target=Name(id='pattern', ctx=Store(), lineno=297, col_offset=60, end_lineno=297, end_col_offset=67), iter=Name(id='exclude_globs', ctx=Load(), lineno=297, col_offset=71, end_lineno=297, end_col_offset=84), is_async=0)], lineno=296, col_offset=32, end_lineno=298, end_col_offset=9)], lineno=296, col_offset=29, end_lineno=298, end_col_offset=9)], lineno=296, col_offset=11, end_lineno=298, end_col_offset=9), body=[Continue(lineno=299, col_offset=12, end_lineno=299, end_col_offset=20)], lineno=296, col_offset=8, end_lineno=299, end_col_offset=20), Expr(value=Call(func=Attribute(value=Name(id='filtered', ctx=Load(), lineno=302, col_offset=8, end_lineno=302, end_col_offset=16), attr='append', ctx=Load(), lineno=302, col_offset=8, end_lineno=302, end_col_offset=23), args=[Name(id='path', ctx=Load(), lineno=302, col_offset=24, end_lineno=302, end_col_offset=28)], lineno=302, col_offset=8, end_lineno=302, end_col_offset=29), lineno=302, col_offset=8, end_lineno=302, end_col_offset=29)], lineno=285, col_offset=4, end_lineno=302, end_col_offset=29), Return(value=Name(id='filtered', ctx=Load(), lineno=304, col_offset=11, end_lineno=304, end_col_offset=19), lineno=304, col_offset=4, end_lineno=304, end_col_offset=19)], returns=Subscript(value=Name(id='list', ctx=Load(), lineno=222, col_offset=5, end_lineno=222, end_col_offset=9), slice=Name(id='str', ctx=Load(), lineno=222, col_offset=10, end_lineno=222, end_col_offset=13), ctx=Load(), lineno=222, col_offset=5, end_lineno=222, end_col_offset=14), lineno=220, col_offset=0, end_lineno=304, end_col_offset=19), FunctionDef(name='apply_language_filter', args=arguments(args=[arg(arg='paths', annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=307, col_offset=33, end_lineno=307, end_col_offset=37), slice=Name(id='str', ctx=Load(), lineno=307, col_offset=38, end_lineno=307, end_col_offset=41), ctx=Load(), lineno=307, col_offset=33, end_lineno=307, end_col_offset=42), lineno=307, col_offset=26, end_lineno=307, end_col_offset=42), arg(arg='languages', annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=307, col_offset=55, end_lineno=307, end_col_offset=59), slice=Name(id='str', ctx=Load(), lineno=307, col_offset=60, end_lineno=307, end_col_offset=63), ctx=Load(), lineno=307, col_offset=55, end_lineno=307, end_col_offset=64), lineno=307, col_offset=44, end_lineno=307, end_col_offset=64)]), body=[Expr(value=Constant(value='Filter paths by programming language.\n\n    Returns only paths whose file extensions match the specified languages.\n    Uses LANGUAGE_EXTENSIONS mapping to resolve language names to extensions.\n\n    Parameters\n    ----------\n    paths : list[str]\n        File paths to filter.\n    languages : list[str]\n        Programming language names (e.g., ["python", "typescript"]).\n        Case-insensitive (normalized to lowercase).\n\n    Returns\n    -------\n    list[str]\n        Paths with extensions matching specified languages (order preserved).\n\n    Examples\n    --------\n    Filter to Python files only:\n\n    >>> paths = ["src/main.py", "src/app.ts", "README.md"]\n    >>> filtered = apply_language_filter(paths, ["python"])\n    >>> filtered\n    [\'src/main.py\']\n\n    Multiple languages:\n\n    >>> filtered = apply_language_filter(paths, ["python", "typescript"])\n    >>> filtered\n    [\'src/main.py\', \'src/app.ts\']\n\n    Unknown language (no matches):\n\n    >>> filtered = apply_language_filter(paths, ["cobol"])\n    >>> filtered\n    []\n\n    Notes\n    -----\n    Language names are case-insensitive: "Python", "python", "PYTHON" all work.\n\n    If a language is not in LANGUAGE_EXTENSIONS, it\'s silently ignored (no\n    error raised). This allows forward compatibility if new languages are added\n    to the mapping later.\n\n    Extension matching is case-sensitive: ".PY" will NOT match Python (use\n    lowercase extensions in path normalization if needed).\n    ', lineno=308, col_offset=4, end_lineno=357, end_col_offset=7), lineno=308, col_offset=4, end_lineno=357, end_col_offset=7), If(test=UnaryOp(op=Not(), operand=Name(id='languages', ctx=Load(), lineno=358, col_offset=11, end_lineno=358, end_col_offset=20), lineno=358, col_offset=7, end_lineno=358, end_col_offset=20), body=[Return(value=Name(id='paths', ctx=Load(), lineno=359, col_offset=15, end_lineno=359, end_col_offset=20), lineno=359, col_offset=8, end_lineno=359, end_col_offset=20)], lineno=358, col_offset=4, end_lineno=359, end_col_offset=20), Assign(targets=[Name(id='normalized_languages', ctx=Store(), lineno=362, col_offset=4, end_lineno=362, end_col_offset=24)], value=ListComp(elt=Call(func=Attribute(value=Name(id='lang', ctx=Load(), lineno=362, col_offset=28, end_lineno=362, end_col_offset=32), attr='lower', ctx=Load(), lineno=362, col_offset=28, end_lineno=362, end_col_offset=38), lineno=362, col_offset=28, end_lineno=362, end_col_offset=40), generators=[comprehension(target=Name(id='lang', ctx=Store(), lineno=362, col_offset=45, end_lineno=362, end_col_offset=49), iter=Name(id='languages', ctx=Load(), lineno=362, col_offset=53, end_lineno=362, end_col_offset=62), is_async=0)], lineno=362, col_offset=27, end_lineno=362, end_col_offset=63), lineno=362, col_offset=4, end_lineno=362, end_col_offset=63), AnnAssign(target=Name(id='extensions', ctx=Store(), lineno=365, col_offset=4, end_lineno=365, end_col_offset=14), annotation=Subscript(value=Name(id='set', ctx=Load(), lineno=365, col_offset=16, end_lineno=365, end_col_offset=19), slice=Name(id='str', ctx=Load(), lineno=365, col_offset=20, end_lineno=365, end_col_offset=23), ctx=Load(), lineno=365, col_offset=16, end_lineno=365, end_col_offset=24), value=Call(func=Name(id='set', ctx=Load(), lineno=365, col_offset=27, end_lineno=365, end_col_offset=30), lineno=365, col_offset=27, end_lineno=365, end_col_offset=32), simple=1, lineno=365, col_offset=4, end_lineno=365, end_col_offset=32), For(target=Name(id='lang', ctx=Store(), lineno=366, col_offset=8, end_lineno=366, end_col_offset=12), iter=Name(id='normalized_languages', ctx=Load(), lineno=366, col_offset=16, end_lineno=366, end_col_offset=36), body=[Assign(targets=[Name(id='lang_extensions', ctx=Store(), lineno=367, col_offset=8, end_lineno=367, end_col_offset=23)], value=Call(func=Attribute(value=Name(id='LANGUAGE_EXTENSIONS', ctx=Load(), lineno=367, col_offset=26, end_lineno=367, end_col_offset=45), attr='get', ctx=Load(), lineno=367, col_offset=26, end_lineno=367, end_col_offset=49), args=[Name(id='lang', ctx=Load(), lineno=367, col_offset=50, end_lineno=367, end_col_offset=54), List(ctx=Load(), lineno=367, col_offset=56, end_lineno=367, end_col_offset=58)], lineno=367, col_offset=26, end_lineno=367, end_col_offset=59), lineno=367, col_offset=8, end_lineno=367, end_col_offset=59), Expr(value=Call(func=Attribute(value=Name(id='extensions', ctx=Load(), lineno=368, col_offset=8, end_lineno=368, end_col_offset=18), attr='update', ctx=Load(), lineno=368, col_offset=8, end_lineno=368, end_col_offset=25), args=[Name(id='lang_extensions', ctx=Load(), lineno=368, col_offset=26, end_lineno=368, end_col_offset=41)], lineno=368, col_offset=8, end_lineno=368, end_col_offset=42), lineno=368, col_offset=8, end_lineno=368, end_col_offset=42)], lineno=366, col_offset=4, end_lineno=368, end_col_offset=42), If(test=UnaryOp(op=Not(), operand=Name(id='extensions', ctx=Load(), lineno=370, col_offset=11, end_lineno=370, end_col_offset=21), lineno=370, col_offset=7, end_lineno=370, end_col_offset=21), body=[Expr(value=Call(func=Attribute(value=Name(id='LOGGER', ctx=Load(), lineno=372, col_offset=8, end_lineno=372, end_col_offset=14), attr='warning', ctx=Load(), lineno=372, col_offset=8, end_lineno=372, end_col_offset=22), args=[Constant(value='No file extensions found for requested languages', lineno=373, col_offset=12, end_lineno=373, end_col_offset=62)], keywords=[keyword(arg='extra', value=Dict(keys=[Constant(value='languages', lineno=374, col_offset=19, end_lineno=374, end_col_offset=30)], values=[Name(id='languages', ctx=Load(), lineno=374, col_offset=32, end_lineno=374, end_col_offset=41)], lineno=374, col_offset=18, end_lineno=374, end_col_offset=42), lineno=374, col_offset=12, end_lineno=374, end_col_offset=42)], lineno=372, col_offset=8, end_lineno=375, end_col_offset=9), lineno=372, col_offset=8, end_lineno=375, end_col_offset=9), Return(value=List(ctx=Load(), lineno=376, col_offset=15, end_lineno=376, end_col_offset=17), lineno=376, col_offset=8, end_lineno=376, end_col_offset=17)], lineno=370, col_offset=4, end_lineno=376, end_col_offset=17), AnnAssign(target=Name(id='filtered', ctx=Store(), lineno=379, col_offset=4, end_lineno=379, end_col_offset=12), annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=379, col_offset=14, end_lineno=379, end_col_offset=18), slice=Name(id='str', ctx=Load(), lineno=379, col_offset=19, end_lineno=379, end_col_offset=22), ctx=Load(), lineno=379, col_offset=14, end_lineno=379, end_col_offset=23), value=List(ctx=Load(), lineno=379, col_offset=26, end_lineno=379, end_col_offset=28), simple=1, lineno=379, col_offset=4, end_lineno=379, end_col_offset=28), For(target=Name(id='path', ctx=Store(), lineno=380, col_offset=8, end_lineno=380, end_col_offset=12), iter=Name(id='paths', ctx=Load(), lineno=380, col_offset=16, end_lineno=380, end_col_offset=21), body=[Assign(targets=[Name(id='path_lower', ctx=Store(), lineno=382, col_offset=8, end_lineno=382, end_col_offset=18)], value=Call(func=Attribute(value=Name(id='path', ctx=Load(), lineno=382, col_offset=21, end_lineno=382, end_col_offset=25), attr='lower', ctx=Load(), lineno=382, col_offset=21, end_lineno=382, end_col_offset=31), lineno=382, col_offset=21, end_lineno=382, end_col_offset=33), lineno=382, col_offset=8, end_lineno=382, end_col_offset=33), For(target=Name(id='ext', ctx=Store(), lineno=383, col_offset=12, end_lineno=383, end_col_offset=15), iter=Name(id='extensions', ctx=Load(), lineno=383, col_offset=19, end_lineno=383, end_col_offset=29), body=[If(test=Call(func=Attribute(value=Name(id='path_lower', ctx=Load(), lineno=384, col_offset=15, end_lineno=384, end_col_offset=25), attr='endswith', ctx=Load(), lineno=384, col_offset=15, end_lineno=384, end_col_offset=34), args=[Call(func=Attribute(value=Name(id='ext', ctx=Load(), lineno=384, col_offset=35, end_lineno=384, end_col_offset=38), attr='lower', ctx=Load(), lineno=384, col_offset=35, end_lineno=384, end_col_offset=44), lineno=384, col_offset=35, end_lineno=384, end_col_offset=46)], lineno=384, col_offset=15, end_lineno=384, end_col_offset=47), body=[Expr(value=Call(func=Attribute(value=Name(id='filtered', ctx=Load(), lineno=385, col_offset=16, end_lineno=385, end_col_offset=24), attr='append', ctx=Load(), lineno=385, col_offset=16, end_lineno=385, end_col_offset=31), args=[Name(id='path', ctx=Load(), lineno=385, col_offset=32, end_lineno=385, end_col_offset=36)], lineno=385, col_offset=16, end_lineno=385, end_col_offset=37), lineno=385, col_offset=16, end_lineno=385, end_col_offset=37), Break(lineno=386, col_offset=16, end_lineno=386, end_col_offset=21)], lineno=384, col_offset=12, end_lineno=386, end_col_offset=21)], lineno=383, col_offset=8, end_lineno=386, end_col_offset=21)], lineno=380, col_offset=4, end_lineno=386, end_col_offset=21), Return(value=Name(id='filtered', ctx=Load(), lineno=388, col_offset=11, end_lineno=388, end_col_offset=19), lineno=388, col_offset=4, end_lineno=388, end_col_offset=19)], returns=Subscript(value=Name(id='list', ctx=Load(), lineno=307, col_offset=69, end_lineno=307, end_col_offset=73), slice=Name(id='str', ctx=Load(), lineno=307, col_offset=74, end_lineno=307, end_col_offset=77), ctx=Load(), lineno=307, col_offset=69, end_lineno=307, end_col_offset=78), lineno=307, col_offset=0, end_lineno=388, end_col_offset=19), FunctionDef(name='path_matches_glob', args=arguments(args=[arg(arg='path', annotation=Name(id='str', ctx=Load(), lineno=391, col_offset=28, end_lineno=391, end_col_offset=31), lineno=391, col_offset=22, end_lineno=391, end_col_offset=31), arg(arg='pattern', annotation=Name(id='str', ctx=Load(), lineno=391, col_offset=42, end_lineno=391, end_col_offset=45), lineno=391, col_offset=33, end_lineno=391, end_col_offset=45)]), body=[Expr(value=Constant(value='Test if path matches glob pattern.\n\n    Wrapper around fnmatch.fnmatch with path normalization for cross-platform\n    compatibility. Handles both simple patterns (*.py) and recursive patterns\n    (**/*.py).\n\n    Parameters\n    ----------\n    path : str\n        File path to test (typically relative to repo root).\n    pattern : str\n        Glob pattern (Unix shell-style).\n\n    Returns\n    -------\n    bool\n        True if path matches pattern, False otherwise.\n\n    Examples\n    --------\n    Simple suffix match:\n\n    >>> path_matches_glob("test.py", "*.py")\n    True\n    >>> path_matches_glob("test.ts", "*.py")\n    False\n\n    Recursive pattern:\n\n    >>> path_matches_glob("src/utils/helpers.py", "**/*.py")\n    True\n    >>> path_matches_glob("README.md", "**/*.py")\n    False\n\n    Directory prefix:\n\n    >>> path_matches_glob("src/main.py", "src/**")\n    True\n    >>> path_matches_glob("lib/util.py", "src/**")\n    False\n\n    Notes\n    -----\n    fnmatch treats `*` as matching any characters INCLUDING slashes, unlike\n    some glob implementations (e.g., bash) where `*` doesn\'t match `/`. This\n    makes `**/*.py` and `*/*.py` functionally equivalent in our implementation.\n\n    For more complex patterns (e.g., brace expansion {a,b}), consider using\n    the `wcmatch` library which supports advanced glob features.\n    ', lineno=392, col_offset=4, end_lineno=441, end_col_offset=7), lineno=392, col_offset=4, end_lineno=441, end_col_offset=7), Assign(targets=[Name(id='normalized_path', ctx=Store(), lineno=443, col_offset=4, end_lineno=443, end_col_offset=19)], value=Call(func=Attribute(value=Name(id='path', ctx=Load(), lineno=443, col_offset=22, end_lineno=443, end_col_offset=26), attr='replace', ctx=Load(), lineno=443, col_offset=22, end_lineno=443, end_col_offset=34), args=[Constant(value='\\', lineno=443, col_offset=35, end_lineno=443, end_col_offset=39), Constant(value='/', lineno=443, col_offset=41, end_lineno=443, end_col_offset=44)], lineno=443, col_offset=22, end_lineno=443, end_col_offset=45), lineno=443, col_offset=4, end_lineno=443, end_col_offset=45), Assign(targets=[Name(id='normalized_pattern', ctx=Store(), lineno=444, col_offset=4, end_lineno=444, end_col_offset=22)], value=Call(func=Attribute(value=Name(id='pattern', ctx=Load(), lineno=444, col_offset=25, end_lineno=444, end_col_offset=32), attr='replace', ctx=Load(), lineno=444, col_offset=25, end_lineno=444, end_col_offset=40), args=[Constant(value='\\', lineno=444, col_offset=41, end_lineno=444, end_col_offset=45), Constant(value='/', lineno=444, col_offset=47, end_lineno=444, end_col_offset=50)], lineno=444, col_offset=25, end_lineno=444, end_col_offset=51), lineno=444, col_offset=4, end_lineno=444, end_col_offset=51), Return(value=Call(func=Attribute(value=Name(id='fnmatch', ctx=Load(), lineno=448, col_offset=11, end_lineno=448, end_col_offset=18), attr='fnmatch', ctx=Load(), lineno=448, col_offset=11, end_lineno=448, end_col_offset=26), args=[Name(id='normalized_path', ctx=Load(), lineno=448, col_offset=27, end_lineno=448, end_col_offset=42), Name(id='normalized_pattern', ctx=Load(), lineno=448, col_offset=44, end_lineno=448, end_col_offset=62)], lineno=448, col_offset=11, end_lineno=448, end_col_offset=63), lineno=448, col_offset=4, end_lineno=448, end_col_offset=63)], returns=Name(id='bool', ctx=Load(), lineno=391, col_offset=50, end_lineno=391, end_col_offset=54), lineno=391, col_offset=0, end_lineno=448, end_col_offset=63), Assign(targets=[Name(id='__all__', ctx=Store(), lineno=451, col_offset=0, end_lineno=451, end_col_offset=7)], value=List(elts=[Constant(value='LANGUAGE_EXTENSIONS', lineno=452, col_offset=4, end_lineno=452, end_col_offset=25), Constant(value='apply_language_filter', lineno=453, col_offset=4, end_lineno=453, end_col_offset=27), Constant(value='apply_path_filters', lineno=454, col_offset=4, end_lineno=454, end_col_offset=24), Constant(value='get_effective_scope', lineno=455, col_offset=4, end_lineno=455, end_col_offset=25), Constant(value='merge_scope_filters', lineno=456, col_offset=4, end_lineno=456, end_col_offset=25), Constant(value='path_matches_glob', lineno=457, col_offset=4, end_lineno=457, end_col_offset=23)], ctx=Load(), lineno=451, col_offset=10, end_lineno=458, end_col_offset=1), lineno=451, col_offset=0, end_lineno=458, end_col_offset=1)])