Module(body=[Expr(value=Constant(value='Application readiness checks for Kubernetes health probes.\n\nThis module provides comprehensive readiness checks for all critical application\nresources including filesystem paths, FAISS indexes, DuckDB catalogs, and\nexternal services (vLLM). The ReadinessProbe class manages these checks and\nexposes results via the /readyz endpoint for Kubernetes integration.\n\nKey Components\n--------------\nCheckResult : dataclass\n    Immutable result of a single readiness check with healthy status and detail.\nReadinessProbe : class\n    Manages readiness checks across all dependencies with async refresh.\n\nDesign Principles\n-----------------\n- **Comprehensive**: Checks all critical resources (files, directories, services)\n- **Non-blocking**: HTTP checks use short timeouts to prevent blocking\n- **Graceful Degradation**: Optional resources (SCIP index) don\'t fail readiness\n- **Structured Results**: CheckResult provides JSON-serializable payloads\n\nExample Usage\n-------------\nDuring application startup:\n\n>>> # In lifespan() function\n>>> readiness = ReadinessProbe(context)\n>>> await readiness.initialize()\n>>> app.state.readiness = readiness\n\nIn readiness endpoint:\n\n>>> # In /readyz handler\n>>> results = await readiness.refresh()\n>>> return {"ready": all(r.healthy for r in results.values()), "checks": results}\n\nSee Also\n--------\ncodeintel_rev.app.config_context : ApplicationContext with configuration\ncodeintel_rev.app.main : FastAPI application with /readyz endpoint\n', lineno=1, col_offset=0, end_lineno=41, end_col_offset=3), lineno=1, col_offset=0, end_lineno=41, end_col_offset=3), ImportFrom(module='__future__', names=[alias(name='annotations', lineno=43, col_offset=23, end_lineno=43, end_col_offset=34)], level=0, lineno=43, col_offset=0, end_lineno=43, end_col_offset=34), Import(names=[alias(name='asyncio', lineno=45, col_offset=7, end_lineno=45, end_col_offset=14)], lineno=45, col_offset=0, end_lineno=45, end_col_offset=14), Import(names=[alias(name='shutil', lineno=46, col_offset=7, end_lineno=46, end_col_offset=13)], lineno=46, col_offset=0, end_lineno=46, end_col_offset=13), ImportFrom(module='collections.abc', names=[alias(name='Mapping', lineno=47, col_offset=28, end_lineno=47, end_col_offset=35)], level=0, lineno=47, col_offset=0, end_lineno=47, end_col_offset=35), ImportFrom(module='dataclasses', names=[alias(name='dataclass', lineno=48, col_offset=24, end_lineno=48, end_col_offset=33)], level=0, lineno=48, col_offset=0, end_lineno=48, end_col_offset=33), ImportFrom(module='pathlib', names=[alias(name='Path', lineno=49, col_offset=20, end_lineno=49, end_col_offset=24)], level=0, lineno=49, col_offset=0, end_lineno=49, end_col_offset=24), ImportFrom(module='typing', names=[alias(name='TYPE_CHECKING', lineno=50, col_offset=19, end_lineno=50, end_col_offset=32), alias(name='Any', lineno=50, col_offset=34, end_lineno=50, end_col_offset=37)], level=0, lineno=50, col_offset=0, end_lineno=50, end_col_offset=37), ImportFrom(module='urllib.parse', names=[alias(name='urlparse', lineno=51, col_offset=25, end_lineno=51, end_col_offset=33)], level=0, lineno=51, col_offset=0, end_lineno=51, end_col_offset=33), Import(names=[alias(name='duckdb', lineno=53, col_offset=7, end_lineno=53, end_col_offset=13)], lineno=53, col_offset=0, end_lineno=53, end_col_offset=13), Import(names=[alias(name='httpx', lineno=54, col_offset=7, end_lineno=54, end_col_offset=12)], lineno=54, col_offset=0, end_lineno=54, end_col_offset=12), ImportFrom(module='kgfoundry_common.logging', names=[alias(name='get_logger', lineno=56, col_offset=37, end_lineno=56, end_col_offset=47)], level=0, lineno=56, col_offset=0, end_lineno=56, end_col_offset=47), If(test=Name(id='TYPE_CHECKING', ctx=Load(), lineno=58, col_offset=3, end_lineno=58, end_col_offset=16), body=[ImportFrom(module='codeintel_rev.app.config_context', names=[alias(name='ApplicationContext', lineno=59, col_offset=49, end_lineno=59, end_col_offset=67)], level=0, lineno=59, col_offset=4, end_lineno=59, end_col_offset=67)], lineno=58, col_offset=0, end_lineno=59, end_col_offset=67), Assign(targets=[Name(id='LOGGER', ctx=Store(), lineno=61, col_offset=0, end_lineno=61, end_col_offset=6)], value=Call(func=Name(id='get_logger', ctx=Load(), lineno=61, col_offset=9, end_lineno=61, end_col_offset=19), args=[Name(id='__name__', ctx=Load(), lineno=61, col_offset=20, end_lineno=61, end_col_offset=28)], lineno=61, col_offset=9, end_lineno=61, end_col_offset=29), lineno=61, col_offset=0, end_lineno=61, end_col_offset=29), Assign(targets=[Name(id='HTTP_HEALTH_TIMEOUT_S', ctx=Store(), lineno=62, col_offset=0, end_lineno=62, end_col_offset=21)], value=Constant(value=2.0, lineno=62, col_offset=24, end_lineno=62, end_col_offset=27), lineno=62, col_offset=0, end_lineno=62, end_col_offset=27), Assign(targets=[Name(id='_EMBED_BATCH_RANK', ctx=Store(), lineno=63, col_offset=0, end_lineno=63, end_col_offset=17)], value=Constant(value=2, lineno=63, col_offset=20, end_lineno=63, end_col_offset=21), lineno=63, col_offset=0, end_lineno=63, end_col_offset=21), Assign(targets=[Name(id='_EMBED_BATCH_MIN_ROWS', ctx=Store(), lineno=64, col_offset=0, end_lineno=64, end_col_offset=21)], value=Constant(value=1, lineno=64, col_offset=24, end_lineno=64, end_col_offset=25), lineno=64, col_offset=0, end_lineno=64, end_col_offset=25), ClassDef(name='CheckResult', body=[Expr(value=Constant(value='Outcome of a single readiness check.\n\n    Attributes\n    ----------\n    healthy : bool\n        Whether the resource is ready for use.\n    detail : str | None\n        Diagnostic detail when unhealthy or degraded. None when healthy.\n\n    Examples\n    --------\n    >>> result = CheckResult(healthy=True)\n    >>> result.as_payload()\n    {\'healthy\': True}\n\n    >>> result = CheckResult(healthy=False, detail="FAISS index not found")\n    >>> result.as_payload()\n    {\'healthy\': False, \'detail\': \'FAISS index not found\'}\n    ', lineno=69, col_offset=4, end_lineno=87, end_col_offset=7), lineno=69, col_offset=4, end_lineno=87, end_col_offset=7), AnnAssign(target=Name(id='healthy', ctx=Store(), lineno=89, col_offset=4, end_lineno=89, end_col_offset=11), annotation=Name(id='bool', ctx=Load(), lineno=89, col_offset=13, end_lineno=89, end_col_offset=17), simple=1, lineno=89, col_offset=4, end_lineno=89, end_col_offset=17), AnnAssign(target=Name(id='detail', ctx=Store(), lineno=90, col_offset=4, end_lineno=90, end_col_offset=10), annotation=BinOp(left=Name(id='str', ctx=Load(), lineno=90, col_offset=12, end_lineno=90, end_col_offset=15), op=BitOr(), right=Constant(value=None, lineno=90, col_offset=18, end_lineno=90, end_col_offset=22), lineno=90, col_offset=12, end_lineno=90, end_col_offset=22), value=Constant(value=None, lineno=90, col_offset=25, end_lineno=90, end_col_offset=29), simple=1, lineno=90, col_offset=4, end_lineno=90, end_col_offset=29), FunctionDef(name='as_payload', args=arguments(args=[arg(arg='self', lineno=92, col_offset=19, end_lineno=92, end_col_offset=23)]), body=[Expr(value=Constant(value='Convert to JSON-serializable dictionary.\n\n        Returns\n        -------\n        dict[str, Any]\n            Dictionary with "healthy" boolean and optional "detail" string.\n        ', lineno=93, col_offset=8, end_lineno=99, end_col_offset=11), lineno=93, col_offset=8, end_lineno=99, end_col_offset=11), AnnAssign(target=Name(id='payload', ctx=Store(), lineno=100, col_offset=8, end_lineno=100, end_col_offset=15), annotation=Subscript(value=Name(id='dict', ctx=Load(), lineno=100, col_offset=17, end_lineno=100, end_col_offset=21), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=100, col_offset=22, end_lineno=100, end_col_offset=25), Name(id='Any', ctx=Load(), lineno=100, col_offset=27, end_lineno=100, end_col_offset=30)], ctx=Load(), lineno=100, col_offset=22, end_lineno=100, end_col_offset=30), ctx=Load(), lineno=100, col_offset=17, end_lineno=100, end_col_offset=31), value=Dict(keys=[Constant(value='healthy', lineno=100, col_offset=35, end_lineno=100, end_col_offset=44)], values=[Attribute(value=Name(id='self', ctx=Load(), lineno=100, col_offset=46, end_lineno=100, end_col_offset=50), attr='healthy', ctx=Load(), lineno=100, col_offset=46, end_lineno=100, end_col_offset=58)], lineno=100, col_offset=34, end_lineno=100, end_col_offset=59), simple=1, lineno=100, col_offset=8, end_lineno=100, end_col_offset=59), If(test=Compare(left=Attribute(value=Name(id='self', ctx=Load(), lineno=101, col_offset=11, end_lineno=101, end_col_offset=15), attr='detail', ctx=Load(), lineno=101, col_offset=11, end_lineno=101, end_col_offset=22), ops=[IsNot()], comparators=[Constant(value=None, lineno=101, col_offset=30, end_lineno=101, end_col_offset=34)], lineno=101, col_offset=11, end_lineno=101, end_col_offset=34), body=[Assign(targets=[Subscript(value=Name(id='payload', ctx=Load(), lineno=102, col_offset=12, end_lineno=102, end_col_offset=19), slice=Constant(value='detail', lineno=102, col_offset=20, end_lineno=102, end_col_offset=28), ctx=Store(), lineno=102, col_offset=12, end_lineno=102, end_col_offset=29)], value=Attribute(value=Name(id='self', ctx=Load(), lineno=102, col_offset=32, end_lineno=102, end_col_offset=36), attr='detail', ctx=Load(), lineno=102, col_offset=32, end_lineno=102, end_col_offset=43), lineno=102, col_offset=12, end_lineno=102, end_col_offset=43)], lineno=101, col_offset=8, end_lineno=102, end_col_offset=43), Return(value=Name(id='payload', ctx=Load(), lineno=103, col_offset=15, end_lineno=103, end_col_offset=22), lineno=103, col_offset=8, end_lineno=103, end_col_offset=22)], returns=Subscript(value=Name(id='dict', ctx=Load(), lineno=92, col_offset=28, end_lineno=92, end_col_offset=32), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=92, col_offset=33, end_lineno=92, end_col_offset=36), Name(id='Any', ctx=Load(), lineno=92, col_offset=38, end_lineno=92, end_col_offset=41)], ctx=Load(), lineno=92, col_offset=33, end_lineno=92, end_col_offset=41), ctx=Load(), lineno=92, col_offset=28, end_lineno=92, end_col_offset=42), lineno=92, col_offset=4, end_lineno=103, end_col_offset=22)], decorator_list=[Call(func=Name(id='dataclass', ctx=Load(), lineno=67, col_offset=1, end_lineno=67, end_col_offset=10), keywords=[keyword(arg='slots', value=Constant(value=True, lineno=67, col_offset=17, end_lineno=67, end_col_offset=21), lineno=67, col_offset=11, end_lineno=67, end_col_offset=21), keyword(arg='frozen', value=Constant(value=True, lineno=67, col_offset=30, end_lineno=67, end_col_offset=34), lineno=67, col_offset=23, end_lineno=67, end_col_offset=34)], lineno=67, col_offset=1, end_lineno=67, end_col_offset=35)], lineno=68, col_offset=0, end_lineno=103, end_col_offset=22), ClassDef(name='ReadinessProbe', body=[Expr(value=Constant(value='Manages readiness checks across core dependencies.\n\n    This class performs comprehensive health checks on all critical application\n    resources including filesystem paths, indexes, databases, and external\n    services. Checks are performed synchronously in a thread pool to avoid\n    blocking the event loop.\n\n    Parameters\n    ----------\n    context : ApplicationContext\n        Application context containing configuration and clients.\n\n    Examples\n    --------\n    Initialize during application startup:\n\n    >>> readiness = ReadinessProbe(context)\n    >>> await readiness.initialize()\n\n    Refresh checks on demand:\n\n    >>> results = await readiness.refresh()\n    >>> all_healthy = all(r.healthy for r in results.values())\n\n    Get cached snapshot:\n\n    >>> snapshot = readiness.snapshot()\n    >>> faiss_status = snapshot["faiss_index"]\n\n    Notes\n    -----\n    The probe maintains a cache of check results to avoid recomputing on every\n    request. The cache is updated atomically via async lock during refresh().\n\n    Internal attributes (not part of public API):\n    - ``_context``: Application context with configuration and paths\n    - ``_lock``: Lock protecting _last_checks cache during concurrent refresh calls\n    - ``_last_checks``: Cache of most recent check results keyed by resource name\n    ', lineno=107, col_offset=4, end_lineno=145, end_col_offset=7), lineno=107, col_offset=4, end_lineno=145, end_col_offset=7), FunctionDef(name='__init__', args=arguments(args=[arg(arg='self', lineno=147, col_offset=17, end_lineno=147, end_col_offset=21), arg(arg='context', annotation=Name(id='ApplicationContext', ctx=Load(), lineno=147, col_offset=32, end_lineno=147, end_col_offset=50), lineno=147, col_offset=23, end_lineno=147, end_col_offset=50)]), body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load(), lineno=148, col_offset=8, end_lineno=148, end_col_offset=12), attr='_context', ctx=Store(), lineno=148, col_offset=8, end_lineno=148, end_col_offset=21)], value=Name(id='context', ctx=Load(), lineno=148, col_offset=24, end_lineno=148, end_col_offset=31), lineno=148, col_offset=8, end_lineno=148, end_col_offset=31), Assign(targets=[Attribute(value=Name(id='self', ctx=Load(), lineno=149, col_offset=8, end_lineno=149, end_col_offset=12), attr='_lock', ctx=Store(), lineno=149, col_offset=8, end_lineno=149, end_col_offset=18)], value=Call(func=Attribute(value=Name(id='asyncio', ctx=Load(), lineno=149, col_offset=21, end_lineno=149, end_col_offset=28), attr='Lock', ctx=Load(), lineno=149, col_offset=21, end_lineno=149, end_col_offset=33), lineno=149, col_offset=21, end_lineno=149, end_col_offset=35), lineno=149, col_offset=8, end_lineno=149, end_col_offset=35), AnnAssign(target=Attribute(value=Name(id='self', ctx=Load(), lineno=150, col_offset=8, end_lineno=150, end_col_offset=12), attr='_last_checks', ctx=Store(), lineno=150, col_offset=8, end_lineno=150, end_col_offset=25), annotation=Subscript(value=Name(id='dict', ctx=Load(), lineno=150, col_offset=27, end_lineno=150, end_col_offset=31), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=150, col_offset=32, end_lineno=150, end_col_offset=35), Name(id='CheckResult', ctx=Load(), lineno=150, col_offset=37, end_lineno=150, end_col_offset=48)], ctx=Load(), lineno=150, col_offset=32, end_lineno=150, end_col_offset=48), ctx=Load(), lineno=150, col_offset=27, end_lineno=150, end_col_offset=49), value=Dict(lineno=150, col_offset=52, end_lineno=150, end_col_offset=54), simple=0, lineno=150, col_offset=8, end_lineno=150, end_col_offset=54)], returns=Constant(value=None, lineno=147, col_offset=55, end_lineno=147, end_col_offset=59), lineno=147, col_offset=4, end_lineno=150, end_col_offset=54), AsyncFunctionDef(name='initialize', args=arguments(args=[arg(arg='self', lineno=152, col_offset=25, end_lineno=152, end_col_offset=29)]), body=[Expr(value=Constant(value='Prime readiness state on application startup.\n\n        Performs initial readiness checks and caches results. This should be\n        called once during application startup before serving requests.\n\n        Examples\n        --------\n        >>> readiness = ReadinessProbe(context)\n        >>> await readiness.initialize()\n        ', lineno=153, col_offset=8, end_lineno=162, end_col_offset=11), lineno=153, col_offset=8, end_lineno=162, end_col_offset=11), Expr(value=Await(value=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=163, col_offset=14, end_lineno=163, end_col_offset=18), attr='refresh', ctx=Load(), lineno=163, col_offset=14, end_lineno=163, end_col_offset=26), lineno=163, col_offset=14, end_lineno=163, end_col_offset=28), lineno=163, col_offset=8, end_lineno=163, end_col_offset=28), lineno=163, col_offset=8, end_lineno=163, end_col_offset=28)], returns=Constant(value=None, lineno=152, col_offset=34, end_lineno=152, end_col_offset=38), lineno=152, col_offset=4, end_lineno=163, end_col_offset=28), AsyncFunctionDef(name='refresh', args=arguments(args=[arg(arg='self', lineno=165, col_offset=22, end_lineno=165, end_col_offset=26)]), body=[Expr(value=Constant(value='Recompute readiness checks asynchronously.\n\n        Runs all checks in a thread pool to avoid blocking the event loop.\n        Updates the internal cache atomically and returns the latest results.\n\n        Returns\n        -------\n        Mapping[str, CheckResult]\n            Latest readiness results keyed by resource name. Keys include:\n            - "repo_root": Repository root directory check\n            - "data_dir": Data directory check (created if missing)\n            - "vectors_dir": Vectors directory check (created if missing)\n            - "faiss_index": FAISS index file check\n            - "duckdb_catalog": DuckDB catalog file check\n            - "scip_index": SCIP index file check (optional)\n            - "vllm_service": vLLM service connectivity check\n\n        Examples\n        --------\n        >>> results = await readiness.refresh()\n        >>> faiss_healthy = results["faiss_index"].healthy\n        ', lineno=166, col_offset=8, end_lineno=187, end_col_offset=11), lineno=166, col_offset=8, end_lineno=187, end_col_offset=11), Assign(targets=[Name(id='checks', ctx=Store(), lineno=188, col_offset=8, end_lineno=188, end_col_offset=14)], value=Await(value=Call(func=Attribute(value=Name(id='asyncio', ctx=Load(), lineno=188, col_offset=23, end_lineno=188, end_col_offset=30), attr='to_thread', ctx=Load(), lineno=188, col_offset=23, end_lineno=188, end_col_offset=40), args=[Attribute(value=Name(id='self', ctx=Load(), lineno=188, col_offset=41, end_lineno=188, end_col_offset=45), attr='_run_checks', ctx=Load(), lineno=188, col_offset=41, end_lineno=188, end_col_offset=57)], lineno=188, col_offset=23, end_lineno=188, end_col_offset=58), lineno=188, col_offset=17, end_lineno=188, end_col_offset=58), lineno=188, col_offset=8, end_lineno=188, end_col_offset=58), AsyncWith(items=[withitem(context_expr=Attribute(value=Name(id='self', ctx=Load(), lineno=189, col_offset=19, end_lineno=189, end_col_offset=23), attr='_lock', ctx=Load(), lineno=189, col_offset=19, end_lineno=189, end_col_offset=29))], body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load(), lineno=190, col_offset=12, end_lineno=190, end_col_offset=16), attr='_last_checks', ctx=Store(), lineno=190, col_offset=12, end_lineno=190, end_col_offset=29)], value=Name(id='checks', ctx=Load(), lineno=190, col_offset=32, end_lineno=190, end_col_offset=38), lineno=190, col_offset=12, end_lineno=190, end_col_offset=38), Return(value=Call(func=Name(id='dict', ctx=Load(), lineno=191, col_offset=19, end_lineno=191, end_col_offset=23), args=[Attribute(value=Name(id='self', ctx=Load(), lineno=191, col_offset=24, end_lineno=191, end_col_offset=28), attr='_last_checks', ctx=Load(), lineno=191, col_offset=24, end_lineno=191, end_col_offset=41)], lineno=191, col_offset=19, end_lineno=191, end_col_offset=42), lineno=191, col_offset=12, end_lineno=191, end_col_offset=42)], lineno=189, col_offset=8, end_lineno=191, end_col_offset=42)], returns=Subscript(value=Name(id='Mapping', ctx=Load(), lineno=165, col_offset=31, end_lineno=165, end_col_offset=38), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=165, col_offset=39, end_lineno=165, end_col_offset=42), Name(id='CheckResult', ctx=Load(), lineno=165, col_offset=44, end_lineno=165, end_col_offset=55)], ctx=Load(), lineno=165, col_offset=39, end_lineno=165, end_col_offset=55), ctx=Load(), lineno=165, col_offset=31, end_lineno=165, end_col_offset=56), lineno=165, col_offset=4, end_lineno=191, end_col_offset=42), AsyncFunctionDef(name='shutdown', args=arguments(args=[arg(arg='self', lineno=193, col_offset=23, end_lineno=193, end_col_offset=27)]), body=[Expr(value=Constant(value='Clear readiness state on shutdown.\n\n        Clears the internal cache of check results. Should be called during\n        application shutdown to free resources.\n\n        Examples\n        --------\n        >>> await readiness.shutdown()\n        ', lineno=194, col_offset=8, end_lineno=202, end_col_offset=11), lineno=194, col_offset=8, end_lineno=202, end_col_offset=11), AsyncWith(items=[withitem(context_expr=Attribute(value=Name(id='self', ctx=Load(), lineno=203, col_offset=19, end_lineno=203, end_col_offset=23), attr='_lock', ctx=Load(), lineno=203, col_offset=19, end_lineno=203, end_col_offset=29))], body=[Expr(value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=204, col_offset=12, end_lineno=204, end_col_offset=16), attr='_last_checks', ctx=Load(), lineno=204, col_offset=12, end_lineno=204, end_col_offset=29), attr='clear', ctx=Load(), lineno=204, col_offset=12, end_lineno=204, end_col_offset=35), lineno=204, col_offset=12, end_lineno=204, end_col_offset=37), lineno=204, col_offset=12, end_lineno=204, end_col_offset=37)], lineno=203, col_offset=8, end_lineno=204, end_col_offset=37)], returns=Constant(value=None, lineno=193, col_offset=32, end_lineno=193, end_col_offset=36), lineno=193, col_offset=4, end_lineno=204, end_col_offset=37), FunctionDef(name='snapshot', args=arguments(args=[arg(arg='self', lineno=206, col_offset=17, end_lineno=206, end_col_offset=21)]), body=[Expr(value=Constant(value='Return the latest readiness snapshot.\n\n        Returns the cached check results without performing new checks. Use\n        refresh() to update the cache with fresh results.\n\n        Returns\n        -------\n        Mapping[str, CheckResult]\n            Most recent readiness results from the last refresh() call.\n\n        Raises\n        ------\n        RuntimeError\n            If the probe has not been initialized yet (no refresh() called).\n\n        Examples\n        --------\n        >>> snapshot = readiness.snapshot()\n        >>> if snapshot["faiss_index"].healthy:\n        ...     # FAISS is ready\n        ...     pass\n        ', lineno=207, col_offset=8, end_lineno=228, end_col_offset=11), lineno=207, col_offset=8, end_lineno=228, end_col_offset=11), If(test=UnaryOp(op=Not(), operand=Attribute(value=Name(id='self', ctx=Load(), lineno=229, col_offset=15, end_lineno=229, end_col_offset=19), attr='_last_checks', ctx=Load(), lineno=229, col_offset=15, end_lineno=229, end_col_offset=32), lineno=229, col_offset=11, end_lineno=229, end_col_offset=32), body=[Assign(targets=[Name(id='msg', ctx=Store(), lineno=230, col_offset=12, end_lineno=230, end_col_offset=15)], value=Constant(value='Readiness probe not initialized', lineno=230, col_offset=18, end_lineno=230, end_col_offset=51), lineno=230, col_offset=12, end_lineno=230, end_col_offset=51), Raise(exc=Call(func=Name(id='RuntimeError', ctx=Load(), lineno=231, col_offset=18, end_lineno=231, end_col_offset=30), args=[Name(id='msg', ctx=Load(), lineno=231, col_offset=31, end_lineno=231, end_col_offset=34)], lineno=231, col_offset=18, end_lineno=231, end_col_offset=35), lineno=231, col_offset=12, end_lineno=231, end_col_offset=35)], lineno=229, col_offset=8, end_lineno=231, end_col_offset=35), Return(value=Call(func=Name(id='dict', ctx=Load(), lineno=232, col_offset=15, end_lineno=232, end_col_offset=19), args=[Attribute(value=Name(id='self', ctx=Load(), lineno=232, col_offset=20, end_lineno=232, end_col_offset=24), attr='_last_checks', ctx=Load(), lineno=232, col_offset=20, end_lineno=232, end_col_offset=37)], lineno=232, col_offset=15, end_lineno=232, end_col_offset=38), lineno=232, col_offset=8, end_lineno=232, end_col_offset=38)], returns=Subscript(value=Name(id='Mapping', ctx=Load(), lineno=206, col_offset=26, end_lineno=206, end_col_offset=33), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=206, col_offset=34, end_lineno=206, end_col_offset=37), Name(id='CheckResult', ctx=Load(), lineno=206, col_offset=39, end_lineno=206, end_col_offset=50)], ctx=Load(), lineno=206, col_offset=34, end_lineno=206, end_col_offset=50), ctx=Load(), lineno=206, col_offset=26, end_lineno=206, end_col_offset=51), lineno=206, col_offset=4, end_lineno=232, end_col_offset=38), FunctionDef(name='_run_checks', args=arguments(args=[arg(arg='self', lineno=234, col_offset=20, end_lineno=234, end_col_offset=24)]), body=[Expr(value=Constant(value='Execute all readiness checks synchronously.\n\n        Performs checks on all critical resources including filesystem paths,\n        index files, and external services. This method runs in a thread pool\n        to avoid blocking the event loop.\n\n        Returns\n        -------\n        dict[str, CheckResult]\n            Check results keyed by resource name.\n        ', lineno=235, col_offset=8, end_lineno=245, end_col_offset=11), lineno=235, col_offset=8, end_lineno=245, end_col_offset=11), AnnAssign(target=Name(id='results', ctx=Store(), lineno=246, col_offset=8, end_lineno=246, end_col_offset=15), annotation=Subscript(value=Name(id='dict', ctx=Load(), lineno=246, col_offset=17, end_lineno=246, end_col_offset=21), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=246, col_offset=22, end_lineno=246, end_col_offset=25), Name(id='CheckResult', ctx=Load(), lineno=246, col_offset=27, end_lineno=246, end_col_offset=38)], ctx=Load(), lineno=246, col_offset=22, end_lineno=246, end_col_offset=38), ctx=Load(), lineno=246, col_offset=17, end_lineno=246, end_col_offset=39), value=Dict(lineno=246, col_offset=42, end_lineno=246, end_col_offset=44), simple=1, lineno=246, col_offset=8, end_lineno=246, end_col_offset=44), Assign(targets=[Name(id='paths', ctx=Store(), lineno=247, col_offset=8, end_lineno=247, end_col_offset=13)], value=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=247, col_offset=16, end_lineno=247, end_col_offset=20), attr='_context', ctx=Load(), lineno=247, col_offset=16, end_lineno=247, end_col_offset=29), attr='paths', ctx=Load(), lineno=247, col_offset=16, end_lineno=247, end_col_offset=35), lineno=247, col_offset=8, end_lineno=247, end_col_offset=35), Assign(targets=[Subscript(value=Name(id='results', ctx=Load(), lineno=250, col_offset=8, end_lineno=250, end_col_offset=15), slice=Constant(value='repo_root', lineno=250, col_offset=16, end_lineno=250, end_col_offset=27), ctx=Store(), lineno=250, col_offset=8, end_lineno=250, end_col_offset=28)], value=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=250, col_offset=31, end_lineno=250, end_col_offset=35), attr='check_directory', ctx=Load(), lineno=250, col_offset=31, end_lineno=250, end_col_offset=51), args=[Attribute(value=Name(id='paths', ctx=Load(), lineno=250, col_offset=52, end_lineno=250, end_col_offset=57), attr='repo_root', ctx=Load(), lineno=250, col_offset=52, end_lineno=250, end_col_offset=67)], lineno=250, col_offset=31, end_lineno=250, end_col_offset=68), lineno=250, col_offset=8, end_lineno=250, end_col_offset=68), Assign(targets=[Subscript(value=Name(id='results', ctx=Load(), lineno=253, col_offset=8, end_lineno=253, end_col_offset=15), slice=Constant(value='data_dir', lineno=253, col_offset=16, end_lineno=253, end_col_offset=26), ctx=Store(), lineno=253, col_offset=8, end_lineno=253, end_col_offset=27)], value=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=253, col_offset=30, end_lineno=253, end_col_offset=34), attr='check_directory', ctx=Load(), lineno=253, col_offset=30, end_lineno=253, end_col_offset=50), args=[Attribute(value=Name(id='paths', ctx=Load(), lineno=253, col_offset=51, end_lineno=253, end_col_offset=56), attr='data_dir', ctx=Load(), lineno=253, col_offset=51, end_lineno=253, end_col_offset=65)], keywords=[keyword(arg='create', value=Constant(value=True, lineno=253, col_offset=74, end_lineno=253, end_col_offset=78), lineno=253, col_offset=67, end_lineno=253, end_col_offset=78)], lineno=253, col_offset=30, end_lineno=253, end_col_offset=79), lineno=253, col_offset=8, end_lineno=253, end_col_offset=79), Assign(targets=[Subscript(value=Name(id='results', ctx=Load(), lineno=254, col_offset=8, end_lineno=254, end_col_offset=15), slice=Constant(value='vectors_dir', lineno=254, col_offset=16, end_lineno=254, end_col_offset=29), ctx=Store(), lineno=254, col_offset=8, end_lineno=254, end_col_offset=30)], value=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=254, col_offset=33, end_lineno=254, end_col_offset=37), attr='check_directory', ctx=Load(), lineno=254, col_offset=33, end_lineno=254, end_col_offset=53), args=[Attribute(value=Name(id='paths', ctx=Load(), lineno=254, col_offset=54, end_lineno=254, end_col_offset=59), attr='vectors_dir', ctx=Load(), lineno=254, col_offset=54, end_lineno=254, end_col_offset=71)], keywords=[keyword(arg='create', value=Constant(value=True, lineno=254, col_offset=80, end_lineno=254, end_col_offset=84), lineno=254, col_offset=73, end_lineno=254, end_col_offset=84)], lineno=254, col_offset=33, end_lineno=254, end_col_offset=85), lineno=254, col_offset=8, end_lineno=254, end_col_offset=85), Assign(targets=[Subscript(value=Name(id='results', ctx=Load(), lineno=257, col_offset=8, end_lineno=257, end_col_offset=15), slice=Constant(value='faiss_index', lineno=257, col_offset=16, end_lineno=257, end_col_offset=29), ctx=Store(), lineno=257, col_offset=8, end_lineno=257, end_col_offset=30)], value=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=257, col_offset=33, end_lineno=257, end_col_offset=37), attr='check_file', ctx=Load(), lineno=257, col_offset=33, end_lineno=257, end_col_offset=48), args=[Attribute(value=Name(id='paths', ctx=Load(), lineno=258, col_offset=12, end_lineno=258, end_col_offset=17), attr='faiss_index', ctx=Load(), lineno=258, col_offset=12, end_lineno=258, end_col_offset=29)], keywords=[keyword(arg='description', value=Constant(value='FAISS index', lineno=259, col_offset=24, end_lineno=259, end_col_offset=37), lineno=259, col_offset=12, end_lineno=259, end_col_offset=37), keyword(arg='optional', value=Constant(value=False, lineno=260, col_offset=21, end_lineno=260, end_col_offset=26), lineno=260, col_offset=12, end_lineno=260, end_col_offset=26)], lineno=257, col_offset=33, end_lineno=261, end_col_offset=9), lineno=257, col_offset=8, end_lineno=261, end_col_offset=9), Assign(targets=[Subscript(value=Name(id='results', ctx=Load(), lineno=264, col_offset=8, end_lineno=264, end_col_offset=15), slice=Constant(value='duckdb_catalog', lineno=264, col_offset=16, end_lineno=264, end_col_offset=32), ctx=Store(), lineno=264, col_offset=8, end_lineno=264, end_col_offset=33)], value=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=264, col_offset=36, end_lineno=264, end_col_offset=40), attr='_check_duckdb_catalog', ctx=Load(), lineno=264, col_offset=36, end_lineno=264, end_col_offset=62), args=[Attribute(value=Name(id='paths', ctx=Load(), lineno=264, col_offset=63, end_lineno=264, end_col_offset=68), attr='duckdb_path', ctx=Load(), lineno=264, col_offset=63, end_lineno=264, end_col_offset=80)], lineno=264, col_offset=36, end_lineno=264, end_col_offset=81), lineno=264, col_offset=8, end_lineno=264, end_col_offset=81), Assign(targets=[Subscript(value=Name(id='results', ctx=Load(), lineno=267, col_offset=8, end_lineno=267, end_col_offset=15), slice=Constant(value='scip_index', lineno=267, col_offset=16, end_lineno=267, end_col_offset=28), ctx=Store(), lineno=267, col_offset=8, end_lineno=267, end_col_offset=29)], value=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=267, col_offset=32, end_lineno=267, end_col_offset=36), attr='check_file', ctx=Load(), lineno=267, col_offset=32, end_lineno=267, end_col_offset=47), args=[Attribute(value=Name(id='paths', ctx=Load(), lineno=268, col_offset=12, end_lineno=268, end_col_offset=17), attr='scip_index', ctx=Load(), lineno=268, col_offset=12, end_lineno=268, end_col_offset=28)], keywords=[keyword(arg='description', value=Constant(value='SCIP index', lineno=269, col_offset=24, end_lineno=269, end_col_offset=36), lineno=269, col_offset=12, end_lineno=269, end_col_offset=36), keyword(arg='optional', value=Constant(value=True, lineno=270, col_offset=21, end_lineno=270, end_col_offset=25), lineno=270, col_offset=12, end_lineno=270, end_col_offset=25)], lineno=267, col_offset=32, end_lineno=271, end_col_offset=9), lineno=267, col_offset=8, end_lineno=271, end_col_offset=9), Assign(targets=[Subscript(value=Name(id='results', ctx=Load(), lineno=274, col_offset=8, end_lineno=274, end_col_offset=15), slice=Constant(value='vllm_service', lineno=274, col_offset=16, end_lineno=274, end_col_offset=30), ctx=Store(), lineno=274, col_offset=8, end_lineno=274, end_col_offset=31)], value=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=274, col_offset=34, end_lineno=274, end_col_offset=38), attr='check_vllm_connection', ctx=Load(), lineno=274, col_offset=34, end_lineno=274, end_col_offset=60), lineno=274, col_offset=34, end_lineno=274, end_col_offset=62), lineno=274, col_offset=8, end_lineno=274, end_col_offset=62), Assign(targets=[Subscript(value=Name(id='results', ctx=Load(), lineno=277, col_offset=8, end_lineno=277, end_col_offset=15), slice=Constant(value='search_cli', lineno=277, col_offset=16, end_lineno=277, end_col_offset=28), ctx=Store(), lineno=277, col_offset=8, end_lineno=277, end_col_offset=29)], value=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=277, col_offset=32, end_lineno=277, end_col_offset=36), attr='_check_search_tools', ctx=Load(), lineno=277, col_offset=32, end_lineno=277, end_col_offset=56), lineno=277, col_offset=32, end_lineno=277, end_col_offset=58), lineno=277, col_offset=8, end_lineno=277, end_col_offset=58), Assign(targets=[Subscript(value=Name(id='results', ctx=Load(), lineno=280, col_offset=8, end_lineno=280, end_col_offset=15), slice=Constant(value='xtr_artifacts', lineno=280, col_offset=16, end_lineno=280, end_col_offset=31), ctx=Store(), lineno=280, col_offset=8, end_lineno=280, end_col_offset=32)], value=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=280, col_offset=35, end_lineno=280, end_col_offset=39), attr='_check_xtr_artifacts', ctx=Load(), lineno=280, col_offset=35, end_lineno=280, end_col_offset=60), lineno=280, col_offset=35, end_lineno=280, end_col_offset=62), lineno=280, col_offset=8, end_lineno=280, end_col_offset=62), Return(value=Name(id='results', ctx=Load(), lineno=282, col_offset=15, end_lineno=282, end_col_offset=22), lineno=282, col_offset=8, end_lineno=282, end_col_offset=22)], returns=Subscript(value=Name(id='dict', ctx=Load(), lineno=234, col_offset=29, end_lineno=234, end_col_offset=33), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=234, col_offset=34, end_lineno=234, end_col_offset=37), Name(id='CheckResult', ctx=Load(), lineno=234, col_offset=39, end_lineno=234, end_col_offset=50)], ctx=Load(), lineno=234, col_offset=34, end_lineno=234, end_col_offset=50), ctx=Load(), lineno=234, col_offset=29, end_lineno=234, end_col_offset=51), lineno=234, col_offset=4, end_lineno=282, end_col_offset=22), FunctionDef(name='check_directory', args=arguments(args=[arg(arg='path', annotation=Name(id='Path', ctx=Load(), lineno=285, col_offset=30, end_lineno=285, end_col_offset=34), lineno=285, col_offset=24, end_lineno=285, end_col_offset=34)], kwonlyargs=[arg(arg='create', annotation=Name(id='bool', ctx=Load(), lineno=285, col_offset=47, end_lineno=285, end_col_offset=51), lineno=285, col_offset=39, end_lineno=285, end_col_offset=51)], kw_defaults=[Constant(value=False, lineno=285, col_offset=54, end_lineno=285, end_col_offset=59)]), body=[Expr(value=Constant(value='Ensure a directory exists (creating it if requested).\n\n        Parameters\n        ----------\n        path : Path\n            Directory path to validate.\n        create : bool, optional\n            When True, create the directory hierarchy if it is missing.\n            Defaults to False.\n\n        Returns\n        -------\n        CheckResult\n            Healthy status and diagnostic detail when unavailable.\n\n        Examples\n        --------\n        >>> result = ReadinessProbe.check_directory(Path("/tmp/test"))\n        >>> result.healthy\n        True\n\n        >>> result = ReadinessProbe.check_directory(Path("/nonexistent"), create=True)\n        >>> result.healthy\n        True  # Directory was created\n        ', lineno=286, col_offset=8, end_lineno=310, end_col_offset=11), lineno=286, col_offset=8, end_lineno=310, end_col_offset=11), Try(body=[If(test=Name(id='create', ctx=Load(), lineno=312, col_offset=15, end_lineno=312, end_col_offset=21), body=[Expr(value=Call(func=Attribute(value=Name(id='path', ctx=Load(), lineno=313, col_offset=16, end_lineno=313, end_col_offset=20), attr='mkdir', ctx=Load(), lineno=313, col_offset=16, end_lineno=313, end_col_offset=26), keywords=[keyword(arg='parents', value=Constant(value=True, lineno=313, col_offset=35, end_lineno=313, end_col_offset=39), lineno=313, col_offset=27, end_lineno=313, end_col_offset=39), keyword(arg='exist_ok', value=Constant(value=True, lineno=313, col_offset=50, end_lineno=313, end_col_offset=54), lineno=313, col_offset=41, end_lineno=313, end_col_offset=54)], lineno=313, col_offset=16, end_lineno=313, end_col_offset=55), lineno=313, col_offset=16, end_lineno=313, end_col_offset=55)], lineno=312, col_offset=12, end_lineno=313, end_col_offset=55), Assign(targets=[Name(id='exists', ctx=Store(), lineno=314, col_offset=12, end_lineno=314, end_col_offset=18)], value=Call(func=Attribute(value=Name(id='path', ctx=Load(), lineno=314, col_offset=21, end_lineno=314, end_col_offset=25), attr='is_dir', ctx=Load(), lineno=314, col_offset=21, end_lineno=314, end_col_offset=32), lineno=314, col_offset=21, end_lineno=314, end_col_offset=34), lineno=314, col_offset=12, end_lineno=314, end_col_offset=34)], handlers=[ExceptHandler(type=Name(id='OSError', ctx=Load(), lineno=315, col_offset=15, end_lineno=315, end_col_offset=22), name='exc', body=[Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=316, col_offset=19, end_lineno=316, end_col_offset=30), keywords=[keyword(arg='healthy', value=Constant(value=False, lineno=316, col_offset=39, end_lineno=316, end_col_offset=44), lineno=316, col_offset=31, end_lineno=316, end_col_offset=44), keyword(arg='detail', value=JoinedStr(values=[Constant(value='Cannot access directory ', lineno=316, col_offset=55, end_lineno=316, end_col_offset=79), FormattedValue(value=Name(id='path', ctx=Load(), lineno=316, col_offset=80, end_lineno=316, end_col_offset=84), conversion=-1, lineno=316, col_offset=79, end_lineno=316, end_col_offset=85), Constant(value=': ', lineno=316, col_offset=85, end_lineno=316, end_col_offset=87), FormattedValue(value=Name(id='exc', ctx=Load(), lineno=316, col_offset=88, end_lineno=316, end_col_offset=91), conversion=-1, lineno=316, col_offset=87, end_lineno=316, end_col_offset=92)], lineno=316, col_offset=53, end_lineno=316, end_col_offset=93), lineno=316, col_offset=46, end_lineno=316, end_col_offset=93)], lineno=316, col_offset=19, end_lineno=316, end_col_offset=94), lineno=316, col_offset=12, end_lineno=316, end_col_offset=94)], lineno=315, col_offset=8, end_lineno=316, end_col_offset=94)], lineno=311, col_offset=8, end_lineno=316, end_col_offset=94), If(test=UnaryOp(op=Not(), operand=Name(id='exists', ctx=Load(), lineno=318, col_offset=15, end_lineno=318, end_col_offset=21), lineno=318, col_offset=11, end_lineno=318, end_col_offset=21), body=[Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=319, col_offset=19, end_lineno=319, end_col_offset=30), keywords=[keyword(arg='healthy', value=Constant(value=False, lineno=319, col_offset=39, end_lineno=319, end_col_offset=44), lineno=319, col_offset=31, end_lineno=319, end_col_offset=44), keyword(arg='detail', value=JoinedStr(values=[Constant(value='Directory missing: ', lineno=319, col_offset=55, end_lineno=319, end_col_offset=74), FormattedValue(value=Name(id='path', ctx=Load(), lineno=319, col_offset=75, end_lineno=319, end_col_offset=79), conversion=-1, lineno=319, col_offset=74, end_lineno=319, end_col_offset=80)], lineno=319, col_offset=53, end_lineno=319, end_col_offset=81), lineno=319, col_offset=46, end_lineno=319, end_col_offset=81)], lineno=319, col_offset=19, end_lineno=319, end_col_offset=82), lineno=319, col_offset=12, end_lineno=319, end_col_offset=82)], lineno=318, col_offset=8, end_lineno=319, end_col_offset=82), Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=320, col_offset=15, end_lineno=320, end_col_offset=26), keywords=[keyword(arg='healthy', value=Constant(value=True, lineno=320, col_offset=35, end_lineno=320, end_col_offset=39), lineno=320, col_offset=27, end_lineno=320, end_col_offset=39)], lineno=320, col_offset=15, end_lineno=320, end_col_offset=40), lineno=320, col_offset=8, end_lineno=320, end_col_offset=40)], decorator_list=[Name(id='staticmethod', ctx=Load(), lineno=284, col_offset=5, end_lineno=284, end_col_offset=17)], returns=Name(id='CheckResult', ctx=Load(), lineno=285, col_offset=64, end_lineno=285, end_col_offset=75), lineno=285, col_offset=4, end_lineno=320, end_col_offset=40), FunctionDef(name='check_file', args=arguments(args=[arg(arg='path', annotation=Name(id='Path', ctx=Load(), lineno=323, col_offset=25, end_lineno=323, end_col_offset=29), lineno=323, col_offset=19, end_lineno=323, end_col_offset=29)], kwonlyargs=[arg(arg='description', annotation=Name(id='str', ctx=Load(), lineno=323, col_offset=47, end_lineno=323, end_col_offset=50), lineno=323, col_offset=34, end_lineno=323, end_col_offset=50), arg(arg='optional', annotation=Name(id='bool', ctx=Load(), lineno=323, col_offset=62, end_lineno=323, end_col_offset=66), lineno=323, col_offset=52, end_lineno=323, end_col_offset=66)], kw_defaults=[None, Constant(value=False, lineno=323, col_offset=69, end_lineno=323, end_col_offset=74)]), body=[Expr(value=Constant(value='Validate existence of a filesystem resource.\n\n        Parameters\n        ----------\n        path : Path\n            Target filesystem path.\n        description : str\n            Human-readable resource description for diagnostics.\n        optional : bool, optional\n            When True, missing resources mark the check as healthy but include\n            detail. Defaults to False (missing resources fail the check).\n\n        Returns\n        -------\n        CheckResult\n            Healthy status and contextual detail.\n\n        Examples\n        --------\n        >>> result = ReadinessProbe.check_file(\n        ...     Path("/tmp/test.txt"), description="test file", optional=False\n        ... )\n        >>> result.healthy\n        False  # File doesn\'t exist\n\n        >>> result = ReadinessProbe.check_file(\n        ...     Path("/tmp/test.txt"), description="test file", optional=True\n        ... )\n        >>> result.healthy\n        True  # Optional file missing is OK\n        >>> result.detail\n        \'test file not found at /tmp/test.txt\'\n        ', lineno=324, col_offset=8, end_lineno=356, end_col_offset=11), lineno=324, col_offset=8, end_lineno=356, end_col_offset=11), Try(body=[Assign(targets=[Name(id='exists', ctx=Store(), lineno=358, col_offset=12, end_lineno=358, end_col_offset=18)], value=Call(func=Attribute(value=Name(id='path', ctx=Load(), lineno=358, col_offset=21, end_lineno=358, end_col_offset=25), attr='is_file', ctx=Load(), lineno=358, col_offset=21, end_lineno=358, end_col_offset=33), lineno=358, col_offset=21, end_lineno=358, end_col_offset=35), lineno=358, col_offset=12, end_lineno=358, end_col_offset=35)], handlers=[ExceptHandler(type=Name(id='OSError', ctx=Load(), lineno=359, col_offset=15, end_lineno=359, end_col_offset=22), name='exc', body=[Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=360, col_offset=19, end_lineno=360, end_col_offset=30), keywords=[keyword(arg='healthy', value=Constant(value=False, lineno=361, col_offset=24, end_lineno=361, end_col_offset=29), lineno=361, col_offset=16, end_lineno=361, end_col_offset=29), keyword(arg='detail', value=JoinedStr(values=[Constant(value='Cannot access ', lineno=362, col_offset=25, end_lineno=362, end_col_offset=39), FormattedValue(value=Name(id='description', ctx=Load(), lineno=362, col_offset=40, end_lineno=362, end_col_offset=51), conversion=-1, lineno=362, col_offset=39, end_lineno=362, end_col_offset=52), Constant(value=' at ', lineno=362, col_offset=52, end_lineno=362, end_col_offset=56), FormattedValue(value=Name(id='path', ctx=Load(), lineno=362, col_offset=57, end_lineno=362, end_col_offset=61), conversion=-1, lineno=362, col_offset=56, end_lineno=362, end_col_offset=62), Constant(value=': ', lineno=362, col_offset=62, end_lineno=362, end_col_offset=64), FormattedValue(value=Name(id='exc', ctx=Load(), lineno=362, col_offset=65, end_lineno=362, end_col_offset=68), conversion=-1, lineno=362, col_offset=64, end_lineno=362, end_col_offset=69)], lineno=362, col_offset=23, end_lineno=362, end_col_offset=70), lineno=362, col_offset=16, end_lineno=362, end_col_offset=70)], lineno=360, col_offset=19, end_lineno=363, end_col_offset=13), lineno=360, col_offset=12, end_lineno=363, end_col_offset=13)], lineno=359, col_offset=8, end_lineno=363, end_col_offset=13)], lineno=357, col_offset=8, end_lineno=363, end_col_offset=13), If(test=Name(id='exists', ctx=Load(), lineno=365, col_offset=11, end_lineno=365, end_col_offset=17), body=[Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=366, col_offset=19, end_lineno=366, end_col_offset=30), keywords=[keyword(arg='healthy', value=Constant(value=True, lineno=366, col_offset=39, end_lineno=366, end_col_offset=43), lineno=366, col_offset=31, end_lineno=366, end_col_offset=43)], lineno=366, col_offset=19, end_lineno=366, end_col_offset=44), lineno=366, col_offset=12, end_lineno=366, end_col_offset=44)], lineno=365, col_offset=8, end_lineno=366, end_col_offset=44), Assign(targets=[Name(id='detail', ctx=Store(), lineno=368, col_offset=8, end_lineno=368, end_col_offset=14)], value=JoinedStr(values=[FormattedValue(value=Name(id='description', ctx=Load(), lineno=368, col_offset=20, end_lineno=368, end_col_offset=31), conversion=-1, lineno=368, col_offset=19, end_lineno=368, end_col_offset=32), Constant(value=' not found at ', lineno=368, col_offset=32, end_lineno=368, end_col_offset=46), FormattedValue(value=Name(id='path', ctx=Load(), lineno=368, col_offset=47, end_lineno=368, end_col_offset=51), conversion=-1, lineno=368, col_offset=46, end_lineno=368, end_col_offset=52)], lineno=368, col_offset=17, end_lineno=368, end_col_offset=53), lineno=368, col_offset=8, end_lineno=368, end_col_offset=53), If(test=Name(id='optional', ctx=Load(), lineno=369, col_offset=11, end_lineno=369, end_col_offset=19), body=[Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=370, col_offset=19, end_lineno=370, end_col_offset=30), keywords=[keyword(arg='healthy', value=Constant(value=True, lineno=370, col_offset=39, end_lineno=370, end_col_offset=43), lineno=370, col_offset=31, end_lineno=370, end_col_offset=43), keyword(arg='detail', value=Name(id='detail', ctx=Load(), lineno=370, col_offset=52, end_lineno=370, end_col_offset=58), lineno=370, col_offset=45, end_lineno=370, end_col_offset=58)], lineno=370, col_offset=19, end_lineno=370, end_col_offset=59), lineno=370, col_offset=12, end_lineno=370, end_col_offset=59)], lineno=369, col_offset=8, end_lineno=370, end_col_offset=59), Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=371, col_offset=15, end_lineno=371, end_col_offset=26), keywords=[keyword(arg='healthy', value=Constant(value=False, lineno=371, col_offset=35, end_lineno=371, end_col_offset=40), lineno=371, col_offset=27, end_lineno=371, end_col_offset=40), keyword(arg='detail', value=Name(id='detail', ctx=Load(), lineno=371, col_offset=49, end_lineno=371, end_col_offset=55), lineno=371, col_offset=42, end_lineno=371, end_col_offset=55)], lineno=371, col_offset=15, end_lineno=371, end_col_offset=56), lineno=371, col_offset=8, end_lineno=371, end_col_offset=56)], decorator_list=[Name(id='staticmethod', ctx=Load(), lineno=322, col_offset=5, end_lineno=322, end_col_offset=17)], returns=Name(id='CheckResult', ctx=Load(), lineno=323, col_offset=79, end_lineno=323, end_col_offset=90), lineno=323, col_offset=4, end_lineno=371, end_col_offset=56), FunctionDef(name='_check_duckdb_catalog', args=arguments(args=[arg(arg='self', lineno=373, col_offset=30, end_lineno=373, end_col_offset=34), arg(arg='path', annotation=Name(id='Path', ctx=Load(), lineno=373, col_offset=42, end_lineno=373, end_col_offset=46), lineno=373, col_offset=36, end_lineno=373, end_col_offset=46)]), body=[Expr(value=Constant(value='Validate DuckDB catalog presence and optional materialization state.\n\n        Parameters\n        ----------\n        path : Path\n            Path to the DuckDB catalog file.\n\n        Returns\n        -------\n        CheckResult\n            Healthy status and diagnostic detail when validation fails.\n        ', lineno=374, col_offset=8, end_lineno=385, end_col_offset=11), lineno=374, col_offset=8, end_lineno=385, end_col_offset=11), Assign(targets=[Name(id='file_result', ctx=Store(), lineno=386, col_offset=8, end_lineno=386, end_col_offset=19)], value=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=386, col_offset=22, end_lineno=386, end_col_offset=26), attr='check_file', ctx=Load(), lineno=386, col_offset=22, end_lineno=386, end_col_offset=37), args=[Name(id='path', ctx=Load(), lineno=386, col_offset=38, end_lineno=386, end_col_offset=42)], keywords=[keyword(arg='description', value=Constant(value='DuckDB catalog', lineno=386, col_offset=56, end_lineno=386, end_col_offset=72), lineno=386, col_offset=44, end_lineno=386, end_col_offset=72), keyword(arg='optional', value=Constant(value=False, lineno=386, col_offset=83, end_lineno=386, end_col_offset=88), lineno=386, col_offset=74, end_lineno=386, end_col_offset=88)], lineno=386, col_offset=22, end_lineno=386, end_col_offset=89), lineno=386, col_offset=8, end_lineno=386, end_col_offset=89), If(test=UnaryOp(op=Not(), operand=Attribute(value=Name(id='file_result', ctx=Load(), lineno=387, col_offset=15, end_lineno=387, end_col_offset=26), attr='healthy', ctx=Load(), lineno=387, col_offset=15, end_lineno=387, end_col_offset=34), lineno=387, col_offset=11, end_lineno=387, end_col_offset=34), body=[Return(value=Name(id='file_result', ctx=Load(), lineno=388, col_offset=19, end_lineno=388, end_col_offset=30), lineno=388, col_offset=12, end_lineno=388, end_col_offset=30)], lineno=387, col_offset=8, end_lineno=388, end_col_offset=30), If(test=UnaryOp(op=Not(), operand=Attribute(value=Attribute(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=390, col_offset=15, end_lineno=390, end_col_offset=19), attr='_context', ctx=Load(), lineno=390, col_offset=15, end_lineno=390, end_col_offset=28), attr='settings', ctx=Load(), lineno=390, col_offset=15, end_lineno=390, end_col_offset=37), attr='index', ctx=Load(), lineno=390, col_offset=15, end_lineno=390, end_col_offset=43), attr='duckdb_materialize', ctx=Load(), lineno=390, col_offset=15, end_lineno=390, end_col_offset=62), lineno=390, col_offset=11, end_lineno=390, end_col_offset=62), body=[Return(value=Name(id='file_result', ctx=Load(), lineno=391, col_offset=19, end_lineno=391, end_col_offset=30), lineno=391, col_offset=12, end_lineno=391, end_col_offset=30)], lineno=390, col_offset=8, end_lineno=391, end_col_offset=30), Try(body=[Assign(targets=[Name(id='conn', ctx=Store(), lineno=394, col_offset=12, end_lineno=394, end_col_offset=16)], value=Call(func=Attribute(value=Name(id='duckdb', ctx=Load(), lineno=394, col_offset=19, end_lineno=394, end_col_offset=25), attr='connect', ctx=Load(), lineno=394, col_offset=19, end_lineno=394, end_col_offset=33), args=[Call(func=Name(id='str', ctx=Load(), lineno=394, col_offset=34, end_lineno=394, end_col_offset=37), args=[Name(id='path', ctx=Load(), lineno=394, col_offset=38, end_lineno=394, end_col_offset=42)], lineno=394, col_offset=34, end_lineno=394, end_col_offset=43)], lineno=394, col_offset=19, end_lineno=394, end_col_offset=44), lineno=394, col_offset=12, end_lineno=394, end_col_offset=44)], handlers=[ExceptHandler(type=Attribute(value=Name(id='duckdb', ctx=Load(), lineno=395, col_offset=15, end_lineno=395, end_col_offset=21), attr='Error', ctx=Load(), lineno=395, col_offset=15, end_lineno=395, end_col_offset=27), name='exc', body=[Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=396, col_offset=19, end_lineno=396, end_col_offset=30), keywords=[keyword(arg='healthy', value=Constant(value=False, lineno=396, col_offset=39, end_lineno=396, end_col_offset=44), lineno=396, col_offset=31, end_lineno=396, end_col_offset=44), keyword(arg='detail', value=JoinedStr(values=[Constant(value='Unable to open DuckDB catalog: ', lineno=396, col_offset=55, end_lineno=396, end_col_offset=86), FormattedValue(value=Name(id='exc', ctx=Load(), lineno=396, col_offset=87, end_lineno=396, end_col_offset=90), conversion=-1, lineno=396, col_offset=86, end_lineno=396, end_col_offset=91)], lineno=396, col_offset=53, end_lineno=396, end_col_offset=92), lineno=396, col_offset=46, end_lineno=396, end_col_offset=92)], lineno=396, col_offset=19, end_lineno=396, end_col_offset=93), lineno=396, col_offset=12, end_lineno=396, end_col_offset=93)], lineno=395, col_offset=8, end_lineno=396, end_col_offset=93)], lineno=393, col_offset=8, end_lineno=396, end_col_offset=93), AnnAssign(target=Name(id='detail', ctx=Store(), lineno=398, col_offset=8, end_lineno=398, end_col_offset=14), annotation=BinOp(left=Name(id='str', ctx=Load(), lineno=398, col_offset=16, end_lineno=398, end_col_offset=19), op=BitOr(), right=Constant(value=None, lineno=398, col_offset=22, end_lineno=398, end_col_offset=26), lineno=398, col_offset=16, end_lineno=398, end_col_offset=26), value=Constant(value=None, lineno=398, col_offset=29, end_lineno=398, end_col_offset=33), simple=1, lineno=398, col_offset=8, end_lineno=398, end_col_offset=33), Try(body=[If(test=UnaryOp(op=Not(), operand=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=400, col_offset=19, end_lineno=400, end_col_offset=23), attr='_duckdb_table_exists', ctx=Load(), lineno=400, col_offset=19, end_lineno=400, end_col_offset=44), args=[Name(id='conn', ctx=Load(), lineno=400, col_offset=45, end_lineno=400, end_col_offset=49)], lineno=400, col_offset=19, end_lineno=400, end_col_offset=50), lineno=400, col_offset=15, end_lineno=400, end_col_offset=50), body=[Assign(targets=[Name(id='detail', ctx=Store(), lineno=401, col_offset=16, end_lineno=401, end_col_offset=22)], value=Constant(value='DuckDB materialization enabled but chunks_materialized table missing. Re-run the indexing pipeline to refresh the catalog.', lineno=402, col_offset=20, end_lineno=403, end_col_offset=74), lineno=401, col_offset=16, end_lineno=404, end_col_offset=17)], orelse=[If(test=UnaryOp(op=Not(), operand=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=405, col_offset=21, end_lineno=405, end_col_offset=25), attr='_duckdb_index_exists', ctx=Load(), lineno=405, col_offset=21, end_lineno=405, end_col_offset=46), args=[Name(id='conn', ctx=Load(), lineno=405, col_offset=47, end_lineno=405, end_col_offset=51)], lineno=405, col_offset=21, end_lineno=405, end_col_offset=52), lineno=405, col_offset=17, end_lineno=405, end_col_offset=52), body=[Assign(targets=[Name(id='detail', ctx=Store(), lineno=406, col_offset=16, end_lineno=406, end_col_offset=22)], value=Constant(value='DuckDB materialization enabled but idx_chunks_materialized_uri index missing. Re-run the indexing pipeline to rebuild indexes.', lineno=407, col_offset=20, end_lineno=408, end_col_offset=70), lineno=406, col_offset=16, end_lineno=409, end_col_offset=17)], lineno=405, col_offset=12, end_lineno=409, end_col_offset=17)], lineno=400, col_offset=12, end_lineno=409, end_col_offset=17)], handlers=[ExceptHandler(type=Attribute(value=Name(id='duckdb', ctx=Load(), lineno=410, col_offset=15, end_lineno=410, end_col_offset=21), attr='Error', ctx=Load(), lineno=410, col_offset=15, end_lineno=410, end_col_offset=27), name='exc', body=[Assign(targets=[Name(id='detail', ctx=Store(), lineno=411, col_offset=12, end_lineno=411, end_col_offset=18)], value=JoinedStr(values=[Constant(value='DuckDB catalog validation failed: ', lineno=411, col_offset=23, end_lineno=411, end_col_offset=57), FormattedValue(value=Name(id='exc', ctx=Load(), lineno=411, col_offset=58, end_lineno=411, end_col_offset=61), conversion=-1, lineno=411, col_offset=57, end_lineno=411, end_col_offset=62)], lineno=411, col_offset=21, end_lineno=411, end_col_offset=63), lineno=411, col_offset=12, end_lineno=411, end_col_offset=63)], lineno=410, col_offset=8, end_lineno=411, end_col_offset=63)], finalbody=[Expr(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=413, col_offset=12, end_lineno=413, end_col_offset=16), attr='close', ctx=Load(), lineno=413, col_offset=12, end_lineno=413, end_col_offset=22), lineno=413, col_offset=12, end_lineno=413, end_col_offset=24), lineno=413, col_offset=12, end_lineno=413, end_col_offset=24)], lineno=399, col_offset=8, end_lineno=413, end_col_offset=24), If(test=Compare(left=Name(id='detail', ctx=Load(), lineno=415, col_offset=11, end_lineno=415, end_col_offset=17), ops=[IsNot()], comparators=[Constant(value=None, lineno=415, col_offset=25, end_lineno=415, end_col_offset=29)], lineno=415, col_offset=11, end_lineno=415, end_col_offset=29), body=[Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=416, col_offset=19, end_lineno=416, end_col_offset=30), keywords=[keyword(arg='healthy', value=Constant(value=False, lineno=416, col_offset=39, end_lineno=416, end_col_offset=44), lineno=416, col_offset=31, end_lineno=416, end_col_offset=44), keyword(arg='detail', value=Name(id='detail', ctx=Load(), lineno=416, col_offset=53, end_lineno=416, end_col_offset=59), lineno=416, col_offset=46, end_lineno=416, end_col_offset=59)], lineno=416, col_offset=19, end_lineno=416, end_col_offset=60), lineno=416, col_offset=12, end_lineno=416, end_col_offset=60)], lineno=415, col_offset=8, end_lineno=416, end_col_offset=60), Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=417, col_offset=15, end_lineno=417, end_col_offset=26), keywords=[keyword(arg='healthy', value=Constant(value=True, lineno=417, col_offset=35, end_lineno=417, end_col_offset=39), lineno=417, col_offset=27, end_lineno=417, end_col_offset=39)], lineno=417, col_offset=15, end_lineno=417, end_col_offset=40), lineno=417, col_offset=8, end_lineno=417, end_col_offset=40)], returns=Name(id='CheckResult', ctx=Load(), lineno=373, col_offset=51, end_lineno=373, end_col_offset=62), lineno=373, col_offset=4, end_lineno=417, end_col_offset=40), FunctionDef(name='_check_xtr_artifacts', args=arguments(args=[arg(arg='self', lineno=419, col_offset=29, end_lineno=419, end_col_offset=33)]), body=[Expr(value=Constant(value='Verify that XTR token artifacts are present when enabled.\n\n        Returns\n        -------\n        CheckResult\n            Healthy status describing artifact availability.\n        ', lineno=420, col_offset=8, end_lineno=426, end_col_offset=11), lineno=420, col_offset=8, end_lineno=426, end_col_offset=11), Assign(targets=[Name(id='cfg', ctx=Store(), lineno=427, col_offset=8, end_lineno=427, end_col_offset=11)], value=Attribute(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=427, col_offset=14, end_lineno=427, end_col_offset=18), attr='_context', ctx=Load(), lineno=427, col_offset=14, end_lineno=427, end_col_offset=27), attr='settings', ctx=Load(), lineno=427, col_offset=14, end_lineno=427, end_col_offset=36), attr='xtr', ctx=Load(), lineno=427, col_offset=14, end_lineno=427, end_col_offset=40), lineno=427, col_offset=8, end_lineno=427, end_col_offset=40), Assign(targets=[Name(id='xtr_dir', ctx=Store(), lineno=428, col_offset=8, end_lineno=428, end_col_offset=15)], value=Attribute(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=428, col_offset=18, end_lineno=428, end_col_offset=22), attr='_context', ctx=Load(), lineno=428, col_offset=18, end_lineno=428, end_col_offset=31), attr='paths', ctx=Load(), lineno=428, col_offset=18, end_lineno=428, end_col_offset=37), attr='xtr_dir', ctx=Load(), lineno=428, col_offset=18, end_lineno=428, end_col_offset=45), lineno=428, col_offset=8, end_lineno=428, end_col_offset=45), Assign(targets=[Name(id='token_name', ctx=Store(), lineno=429, col_offset=8, end_lineno=429, end_col_offset=18)], value=IfExp(test=Compare(left=Attribute(value=Name(id='cfg', ctx=Load(), lineno=429, col_offset=37, end_lineno=429, end_col_offset=40), attr='dtype', ctx=Load(), lineno=429, col_offset=37, end_lineno=429, end_col_offset=46), ops=[Eq()], comparators=[Constant(value='float32', lineno=429, col_offset=50, end_lineno=429, end_col_offset=59)], lineno=429, col_offset=37, end_lineno=429, end_col_offset=59), body=Constant(value='tokens.f32', lineno=429, col_offset=21, end_lineno=429, end_col_offset=33), orelse=Constant(value='tokens.f16', lineno=429, col_offset=65, end_lineno=429, end_col_offset=77), lineno=429, col_offset=21, end_lineno=429, end_col_offset=77), lineno=429, col_offset=8, end_lineno=429, end_col_offset=77), Assign(targets=[Name(id='token_path', ctx=Store(), lineno=430, col_offset=8, end_lineno=430, end_col_offset=18)], value=BinOp(left=Name(id='xtr_dir', ctx=Load(), lineno=430, col_offset=21, end_lineno=430, end_col_offset=28), op=Div(), right=Name(id='token_name', ctx=Load(), lineno=430, col_offset=31, end_lineno=430, end_col_offset=41), lineno=430, col_offset=21, end_lineno=430, end_col_offset=41), lineno=430, col_offset=8, end_lineno=430, end_col_offset=41), Assign(targets=[Name(id='meta_path', ctx=Store(), lineno=431, col_offset=8, end_lineno=431, end_col_offset=17)], value=BinOp(left=Name(id='xtr_dir', ctx=Load(), lineno=431, col_offset=20, end_lineno=431, end_col_offset=27), op=Div(), right=Constant(value='index.meta.json', lineno=431, col_offset=30, end_lineno=431, end_col_offset=47), lineno=431, col_offset=20, end_lineno=431, end_col_offset=47), lineno=431, col_offset=8, end_lineno=431, end_col_offset=47), Assign(targets=[Name(id='expected', ctx=Store(), lineno=432, col_offset=8, end_lineno=432, end_col_offset=16)], value=List(elts=[Name(id='token_path', ctx=Load(), lineno=432, col_offset=20, end_lineno=432, end_col_offset=30), Name(id='meta_path', ctx=Load(), lineno=432, col_offset=32, end_lineno=432, end_col_offset=41)], ctx=Load(), lineno=432, col_offset=19, end_lineno=432, end_col_offset=42), lineno=432, col_offset=8, end_lineno=432, end_col_offset=42), Assign(targets=[Name(id='missing', ctx=Store(), lineno=433, col_offset=8, end_lineno=433, end_col_offset=15)], value=ListComp(elt=Name(id='path', ctx=Load(), lineno=433, col_offset=19, end_lineno=433, end_col_offset=23), generators=[comprehension(target=Name(id='path', ctx=Store(), lineno=433, col_offset=28, end_lineno=433, end_col_offset=32), iter=Name(id='expected', ctx=Load(), lineno=433, col_offset=36, end_lineno=433, end_col_offset=44), ifs=[UnaryOp(op=Not(), operand=Call(func=Attribute(value=Name(id='path', ctx=Load(), lineno=433, col_offset=52, end_lineno=433, end_col_offset=56), attr='exists', ctx=Load(), lineno=433, col_offset=52, end_lineno=433, end_col_offset=63), lineno=433, col_offset=52, end_lineno=433, end_col_offset=65), lineno=433, col_offset=48, end_lineno=433, end_col_offset=65)], is_async=0)], lineno=433, col_offset=18, end_lineno=433, end_col_offset=66), lineno=433, col_offset=8, end_lineno=433, end_col_offset=66), If(test=UnaryOp(op=Not(), operand=Name(id='missing', ctx=Load(), lineno=434, col_offset=15, end_lineno=434, end_col_offset=22), lineno=434, col_offset=11, end_lineno=434, end_col_offset=22), body=[Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=435, col_offset=19, end_lineno=435, end_col_offset=30), keywords=[keyword(arg='healthy', value=Constant(value=True, lineno=435, col_offset=39, end_lineno=435, end_col_offset=43), lineno=435, col_offset=31, end_lineno=435, end_col_offset=43)], lineno=435, col_offset=19, end_lineno=435, end_col_offset=44), lineno=435, col_offset=12, end_lineno=435, end_col_offset=44)], lineno=434, col_offset=8, end_lineno=435, end_col_offset=44), Assign(targets=[Name(id='detail', ctx=Store(), lineno=436, col_offset=8, end_lineno=436, end_col_offset=14)], value=JoinedStr(values=[Constant(value='Missing XTR artifacts: ', lineno=436, col_offset=19, end_lineno=436, end_col_offset=42), FormattedValue(value=Call(func=Attribute(value=Constant(value=', ', lineno=436, col_offset=43, end_lineno=436, end_col_offset=47), attr='join', ctx=Load(), lineno=436, col_offset=43, end_lineno=436, end_col_offset=52), args=[GeneratorExp(elt=Call(func=Name(id='str', ctx=Load(), lineno=436, col_offset=53, end_lineno=436, end_col_offset=56), args=[Name(id='path', ctx=Load(), lineno=436, col_offset=57, end_lineno=436, end_col_offset=61)], lineno=436, col_offset=53, end_lineno=436, end_col_offset=62), generators=[comprehension(target=Name(id='path', ctx=Store(), lineno=436, col_offset=67, end_lineno=436, end_col_offset=71), iter=Name(id='missing', ctx=Load(), lineno=436, col_offset=75, end_lineno=436, end_col_offset=82), is_async=0)], lineno=436, col_offset=52, end_lineno=436, end_col_offset=83)], lineno=436, col_offset=43, end_lineno=436, end_col_offset=83), conversion=-1, lineno=436, col_offset=42, end_lineno=436, end_col_offset=84)], lineno=436, col_offset=17, end_lineno=436, end_col_offset=85), lineno=436, col_offset=8, end_lineno=436, end_col_offset=85), If(test=Attribute(value=Name(id='cfg', ctx=Load(), lineno=437, col_offset=11, end_lineno=437, end_col_offset=14), attr='enable', ctx=Load(), lineno=437, col_offset=11, end_lineno=437, end_col_offset=21), body=[Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=438, col_offset=19, end_lineno=438, end_col_offset=30), keywords=[keyword(arg='healthy', value=Constant(value=False, lineno=438, col_offset=39, end_lineno=438, end_col_offset=44), lineno=438, col_offset=31, end_lineno=438, end_col_offset=44), keyword(arg='detail', value=Name(id='detail', ctx=Load(), lineno=438, col_offset=53, end_lineno=438, end_col_offset=59), lineno=438, col_offset=46, end_lineno=438, end_col_offset=59)], lineno=438, col_offset=19, end_lineno=438, end_col_offset=60), lineno=438, col_offset=12, end_lineno=438, end_col_offset=60)], lineno=437, col_offset=8, end_lineno=438, end_col_offset=60), Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=439, col_offset=15, end_lineno=439, end_col_offset=26), keywords=[keyword(arg='healthy', value=Constant(value=True, lineno=439, col_offset=35, end_lineno=439, end_col_offset=39), lineno=439, col_offset=27, end_lineno=439, end_col_offset=39), keyword(arg='detail', value=Name(id='detail', ctx=Load(), lineno=439, col_offset=48, end_lineno=439, end_col_offset=54), lineno=439, col_offset=41, end_lineno=439, end_col_offset=54)], lineno=439, col_offset=15, end_lineno=439, end_col_offset=55), lineno=439, col_offset=8, end_lineno=439, end_col_offset=55)], returns=Name(id='CheckResult', ctx=Load(), lineno=419, col_offset=38, end_lineno=419, end_col_offset=49), lineno=419, col_offset=4, end_lineno=439, end_col_offset=55), FunctionDef(name='_duckdb_table_exists', args=arguments(args=[arg(arg='conn', annotation=Attribute(value=Name(id='duckdb', ctx=Load(), lineno=442, col_offset=35, end_lineno=442, end_col_offset=41), attr='DuckDBPyConnection', ctx=Load(), lineno=442, col_offset=35, end_lineno=442, end_col_offset=60), lineno=442, col_offset=29, end_lineno=442, end_col_offset=60)]), body=[Expr(value=Constant(value='Return True when `chunks_materialized` table exists.\n\n        Parameters\n        ----------\n        conn : duckdb.DuckDBPyConnection\n            DuckDB database connection.\n\n        Returns\n        -------\n        bool\n            ``True`` when the materialized table exists, ``False`` otherwise.\n        ', lineno=443, col_offset=8, end_lineno=454, end_col_offset=11), lineno=443, col_offset=8, end_lineno=454, end_col_offset=11), Assign(targets=[Name(id='row', ctx=Store(), lineno=455, col_offset=8, end_lineno=455, end_col_offset=11)], value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=455, col_offset=14, end_lineno=455, end_col_offset=18), attr='execute', ctx=Load(), lineno=455, col_offset=14, end_lineno=455, end_col_offset=26), args=[Constant(value="\n            SELECT COUNT(*)\n            FROM information_schema.tables\n            WHERE table_schema = 'main'\n              AND table_name = 'chunks_materialized'\n            ", lineno=456, col_offset=12, end_lineno=461, end_col_offset=15)], lineno=455, col_offset=14, end_lineno=462, end_col_offset=9), attr='fetchone', ctx=Load(), lineno=455, col_offset=14, end_lineno=462, end_col_offset=18), lineno=455, col_offset=14, end_lineno=462, end_col_offset=20), lineno=455, col_offset=8, end_lineno=462, end_col_offset=20), Return(value=Call(func=Name(id='bool', ctx=Load(), lineno=463, col_offset=15, end_lineno=463, end_col_offset=19), args=[BoolOp(op=And(), values=[Name(id='row', ctx=Load(), lineno=463, col_offset=20, end_lineno=463, end_col_offset=23), Subscript(value=Name(id='row', ctx=Load(), lineno=463, col_offset=28, end_lineno=463, end_col_offset=31), slice=Constant(value=0, lineno=463, col_offset=32, end_lineno=463, end_col_offset=33), ctx=Load(), lineno=463, col_offset=28, end_lineno=463, end_col_offset=34)], lineno=463, col_offset=20, end_lineno=463, end_col_offset=34)], lineno=463, col_offset=15, end_lineno=463, end_col_offset=35), lineno=463, col_offset=8, end_lineno=463, end_col_offset=35)], decorator_list=[Name(id='staticmethod', ctx=Load(), lineno=441, col_offset=5, end_lineno=441, end_col_offset=17)], returns=Name(id='bool', ctx=Load(), lineno=442, col_offset=65, end_lineno=442, end_col_offset=69), lineno=442, col_offset=4, end_lineno=463, end_col_offset=35), FunctionDef(name='_duckdb_index_exists', args=arguments(args=[arg(arg='conn', annotation=Attribute(value=Name(id='duckdb', ctx=Load(), lineno=466, col_offset=35, end_lineno=466, end_col_offset=41), attr='DuckDBPyConnection', ctx=Load(), lineno=466, col_offset=35, end_lineno=466, end_col_offset=60), lineno=466, col_offset=29, end_lineno=466, end_col_offset=60)]), body=[Expr(value=Constant(value='Return True when `idx_chunks_materialized_uri` index exists.\n\n        Parameters\n        ----------\n        conn : duckdb.DuckDBPyConnection\n            DuckDB database connection.\n\n        Returns\n        -------\n        bool\n            ``True`` when the index exists, ``False`` otherwise.\n        ', lineno=467, col_offset=8, end_lineno=478, end_col_offset=11), lineno=467, col_offset=8, end_lineno=478, end_col_offset=11), Assign(targets=[Name(id='row', ctx=Store(), lineno=479, col_offset=8, end_lineno=479, end_col_offset=11)], value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=479, col_offset=14, end_lineno=479, end_col_offset=18), attr='execute', ctx=Load(), lineno=479, col_offset=14, end_lineno=479, end_col_offset=26), args=[Constant(value="\n            SELECT COUNT(*) FROM duckdb_indexes\n            WHERE table_name = 'chunks_materialized'\n              AND index_name = 'idx_chunks_materialized_uri'\n            ", lineno=480, col_offset=12, end_lineno=484, end_col_offset=15)], lineno=479, col_offset=14, end_lineno=485, end_col_offset=9), attr='fetchone', ctx=Load(), lineno=479, col_offset=14, end_lineno=485, end_col_offset=18), lineno=479, col_offset=14, end_lineno=485, end_col_offset=20), lineno=479, col_offset=8, end_lineno=485, end_col_offset=20), Return(value=Call(func=Name(id='bool', ctx=Load(), lineno=486, col_offset=15, end_lineno=486, end_col_offset=19), args=[BoolOp(op=And(), values=[Name(id='row', ctx=Load(), lineno=486, col_offset=20, end_lineno=486, end_col_offset=23), Subscript(value=Name(id='row', ctx=Load(), lineno=486, col_offset=28, end_lineno=486, end_col_offset=31), slice=Constant(value=0, lineno=486, col_offset=32, end_lineno=486, end_col_offset=33), ctx=Load(), lineno=486, col_offset=28, end_lineno=486, end_col_offset=34)], lineno=486, col_offset=20, end_lineno=486, end_col_offset=34)], lineno=486, col_offset=15, end_lineno=486, end_col_offset=35), lineno=486, col_offset=8, end_lineno=486, end_col_offset=35)], decorator_list=[Name(id='staticmethod', ctx=Load(), lineno=465, col_offset=5, end_lineno=465, end_col_offset=17)], returns=Name(id='bool', ctx=Load(), lineno=466, col_offset=65, end_lineno=466, end_col_offset=69), lineno=466, col_offset=4, end_lineno=486, end_col_offset=35), FunctionDef(name='_check_search_tools', args=arguments(), body=[Expr(value=Constant(value='Ensure either ripgrep or grep is available for text search.\n\n        Returns\n        -------\n        CheckResult\n            Healthy status if ripgrep or grep is available, otherwise error detail.\n        ', lineno=490, col_offset=8, end_lineno=496, end_col_offset=11), lineno=490, col_offset=8, end_lineno=496, end_col_offset=11), Assign(targets=[Name(id='rg_path', ctx=Store(), lineno=497, col_offset=8, end_lineno=497, end_col_offset=15)], value=Call(func=Attribute(value=Name(id='shutil', ctx=Load(), lineno=497, col_offset=18, end_lineno=497, end_col_offset=24), attr='which', ctx=Load(), lineno=497, col_offset=18, end_lineno=497, end_col_offset=30), args=[Constant(value='rg', lineno=497, col_offset=31, end_lineno=497, end_col_offset=35)], lineno=497, col_offset=18, end_lineno=497, end_col_offset=36), lineno=497, col_offset=8, end_lineno=497, end_col_offset=36), Assign(targets=[Name(id='grep_path', ctx=Store(), lineno=498, col_offset=8, end_lineno=498, end_col_offset=17)], value=Call(func=Attribute(value=Name(id='shutil', ctx=Load(), lineno=498, col_offset=20, end_lineno=498, end_col_offset=26), attr='which', ctx=Load(), lineno=498, col_offset=20, end_lineno=498, end_col_offset=32), args=[Constant(value='grep', lineno=498, col_offset=33, end_lineno=498, end_col_offset=39)], lineno=498, col_offset=20, end_lineno=498, end_col_offset=40), lineno=498, col_offset=8, end_lineno=498, end_col_offset=40), If(test=Name(id='rg_path', ctx=Load(), lineno=500, col_offset=11, end_lineno=500, end_col_offset=18), body=[Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=501, col_offset=19, end_lineno=501, end_col_offset=30), keywords=[keyword(arg='healthy', value=Constant(value=True, lineno=501, col_offset=39, end_lineno=501, end_col_offset=43), lineno=501, col_offset=31, end_lineno=501, end_col_offset=43)], lineno=501, col_offset=19, end_lineno=501, end_col_offset=44), lineno=501, col_offset=12, end_lineno=501, end_col_offset=44)], lineno=500, col_offset=8, end_lineno=501, end_col_offset=44), If(test=Name(id='grep_path', ctx=Load(), lineno=503, col_offset=11, end_lineno=503, end_col_offset=20), body=[Assign(targets=[Name(id='detail', ctx=Store(), lineno=504, col_offset=12, end_lineno=504, end_col_offset=18)], value=JoinedStr(values=[Constant(value='ripgrep (rg) not found; using grep fallback at ', lineno=504, col_offset=23, end_lineno=504, end_col_offset=70), FormattedValue(value=Name(id='grep_path', ctx=Load(), lineno=504, col_offset=71, end_lineno=504, end_col_offset=80), conversion=-1, lineno=504, col_offset=70, end_lineno=504, end_col_offset=81)], lineno=504, col_offset=21, end_lineno=504, end_col_offset=82), lineno=504, col_offset=12, end_lineno=504, end_col_offset=82), Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=505, col_offset=19, end_lineno=505, end_col_offset=30), keywords=[keyword(arg='healthy', value=Constant(value=True, lineno=505, col_offset=39, end_lineno=505, end_col_offset=43), lineno=505, col_offset=31, end_lineno=505, end_col_offset=43), keyword(arg='detail', value=Name(id='detail', ctx=Load(), lineno=505, col_offset=52, end_lineno=505, end_col_offset=58), lineno=505, col_offset=45, end_lineno=505, end_col_offset=58)], lineno=505, col_offset=19, end_lineno=505, end_col_offset=59), lineno=505, col_offset=12, end_lineno=505, end_col_offset=59)], lineno=503, col_offset=8, end_lineno=505, end_col_offset=59), Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=507, col_offset=15, end_lineno=507, end_col_offset=26), keywords=[keyword(arg='healthy', value=Constant(value=False, lineno=508, col_offset=20, end_lineno=508, end_col_offset=25), lineno=508, col_offset=12, end_lineno=508, end_col_offset=25), keyword(arg='detail', value=Constant(value='Search tooling unavailable: install ripgrep (rg) or provide grep on PATH.', lineno=509, col_offset=19, end_lineno=509, end_col_offset=94), lineno=509, col_offset=12, end_lineno=509, end_col_offset=94)], lineno=507, col_offset=15, end_lineno=510, end_col_offset=9), lineno=507, col_offset=8, end_lineno=510, end_col_offset=9)], decorator_list=[Name(id='staticmethod', ctx=Load(), lineno=488, col_offset=5, end_lineno=488, end_col_offset=17)], returns=Name(id='CheckResult', ctx=Load(), lineno=489, col_offset=33, end_lineno=489, end_col_offset=44), lineno=489, col_offset=4, end_lineno=510, end_col_offset=9), FunctionDef(name='check_vllm_connection', args=arguments(args=[arg(arg='self', lineno=512, col_offset=30, end_lineno=512, end_col_offset=34)]), body=[Expr(value=Constant(value='Verify vLLM availability for the configured execution mode.\n\n        Returns\n        -------\n        CheckResult\n            Result of the probe indicating health and optional detail.\n        ', lineno=513, col_offset=8, end_lineno=519, end_col_offset=11), lineno=513, col_offset=8, end_lineno=519, end_col_offset=11), Assign(targets=[Name(id='mode', ctx=Store(), lineno=520, col_offset=8, end_lineno=520, end_col_offset=12)], value=Call(func=Name(id='getattr', ctx=Load(), lineno=520, col_offset=15, end_lineno=520, end_col_offset=22), args=[Attribute(value=Attribute(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=520, col_offset=23, end_lineno=520, end_col_offset=27), attr='_context', ctx=Load(), lineno=520, col_offset=23, end_lineno=520, end_col_offset=36), attr='settings', ctx=Load(), lineno=520, col_offset=23, end_lineno=520, end_col_offset=45), attr='vllm', ctx=Load(), lineno=520, col_offset=23, end_lineno=520, end_col_offset=50), attr='run', ctx=Load(), lineno=520, col_offset=23, end_lineno=520, end_col_offset=54), Constant(value='mode', lineno=520, col_offset=56, end_lineno=520, end_col_offset=62), Constant(value='inprocess', lineno=520, col_offset=64, end_lineno=520, end_col_offset=75)], lineno=520, col_offset=15, end_lineno=520, end_col_offset=76), lineno=520, col_offset=8, end_lineno=520, end_col_offset=76), If(test=Compare(left=Name(id='mode', ctx=Load(), lineno=521, col_offset=11, end_lineno=521, end_col_offset=15), ops=[Eq()], comparators=[Constant(value='http', lineno=521, col_offset=19, end_lineno=521, end_col_offset=25)], lineno=521, col_offset=11, end_lineno=521, end_col_offset=25), body=[Return(value=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=522, col_offset=19, end_lineno=522, end_col_offset=23), attr='_check_vllm_http', ctx=Load(), lineno=522, col_offset=19, end_lineno=522, end_col_offset=40), args=[Attribute(value=Attribute(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=522, col_offset=41, end_lineno=522, end_col_offset=45), attr='_context', ctx=Load(), lineno=522, col_offset=41, end_lineno=522, end_col_offset=54), attr='settings', ctx=Load(), lineno=522, col_offset=41, end_lineno=522, end_col_offset=63), attr='vllm', ctx=Load(), lineno=522, col_offset=41, end_lineno=522, end_col_offset=68), attr='base_url', ctx=Load(), lineno=522, col_offset=41, end_lineno=522, end_col_offset=77)], lineno=522, col_offset=19, end_lineno=522, end_col_offset=78), lineno=522, col_offset=12, end_lineno=522, end_col_offset=78)], lineno=521, col_offset=8, end_lineno=522, end_col_offset=78), Return(value=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=523, col_offset=15, end_lineno=523, end_col_offset=19), attr='_check_vllm_inprocess', ctx=Load(), lineno=523, col_offset=15, end_lineno=523, end_col_offset=41), lineno=523, col_offset=15, end_lineno=523, end_col_offset=43), lineno=523, col_offset=8, end_lineno=523, end_col_offset=43)], returns=Name(id='CheckResult', ctx=Load(), lineno=512, col_offset=39, end_lineno=512, end_col_offset=50), lineno=512, col_offset=4, end_lineno=523, end_col_offset=43), FunctionDef(name='_check_vllm_inprocess', args=arguments(args=[arg(arg='self', lineno=525, col_offset=30, end_lineno=525, end_col_offset=34)]), body=[Expr(value=Constant(value='Perform an embedding smoke test when running vLLM in-process.\n\n        Returns\n        -------\n        CheckResult\n            Healthy status along with diagnostic detail when failures occur.\n        ', lineno=526, col_offset=8, end_lineno=532, end_col_offset=11), lineno=526, col_offset=8, end_lineno=532, end_col_offset=11), Assign(targets=[Name(id='client', ctx=Store(), lineno=533, col_offset=8, end_lineno=533, end_col_offset=14)], value=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=533, col_offset=17, end_lineno=533, end_col_offset=21), attr='_context', ctx=Load(), lineno=533, col_offset=17, end_lineno=533, end_col_offset=30), attr='vllm_client', ctx=Load(), lineno=533, col_offset=17, end_lineno=533, end_col_offset=42), lineno=533, col_offset=8, end_lineno=533, end_col_offset=42), Try(body=[Assign(targets=[Name(id='vectors', ctx=Store(), lineno=535, col_offset=12, end_lineno=535, end_col_offset=19)], value=Call(func=Attribute(value=Name(id='client', ctx=Load(), lineno=535, col_offset=22, end_lineno=535, end_col_offset=28), attr='embed_batch', ctx=Load(), lineno=535, col_offset=22, end_lineno=535, end_col_offset=40), args=[List(elts=[Constant(value='__readyz__', lineno=535, col_offset=42, end_lineno=535, end_col_offset=54)], ctx=Load(), lineno=535, col_offset=41, end_lineno=535, end_col_offset=55)], lineno=535, col_offset=22, end_lineno=535, end_col_offset=56), lineno=535, col_offset=12, end_lineno=535, end_col_offset=56)], handlers=[ExceptHandler(type=Tuple(elts=[Name(id='RuntimeError', ctx=Load(), lineno=536, col_offset=16, end_lineno=536, end_col_offset=28), Name(id='ValueError', ctx=Load(), lineno=536, col_offset=30, end_lineno=536, end_col_offset=40)], ctx=Load(), lineno=536, col_offset=15, end_lineno=536, end_col_offset=41), name='exc', body=[Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=537, col_offset=19, end_lineno=537, end_col_offset=30), keywords=[keyword(arg='healthy', value=Constant(value=False, lineno=538, col_offset=24, end_lineno=538, end_col_offset=29), lineno=538, col_offset=16, end_lineno=538, end_col_offset=29), keyword(arg='detail', value=JoinedStr(values=[Constant(value='vLLM in-process embedding failed: ', lineno=539, col_offset=25, end_lineno=539, end_col_offset=59), FormattedValue(value=Name(id='exc', ctx=Load(), lineno=539, col_offset=60, end_lineno=539, end_col_offset=63), conversion=-1, lineno=539, col_offset=59, end_lineno=539, end_col_offset=64)], lineno=539, col_offset=23, end_lineno=539, end_col_offset=65), lineno=539, col_offset=16, end_lineno=539, end_col_offset=65)], lineno=537, col_offset=19, end_lineno=540, end_col_offset=13), lineno=537, col_offset=12, end_lineno=540, end_col_offset=13)], lineno=536, col_offset=8, end_lineno=540, end_col_offset=13)], lineno=534, col_offset=8, end_lineno=540, end_col_offset=13), Assign(targets=[Name(id='shape', ctx=Store(), lineno=541, col_offset=8, end_lineno=541, end_col_offset=13)], value=Call(func=Name(id='getattr', ctx=Load(), lineno=541, col_offset=16, end_lineno=541, end_col_offset=23), args=[Name(id='vectors', ctx=Load(), lineno=541, col_offset=24, end_lineno=541, end_col_offset=31), Constant(value='shape', lineno=541, col_offset=33, end_lineno=541, end_col_offset=40), Constant(value=None, lineno=541, col_offset=42, end_lineno=541, end_col_offset=46)], lineno=541, col_offset=16, end_lineno=541, end_col_offset=47), lineno=541, col_offset=8, end_lineno=541, end_col_offset=47), If(test=BoolOp(op=Or(), values=[UnaryOp(op=Not(), operand=Name(id='shape', ctx=Load(), lineno=542, col_offset=15, end_lineno=542, end_col_offset=20), lineno=542, col_offset=11, end_lineno=542, end_col_offset=20), Compare(left=Call(func=Name(id='len', ctx=Load(), lineno=542, col_offset=24, end_lineno=542, end_col_offset=27), args=[Name(id='shape', ctx=Load(), lineno=542, col_offset=28, end_lineno=542, end_col_offset=33)], lineno=542, col_offset=24, end_lineno=542, end_col_offset=34), ops=[NotEq()], comparators=[Name(id='_EMBED_BATCH_RANK', ctx=Load(), lineno=542, col_offset=38, end_lineno=542, end_col_offset=55)], lineno=542, col_offset=24, end_lineno=542, end_col_offset=55), Compare(left=Subscript(value=Name(id='shape', ctx=Load(), lineno=542, col_offset=59, end_lineno=542, end_col_offset=64), slice=Constant(value=0, lineno=542, col_offset=65, end_lineno=542, end_col_offset=66), ctx=Load(), lineno=542, col_offset=59, end_lineno=542, end_col_offset=67), ops=[NotEq()], comparators=[Name(id='_EMBED_BATCH_MIN_ROWS', ctx=Load(), lineno=542, col_offset=71, end_lineno=542, end_col_offset=92)], lineno=542, col_offset=59, end_lineno=542, end_col_offset=92)], lineno=542, col_offset=11, end_lineno=542, end_col_offset=92), body=[Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=543, col_offset=19, end_lineno=543, end_col_offset=30), keywords=[keyword(arg='healthy', value=Constant(value=False, lineno=544, col_offset=24, end_lineno=544, end_col_offset=29), lineno=544, col_offset=16, end_lineno=544, end_col_offset=29), keyword(arg='detail', value=JoinedStr(values=[Constant(value='Unexpected embedding output shape: ', lineno=545, col_offset=25, end_lineno=545, end_col_offset=60), FormattedValue(value=Name(id='shape', ctx=Load(), lineno=545, col_offset=61, end_lineno=545, end_col_offset=66), conversion=-1, lineno=545, col_offset=60, end_lineno=545, end_col_offset=67)], lineno=545, col_offset=23, end_lineno=545, end_col_offset=68), lineno=545, col_offset=16, end_lineno=545, end_col_offset=68)], lineno=543, col_offset=19, end_lineno=546, end_col_offset=13), lineno=543, col_offset=12, end_lineno=546, end_col_offset=13)], lineno=542, col_offset=8, end_lineno=546, end_col_offset=13), Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=547, col_offset=15, end_lineno=547, end_col_offset=26), keywords=[keyword(arg='healthy', value=Constant(value=True, lineno=547, col_offset=35, end_lineno=547, end_col_offset=39), lineno=547, col_offset=27, end_lineno=547, end_col_offset=39)], lineno=547, col_offset=15, end_lineno=547, end_col_offset=40), lineno=547, col_offset=8, end_lineno=547, end_col_offset=40)], returns=Name(id='CheckResult', ctx=Load(), lineno=525, col_offset=39, end_lineno=525, end_col_offset=50), lineno=525, col_offset=4, end_lineno=547, end_col_offset=40), FunctionDef(name='_check_vllm_http', args=arguments(args=[arg(arg='base_url', annotation=Name(id='str', ctx=Load(), lineno=550, col_offset=35, end_lineno=550, end_col_offset=38), lineno=550, col_offset=25, end_lineno=550, end_col_offset=38)]), body=[Expr(value=Constant(value='Validate HTTP vLLM endpoint reachability.\n\n        Extended Summary\n        ----------------\n        This static method performs a health check on a remote vLLM HTTP endpoint\n        by sending a GET request to the /health endpoint. It validates the URL format,\n        checks connectivity, and verifies that the endpoint returns a successful HTTP\n        status code. This is used by the readiness probe to determine if the vLLM\n        service is available and responding correctly when running in HTTP mode.\n\n        Parameters\n        ----------\n        base_url : str\n            Base URL of the vLLM HTTP service (e.g., "http://localhost:8001/v1").\n            Must be a valid HTTP or HTTPS URL with a netloc component. Invalid URLs\n            result in an unhealthy CheckResult.\n\n        Returns\n        -------\n        CheckResult\n            Status representing endpoint availability. healthy=True if the endpoint\n            responds successfully, healthy=False with detail message if the endpoint\n            is unreachable, returns an error status, or the URL is invalid.\n\n        Notes\n        -----\n        Time complexity O(1) plus network latency. Space complexity O(1) aside from\n        HTTP response buffers. The method performs network I/O with a timeout defined\n        by HTTP_HEALTH_TIMEOUT_S. Thread-safe as it\'s a static method with no shared\n        state. Network errors are caught and converted to unhealthy CheckResult.\n        ', lineno=551, col_offset=8, end_lineno=581, end_col_offset=11), lineno=551, col_offset=8, end_lineno=581, end_col_offset=11), Assign(targets=[Name(id='parsed', ctx=Store(), lineno=582, col_offset=8, end_lineno=582, end_col_offset=14)], value=Call(func=Name(id='urlparse', ctx=Load(), lineno=582, col_offset=17, end_lineno=582, end_col_offset=25), args=[Name(id='base_url', ctx=Load(), lineno=582, col_offset=26, end_lineno=582, end_col_offset=34)], lineno=582, col_offset=17, end_lineno=582, end_col_offset=35), lineno=582, col_offset=8, end_lineno=582, end_col_offset=35), If(test=BoolOp(op=Or(), values=[Compare(left=Attribute(value=Name(id='parsed', ctx=Load(), lineno=583, col_offset=11, end_lineno=583, end_col_offset=17), attr='scheme', ctx=Load(), lineno=583, col_offset=11, end_lineno=583, end_col_offset=24), ops=[NotIn()], comparators=[Set(elts=[Constant(value='http', lineno=583, col_offset=33, end_lineno=583, end_col_offset=39), Constant(value='https', lineno=583, col_offset=41, end_lineno=583, end_col_offset=48)], lineno=583, col_offset=32, end_lineno=583, end_col_offset=49)], lineno=583, col_offset=11, end_lineno=583, end_col_offset=49), UnaryOp(op=Not(), operand=Attribute(value=Name(id='parsed', ctx=Load(), lineno=583, col_offset=57, end_lineno=583, end_col_offset=63), attr='netloc', ctx=Load(), lineno=583, col_offset=57, end_lineno=583, end_col_offset=70), lineno=583, col_offset=53, end_lineno=583, end_col_offset=70)], lineno=583, col_offset=11, end_lineno=583, end_col_offset=70), body=[Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=584, col_offset=19, end_lineno=584, end_col_offset=30), keywords=[keyword(arg='healthy', value=Constant(value=False, lineno=585, col_offset=24, end_lineno=585, end_col_offset=29), lineno=585, col_offset=16, end_lineno=585, end_col_offset=29), keyword(arg='detail', value=JoinedStr(values=[Constant(value='Invalid vLLM endpoint URL: ', lineno=586, col_offset=25, end_lineno=586, end_col_offset=52), FormattedValue(value=Name(id='base_url', ctx=Load(), lineno=586, col_offset=53, end_lineno=586, end_col_offset=61), conversion=-1, lineno=586, col_offset=52, end_lineno=586, end_col_offset=62)], lineno=586, col_offset=23, end_lineno=586, end_col_offset=63), lineno=586, col_offset=16, end_lineno=586, end_col_offset=63)], lineno=584, col_offset=19, end_lineno=587, end_col_offset=13), lineno=584, col_offset=12, end_lineno=587, end_col_offset=13)], lineno=583, col_offset=8, end_lineno=587, end_col_offset=13), Try(body=[With(items=[withitem(context_expr=Call(func=Attribute(value=Name(id='httpx', ctx=Load(), lineno=589, col_offset=17, end_lineno=589, end_col_offset=22), attr='Client', ctx=Load(), lineno=589, col_offset=17, end_lineno=589, end_col_offset=29), keywords=[keyword(arg='timeout', value=Name(id='HTTP_HEALTH_TIMEOUT_S', ctx=Load(), lineno=589, col_offset=38, end_lineno=589, end_col_offset=59), lineno=589, col_offset=30, end_lineno=589, end_col_offset=59)], lineno=589, col_offset=17, end_lineno=589, end_col_offset=60), optional_vars=Name(id='client', ctx=Store(), lineno=589, col_offset=64, end_lineno=589, end_col_offset=70))], body=[Assign(targets=[Name(id='response', ctx=Store(), lineno=590, col_offset=16, end_lineno=590, end_col_offset=24)], value=Call(func=Attribute(value=Name(id='client', ctx=Load(), lineno=590, col_offset=27, end_lineno=590, end_col_offset=33), attr='get', ctx=Load(), lineno=590, col_offset=27, end_lineno=590, end_col_offset=37), args=[JoinedStr(values=[FormattedValue(value=Name(id='base_url', ctx=Load(), lineno=590, col_offset=41, end_lineno=590, end_col_offset=49), conversion=-1, lineno=590, col_offset=40, end_lineno=590, end_col_offset=50), Constant(value='/health', lineno=590, col_offset=50, end_lineno=590, end_col_offset=57)], lineno=590, col_offset=38, end_lineno=590, end_col_offset=58)], keywords=[keyword(arg='follow_redirects', value=Constant(value=True, lineno=590, col_offset=77, end_lineno=590, end_col_offset=81), lineno=590, col_offset=60, end_lineno=590, end_col_offset=81)], lineno=590, col_offset=27, end_lineno=590, end_col_offset=82), lineno=590, col_offset=16, end_lineno=590, end_col_offset=82), If(test=Attribute(value=Name(id='response', ctx=Load(), lineno=591, col_offset=19, end_lineno=591, end_col_offset=27), attr='is_success', ctx=Load(), lineno=591, col_offset=19, end_lineno=591, end_col_offset=38), body=[Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=592, col_offset=27, end_lineno=592, end_col_offset=38), keywords=[keyword(arg='healthy', value=Constant(value=True, lineno=592, col_offset=47, end_lineno=592, end_col_offset=51), lineno=592, col_offset=39, end_lineno=592, end_col_offset=51)], lineno=592, col_offset=27, end_lineno=592, end_col_offset=52), lineno=592, col_offset=20, end_lineno=592, end_col_offset=52)], lineno=591, col_offset=16, end_lineno=592, end_col_offset=52), Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=593, col_offset=23, end_lineno=593, end_col_offset=34), keywords=[keyword(arg='healthy', value=Constant(value=False, lineno=594, col_offset=28, end_lineno=594, end_col_offset=33), lineno=594, col_offset=20, end_lineno=594, end_col_offset=33), keyword(arg='detail', value=JoinedStr(values=[Constant(value='vLLM health check failed: HTTP ', lineno=595, col_offset=29, end_lineno=595, end_col_offset=60), FormattedValue(value=Attribute(value=Name(id='response', ctx=Load(), lineno=595, col_offset=61, end_lineno=595, end_col_offset=69), attr='status_code', ctx=Load(), lineno=595, col_offset=61, end_lineno=595, end_col_offset=81), conversion=-1, lineno=595, col_offset=60, end_lineno=595, end_col_offset=82)], lineno=595, col_offset=27, end_lineno=595, end_col_offset=83), lineno=595, col_offset=20, end_lineno=595, end_col_offset=83)], lineno=593, col_offset=23, end_lineno=596, end_col_offset=17), lineno=593, col_offset=16, end_lineno=596, end_col_offset=17)], lineno=589, col_offset=12, end_lineno=596, end_col_offset=17)], handlers=[ExceptHandler(type=Attribute(value=Name(id='httpx', ctx=Load(), lineno=597, col_offset=15, end_lineno=597, end_col_offset=20), attr='HTTPError', ctx=Load(), lineno=597, col_offset=15, end_lineno=597, end_col_offset=30), name='exc', body=[Return(value=Call(func=Name(id='CheckResult', ctx=Load(), lineno=598, col_offset=19, end_lineno=598, end_col_offset=30), keywords=[keyword(arg='healthy', value=Constant(value=False, lineno=599, col_offset=24, end_lineno=599, end_col_offset=29), lineno=599, col_offset=16, end_lineno=599, end_col_offset=29), keyword(arg='detail', value=JoinedStr(values=[Constant(value='vLLM service unreachable: ', lineno=600, col_offset=25, end_lineno=600, end_col_offset=51), FormattedValue(value=Name(id='exc', ctx=Load(), lineno=600, col_offset=52, end_lineno=600, end_col_offset=55), conversion=-1, lineno=600, col_offset=51, end_lineno=600, end_col_offset=56)], lineno=600, col_offset=23, end_lineno=600, end_col_offset=57), lineno=600, col_offset=16, end_lineno=600, end_col_offset=57)], lineno=598, col_offset=19, end_lineno=601, end_col_offset=13), lineno=598, col_offset=12, end_lineno=601, end_col_offset=13)], lineno=597, col_offset=8, end_lineno=601, end_col_offset=13)], lineno=588, col_offset=8, end_lineno=601, end_col_offset=13)], decorator_list=[Name(id='staticmethod', ctx=Load(), lineno=549, col_offset=5, end_lineno=549, end_col_offset=17)], returns=Name(id='CheckResult', ctx=Load(), lineno=550, col_offset=43, end_lineno=550, end_col_offset=54), lineno=550, col_offset=4, end_lineno=601, end_col_offset=13)], lineno=106, col_offset=0, end_lineno=601, end_col_offset=13)])