Module(body=[ImportFrom(module='__future__', names=[alias(name='annotations', lineno=1, col_offset=23, end_lineno=1, end_col_offset=34)], level=0, lineno=1, col_offset=0, end_lineno=1, end_col_offset=34), ImportFrom(module='pathlib', names=[alias(name='Path', lineno=3, col_offset=20, end_lineno=3, end_col_offset=24)], level=0, lineno=3, col_offset=0, end_lineno=3, end_col_offset=24), Import(names=[alias(name='pytest', lineno=5, col_offset=7, end_lineno=5, end_col_offset=13)], lineno=5, col_offset=0, end_lineno=5, end_col_offset=13), ImportFrom(module='tools', names=[alias(name='CliRunConfig', lineno=6, col_offset=18, end_lineno=6, end_col_offset=30), alias(name='Paths', lineno=6, col_offset=32, end_lineno=6, end_col_offset=37), alias(name='cli_run', lineno=6, col_offset=39, end_lineno=6, end_col_offset=46)], level=0, lineno=6, col_offset=0, end_lineno=6, end_col_offset=46), FunctionDef(name='_stub_paths', args=arguments(args=[arg(arg='tmp_path', annotation=Name(id='Path', ctx=Load(), lineno=9, col_offset=26, end_lineno=9, end_col_offset=30), lineno=9, col_offset=16, end_lineno=9, end_col_offset=30)]), body=[Return(value=Call(func=Name(id='Paths', ctx=Load(), lineno=10, col_offset=11, end_lineno=10, end_col_offset=16), keywords=[keyword(arg='repo_root', value=Name(id='tmp_path', ctx=Load(), lineno=11, col_offset=18, end_lineno=11, end_col_offset=26), lineno=11, col_offset=8, end_lineno=11, end_col_offset=26), keyword(arg='docs_data', value=BinOp(left=Name(id='tmp_path', ctx=Load(), lineno=12, col_offset=18, end_lineno=12, end_col_offset=26), op=Div(), right=Constant(value='docs/_data', lineno=12, col_offset=29, end_lineno=12, end_col_offset=41), lineno=12, col_offset=18, end_lineno=12, end_col_offset=41), lineno=12, col_offset=8, end_lineno=12, end_col_offset=41), keyword(arg='cli_out_root', value=BinOp(left=Name(id='tmp_path', ctx=Load(), lineno=13, col_offset=21, end_lineno=13, end_col_offset=29), op=Div(), right=Constant(value='docs/_data/cli', lineno=13, col_offset=32, end_lineno=13, end_col_offset=48), lineno=13, col_offset=21, end_lineno=13, end_col_offset=48), lineno=13, col_offset=8, end_lineno=13, end_col_offset=48)], lineno=10, col_offset=11, end_lineno=14, end_col_offset=5), lineno=10, col_offset=4, end_lineno=14, end_col_offset=5)], returns=Name(id='Paths', ctx=Load(), lineno=9, col_offset=35, end_lineno=9, end_col_offset=40), lineno=9, col_offset=0, end_lineno=14, end_col_offset=5), FunctionDef(name='test_success', args=arguments(args=[arg(arg='tmp_path', annotation=Name(id='Path', ctx=Load(), lineno=17, col_offset=27, end_lineno=17, end_col_offset=31), lineno=17, col_offset=17, end_lineno=17, end_col_offset=31), arg(arg='monkeypatch', annotation=Attribute(value=Name(id='pytest', ctx=Load(), lineno=17, col_offset=46, end_lineno=17, end_col_offset=52), attr='MonkeyPatch', ctx=Load(), lineno=17, col_offset=46, end_lineno=17, end_col_offset=64), lineno=17, col_offset=33, end_lineno=17, end_col_offset=64)]), body=[Expr(value=Call(func=Attribute(value=Name(id='monkeypatch', ctx=Load(), lineno=18, col_offset=4, end_lineno=18, end_col_offset=15), attr='setattr', ctx=Load(), lineno=18, col_offset=4, end_lineno=18, end_col_offset=23), args=[Name(id='Paths', ctx=Load(), lineno=18, col_offset=24, end_lineno=18, end_col_offset=29), Constant(value='discover', lineno=18, col_offset=31, end_lineno=18, end_col_offset=41), Call(func=Name(id='staticmethod', ctx=Load(), lineno=18, col_offset=43, end_lineno=18, end_col_offset=55), args=[Lambda(args=arguments(), body=Call(func=Name(id='_stub_paths', ctx=Load(), lineno=18, col_offset=64, end_lineno=18, end_col_offset=75), args=[Name(id='tmp_path', ctx=Load(), lineno=18, col_offset=76, end_lineno=18, end_col_offset=84)], lineno=18, col_offset=64, end_lineno=18, end_col_offset=85), lineno=18, col_offset=56, end_lineno=18, end_col_offset=85)], lineno=18, col_offset=43, end_lineno=18, end_col_offset=86)], lineno=18, col_offset=4, end_lineno=18, end_col_offset=87), lineno=18, col_offset=4, end_lineno=18, end_col_offset=87), Assign(targets=[Name(id='cfg', ctx=Store(), lineno=19, col_offset=4, end_lineno=19, end_col_offset=7)], value=Call(func=Attribute(value=Name(id='CliRunConfig', ctx=Load(), lineno=19, col_offset=10, end_lineno=19, end_col_offset=22), attr='from_route', ctx=Load(), lineno=19, col_offset=10, end_lineno=19, end_col_offset=33), args=[Constant(value='demo', lineno=19, col_offset=34, end_lineno=19, end_col_offset=40), Constant(value='ok', lineno=19, col_offset=42, end_lineno=19, end_col_offset=46)], keywords=[keyword(arg='write_envelope_on', value=Constant(value='always', lineno=19, col_offset=66, end_lineno=19, end_col_offset=74), lineno=19, col_offset=48, end_lineno=19, end_col_offset=74), keyword(arg='exit_on_error', value=Constant(value=False, lineno=19, col_offset=90, end_lineno=19, end_col_offset=95), lineno=19, col_offset=76, end_lineno=19, end_col_offset=95)], lineno=19, col_offset=10, end_lineno=19, end_col_offset=96), lineno=19, col_offset=4, end_lineno=19, end_col_offset=96), With(items=[withitem(context_expr=Call(func=Name(id='cli_run', ctx=Load(), lineno=20, col_offset=9, end_lineno=20, end_col_offset=16), args=[Name(id='cfg', ctx=Load(), lineno=20, col_offset=17, end_lineno=20, end_col_offset=20)], lineno=20, col_offset=9, end_lineno=20, end_col_offset=21), optional_vars=Tuple(elts=[Name(id='context', ctx=Store(), lineno=20, col_offset=26, end_lineno=20, end_col_offset=33), Name(id='envelope', ctx=Store(), lineno=20, col_offset=35, end_lineno=20, end_col_offset=43)], ctx=Store(), lineno=20, col_offset=25, end_lineno=20, end_col_offset=44))], body=[Assert(test=Compare(left=Attribute(value=Name(id='context', ctx=Load(), lineno=21, col_offset=15, end_lineno=21, end_col_offset=22), attr='operation', ctx=Load(), lineno=21, col_offset=15, end_lineno=21, end_col_offset=32), ops=[Eq()], comparators=[Constant(value='demo.ok', lineno=21, col_offset=36, end_lineno=21, end_col_offset=45)], lineno=21, col_offset=15, end_lineno=21, end_col_offset=45), lineno=21, col_offset=8, end_lineno=21, end_col_offset=45), Expr(value=Call(func=Attribute(value=Name(id='envelope', ctx=Load(), lineno=22, col_offset=8, end_lineno=22, end_col_offset=16), attr='set_result', ctx=Load(), lineno=22, col_offset=8, end_lineno=22, end_col_offset=27), keywords=[keyword(arg='summary', value=Constant(value='ok', lineno=22, col_offset=36, end_lineno=22, end_col_offset=40), lineno=22, col_offset=28, end_lineno=22, end_col_offset=40)], lineno=22, col_offset=8, end_lineno=22, end_col_offset=41), lineno=22, col_offset=8, end_lineno=22, end_col_offset=41)], lineno=20, col_offset=4, end_lineno=22, end_col_offset=41), Assign(targets=[Name(id='out_dir', ctx=Store(), lineno=25, col_offset=4, end_lineno=25, end_col_offset=11)], value=BinOp(left=Name(id='tmp_path', ctx=Load(), lineno=25, col_offset=14, end_lineno=25, end_col_offset=22), op=Div(), right=Constant(value='docs/_data/cli/demo/ok', lineno=25, col_offset=25, end_lineno=25, end_col_offset=49), lineno=25, col_offset=14, end_lineno=25, end_col_offset=49), lineno=25, col_offset=4, end_lineno=25, end_col_offset=49), Assign(targets=[Name(id='paths', ctx=Store(), lineno=26, col_offset=4, end_lineno=26, end_col_offset=9)], value=Call(func=Name(id='sorted', ctx=Load(), lineno=26, col_offset=12, end_lineno=26, end_col_offset=18), args=[Call(func=Attribute(value=Name(id='out_dir', ctx=Load(), lineno=26, col_offset=19, end_lineno=26, end_col_offset=26), attr='glob', ctx=Load(), lineno=26, col_offset=19, end_lineno=26, end_col_offset=31), args=[Constant(value='*.json', lineno=26, col_offset=32, end_lineno=26, end_col_offset=40)], lineno=26, col_offset=19, end_lineno=26, end_col_offset=41)], lineno=26, col_offset=12, end_lineno=26, end_col_offset=42), lineno=26, col_offset=4, end_lineno=26, end_col_offset=42), Assert(test=Compare(left=Call(func=Name(id='len', ctx=Load(), lineno=27, col_offset=11, end_lineno=27, end_col_offset=14), args=[Name(id='paths', ctx=Load(), lineno=27, col_offset=15, end_lineno=27, end_col_offset=20)], lineno=27, col_offset=11, end_lineno=27, end_col_offset=21), ops=[Eq()], comparators=[Constant(value=1, lineno=27, col_offset=25, end_lineno=27, end_col_offset=26)], lineno=27, col_offset=11, end_lineno=27, end_col_offset=26), lineno=27, col_offset=4, end_lineno=27, end_col_offset=26), Assign(targets=[Name(id='data', ctx=Store(), lineno=28, col_offset=4, end_lineno=28, end_col_offset=8)], value=Call(func=Attribute(value=Subscript(value=Name(id='paths', ctx=Load(), lineno=28, col_offset=11, end_lineno=28, end_col_offset=16), slice=Constant(value=0, lineno=28, col_offset=17, end_lineno=28, end_col_offset=18), ctx=Load(), lineno=28, col_offset=11, end_lineno=28, end_col_offset=19), attr='read_text', ctx=Load(), lineno=28, col_offset=11, end_lineno=28, end_col_offset=29), lineno=28, col_offset=11, end_lineno=28, end_col_offset=31), lineno=28, col_offset=4, end_lineno=28, end_col_offset=31), Assert(test=Compare(left=Constant(value='"status": "success"', lineno=29, col_offset=11, end_lineno=29, end_col_offset=32), ops=[In()], comparators=[Name(id='data', ctx=Load(), lineno=29, col_offset=36, end_lineno=29, end_col_offset=40)], lineno=29, col_offset=11, end_lineno=29, end_col_offset=40), lineno=29, col_offset=4, end_lineno=29, end_col_offset=40), Assert(test=Compare(left=Constant(value='"operation": "demo.ok"', lineno=30, col_offset=11, end_lineno=30, end_col_offset=35), ops=[In()], comparators=[Name(id='data', ctx=Load(), lineno=30, col_offset=39, end_lineno=30, end_col_offset=43)], lineno=30, col_offset=11, end_lineno=30, end_col_offset=43), lineno=30, col_offset=4, end_lineno=30, end_col_offset=43)], returns=Constant(value=None, lineno=17, col_offset=69, end_lineno=17, end_col_offset=73), lineno=17, col_offset=0, end_lineno=30, end_col_offset=43), FunctionDef(name='test_error', args=arguments(args=[arg(arg='tmp_path', annotation=Name(id='Path', ctx=Load(), lineno=33, col_offset=25, end_lineno=33, end_col_offset=29), lineno=33, col_offset=15, end_lineno=33, end_col_offset=29), arg(arg='monkeypatch', annotation=Attribute(value=Name(id='pytest', ctx=Load(), lineno=33, col_offset=44, end_lineno=33, end_col_offset=50), attr='MonkeyPatch', ctx=Load(), lineno=33, col_offset=44, end_lineno=33, end_col_offset=62), lineno=33, col_offset=31, end_lineno=33, end_col_offset=62)]), body=[Expr(value=Call(func=Attribute(value=Name(id='monkeypatch', ctx=Load(), lineno=34, col_offset=4, end_lineno=34, end_col_offset=15), attr='setattr', ctx=Load(), lineno=34, col_offset=4, end_lineno=34, end_col_offset=23), args=[Name(id='Paths', ctx=Load(), lineno=34, col_offset=24, end_lineno=34, end_col_offset=29), Constant(value='discover', lineno=34, col_offset=31, end_lineno=34, end_col_offset=41), Call(func=Name(id='staticmethod', ctx=Load(), lineno=34, col_offset=43, end_lineno=34, end_col_offset=55), args=[Lambda(args=arguments(), body=Call(func=Name(id='_stub_paths', ctx=Load(), lineno=34, col_offset=64, end_lineno=34, end_col_offset=75), args=[Name(id='tmp_path', ctx=Load(), lineno=34, col_offset=76, end_lineno=34, end_col_offset=84)], lineno=34, col_offset=64, end_lineno=34, end_col_offset=85), lineno=34, col_offset=56, end_lineno=34, end_col_offset=85)], lineno=34, col_offset=43, end_lineno=34, end_col_offset=86)], lineno=34, col_offset=4, end_lineno=34, end_col_offset=87), lineno=34, col_offset=4, end_lineno=34, end_col_offset=87), Assign(targets=[Name(id='cfg', ctx=Store(), lineno=35, col_offset=4, end_lineno=35, end_col_offset=7)], value=Call(func=Attribute(value=Name(id='CliRunConfig', ctx=Load(), lineno=35, col_offset=10, end_lineno=35, end_col_offset=22), attr='from_route', ctx=Load(), lineno=35, col_offset=10, end_lineno=35, end_col_offset=33), args=[Constant(value='demo', lineno=35, col_offset=34, end_lineno=35, end_col_offset=40), Constant(value='fail', lineno=35, col_offset=42, end_lineno=35, end_col_offset=48)], keywords=[keyword(arg='write_envelope_on', value=Constant(value='always', lineno=35, col_offset=68, end_lineno=35, end_col_offset=76), lineno=35, col_offset=50, end_lineno=35, end_col_offset=76), keyword(arg='exit_on_error', value=Constant(value=False, lineno=35, col_offset=92, end_lineno=35, end_col_offset=97), lineno=35, col_offset=78, end_lineno=35, end_col_offset=97)], lineno=35, col_offset=10, end_lineno=35, end_col_offset=98), lineno=35, col_offset=4, end_lineno=35, end_col_offset=98), FunctionDef(name='_invoke_failure', args=arguments(), body=[With(items=[withitem(context_expr=Call(func=Name(id='cli_run', ctx=Load(), lineno=38, col_offset=13, end_lineno=38, end_col_offset=20), args=[Name(id='cfg', ctx=Load(), lineno=38, col_offset=21, end_lineno=38, end_col_offset=24)], lineno=38, col_offset=13, end_lineno=38, end_col_offset=25), optional_vars=Tuple(elts=[Name(id='context', ctx=Store(), lineno=38, col_offset=30, end_lineno=38, end_col_offset=37), Name(id='_', ctx=Store(), lineno=38, col_offset=39, end_lineno=38, end_col_offset=40)], ctx=Store(), lineno=38, col_offset=29, end_lineno=38, end_col_offset=41))], body=[Assert(test=Compare(left=Attribute(value=Name(id='context', ctx=Load(), lineno=39, col_offset=19, end_lineno=39, end_col_offset=26), attr='operation', ctx=Load(), lineno=39, col_offset=19, end_lineno=39, end_col_offset=36), ops=[Eq()], comparators=[Constant(value='demo.fail', lineno=39, col_offset=40, end_lineno=39, end_col_offset=51)], lineno=39, col_offset=19, end_lineno=39, end_col_offset=51), lineno=39, col_offset=12, end_lineno=39, end_col_offset=51), Assign(targets=[Name(id='message', ctx=Store(), lineno=40, col_offset=12, end_lineno=40, end_col_offset=19)], value=Constant(value='boom', lineno=40, col_offset=22, end_lineno=40, end_col_offset=28), lineno=40, col_offset=12, end_lineno=40, end_col_offset=28), Raise(exc=Call(func=Name(id='RuntimeError', ctx=Load(), lineno=41, col_offset=18, end_lineno=41, end_col_offset=30), args=[Name(id='message', ctx=Load(), lineno=41, col_offset=31, end_lineno=41, end_col_offset=38)], lineno=41, col_offset=18, end_lineno=41, end_col_offset=39), lineno=41, col_offset=12, end_lineno=41, end_col_offset=39)], lineno=38, col_offset=8, end_lineno=41, end_col_offset=39)], returns=Constant(value=None, lineno=37, col_offset=29, end_lineno=37, end_col_offset=33), lineno=37, col_offset=4, end_lineno=41, end_col_offset=39), With(items=[withitem(context_expr=Call(func=Attribute(value=Name(id='pytest', ctx=Load(), lineno=43, col_offset=9, end_lineno=43, end_col_offset=15), attr='raises', ctx=Load(), lineno=43, col_offset=9, end_lineno=43, end_col_offset=22), args=[Name(id='RuntimeError', ctx=Load(), lineno=43, col_offset=23, end_lineno=43, end_col_offset=35)], lineno=43, col_offset=9, end_lineno=43, end_col_offset=36))], body=[Expr(value=Call(func=Name(id='_invoke_failure', ctx=Load(), lineno=44, col_offset=8, end_lineno=44, end_col_offset=23), lineno=44, col_offset=8, end_lineno=44, end_col_offset=25), lineno=44, col_offset=8, end_lineno=44, end_col_offset=25)], lineno=43, col_offset=4, end_lineno=44, end_col_offset=25), Assign(targets=[Name(id='out_dir', ctx=Store(), lineno=45, col_offset=4, end_lineno=45, end_col_offset=11)], value=BinOp(left=Name(id='tmp_path', ctx=Load(), lineno=45, col_offset=14, end_lineno=45, end_col_offset=22), op=Div(), right=Constant(value='docs/_data/cli/demo/fail', lineno=45, col_offset=25, end_lineno=45, end_col_offset=51), lineno=45, col_offset=14, end_lineno=45, end_col_offset=51), lineno=45, col_offset=4, end_lineno=45, end_col_offset=51), Assert(test=Call(func=Name(id='any', ctx=Load(), lineno=46, col_offset=11, end_lineno=46, end_col_offset=14), args=[GeneratorExp(elt=Compare(left=Constant(value='"status": "error"', lineno=46, col_offset=15, end_lineno=46, end_col_offset=34), ops=[In()], comparators=[Call(func=Attribute(value=Name(id='p', ctx=Load(), lineno=46, col_offset=38, end_lineno=46, end_col_offset=39), attr='read_text', ctx=Load(), lineno=46, col_offset=38, end_lineno=46, end_col_offset=49), lineno=46, col_offset=38, end_lineno=46, end_col_offset=51)], lineno=46, col_offset=15, end_lineno=46, end_col_offset=51), generators=[comprehension(target=Name(id='p', ctx=Store(), lineno=46, col_offset=56, end_lineno=46, end_col_offset=57), iter=Call(func=Attribute(value=Name(id='out_dir', ctx=Load(), lineno=46, col_offset=61, end_lineno=46, end_col_offset=68), attr='glob', ctx=Load(), lineno=46, col_offset=61, end_lineno=46, end_col_offset=73), args=[Constant(value='*.json', lineno=46, col_offset=74, end_lineno=46, end_col_offset=82)], lineno=46, col_offset=61, end_lineno=46, end_col_offset=83), is_async=0)], lineno=46, col_offset=14, end_lineno=46, end_col_offset=84)], lineno=46, col_offset=11, end_lineno=46, end_col_offset=84), lineno=46, col_offset=4, end_lineno=46, end_col_offset=84)], returns=Constant(value=None, lineno=33, col_offset=67, end_lineno=33, end_col_offset=71), lineno=33, col_offset=0, end_lineno=46, end_col_offset=84)])