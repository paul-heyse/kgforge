Module(body=[Expr(value=Constant(value='Test utilities for loading typing façade modules and attributes.\n\nThis module provides helpers that load façade modules and their attributes using\n`importlib` instead of direct imports. This eliminates PLC0415 violations by\nmoving imports out of test functions while maintaining type safety and lazy\nloading guarantees.\n\nExamples\n--------\nLoad a façade module:\n\n>>> from tests.helpers.typing_facades import load_facade_module\n>>> module = load_facade_module("kgfoundry_common.typing")\n>>> assert hasattr(module, "gate_import")\n\nLoad a specific attribute:\n\n>>> from tests.helpers.typing_facades import load_facade_attribute\n>>> gate_import = load_facade_attribute("kgfoundry_common.typing", "gate_import")\n>>> assert callable(gate_import)\n\nLoad with type checking:\n\n>>> from tests.helpers.typing_facades import load_facade_attribute_typed\n>>> from collections.abc import Callable\n>>> gate_import = load_facade_attribute_typed("kgfoundry_common.typing", "gate_import", Callable)\n', lineno=1, col_offset=0, end_lineno=27, end_col_offset=3), lineno=1, col_offset=0, end_lineno=27, end_col_offset=3), ImportFrom(module='__future__', names=[alias(name='annotations', lineno=29, col_offset=23, end_lineno=29, end_col_offset=34)], level=0, lineno=29, col_offset=0, end_lineno=29, end_col_offset=34), ImportFrom(module='importlib', names=[alias(name='import_module', lineno=31, col_offset=22, end_lineno=31, end_col_offset=35)], level=0, lineno=31, col_offset=0, end_lineno=31, end_col_offset=35), ImportFrom(module='typing', names=[alias(name='TYPE_CHECKING', lineno=32, col_offset=19, end_lineno=32, end_col_offset=32)], level=0, lineno=32, col_offset=0, end_lineno=32, end_col_offset=32), If(test=Name(id='TYPE_CHECKING', ctx=Load(), lineno=34, col_offset=3, end_lineno=34, end_col_offset=16), body=[ImportFrom(module='types', names=[alias(name='ModuleType', lineno=35, col_offset=22, end_lineno=35, end_col_offset=32)], level=0, lineno=35, col_offset=4, end_lineno=35, end_col_offset=32)], lineno=34, col_offset=0, end_lineno=35, end_col_offset=32), FunctionDef(name='load_facade_module', args=arguments(args=[arg(arg='module_name', annotation=Name(id='str', ctx=Load(), lineno=38, col_offset=36, end_lineno=38, end_col_offset=39), lineno=38, col_offset=23, end_lineno=38, end_col_offset=39)]), body=[Expr(value=Constant(value='Load a façade module using importlib.\n\n    This function loads the module at runtime, avoiding direct imports in test\n    functions that trigger PLC0415 violations. It preserves lazy-loading\n    guarantees required by typing façade modules.\n\n    Parameters\n    ----------\n    module_name : str\n        Dotted name of the module to import (e.g., "kgfoundry_common.typing").\n\n    Returns\n    -------\n    ModuleType\n        The loaded module object.\n\n    Examples\n    --------\n    >>> module = load_facade_module("kgfoundry_common.typing")\n    >>> assert hasattr(module, "gate_import")\n    ', lineno=39, col_offset=4, end_lineno=59, end_col_offset=7), lineno=39, col_offset=4, end_lineno=59, end_col_offset=7), Return(value=Call(func=Name(id='import_module', ctx=Load(), lineno=60, col_offset=11, end_lineno=60, end_col_offset=24), args=[Name(id='module_name', ctx=Load(), lineno=60, col_offset=25, end_lineno=60, end_col_offset=36)], lineno=60, col_offset=11, end_lineno=60, end_col_offset=37), lineno=60, col_offset=4, end_lineno=60, end_col_offset=37)], returns=Name(id='ModuleType', ctx=Load(), lineno=38, col_offset=44, end_lineno=38, end_col_offset=54), lineno=38, col_offset=0, end_lineno=60, end_col_offset=37), FunctionDef(name='load_facade_attribute', args=arguments(args=[arg(arg='module_name', annotation=Name(id='str', ctx=Load(), lineno=63, col_offset=39, end_lineno=63, end_col_offset=42), lineno=63, col_offset=26, end_lineno=63, end_col_offset=42), arg(arg='attribute', annotation=Name(id='str', ctx=Load(), lineno=63, col_offset=55, end_lineno=63, end_col_offset=58), lineno=63, col_offset=44, end_lineno=63, end_col_offset=58)]), body=[Expr(value=Constant(value='Load an attribute from a façade module.\n\n    Parameters\n    ----------\n    module_name : str\n        Dotted name of the module containing the attribute.\n    attribute : str\n        Name of the attribute to retrieve.\n\n    Returns\n    -------\n    object\n        The attribute value.\n\n    Examples\n    --------\n    >>> gate_import = load_facade_attribute("kgfoundry_common.typing", "gate_import")\n    >>> assert callable(gate_import)\n    ', lineno=64, col_offset=4, end_lineno=82, end_col_offset=7), lineno=64, col_offset=4, end_lineno=82, end_col_offset=7), Assign(targets=[Name(id='module', ctx=Store(), lineno=83, col_offset=4, end_lineno=83, end_col_offset=10)], value=Call(func=Name(id='load_facade_module', ctx=Load(), lineno=83, col_offset=13, end_lineno=83, end_col_offset=31), args=[Name(id='module_name', ctx=Load(), lineno=83, col_offset=32, end_lineno=83, end_col_offset=43)], lineno=83, col_offset=13, end_lineno=83, end_col_offset=44), lineno=83, col_offset=4, end_lineno=83, end_col_offset=44), AnnAssign(target=Name(id='attr', ctx=Store(), lineno=84, col_offset=4, end_lineno=84, end_col_offset=8), annotation=Name(id='object', ctx=Load(), lineno=84, col_offset=10, end_lineno=84, end_col_offset=16), value=Call(func=Name(id='getattr', ctx=Load(), lineno=84, col_offset=19, end_lineno=84, end_col_offset=26), args=[Name(id='module', ctx=Load(), lineno=84, col_offset=27, end_lineno=84, end_col_offset=33), Name(id='attribute', ctx=Load(), lineno=84, col_offset=35, end_lineno=84, end_col_offset=44)], lineno=84, col_offset=19, end_lineno=84, end_col_offset=45), simple=1, lineno=84, col_offset=4, end_lineno=84, end_col_offset=45), Return(value=Name(id='attr', ctx=Load(), lineno=85, col_offset=11, end_lineno=85, end_col_offset=15), lineno=85, col_offset=4, end_lineno=85, end_col_offset=15)], returns=Name(id='object', ctx=Load(), lineno=63, col_offset=63, end_lineno=63, end_col_offset=69), lineno=63, col_offset=0, end_lineno=85, end_col_offset=15), FunctionDef(name='load_facade_attribute_typed', args=arguments(args=[arg(arg='module_name', annotation=Name(id='str', ctx=Load(), lineno=88, col_offset=48, end_lineno=88, end_col_offset=51), lineno=88, col_offset=35, end_lineno=88, end_col_offset=51), arg(arg='attribute', annotation=Name(id='str', ctx=Load(), lineno=88, col_offset=64, end_lineno=88, end_col_offset=67), lineno=88, col_offset=53, end_lineno=88, end_col_offset=67), arg(arg='expected_type', annotation=Subscript(value=Name(id='type', ctx=Load(), lineno=88, col_offset=84, end_lineno=88, end_col_offset=88), slice=Name(id='T', ctx=Load(), lineno=88, col_offset=89, end_lineno=88, end_col_offset=90), ctx=Load(), lineno=88, col_offset=84, end_lineno=88, end_col_offset=91), lineno=88, col_offset=69, end_lineno=88, end_col_offset=91)]), body=[Expr(value=Constant(value='Load an attribute from a façade module with runtime type checking.\n\n    Parameters\n    ----------\n    module_name : str\n        Dotted name of the module containing the attribute.\n    attribute : str\n        Name of the attribute to retrieve.\n    expected_type : type[T]\n        Expected type of the attribute (checked at runtime).\n\n    Returns\n    -------\n    T\n        The attribute value, typed as T.\n\n    Raises\n    ------\n    TypeError\n        If the attribute does not match the expected type.\n\n    Examples\n    --------\n    >>> from collections.abc import Callable\n    >>> gate_import = load_facade_attribute_typed(\n    ...     "kgfoundry_common.typing", "gate_import", Callable\n    ... )\n    >>> assert callable(gate_import)\n    ', lineno=89, col_offset=4, end_lineno=117, end_col_offset=7), lineno=89, col_offset=4, end_lineno=117, end_col_offset=7), Assign(targets=[Name(id='value', ctx=Store(), lineno=118, col_offset=4, end_lineno=118, end_col_offset=9)], value=Call(func=Name(id='load_facade_attribute', ctx=Load(), lineno=118, col_offset=12, end_lineno=118, end_col_offset=33), args=[Name(id='module_name', ctx=Load(), lineno=118, col_offset=34, end_lineno=118, end_col_offset=45), Name(id='attribute', ctx=Load(), lineno=118, col_offset=47, end_lineno=118, end_col_offset=56)], lineno=118, col_offset=12, end_lineno=118, end_col_offset=57), lineno=118, col_offset=4, end_lineno=118, end_col_offset=57), If(test=UnaryOp(op=Not(), operand=Call(func=Name(id='isinstance', ctx=Load(), lineno=119, col_offset=11, end_lineno=119, end_col_offset=21), args=[Name(id='value', ctx=Load(), lineno=119, col_offset=22, end_lineno=119, end_col_offset=27), Name(id='expected_type', ctx=Load(), lineno=119, col_offset=29, end_lineno=119, end_col_offset=42)], lineno=119, col_offset=11, end_lineno=119, end_col_offset=43), lineno=119, col_offset=7, end_lineno=119, end_col_offset=43), body=[Assign(targets=[Name(id='message', ctx=Store(), lineno=120, col_offset=8, end_lineno=120, end_col_offset=15)], value=JoinedStr(values=[FormattedValue(value=Name(id='module_name', ctx=Load(), lineno=121, col_offset=15, end_lineno=121, end_col_offset=26), conversion=-1, lineno=121, col_offset=14, end_lineno=121, end_col_offset=27), Constant(value='.', lineno=121, col_offset=27, end_lineno=121, end_col_offset=28), FormattedValue(value=Name(id='attribute', ctx=Load(), lineno=121, col_offset=29, end_lineno=121, end_col_offset=38), conversion=-1, lineno=121, col_offset=28, end_lineno=121, end_col_offset=39), Constant(value=' expected ', lineno=121, col_offset=39, end_lineno=121, end_col_offset=49), FormattedValue(value=Name(id='expected_type', ctx=Load(), lineno=121, col_offset=50, end_lineno=121, end_col_offset=63), conversion=114, lineno=121, col_offset=49, end_lineno=121, end_col_offset=66), Constant(value=' but received ', lineno=121, col_offset=66, end_lineno=121, end_col_offset=80), FormattedValue(value=Call(func=Name(id='type', ctx=Load(), lineno=121, col_offset=81, end_lineno=121, end_col_offset=85), args=[Name(id='value', ctx=Load(), lineno=121, col_offset=86, end_lineno=121, end_col_offset=91)], lineno=121, col_offset=81, end_lineno=121, end_col_offset=92), conversion=114, lineno=121, col_offset=80, end_lineno=121, end_col_offset=95)], lineno=121, col_offset=12, end_lineno=121, end_col_offset=96), lineno=120, col_offset=8, end_lineno=122, end_col_offset=9), Raise(exc=Call(func=Name(id='TypeError', ctx=Load(), lineno=123, col_offset=14, end_lineno=123, end_col_offset=23), args=[Name(id='message', ctx=Load(), lineno=123, col_offset=24, end_lineno=123, end_col_offset=31)], lineno=123, col_offset=14, end_lineno=123, end_col_offset=32), lineno=123, col_offset=8, end_lineno=123, end_col_offset=32)], lineno=119, col_offset=4, end_lineno=123, end_col_offset=32), Assert(test=Call(func=Name(id='isinstance', ctx=Load(), lineno=124, col_offset=11, end_lineno=124, end_col_offset=21), args=[Name(id='value', ctx=Load(), lineno=124, col_offset=22, end_lineno=124, end_col_offset=27), Name(id='expected_type', ctx=Load(), lineno=124, col_offset=29, end_lineno=124, end_col_offset=42)], lineno=124, col_offset=11, end_lineno=124, end_col_offset=43), lineno=124, col_offset=4, end_lineno=124, end_col_offset=43), Return(value=Name(id='value', ctx=Load(), lineno=125, col_offset=11, end_lineno=125, end_col_offset=16), lineno=125, col_offset=4, end_lineno=125, end_col_offset=16)], returns=Name(id='T', ctx=Load(), lineno=88, col_offset=96, end_lineno=88, end_col_offset=97), type_params=[TypeVar(name='T', lineno=88, col_offset=32, end_lineno=88, end_col_offset=33)], lineno=88, col_offset=0, end_lineno=125, end_col_offset=16)])