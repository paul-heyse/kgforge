Module(body=[Expr(value=Constant(value='Tests for PR summary generation utilities.', lineno=1, col_offset=0, end_lineno=1, end_col_offset=48), lineno=1, col_offset=0, end_lineno=1, end_col_offset=48), ImportFrom(module='__future__', names=[alias(name='annotations', lineno=3, col_offset=23, end_lineno=3, end_col_offset=34)], level=0, lineno=3, col_offset=0, end_lineno=3, end_col_offset=34), ImportFrom(module='typing', names=[alias(name='TYPE_CHECKING', lineno=5, col_offset=19, end_lineno=5, end_col_offset=32)], level=0, lineno=5, col_offset=0, end_lineno=5, end_col_offset=32), ImportFrom(module='tools.generate_pr_summary', names=[alias(name='collect_artifact_snapshot', lineno=7, col_offset=38, end_lineno=7, end_col_offset=63), alias(name='generate_summary', lineno=7, col_offset=65, end_lineno=7, end_col_offset=81)], level=0, lineno=7, col_offset=0, end_lineno=7, end_col_offset=81), If(test=Name(id='TYPE_CHECKING', ctx=Load(), lineno=9, col_offset=3, end_lineno=9, end_col_offset=16), body=[ImportFrom(module='pathlib', names=[alias(name='Path', lineno=10, col_offset=24, end_lineno=10, end_col_offset=28)], level=0, lineno=10, col_offset=4, end_lineno=10, end_col_offset=28)], lineno=9, col_offset=0, end_lineno=10, end_col_offset=28), FunctionDef(name='test_collect_artifact_snapshot_detects_numbered_codemod_logs', args=arguments(args=[arg(arg='tmp_path', annotation=Name(id='Path', ctx=Load(), lineno=14, col_offset=14, end_lineno=14, end_col_offset=18), lineno=14, col_offset=4, end_lineno=14, end_col_offset=18)]), body=[Expr(value=Constant(value='Snapshot should include all codemod log files with numeric suffixes.', lineno=16, col_offset=4, end_lineno=16, end_col_offset=78), lineno=16, col_offset=4, end_lineno=16, end_col_offset=78), Expr(value=Call(func=Attribute(value=BinOp(left=Name(id='tmp_path', ctx=Load(), lineno=17, col_offset=5, end_lineno=17, end_col_offset=13), op=Div(), right=Constant(value='codemod.log', lineno=17, col_offset=16, end_lineno=17, end_col_offset=29), lineno=17, col_offset=5, end_lineno=17, end_col_offset=29), attr='write_text', ctx=Load(), lineno=17, col_offset=4, end_lineno=17, end_col_offset=41), args=[Constant(value='root run\n', lineno=17, col_offset=42, end_lineno=17, end_col_offset=54)], lineno=17, col_offset=4, end_lineno=17, end_col_offset=55), lineno=17, col_offset=4, end_lineno=17, end_col_offset=55), Expr(value=Call(func=Attribute(value=BinOp(left=Name(id='tmp_path', ctx=Load(), lineno=18, col_offset=5, end_lineno=18, end_col_offset=13), op=Div(), right=Constant(value='codemod_r1.log', lineno=18, col_offset=16, end_lineno=18, end_col_offset=32), lineno=18, col_offset=5, end_lineno=18, end_col_offset=32), attr='write_text', ctx=Load(), lineno=18, col_offset=4, end_lineno=18, end_col_offset=44), args=[Constant(value='run 1\n', lineno=18, col_offset=45, end_lineno=18, end_col_offset=54)], lineno=18, col_offset=4, end_lineno=18, end_col_offset=55), lineno=18, col_offset=4, end_lineno=18, end_col_offset=55), Expr(value=Call(func=Attribute(value=BinOp(left=Name(id='tmp_path', ctx=Load(), lineno=19, col_offset=5, end_lineno=19, end_col_offset=13), op=Div(), right=Constant(value='codemod_r2.log', lineno=19, col_offset=16, end_lineno=19, end_col_offset=32), lineno=19, col_offset=5, end_lineno=19, end_col_offset=32), attr='write_text', ctx=Load(), lineno=19, col_offset=4, end_lineno=19, end_col_offset=44), args=[Constant(value='run 2\n', lineno=19, col_offset=45, end_lineno=19, end_col_offset=54)], lineno=19, col_offset=4, end_lineno=19, end_col_offset=55), lineno=19, col_offset=4, end_lineno=19, end_col_offset=55), Expr(value=Call(func=Attribute(value=BinOp(left=Name(id='tmp_path', ctx=Load(), lineno=20, col_offset=5, end_lineno=20, end_col_offset=13), op=Div(), right=Constant(value='codemod_r3.txt', lineno=20, col_offset=16, end_lineno=20, end_col_offset=32), lineno=20, col_offset=5, end_lineno=20, end_col_offset=32), attr='write_text', ctx=Load(), lineno=20, col_offset=4, end_lineno=20, end_col_offset=44), args=[Constant(value='not a log\n', lineno=20, col_offset=45, end_lineno=20, end_col_offset=58)], lineno=20, col_offset=4, end_lineno=20, end_col_offset=59), lineno=20, col_offset=4, end_lineno=20, end_col_offset=59), Assign(targets=[Name(id='snapshot', ctx=Store(), lineno=22, col_offset=4, end_lineno=22, end_col_offset=12)], value=Call(func=Name(id='collect_artifact_snapshot', ctx=Load(), lineno=22, col_offset=15, end_lineno=22, end_col_offset=40), args=[Name(id='tmp_path', ctx=Load(), lineno=22, col_offset=41, end_lineno=22, end_col_offset=49)], lineno=22, col_offset=15, end_lineno=22, end_col_offset=50), lineno=22, col_offset=4, end_lineno=22, end_col_offset=50), Assert(test=Compare(left=Attribute(value=Name(id='snapshot', ctx=Load(), lineno=24, col_offset=11, end_lineno=24, end_col_offset=19), attr='codemod_logs', ctx=Load(), lineno=24, col_offset=11, end_lineno=24, end_col_offset=32), ops=[Eq()], comparators=[Tuple(elts=[Constant(value='codemod.log', lineno=25, col_offset=8, end_lineno=25, end_col_offset=21), Constant(value='codemod_r1.log', lineno=26, col_offset=8, end_lineno=26, end_col_offset=24), Constant(value='codemod_r2.log', lineno=27, col_offset=8, end_lineno=27, end_col_offset=24)], ctx=Load(), lineno=24, col_offset=36, end_lineno=28, end_col_offset=5)], lineno=24, col_offset=11, end_lineno=28, end_col_offset=5), lineno=24, col_offset=4, end_lineno=28, end_col_offset=5)], returns=Constant(value=None, lineno=15, col_offset=5, end_lineno=15, end_col_offset=9), lineno=13, col_offset=0, end_lineno=28, end_col_offset=5), FunctionDef(name='test_collect_artifact_snapshot_orders_double_digit_logs', args=arguments(args=[arg(arg='tmp_path', annotation=Name(id='Path', ctx=Load(), lineno=31, col_offset=70, end_lineno=31, end_col_offset=74), lineno=31, col_offset=60, end_lineno=31, end_col_offset=74)]), body=[Expr(value=Constant(value='Codemod logs should be sorted using natural order for numeric suffixes.', lineno=32, col_offset=4, end_lineno=32, end_col_offset=81), lineno=32, col_offset=4, end_lineno=32, end_col_offset=81), Expr(value=Call(func=Attribute(value=BinOp(left=Name(id='tmp_path', ctx=Load(), lineno=33, col_offset=5, end_lineno=33, end_col_offset=13), op=Div(), right=Constant(value='codemod_r10.log', lineno=33, col_offset=16, end_lineno=33, end_col_offset=33), lineno=33, col_offset=5, end_lineno=33, end_col_offset=33), attr='write_text', ctx=Load(), lineno=33, col_offset=4, end_lineno=33, end_col_offset=45), args=[Constant(value='run 10\n', lineno=33, col_offset=46, end_lineno=33, end_col_offset=56)], lineno=33, col_offset=4, end_lineno=33, end_col_offset=57), lineno=33, col_offset=4, end_lineno=33, end_col_offset=57), Expr(value=Call(func=Attribute(value=BinOp(left=Name(id='tmp_path', ctx=Load(), lineno=34, col_offset=5, end_lineno=34, end_col_offset=13), op=Div(), right=Constant(value='codemod.log', lineno=34, col_offset=16, end_lineno=34, end_col_offset=29), lineno=34, col_offset=5, end_lineno=34, end_col_offset=29), attr='write_text', ctx=Load(), lineno=34, col_offset=4, end_lineno=34, end_col_offset=41), args=[Constant(value='root run\n', lineno=34, col_offset=42, end_lineno=34, end_col_offset=54)], lineno=34, col_offset=4, end_lineno=34, end_col_offset=55), lineno=34, col_offset=4, end_lineno=34, end_col_offset=55), Expr(value=Call(func=Attribute(value=BinOp(left=Name(id='tmp_path', ctx=Load(), lineno=35, col_offset=5, end_lineno=35, end_col_offset=13), op=Div(), right=Constant(value='codemod_r2.log', lineno=35, col_offset=16, end_lineno=35, end_col_offset=32), lineno=35, col_offset=5, end_lineno=35, end_col_offset=32), attr='write_text', ctx=Load(), lineno=35, col_offset=4, end_lineno=35, end_col_offset=44), args=[Constant(value='run 2\n', lineno=35, col_offset=45, end_lineno=35, end_col_offset=54)], lineno=35, col_offset=4, end_lineno=35, end_col_offset=55), lineno=35, col_offset=4, end_lineno=35, end_col_offset=55), Assign(targets=[Name(id='snapshot', ctx=Store(), lineno=37, col_offset=4, end_lineno=37, end_col_offset=12)], value=Call(func=Name(id='collect_artifact_snapshot', ctx=Load(), lineno=37, col_offset=15, end_lineno=37, end_col_offset=40), args=[Name(id='tmp_path', ctx=Load(), lineno=37, col_offset=41, end_lineno=37, end_col_offset=49)], lineno=37, col_offset=15, end_lineno=37, end_col_offset=50), lineno=37, col_offset=4, end_lineno=37, end_col_offset=50), Assert(test=Compare(left=Attribute(value=Name(id='snapshot', ctx=Load(), lineno=39, col_offset=11, end_lineno=39, end_col_offset=19), attr='codemod_logs', ctx=Load(), lineno=39, col_offset=11, end_lineno=39, end_col_offset=32), ops=[Eq()], comparators=[Tuple(elts=[Constant(value='codemod.log', lineno=40, col_offset=8, end_lineno=40, end_col_offset=21), Constant(value='codemod_r2.log', lineno=41, col_offset=8, end_lineno=41, end_col_offset=24), Constant(value='codemod_r10.log', lineno=42, col_offset=8, end_lineno=42, end_col_offset=25)], ctx=Load(), lineno=39, col_offset=36, end_lineno=43, end_col_offset=5)], lineno=39, col_offset=11, end_lineno=43, end_col_offset=5), lineno=39, col_offset=4, end_lineno=43, end_col_offset=5)], returns=Constant(value=None, lineno=31, col_offset=79, end_lineno=31, end_col_offset=83), lineno=31, col_offset=0, end_lineno=43, end_col_offset=5), FunctionDef(name='test_generate_summary_lists_all_codemod_logs', args=arguments(args=[arg(arg='tmp_path', annotation=Name(id='Path', ctx=Load(), lineno=46, col_offset=59, end_lineno=46, end_col_offset=63), lineno=46, col_offset=49, end_lineno=46, end_col_offset=63)]), body=[Expr(value=Constant(value='Rendered summary should include every detected codemod log entry.', lineno=47, col_offset=4, end_lineno=47, end_col_offset=75), lineno=47, col_offset=4, end_lineno=47, end_col_offset=75), For(target=Name(id='name', ctx=Store(), lineno=48, col_offset=8, end_lineno=48, end_col_offset=12), iter=Tuple(elts=[Constant(value='codemod.log', lineno=48, col_offset=17, end_lineno=48, end_col_offset=30), Constant(value='codemod_r7.log', lineno=48, col_offset=32, end_lineno=48, end_col_offset=48)], ctx=Load(), lineno=48, col_offset=16, end_lineno=48, end_col_offset=49), body=[Expr(value=Call(func=Attribute(value=BinOp(left=Name(id='tmp_path', ctx=Load(), lineno=49, col_offset=9, end_lineno=49, end_col_offset=17), op=Div(), right=Name(id='name', ctx=Load(), lineno=49, col_offset=20, end_lineno=49, end_col_offset=24), lineno=49, col_offset=9, end_lineno=49, end_col_offset=24), attr='write_text', ctx=Load(), lineno=49, col_offset=8, end_lineno=49, end_col_offset=36), args=[Constant(value='log contents\n', lineno=49, col_offset=37, end_lineno=49, end_col_offset=53)], lineno=49, col_offset=8, end_lineno=49, end_col_offset=54), lineno=49, col_offset=8, end_lineno=49, end_col_offset=54)], lineno=48, col_offset=4, end_lineno=49, end_col_offset=54), Assign(targets=[Name(id='snapshot', ctx=Store(), lineno=51, col_offset=4, end_lineno=51, end_col_offset=12)], value=Call(func=Name(id='collect_artifact_snapshot', ctx=Load(), lineno=51, col_offset=15, end_lineno=51, end_col_offset=40), args=[Name(id='tmp_path', ctx=Load(), lineno=51, col_offset=41, end_lineno=51, end_col_offset=49)], lineno=51, col_offset=15, end_lineno=51, end_col_offset=50), lineno=51, col_offset=4, end_lineno=51, end_col_offset=50), Assign(targets=[Name(id='summary', ctx=Store(), lineno=52, col_offset=4, end_lineno=52, end_col_offset=11)], value=Call(func=Name(id='generate_summary', ctx=Load(), lineno=52, col_offset=14, end_lineno=52, end_col_offset=30), keywords=[keyword(arg='snapshot', value=Name(id='snapshot', ctx=Load(), lineno=52, col_offset=40, end_lineno=52, end_col_offset=48), lineno=52, col_offset=31, end_lineno=52, end_col_offset=48), keyword(arg='checks', value=Tuple(ctx=Load(), lineno=52, col_offset=57, end_lineno=52, end_col_offset=59), lineno=52, col_offset=50, end_lineno=52, end_col_offset=59)], lineno=52, col_offset=14, end_lineno=52, end_col_offset=60), lineno=52, col_offset=4, end_lineno=52, end_col_offset=60), Assert(test=Compare(left=Constant(value='`codemod.log`', lineno=54, col_offset=11, end_lineno=54, end_col_offset=26), ops=[In()], comparators=[Name(id='summary', ctx=Load(), lineno=54, col_offset=30, end_lineno=54, end_col_offset=37)], lineno=54, col_offset=11, end_lineno=54, end_col_offset=37), lineno=54, col_offset=4, end_lineno=54, end_col_offset=37), Assert(test=Compare(left=Constant(value='`codemod_r7.log`', lineno=55, col_offset=11, end_lineno=55, end_col_offset=29), ops=[In()], comparators=[Name(id='summary', ctx=Load(), lineno=55, col_offset=33, end_lineno=55, end_col_offset=40)], lineno=55, col_offset=11, end_lineno=55, end_col_offset=40), lineno=55, col_offset=4, end_lineno=55, end_col_offset=40), Assert(test=Compare(left=Call(func=Attribute(value=Name(id='summary', ctx=Load(), lineno=56, col_offset=11, end_lineno=56, end_col_offset=18), attr='count', ctx=Load(), lineno=56, col_offset=11, end_lineno=56, end_col_offset=24), args=[Constant(value='Codemod execution log', lineno=56, col_offset=25, end_lineno=56, end_col_offset=48)], lineno=56, col_offset=11, end_lineno=56, end_col_offset=49), ops=[Eq()], comparators=[Constant(value=2, lineno=56, col_offset=53, end_lineno=56, end_col_offset=54)], lineno=56, col_offset=11, end_lineno=56, end_col_offset=54), lineno=56, col_offset=4, end_lineno=56, end_col_offset=54)], returns=Constant(value=None, lineno=46, col_offset=68, end_lineno=46, end_col_offset=72), lineno=46, col_offset=0, end_lineno=56, end_col_offset=54), FunctionDef(name='test_generate_summary_with_empty_checks_emits_only_headers', args=arguments(args=[arg(arg='tmp_path', annotation=Name(id='Path', ctx=Load(), lineno=59, col_offset=73, end_lineno=59, end_col_offset=77), lineno=59, col_offset=63, end_lineno=59, end_col_offset=77)]), body=[Expr(value=Constant(value='Explicit empty checks should result in no table rows beyond the header.', lineno=60, col_offset=4, end_lineno=60, end_col_offset=81), lineno=60, col_offset=4, end_lineno=60, end_col_offset=81), Assign(targets=[Name(id='snapshot', ctx=Store(), lineno=61, col_offset=4, end_lineno=61, end_col_offset=12)], value=Call(func=Name(id='collect_artifact_snapshot', ctx=Load(), lineno=61, col_offset=15, end_lineno=61, end_col_offset=40), args=[Name(id='tmp_path', ctx=Load(), lineno=61, col_offset=41, end_lineno=61, end_col_offset=49)], lineno=61, col_offset=15, end_lineno=61, end_col_offset=50), lineno=61, col_offset=4, end_lineno=61, end_col_offset=50), Assign(targets=[Name(id='summary', ctx=Store(), lineno=62, col_offset=4, end_lineno=62, end_col_offset=11)], value=Call(func=Name(id='generate_summary', ctx=Load(), lineno=62, col_offset=14, end_lineno=62, end_col_offset=30), keywords=[keyword(arg='snapshot', value=Name(id='snapshot', ctx=Load(), lineno=62, col_offset=40, end_lineno=62, end_col_offset=48), lineno=62, col_offset=31, end_lineno=62, end_col_offset=48), keyword(arg='checks', value=Tuple(ctx=Load(), lineno=62, col_offset=57, end_lineno=62, end_col_offset=59), lineno=62, col_offset=50, end_lineno=62, end_col_offset=59)], lineno=62, col_offset=14, end_lineno=62, end_col_offset=60), lineno=62, col_offset=4, end_lineno=62, end_col_offset=60), Assign(targets=[Name(id='table_lines', ctx=Store(), lineno=64, col_offset=4, end_lineno=64, end_col_offset=15)], value=ListComp(elt=Name(id='line', ctx=Load(), lineno=64, col_offset=19, end_lineno=64, end_col_offset=23), generators=[comprehension(target=Name(id='line', ctx=Store(), lineno=64, col_offset=28, end_lineno=64, end_col_offset=32), iter=Call(func=Attribute(value=Name(id='summary', ctx=Load(), lineno=64, col_offset=36, end_lineno=64, end_col_offset=43), attr='splitlines', ctx=Load(), lineno=64, col_offset=36, end_lineno=64, end_col_offset=54), lineno=64, col_offset=36, end_lineno=64, end_col_offset=56), ifs=[Call(func=Attribute(value=Name(id='line', ctx=Load(), lineno=64, col_offset=60, end_lineno=64, end_col_offset=64), attr='startswith', ctx=Load(), lineno=64, col_offset=60, end_lineno=64, end_col_offset=75), args=[Constant(value='|', lineno=64, col_offset=76, end_lineno=64, end_col_offset=79)], lineno=64, col_offset=60, end_lineno=64, end_col_offset=80)], is_async=0)], lineno=64, col_offset=18, end_lineno=64, end_col_offset=81), lineno=64, col_offset=4, end_lineno=64, end_col_offset=81), Assert(test=Compare(left=Name(id='table_lines', ctx=Load(), lineno=66, col_offset=11, end_lineno=66, end_col_offset=22), ops=[Eq()], comparators=[List(elts=[Constant(value='| Check | Status |', lineno=66, col_offset=27, end_lineno=66, end_col_offset=47), Constant(value='|-------|--------|', lineno=66, col_offset=49, end_lineno=66, end_col_offset=69)], ctx=Load(), lineno=66, col_offset=26, end_lineno=66, end_col_offset=70)], lineno=66, col_offset=11, end_lineno=66, end_col_offset=70), lineno=66, col_offset=4, end_lineno=66, end_col_offset=70)], returns=Constant(value=None, lineno=59, col_offset=82, end_lineno=59, end_col_offset=86), lineno=59, col_offset=0, end_lineno=66, end_col_offset=70)])