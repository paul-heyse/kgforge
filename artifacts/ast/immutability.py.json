Module(body=[Expr(value=Constant(value='Utilities for asserting dataclass immutability in tests.\n\nThese helpers provide a consistent way to verify that frozen dataclasses and\nother immutable configuration objects reject attribute mutation. Instead of\nrelying on ad-hoc casts or direct attribute assignment (which can confuse\nstatic analysers), tests call the helpers defined here to exercise the same\n``FrozenInstanceError`` semantics while keeping type-checkers happy.\n\nExample\n-------\n>>> from tests.helpers.immutability import assert_frozen_attribute\n>>> from dataclasses import dataclass\n>>> @dataclass(frozen=True)\n... class Config:\n...     flag: bool = False\n>>> config = Config()\n>>> assert_frozen_attribute(config, "flag", True)\n', lineno=1, col_offset=0, end_lineno=18, end_col_offset=3), lineno=1, col_offset=0, end_lineno=18, end_col_offset=3), ImportFrom(module='__future__', names=[alias(name='annotations', lineno=20, col_offset=23, end_lineno=20, end_col_offset=34)], level=0, lineno=20, col_offset=0, end_lineno=20, end_col_offset=34), ImportFrom(module='dataclasses', names=[alias(name='FrozenInstanceError', lineno=22, col_offset=24, end_lineno=22, end_col_offset=43)], level=0, lineno=22, col_offset=0, end_lineno=22, end_col_offset=43), ImportFrom(module='typing', names=[alias(name='Protocol', lineno=23, col_offset=19, end_lineno=23, end_col_offset=27)], level=0, lineno=23, col_offset=0, end_lineno=23, end_col_offset=27), Import(names=[alias(name='pytest', lineno=25, col_offset=7, end_lineno=25, end_col_offset=13)], lineno=25, col_offset=0, end_lineno=25, end_col_offset=13), Assign(targets=[Name(id='__all__', ctx=Store(), lineno=27, col_offset=0, end_lineno=27, end_col_offset=7)], value=List(elts=[Constant(value='assert_frozen_attribute', lineno=28, col_offset=4, end_lineno=28, end_col_offset=29), Constant(value='assert_frozen_attributes', lineno=29, col_offset=4, end_lineno=29, end_col_offset=30), Constant(value='assert_frozen_mutation', lineno=30, col_offset=4, end_lineno=30, end_col_offset=28)], ctx=Load(), lineno=27, col_offset=10, end_lineno=31, end_col_offset=1), lineno=27, col_offset=0, end_lineno=31, end_col_offset=1), FunctionDef(name='assert_frozen_attribute', args=arguments(args=[arg(arg='obj', annotation=Name(id='object', ctx=Load(), lineno=34, col_offset=33, end_lineno=34, end_col_offset=39), lineno=34, col_offset=28, end_lineno=34, end_col_offset=39), arg(arg='attr', annotation=Name(id='str', ctx=Load(), lineno=34, col_offset=47, end_lineno=34, end_col_offset=50), lineno=34, col_offset=41, end_lineno=34, end_col_offset=50), arg(arg='value', annotation=Name(id='object', ctx=Load(), lineno=34, col_offset=59, end_lineno=34, end_col_offset=65), lineno=34, col_offset=52, end_lineno=34, end_col_offset=65)]), body=[Expr(value=Constant(value='Assert that assigning ``value`` to ``attr`` raises ``FrozenInstanceError``.', lineno=35, col_offset=4, end_lineno=35, end_col_offset=85), lineno=35, col_offset=4, end_lineno=35, end_col_offset=85), With(items=[withitem(context_expr=Call(func=Attribute(value=Name(id='pytest', ctx=Load(), lineno=36, col_offset=9, end_lineno=36, end_col_offset=15), attr='raises', ctx=Load(), lineno=36, col_offset=9, end_lineno=36, end_col_offset=22), args=[Name(id='FrozenInstanceError', ctx=Load(), lineno=36, col_offset=23, end_lineno=36, end_col_offset=42)], lineno=36, col_offset=9, end_lineno=36, end_col_offset=43))], body=[Expr(value=Call(func=Name(id='setattr', ctx=Load(), lineno=37, col_offset=8, end_lineno=37, end_col_offset=15), args=[Name(id='obj', ctx=Load(), lineno=37, col_offset=16, end_lineno=37, end_col_offset=19), Name(id='attr', ctx=Load(), lineno=37, col_offset=21, end_lineno=37, end_col_offset=25), Name(id='value', ctx=Load(), lineno=37, col_offset=27, end_lineno=37, end_col_offset=32)], lineno=37, col_offset=8, end_lineno=37, end_col_offset=33), lineno=37, col_offset=8, end_lineno=37, end_col_offset=33)], lineno=36, col_offset=4, end_lineno=37, end_col_offset=33)], returns=Constant(value=None, lineno=34, col_offset=70, end_lineno=34, end_col_offset=74), lineno=34, col_offset=0, end_lineno=37, end_col_offset=33), FunctionDef(name='assert_frozen_attributes', args=arguments(args=[arg(arg='obj', annotation=Name(id='object', ctx=Load(), lineno=40, col_offset=34, end_lineno=40, end_col_offset=40), lineno=40, col_offset=29, end_lineno=40, end_col_offset=40)], kwarg=arg(arg='updates', annotation=Name(id='object', ctx=Load(), lineno=40, col_offset=53, end_lineno=40, end_col_offset=59), lineno=40, col_offset=44, end_lineno=40, end_col_offset=59)), body=[Expr(value=Constant(value='Assert that each attribute in ``updates`` rejects reassignment.', lineno=41, col_offset=4, end_lineno=41, end_col_offset=73), lineno=41, col_offset=4, end_lineno=41, end_col_offset=73), For(target=Tuple(elts=[Name(id='name', ctx=Store(), lineno=42, col_offset=8, end_lineno=42, end_col_offset=12), Name(id='value', ctx=Store(), lineno=42, col_offset=14, end_lineno=42, end_col_offset=19)], ctx=Store(), lineno=42, col_offset=8, end_lineno=42, end_col_offset=19), iter=Call(func=Attribute(value=Name(id='updates', ctx=Load(), lineno=42, col_offset=23, end_lineno=42, end_col_offset=30), attr='items', ctx=Load(), lineno=42, col_offset=23, end_lineno=42, end_col_offset=36), lineno=42, col_offset=23, end_lineno=42, end_col_offset=38), body=[Expr(value=Call(func=Name(id='assert_frozen_attribute', ctx=Load(), lineno=43, col_offset=8, end_lineno=43, end_col_offset=31), args=[Name(id='obj', ctx=Load(), lineno=43, col_offset=32, end_lineno=43, end_col_offset=35), Name(id='name', ctx=Load(), lineno=43, col_offset=37, end_lineno=43, end_col_offset=41), Name(id='value', ctx=Load(), lineno=43, col_offset=43, end_lineno=43, end_col_offset=48)], lineno=43, col_offset=8, end_lineno=43, end_col_offset=49), lineno=43, col_offset=8, end_lineno=43, end_col_offset=49)], lineno=42, col_offset=4, end_lineno=43, end_col_offset=49)], returns=Constant(value=None, lineno=40, col_offset=64, end_lineno=40, end_col_offset=68), lineno=40, col_offset=0, end_lineno=43, end_col_offset=49), ClassDef(name='_Mutator', bases=[Name(id='Protocol', ctx=Load(), lineno=46, col_offset=18, end_lineno=46, end_col_offset=26)], body=[Expr(value=Constant(value='Protocol for mutation callables.', lineno=47, col_offset=4, end_lineno=47, end_col_offset=42), lineno=47, col_offset=4, end_lineno=47, end_col_offset=42), FunctionDef(name='__call__', args=arguments(posonlyargs=[arg(arg='self', lineno=49, col_offset=17, end_lineno=49, end_col_offset=21), arg(arg='obj', annotation=Name(id='T', ctx=Load(), lineno=49, col_offset=28, end_lineno=49, end_col_offset=29), lineno=49, col_offset=23, end_lineno=49, end_col_offset=29)]), body=[Expr(value=Constant(value='Mutate object.\n\n        Parameters\n        ----------\n        obj : T\n            Object to mutate.\n\n        Returns\n        -------\n        object\n            Mutation result.\n        ', lineno=50, col_offset=8, end_lineno=61, end_col_offset=11), lineno=50, col_offset=8, end_lineno=61, end_col_offset=11), Expr(value=Constant(value=Ellipsis, lineno=62, col_offset=8, end_lineno=62, end_col_offset=11), lineno=62, col_offset=8, end_lineno=62, end_col_offset=11)], returns=Name(id='object', ctx=Load(), lineno=49, col_offset=37, end_lineno=49, end_col_offset=43), lineno=49, col_offset=4, end_lineno=62, end_col_offset=11)], type_params=[TypeVar(name='T', lineno=46, col_offset=15, end_lineno=46, end_col_offset=16)], lineno=46, col_offset=0, end_lineno=62, end_col_offset=11), FunctionDef(name='assert_frozen_mutation', args=arguments(args=[arg(arg='obj', annotation=Name(id='T', ctx=Load(), lineno=65, col_offset=35, end_lineno=65, end_col_offset=36), lineno=65, col_offset=30, end_lineno=65, end_col_offset=36), arg(arg='mutate', annotation=Subscript(value=Name(id='_Mutator', ctx=Load(), lineno=65, col_offset=46, end_lineno=65, end_col_offset=54), slice=Name(id='T', ctx=Load(), lineno=65, col_offset=55, end_lineno=65, end_col_offset=56), ctx=Load(), lineno=65, col_offset=46, end_lineno=65, end_col_offset=57), lineno=65, col_offset=38, end_lineno=65, end_col_offset=57)]), body=[Expr(value=Constant(value='Assert that executing mutate on obj raises FrozenInstanceError.\n\n    Parameters\n    ----------\n    obj : T\n        Object to mutate.\n    mutate : _Mutator[T]\n        Callable that mutates the object.\n    ', lineno=66, col_offset=4, end_lineno=74, end_col_offset=7), lineno=66, col_offset=4, end_lineno=74, end_col_offset=7), With(items=[withitem(context_expr=Call(func=Attribute(value=Name(id='pytest', ctx=Load(), lineno=75, col_offset=9, end_lineno=75, end_col_offset=15), attr='raises', ctx=Load(), lineno=75, col_offset=9, end_lineno=75, end_col_offset=22), args=[Name(id='FrozenInstanceError', ctx=Load(), lineno=75, col_offset=23, end_lineno=75, end_col_offset=42)], lineno=75, col_offset=9, end_lineno=75, end_col_offset=43))], body=[Expr(value=Call(func=Name(id='mutate', ctx=Load(), lineno=76, col_offset=8, end_lineno=76, end_col_offset=14), args=[Name(id='obj', ctx=Load(), lineno=76, col_offset=15, end_lineno=76, end_col_offset=18)], lineno=76, col_offset=8, end_lineno=76, end_col_offset=19), lineno=76, col_offset=8, end_lineno=76, end_col_offset=19)], lineno=75, col_offset=4, end_lineno=76, end_col_offset=19)], returns=Constant(value=None, lineno=65, col_offset=62, end_lineno=65, end_col_offset=66), type_params=[TypeVar(name='T', lineno=65, col_offset=27, end_lineno=65, end_col_offset=28)], lineno=65, col_offset=0, end_lineno=76, end_col_offset=19)])