Module(body=[Expr(value=Constant(value='Tests for cAST chunker byte-to-line mapping.', lineno=1, col_offset=0, end_lineno=1, end_col_offset=50), lineno=1, col_offset=0, end_lineno=1, end_col_offset=50), ImportFrom(module='pathlib', names=[alias(name='Path', lineno=3, col_offset=20, end_lineno=3, end_col_offset=24)], level=0, lineno=3, col_offset=0, end_lineno=3, end_col_offset=24), ImportFrom(module='codeintel_rev.indexing.cast_chunker', names=[alias(name='chunk_file', lineno=5, col_offset=48, end_lineno=5, end_col_offset=58)], level=0, lineno=5, col_offset=0, end_lineno=5, end_col_offset=58), ImportFrom(module='codeintel_rev.indexing.scip_reader', names=[alias(name='Range', lineno=6, col_offset=47, end_lineno=6, end_col_offset=52), alias(name='SymbolDef', lineno=6, col_offset=54, end_lineno=6, end_col_offset=63)], level=0, lineno=6, col_offset=0, end_lineno=6, end_col_offset=63), FunctionDef(name='test_chunk_with_mid_line_bounds_uses_correct_line_indices', args=arguments(), body=[Expr(value=Constant(value='Chunk boundaries inside lines should map to the containing lines.', lineno=10, col_offset=4, end_lineno=10, end_col_offset=75), lineno=10, col_offset=4, end_lineno=10, end_col_offset=75), Assign(targets=[Name(id='text', ctx=Store(), lineno=11, col_offset=4, end_lineno=11, end_col_offset=8)], value=Constant(value='alpha = 1\nvalue = compute()\nthird line!\n', lineno=11, col_offset=11, end_lineno=11, end_col_offset=56), lineno=11, col_offset=4, end_lineno=11, end_col_offset=56), Assign(targets=[Name(id='definitions', ctx=Store(), lineno=12, col_offset=4, end_lineno=12, end_col_offset=15)], value=List(elts=[Call(func=Name(id='SymbolDef', ctx=Load(), lineno=13, col_offset=8, end_lineno=13, end_col_offset=17), keywords=[keyword(arg='symbol', value=Constant(value='python test#mid_line', lineno=14, col_offset=19, end_lineno=14, end_col_offset=41), lineno=14, col_offset=12, end_lineno=14, end_col_offset=41), keyword(arg='path', value=Constant(value='file.py', lineno=15, col_offset=17, end_lineno=15, end_col_offset=26), lineno=15, col_offset=12, end_lineno=15, end_col_offset=26), keyword(arg='range', value=Call(func=Name(id='Range', ctx=Load(), lineno=16, col_offset=18, end_lineno=16, end_col_offset=23), keywords=[keyword(arg='start_line', value=Constant(value=1, lineno=17, col_offset=27, end_lineno=17, end_col_offset=28), lineno=17, col_offset=16, end_lineno=17, end_col_offset=28), keyword(arg='start_character', value=Constant(value=4, lineno=18, col_offset=32, end_lineno=18, end_col_offset=33), lineno=18, col_offset=16, end_lineno=18, end_col_offset=33), keyword(arg='end_line', value=Constant(value=2, lineno=19, col_offset=25, end_lineno=19, end_col_offset=26), lineno=19, col_offset=16, end_lineno=19, end_col_offset=26), keyword(arg='end_character', value=Constant(value=5, lineno=20, col_offset=30, end_lineno=20, end_col_offset=31), lineno=20, col_offset=16, end_lineno=20, end_col_offset=31)], lineno=16, col_offset=18, end_lineno=21, end_col_offset=13), lineno=16, col_offset=12, end_lineno=21, end_col_offset=13), keyword(arg='language', value=Constant(value='python', lineno=22, col_offset=21, end_lineno=22, end_col_offset=29), lineno=22, col_offset=12, end_lineno=22, end_col_offset=29)], lineno=13, col_offset=8, end_lineno=23, end_col_offset=9)], ctx=Load(), lineno=12, col_offset=18, end_lineno=24, end_col_offset=5), lineno=12, col_offset=4, end_lineno=24, end_col_offset=5), Assign(targets=[Name(id='chunks', ctx=Store(), lineno=26, col_offset=4, end_lineno=26, end_col_offset=10)], value=Call(func=Name(id='chunk_file', ctx=Load(), lineno=26, col_offset=13, end_lineno=26, end_col_offset=23), args=[Call(func=Name(id='Path', ctx=Load(), lineno=26, col_offset=24, end_lineno=26, end_col_offset=28), args=[Constant(value='file.py', lineno=26, col_offset=29, end_lineno=26, end_col_offset=38)], lineno=26, col_offset=24, end_lineno=26, end_col_offset=39), Name(id='text', ctx=Load(), lineno=26, col_offset=41, end_lineno=26, end_col_offset=45), Name(id='definitions', ctx=Load(), lineno=26, col_offset=47, end_lineno=26, end_col_offset=58)], keywords=[keyword(arg='budget', value=Constant(value=2200, lineno=26, col_offset=67, end_lineno=26, end_col_offset=71), lineno=26, col_offset=60, end_lineno=26, end_col_offset=71)], lineno=26, col_offset=13, end_lineno=26, end_col_offset=72), lineno=26, col_offset=4, end_lineno=26, end_col_offset=72), Assert(test=Compare(left=Call(func=Name(id='len', ctx=Load(), lineno=28, col_offset=11, end_lineno=28, end_col_offset=14), args=[Name(id='chunks', ctx=Load(), lineno=28, col_offset=15, end_lineno=28, end_col_offset=21)], lineno=28, col_offset=11, end_lineno=28, end_col_offset=22), ops=[Eq()], comparators=[Constant(value=1, lineno=28, col_offset=26, end_lineno=28, end_col_offset=27)], lineno=28, col_offset=11, end_lineno=28, end_col_offset=27), lineno=28, col_offset=4, end_lineno=28, end_col_offset=27), Assign(targets=[Name(id='chunk', ctx=Store(), lineno=29, col_offset=4, end_lineno=29, end_col_offset=9)], value=Subscript(value=Name(id='chunks', ctx=Load(), lineno=29, col_offset=12, end_lineno=29, end_col_offset=18), slice=Constant(value=0, lineno=29, col_offset=19, end_lineno=29, end_col_offset=20), ctx=Load(), lineno=29, col_offset=12, end_lineno=29, end_col_offset=21), lineno=29, col_offset=4, end_lineno=29, end_col_offset=21), Assert(test=Compare(left=Attribute(value=Name(id='chunk', ctx=Load(), lineno=30, col_offset=11, end_lineno=30, end_col_offset=16), attr='start_line', ctx=Load(), lineno=30, col_offset=11, end_lineno=30, end_col_offset=27), ops=[Eq()], comparators=[Constant(value=1, lineno=30, col_offset=31, end_lineno=30, end_col_offset=32)], lineno=30, col_offset=11, end_lineno=30, end_col_offset=32), lineno=30, col_offset=4, end_lineno=30, end_col_offset=32), Assert(test=Compare(left=Attribute(value=Name(id='chunk', ctx=Load(), lineno=31, col_offset=11, end_lineno=31, end_col_offset=16), attr='end_line', ctx=Load(), lineno=31, col_offset=11, end_lineno=31, end_col_offset=25), ops=[Eq()], comparators=[Constant(value=2, lineno=31, col_offset=29, end_lineno=31, end_col_offset=30)], lineno=31, col_offset=11, end_lineno=31, end_col_offset=30), lineno=31, col_offset=4, end_lineno=31, end_col_offset=30)], returns=Constant(value=None, lineno=9, col_offset=67, end_lineno=9, end_col_offset=71), lineno=9, col_offset=0, end_lineno=31, end_col_offset=30), FunctionDef(name='test_chunk_bytes_align_with_multibyte_characters', args=arguments(), body=[Expr(value=Constant(value='Byte offsets should round-trip slice the original UTF-8 data.', lineno=35, col_offset=4, end_lineno=35, end_col_offset=71), lineno=35, col_offset=4, end_lineno=35, end_col_offset=71), Assign(targets=[Name(id='text', ctx=Store(), lineno=36, col_offset=4, end_lineno=36, end_col_offset=8)], value=Constant(value='intro = 1\náéíóú = 2\n目标 = 3\n', lineno=36, col_offset=11, end_lineno=36, end_col_offset=52), lineno=36, col_offset=4, end_lineno=36, end_col_offset=52), Assign(targets=[Name(id='encoded', ctx=Store(), lineno=37, col_offset=4, end_lineno=37, end_col_offset=11)], value=Call(func=Attribute(value=Name(id='text', ctx=Load(), lineno=37, col_offset=14, end_lineno=37, end_col_offset=18), attr='encode', ctx=Load(), lineno=37, col_offset=14, end_lineno=37, end_col_offset=25), args=[Constant(value='utf-8', lineno=37, col_offset=26, end_lineno=37, end_col_offset=33)], lineno=37, col_offset=14, end_lineno=37, end_col_offset=34), lineno=37, col_offset=4, end_lineno=37, end_col_offset=34), Assign(targets=[Name(id='definitions', ctx=Store(), lineno=39, col_offset=4, end_lineno=39, end_col_offset=15)], value=List(elts=[Call(func=Name(id='SymbolDef', ctx=Load(), lineno=40, col_offset=8, end_lineno=40, end_col_offset=17), keywords=[keyword(arg='symbol', value=Constant(value='python test#multibyte', lineno=41, col_offset=19, end_lineno=41, end_col_offset=42), lineno=41, col_offset=12, end_lineno=41, end_col_offset=42), keyword(arg='path', value=Constant(value='file.py', lineno=42, col_offset=17, end_lineno=42, end_col_offset=26), lineno=42, col_offset=12, end_lineno=42, end_col_offset=26), keyword(arg='range', value=Call(func=Name(id='Range', ctx=Load(), lineno=43, col_offset=18, end_lineno=43, end_col_offset=23), keywords=[keyword(arg='start_line', value=Constant(value=2, lineno=44, col_offset=27, end_lineno=44, end_col_offset=28), lineno=44, col_offset=16, end_lineno=44, end_col_offset=28), keyword(arg='start_character', value=Constant(value=0, lineno=45, col_offset=32, end_lineno=45, end_col_offset=33), lineno=45, col_offset=16, end_lineno=45, end_col_offset=33), keyword(arg='end_line', value=Constant(value=2, lineno=46, col_offset=25, end_lineno=46, end_col_offset=26), lineno=46, col_offset=16, end_lineno=46, end_col_offset=26), keyword(arg='end_character', value=Call(func=Name(id='len', ctx=Load(), lineno=47, col_offset=30, end_lineno=47, end_col_offset=33), args=[Constant(value='目标 = 3', lineno=47, col_offset=34, end_lineno=47, end_col_offset=46)], lineno=47, col_offset=30, end_lineno=47, end_col_offset=47), lineno=47, col_offset=16, end_lineno=47, end_col_offset=47)], lineno=43, col_offset=18, end_lineno=48, end_col_offset=13), lineno=43, col_offset=12, end_lineno=48, end_col_offset=13), keyword(arg='language', value=Constant(value='python', lineno=49, col_offset=21, end_lineno=49, end_col_offset=29), lineno=49, col_offset=12, end_lineno=49, end_col_offset=29)], lineno=40, col_offset=8, end_lineno=50, end_col_offset=9)], ctx=Load(), lineno=39, col_offset=18, end_lineno=51, end_col_offset=5), lineno=39, col_offset=4, end_lineno=51, end_col_offset=5), Assign(targets=[Name(id='chunks', ctx=Store(), lineno=53, col_offset=4, end_lineno=53, end_col_offset=10)], value=Call(func=Name(id='chunk_file', ctx=Load(), lineno=53, col_offset=13, end_lineno=53, end_col_offset=23), args=[Call(func=Name(id='Path', ctx=Load(), lineno=53, col_offset=24, end_lineno=53, end_col_offset=28), args=[Constant(value='file.py', lineno=53, col_offset=29, end_lineno=53, end_col_offset=38)], lineno=53, col_offset=24, end_lineno=53, end_col_offset=39), Name(id='text', ctx=Load(), lineno=53, col_offset=41, end_lineno=53, end_col_offset=45), Name(id='definitions', ctx=Load(), lineno=53, col_offset=47, end_lineno=53, end_col_offset=58)], keywords=[keyword(arg='budget', value=Constant(value=2200, lineno=53, col_offset=67, end_lineno=53, end_col_offset=71), lineno=53, col_offset=60, end_lineno=53, end_col_offset=71)], lineno=53, col_offset=13, end_lineno=53, end_col_offset=72), lineno=53, col_offset=4, end_lineno=53, end_col_offset=72), Assert(test=Compare(left=Call(func=Name(id='len', ctx=Load(), lineno=55, col_offset=11, end_lineno=55, end_col_offset=14), args=[Name(id='chunks', ctx=Load(), lineno=55, col_offset=15, end_lineno=55, end_col_offset=21)], lineno=55, col_offset=11, end_lineno=55, end_col_offset=22), ops=[Eq()], comparators=[Constant(value=1, lineno=55, col_offset=26, end_lineno=55, end_col_offset=27)], lineno=55, col_offset=11, end_lineno=55, end_col_offset=27), lineno=55, col_offset=4, end_lineno=55, end_col_offset=27), Assign(targets=[Name(id='chunk', ctx=Store(), lineno=56, col_offset=4, end_lineno=56, end_col_offset=9)], value=Subscript(value=Name(id='chunks', ctx=Load(), lineno=56, col_offset=12, end_lineno=56, end_col_offset=18), slice=Constant(value=0, lineno=56, col_offset=19, end_lineno=56, end_col_offset=20), ctx=Load(), lineno=56, col_offset=12, end_lineno=56, end_col_offset=21), lineno=56, col_offset=4, end_lineno=56, end_col_offset=21), Assign(targets=[Name(id='expected_start', ctx=Store(), lineno=58, col_offset=4, end_lineno=58, end_col_offset=18)], value=Call(func=Name(id='len', ctx=Load(), lineno=58, col_offset=21, end_lineno=58, end_col_offset=24), args=[Call(func=Attribute(value=Constant(value='intro = 1\náéíóú = 2\n', lineno=58, col_offset=25, end_lineno=58, end_col_offset=54), attr='encode', ctx=Load(), lineno=58, col_offset=25, end_lineno=58, end_col_offset=61), lineno=58, col_offset=25, end_lineno=58, end_col_offset=63)], lineno=58, col_offset=21, end_lineno=58, end_col_offset=64), lineno=58, col_offset=4, end_lineno=58, end_col_offset=64), Assign(targets=[Name(id='expected_end', ctx=Store(), lineno=59, col_offset=4, end_lineno=59, end_col_offset=16)], value=BinOp(left=Name(id='expected_start', ctx=Load(), lineno=59, col_offset=19, end_lineno=59, end_col_offset=33), op=Add(), right=Call(func=Name(id='len', ctx=Load(), lineno=59, col_offset=36, end_lineno=59, end_col_offset=39), args=[Call(func=Attribute(value=Constant(value='目标 = 3', lineno=59, col_offset=40, end_lineno=59, end_col_offset=52), attr='encode', ctx=Load(), lineno=59, col_offset=40, end_lineno=59, end_col_offset=59), lineno=59, col_offset=40, end_lineno=59, end_col_offset=61)], lineno=59, col_offset=36, end_lineno=59, end_col_offset=62), lineno=59, col_offset=19, end_lineno=59, end_col_offset=62), lineno=59, col_offset=4, end_lineno=59, end_col_offset=62), Assert(test=Compare(left=Attribute(value=Name(id='chunk', ctx=Load(), lineno=61, col_offset=11, end_lineno=61, end_col_offset=16), attr='start_byte', ctx=Load(), lineno=61, col_offset=11, end_lineno=61, end_col_offset=27), ops=[Eq()], comparators=[Name(id='expected_start', ctx=Load(), lineno=61, col_offset=31, end_lineno=61, end_col_offset=45)], lineno=61, col_offset=11, end_lineno=61, end_col_offset=45), lineno=61, col_offset=4, end_lineno=61, end_col_offset=45), Assert(test=Compare(left=Attribute(value=Name(id='chunk', ctx=Load(), lineno=62, col_offset=11, end_lineno=62, end_col_offset=16), attr='end_byte', ctx=Load(), lineno=62, col_offset=11, end_lineno=62, end_col_offset=25), ops=[Eq()], comparators=[Name(id='expected_end', ctx=Load(), lineno=62, col_offset=29, end_lineno=62, end_col_offset=41)], lineno=62, col_offset=11, end_lineno=62, end_col_offset=41), lineno=62, col_offset=4, end_lineno=62, end_col_offset=41), Assign(targets=[Name(id='round_trip', ctx=Store(), lineno=64, col_offset=4, end_lineno=64, end_col_offset=14)], value=Call(func=Attribute(value=Subscript(value=Name(id='encoded', ctx=Load(), lineno=64, col_offset=17, end_lineno=64, end_col_offset=24), slice=Slice(lower=Attribute(value=Name(id='chunk', ctx=Load(), lineno=64, col_offset=25, end_lineno=64, end_col_offset=30), attr='start_byte', ctx=Load(), lineno=64, col_offset=25, end_lineno=64, end_col_offset=41), upper=Attribute(value=Name(id='chunk', ctx=Load(), lineno=64, col_offset=44, end_lineno=64, end_col_offset=49), attr='end_byte', ctx=Load(), lineno=64, col_offset=44, end_lineno=64, end_col_offset=58), lineno=64, col_offset=25, end_lineno=64, end_col_offset=58), ctx=Load(), lineno=64, col_offset=17, end_lineno=64, end_col_offset=59), attr='decode', ctx=Load(), lineno=64, col_offset=17, end_lineno=64, end_col_offset=66), args=[Constant(value='utf-8', lineno=64, col_offset=67, end_lineno=64, end_col_offset=74)], lineno=64, col_offset=17, end_lineno=64, end_col_offset=75), lineno=64, col_offset=4, end_lineno=64, end_col_offset=75), Assert(test=Compare(left=Name(id='round_trip', ctx=Load(), lineno=65, col_offset=11, end_lineno=65, end_col_offset=21), ops=[Eq()], comparators=[Attribute(value=Name(id='chunk', ctx=Load(), lineno=65, col_offset=25, end_lineno=65, end_col_offset=30), attr='text', ctx=Load(), lineno=65, col_offset=25, end_lineno=65, end_col_offset=35)], lineno=65, col_offset=11, end_lineno=65, end_col_offset=35), lineno=65, col_offset=4, end_lineno=65, end_col_offset=35)], returns=Constant(value=None, lineno=34, col_offset=58, end_lineno=34, end_col_offset=62), lineno=34, col_offset=0, end_lineno=65, end_col_offset=35)])