Module(body=[Expr(value=Constant(value='Path safety utilities for repository-scoped operations.', lineno=1, col_offset=0, end_lineno=1, end_col_offset=61), lineno=1, col_offset=0, end_lineno=1, end_col_offset=61), ImportFrom(module='__future__', names=[alias(name='annotations', lineno=3, col_offset=23, end_lineno=3, end_col_offset=34)], level=0, lineno=3, col_offset=0, end_lineno=3, end_col_offset=34), ImportFrom(module='pathlib', names=[alias(name='Path', lineno=5, col_offset=20, end_lineno=5, end_col_offset=24)], level=0, lineno=5, col_offset=0, end_lineno=5, end_col_offset=24), ClassDef(name='PathOutsideRepositoryError', bases=[Name(id='ValueError', ctx=Load(), lineno=8, col_offset=33, end_lineno=8, end_col_offset=43)], body=[Expr(value=Constant(value='Raised when a path escapes the configured repository root.', lineno=9, col_offset=4, end_lineno=9, end_col_offset=68), lineno=9, col_offset=4, end_lineno=9, end_col_offset=68)], lineno=8, col_offset=0, end_lineno=9, end_col_offset=68), FunctionDef(name='resolve_within_repo', args=arguments(args=[arg(arg='repo_root', annotation=Name(id='Path', ctx=Load(), lineno=13, col_offset=15, end_lineno=13, end_col_offset=19), lineno=13, col_offset=4, end_lineno=13, end_col_offset=19), arg(arg='target', annotation=BinOp(left=Name(id='str', ctx=Load(), lineno=14, col_offset=12, end_lineno=14, end_col_offset=15), op=BitOr(), right=Name(id='Path', ctx=Load(), lineno=14, col_offset=18, end_lineno=14, end_col_offset=22), lineno=14, col_offset=12, end_lineno=14, end_col_offset=22), lineno=14, col_offset=4, end_lineno=14, end_col_offset=22)], kwonlyargs=[arg(arg='allow_nonexistent', annotation=Name(id='bool', ctx=Load(), lineno=16, col_offset=23, end_lineno=16, end_col_offset=27), lineno=16, col_offset=4, end_lineno=16, end_col_offset=27)], kw_defaults=[Constant(value=True, lineno=16, col_offset=30, end_lineno=16, end_col_offset=34)]), body=[Expr(value=Constant(value='Resolve ``target`` against ``repo_root`` and ensure it stays within bounds.\n\n    Parameters\n    ----------\n    repo_root : Path\n        Repository root directory.\n    target : str | Path\n        Requested path (relative or absolute).\n    allow_nonexistent : bool, optional\n        When ``False`` the resolved path must already exist on disk.\n\n    Returns\n    -------\n    Path\n        Absolute path inside ``repo_root``.\n\n    Raises\n    ------\n    PathOutsideRepositoryError\n        If the resolved path is outside the repository.\n    FileNotFoundError\n        When ``allow_nonexistent`` is ``False`` and the path does not exist.\n    ', lineno=18, col_offset=4, end_lineno=40, end_col_offset=7), lineno=18, col_offset=4, end_lineno=40, end_col_offset=7), Assign(targets=[Name(id='resolved_root', ctx=Store(), lineno=41, col_offset=4, end_lineno=41, end_col_offset=17)], value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='repo_root', ctx=Load(), lineno=41, col_offset=20, end_lineno=41, end_col_offset=29), attr='expanduser', ctx=Load(), lineno=41, col_offset=20, end_lineno=41, end_col_offset=40), lineno=41, col_offset=20, end_lineno=41, end_col_offset=42), attr='resolve', ctx=Load(), lineno=41, col_offset=20, end_lineno=41, end_col_offset=50), lineno=41, col_offset=20, end_lineno=41, end_col_offset=52), lineno=41, col_offset=4, end_lineno=41, end_col_offset=52), Assign(targets=[Name(id='candidate', ctx=Store(), lineno=42, col_offset=4, end_lineno=42, end_col_offset=13)], value=Call(func=Name(id='Path', ctx=Load(), lineno=42, col_offset=16, end_lineno=42, end_col_offset=20), args=[Name(id='target', ctx=Load(), lineno=42, col_offset=21, end_lineno=42, end_col_offset=27)], lineno=42, col_offset=16, end_lineno=42, end_col_offset=28), lineno=42, col_offset=4, end_lineno=42, end_col_offset=28), If(test=UnaryOp(op=Not(), operand=Call(func=Attribute(value=Name(id='candidate', ctx=Load(), lineno=43, col_offset=11, end_lineno=43, end_col_offset=20), attr='is_absolute', ctx=Load(), lineno=43, col_offset=11, end_lineno=43, end_col_offset=32), lineno=43, col_offset=11, end_lineno=43, end_col_offset=34), lineno=43, col_offset=7, end_lineno=43, end_col_offset=34), body=[Assign(targets=[Name(id='candidate', ctx=Store(), lineno=44, col_offset=8, end_lineno=44, end_col_offset=17)], value=BinOp(left=Name(id='resolved_root', ctx=Load(), lineno=44, col_offset=20, end_lineno=44, end_col_offset=33), op=Div(), right=Name(id='candidate', ctx=Load(), lineno=44, col_offset=36, end_lineno=44, end_col_offset=45), lineno=44, col_offset=20, end_lineno=44, end_col_offset=45), lineno=44, col_offset=8, end_lineno=44, end_col_offset=45)], lineno=43, col_offset=4, end_lineno=44, end_col_offset=45), Assign(targets=[Name(id='candidate', ctx=Store(), lineno=45, col_offset=4, end_lineno=45, end_col_offset=13)], value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='candidate', ctx=Load(), lineno=45, col_offset=16, end_lineno=45, end_col_offset=25), attr='expanduser', ctx=Load(), lineno=45, col_offset=16, end_lineno=45, end_col_offset=36), lineno=45, col_offset=16, end_lineno=45, end_col_offset=38), attr='resolve', ctx=Load(), lineno=45, col_offset=16, end_lineno=45, end_col_offset=46), lineno=45, col_offset=16, end_lineno=45, end_col_offset=48), lineno=45, col_offset=4, end_lineno=45, end_col_offset=48), If(test=UnaryOp(op=Not(), operand=Call(func=Attribute(value=Name(id='candidate', ctx=Load(), lineno=47, col_offset=11, end_lineno=47, end_col_offset=20), attr='is_relative_to', ctx=Load(), lineno=47, col_offset=11, end_lineno=47, end_col_offset=35), args=[Name(id='resolved_root', ctx=Load(), lineno=47, col_offset=36, end_lineno=47, end_col_offset=49)], lineno=47, col_offset=11, end_lineno=47, end_col_offset=50), lineno=47, col_offset=7, end_lineno=47, end_col_offset=50), body=[Assign(targets=[Name(id='msg', ctx=Store(), lineno=48, col_offset=8, end_lineno=48, end_col_offset=11)], value=JoinedStr(values=[Constant(value='Path ', lineno=48, col_offset=16, end_lineno=48, end_col_offset=21), FormattedValue(value=Name(id='candidate', ctx=Load(), lineno=48, col_offset=22, end_lineno=48, end_col_offset=31), conversion=-1, lineno=48, col_offset=21, end_lineno=48, end_col_offset=32), Constant(value=' escapes repository root ', lineno=48, col_offset=32, end_lineno=48, end_col_offset=57), FormattedValue(value=Name(id='resolved_root', ctx=Load(), lineno=48, col_offset=58, end_lineno=48, end_col_offset=71), conversion=-1, lineno=48, col_offset=57, end_lineno=48, end_col_offset=72)], lineno=48, col_offset=14, end_lineno=48, end_col_offset=73), lineno=48, col_offset=8, end_lineno=48, end_col_offset=73), Raise(exc=Call(func=Name(id='PathOutsideRepositoryError', ctx=Load(), lineno=49, col_offset=14, end_lineno=49, end_col_offset=40), args=[Name(id='msg', ctx=Load(), lineno=49, col_offset=41, end_lineno=49, end_col_offset=44)], lineno=49, col_offset=14, end_lineno=49, end_col_offset=45), lineno=49, col_offset=8, end_lineno=49, end_col_offset=45)], lineno=47, col_offset=4, end_lineno=49, end_col_offset=45), If(test=BoolOp(op=And(), values=[UnaryOp(op=Not(), operand=Name(id='allow_nonexistent', ctx=Load(), lineno=51, col_offset=11, end_lineno=51, end_col_offset=28), lineno=51, col_offset=7, end_lineno=51, end_col_offset=28), UnaryOp(op=Not(), operand=Call(func=Attribute(value=Name(id='candidate', ctx=Load(), lineno=51, col_offset=37, end_lineno=51, end_col_offset=46), attr='exists', ctx=Load(), lineno=51, col_offset=37, end_lineno=51, end_col_offset=53), lineno=51, col_offset=37, end_lineno=51, end_col_offset=55), lineno=51, col_offset=33, end_lineno=51, end_col_offset=55)], lineno=51, col_offset=7, end_lineno=51, end_col_offset=55), body=[Raise(exc=Call(func=Name(id='FileNotFoundError', ctx=Load(), lineno=52, col_offset=14, end_lineno=52, end_col_offset=31), args=[Name(id='candidate', ctx=Load(), lineno=52, col_offset=32, end_lineno=52, end_col_offset=41)], lineno=52, col_offset=14, end_lineno=52, end_col_offset=42), lineno=52, col_offset=8, end_lineno=52, end_col_offset=42)], lineno=51, col_offset=4, end_lineno=52, end_col_offset=42), Return(value=Name(id='candidate', ctx=Load(), lineno=54, col_offset=11, end_lineno=54, end_col_offset=20), lineno=54, col_offset=4, end_lineno=54, end_col_offset=20)], returns=Name(id='Path', ctx=Load(), lineno=17, col_offset=5, end_lineno=17, end_col_offset=9), lineno=12, col_offset=0, end_lineno=54, end_col_offset=20)])