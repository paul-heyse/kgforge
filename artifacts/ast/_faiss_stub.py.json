Module(body=[ImportFrom(module='__future__', names=[alias(name='annotations', lineno=1, col_offset=23, end_lineno=1, end_col_offset=34)], level=0, lineno=1, col_offset=0, end_lineno=1, end_col_offset=34), Import(names=[alias(name='importlib', lineno=3, col_offset=7, end_lineno=3, end_col_offset=16)], lineno=3, col_offset=0, end_lineno=3, end_col_offset=16), Import(names=[alias(name='importlib.machinery', lineno=4, col_offset=7, end_lineno=4, end_col_offset=26)], lineno=4, col_offset=0, end_lineno=4, end_col_offset=26), Import(names=[alias(name='sys', lineno=5, col_offset=7, end_lineno=5, end_col_offset=10)], lineno=5, col_offset=0, end_lineno=5, end_col_offset=10), Import(names=[alias(name='types', lineno=6, col_offset=7, end_lineno=6, end_col_offset=12)], lineno=6, col_offset=0, end_lineno=6, end_col_offset=12), FunctionDef(name='ensure_faiss_stub', args=arguments(), body=[Expr(value=Constant(value='Register a minimal ``faiss`` module stub for environments without FAISS.', lineno=10, col_offset=4, end_lineno=10, end_col_offset=82), lineno=10, col_offset=4, end_lineno=10, end_col_offset=82), Try(body=[Assign(targets=[Name(id='module', ctx=Store(), lineno=12, col_offset=8, end_lineno=12, end_col_offset=14)], value=Call(func=Attribute(value=Name(id='importlib', ctx=Load(), lineno=12, col_offset=17, end_lineno=12, end_col_offset=26), attr='import_module', ctx=Load(), lineno=12, col_offset=17, end_lineno=12, end_col_offset=40), args=[Constant(value='faiss', lineno=12, col_offset=41, end_lineno=12, end_col_offset=48)], lineno=12, col_offset=17, end_lineno=12, end_col_offset=49), lineno=12, col_offset=8, end_lineno=12, end_col_offset=49)], handlers=[ExceptHandler(type=Tuple(elts=[Name(id='AttributeError', ctx=Load(), lineno=13, col_offset=12, end_lineno=13, end_col_offset=26), Name(id='ImportError', ctx=Load(), lineno=13, col_offset=28, end_lineno=13, end_col_offset=39), Name(id='ModuleNotFoundError', ctx=Load(), lineno=13, col_offset=41, end_lineno=13, end_col_offset=60), Name(id='OSError', ctx=Load(), lineno=13, col_offset=62, end_lineno=13, end_col_offset=69), Name(id='RuntimeError', ctx=Load(), lineno=13, col_offset=71, end_lineno=13, end_col_offset=83)], ctx=Load(), lineno=13, col_offset=11, end_lineno=13, end_col_offset=84), body=[Assign(targets=[Name(id='module', ctx=Store(), lineno=14, col_offset=8, end_lineno=14, end_col_offset=14)], value=Constant(value=None, lineno=14, col_offset=17, end_lineno=14, end_col_offset=21), lineno=14, col_offset=8, end_lineno=14, end_col_offset=21)], lineno=13, col_offset=4, end_lineno=14, end_col_offset=21)], orelse=[Assign(targets=[Name(id='required_attrs', ctx=Store(), lineno=16, col_offset=8, end_lineno=16, end_col_offset=22)], value=Tuple(elts=[Constant(value='normalize_L2', lineno=16, col_offset=26, end_lineno=16, end_col_offset=40), Constant(value='IndexFlatIP', lineno=16, col_offset=42, end_lineno=16, end_col_offset=55), Constant(value='write_index', lineno=16, col_offset=57, end_lineno=16, end_col_offset=70)], ctx=Load(), lineno=16, col_offset=25, end_lineno=16, end_col_offset=71), lineno=16, col_offset=8, end_lineno=16, end_col_offset=71), If(test=Call(func=Name(id='all', ctx=Load(), lineno=17, col_offset=11, end_lineno=17, end_col_offset=14), args=[GeneratorExp(elt=Call(func=Name(id='hasattr', ctx=Load(), lineno=17, col_offset=15, end_lineno=17, end_col_offset=22), args=[Name(id='module', ctx=Load(), lineno=17, col_offset=23, end_lineno=17, end_col_offset=29), Name(id='attr', ctx=Load(), lineno=17, col_offset=31, end_lineno=17, end_col_offset=35)], lineno=17, col_offset=15, end_lineno=17, end_col_offset=36), generators=[comprehension(target=Name(id='attr', ctx=Store(), lineno=17, col_offset=41, end_lineno=17, end_col_offset=45), iter=Name(id='required_attrs', ctx=Load(), lineno=17, col_offset=49, end_lineno=17, end_col_offset=63), is_async=0)], lineno=17, col_offset=14, end_lineno=17, end_col_offset=64)], lineno=17, col_offset=11, end_lineno=17, end_col_offset=64), body=[Return(lineno=18, col_offset=12, end_lineno=18, end_col_offset=18)], lineno=17, col_offset=8, end_lineno=18, end_col_offset=18), Expr(value=Call(func=Attribute(value=Attribute(value=Name(id='sys', ctx=Load(), lineno=19, col_offset=8, end_lineno=19, end_col_offset=11), attr='modules', ctx=Load(), lineno=19, col_offset=8, end_lineno=19, end_col_offset=19), attr='pop', ctx=Load(), lineno=19, col_offset=8, end_lineno=19, end_col_offset=23), args=[Constant(value='faiss', lineno=19, col_offset=24, end_lineno=19, end_col_offset=31), Constant(value=None, lineno=19, col_offset=33, end_lineno=19, end_col_offset=37)], lineno=19, col_offset=8, end_lineno=19, end_col_offset=38), lineno=19, col_offset=8, end_lineno=19, end_col_offset=38)], lineno=11, col_offset=4, end_lineno=19, end_col_offset=38), If(test=Compare(left=Constant(value='faiss', lineno=21, col_offset=7, end_lineno=21, end_col_offset=14), ops=[In()], comparators=[Attribute(value=Name(id='sys', ctx=Load(), lineno=21, col_offset=18, end_lineno=21, end_col_offset=21), attr='modules', ctx=Load(), lineno=21, col_offset=18, end_lineno=21, end_col_offset=29)], lineno=21, col_offset=7, end_lineno=21, end_col_offset=29), body=[Return(lineno=22, col_offset=8, end_lineno=22, end_col_offset=14)], lineno=21, col_offset=4, end_lineno=22, end_col_offset=14), Assign(targets=[Name(id='module', ctx=Store(), lineno=24, col_offset=4, end_lineno=24, end_col_offset=10)], value=Call(func=Attribute(value=Name(id='types', ctx=Load(), lineno=24, col_offset=13, end_lineno=24, end_col_offset=18), attr='ModuleType', ctx=Load(), lineno=24, col_offset=13, end_lineno=24, end_col_offset=29), args=[Constant(value='faiss', lineno=24, col_offset=30, end_lineno=24, end_col_offset=37)], lineno=24, col_offset=13, end_lineno=24, end_col_offset=38), lineno=24, col_offset=4, end_lineno=24, end_col_offset=38), Assign(targets=[Attribute(value=Name(id='module', ctx=Load(), lineno=25, col_offset=4, end_lineno=25, end_col_offset=10), attr='__spec__', ctx=Store(), lineno=25, col_offset=4, end_lineno=25, end_col_offset=19)], value=Call(func=Attribute(value=Attribute(value=Name(id='importlib', ctx=Load(), lineno=25, col_offset=22, end_lineno=25, end_col_offset=31), attr='machinery', ctx=Load(), lineno=25, col_offset=22, end_lineno=25, end_col_offset=41), attr='ModuleSpec', ctx=Load(), lineno=25, col_offset=22, end_lineno=25, end_col_offset=52), args=[Constant(value='faiss', lineno=25, col_offset=53, end_lineno=25, end_col_offset=60)], keywords=[keyword(arg='loader', value=Constant(value=None, lineno=25, col_offset=69, end_lineno=25, end_col_offset=73), lineno=25, col_offset=62, end_lineno=25, end_col_offset=73)], lineno=25, col_offset=22, end_lineno=25, end_col_offset=74), lineno=25, col_offset=4, end_lineno=25, end_col_offset=74), Assign(targets=[Subscript(value=Attribute(value=Name(id='sys', ctx=Load(), lineno=26, col_offset=4, end_lineno=26, end_col_offset=7), attr='modules', ctx=Load(), lineno=26, col_offset=4, end_lineno=26, end_col_offset=15), slice=Constant(value='faiss', lineno=26, col_offset=16, end_lineno=26, end_col_offset=23), ctx=Store(), lineno=26, col_offset=4, end_lineno=26, end_col_offset=24)], value=Name(id='module', ctx=Load(), lineno=26, col_offset=27, end_lineno=26, end_col_offset=33), lineno=26, col_offset=4, end_lineno=26, end_col_offset=33)], returns=Constant(value=None, lineno=9, col_offset=27, end_lineno=9, end_col_offset=31), lineno=9, col_offset=0, end_lineno=26, end_col_offset=33), Expr(value=Call(func=Name(id='ensure_faiss_stub', ctx=Load(), lineno=29, col_offset=0, end_lineno=29, end_col_offset=17), lineno=29, col_offset=0, end_lineno=29, end_col_offset=19), lineno=29, col_offset=0, end_lineno=29, end_col_offset=19)])