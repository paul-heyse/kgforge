Module(body=[Expr(value=Constant(value='cAST chunking using SCIP symbol ranges.\n\nImplements structure-aware chunking using symbol boundaries from SCIP\nrather than tree-sitter parsing. Greedily packs top-level symbols up to\nthe character budget, splitting large symbols on blank lines.\n', lineno=1, col_offset=0, end_lineno=6, end_col_offset=3), lineno=1, col_offset=0, end_lineno=6, end_col_offset=3), ImportFrom(module='__future__', names=[alias(name='annotations', lineno=8, col_offset=23, end_lineno=8, end_col_offset=34)], level=0, lineno=8, col_offset=0, end_lineno=8, end_col_offset=34), ImportFrom(module='bisect', names=[alias(name='bisect_right', lineno=10, col_offset=19, end_lineno=10, end_col_offset=31)], level=0, lineno=10, col_offset=0, end_lineno=10, end_col_offset=31), ImportFrom(module='collections.abc', names=[alias(name='Sequence', lineno=11, col_offset=28, end_lineno=11, end_col_offset=36)], level=0, lineno=11, col_offset=0, end_lineno=11, end_col_offset=36), ImportFrom(module='dataclasses', names=[alias(name='dataclass', lineno=12, col_offset=24, end_lineno=12, end_col_offset=33), alias(name='replace', lineno=12, col_offset=35, end_lineno=12, end_col_offset=42)], level=0, lineno=12, col_offset=0, end_lineno=12, end_col_offset=42), ImportFrom(module='pathlib', names=[alias(name='Path', lineno=13, col_offset=20, end_lineno=13, end_col_offset=24)], level=0, lineno=13, col_offset=0, end_lineno=13, end_col_offset=24), ImportFrom(module='typing', names=[alias(name='TYPE_CHECKING', lineno=14, col_offset=19, end_lineno=14, end_col_offset=32)], level=0, lineno=14, col_offset=0, end_lineno=14, end_col_offset=32), If(test=Name(id='TYPE_CHECKING', ctx=Load(), lineno=16, col_offset=3, end_lineno=16, end_col_offset=16), body=[ImportFrom(module='codeintel_rev.indexing.scip_reader', names=[alias(name='Range', lineno=17, col_offset=51, end_lineno=17, end_col_offset=56), alias(name='SymbolDef', lineno=17, col_offset=58, end_lineno=17, end_col_offset=67)], level=0, lineno=17, col_offset=4, end_lineno=17, end_col_offset=67)], lineno=16, col_offset=0, end_lineno=17, end_col_offset=67), ClassDef(name='Chunk', body=[Expr(value=Constant(value='Code chunk with precise byte and line bounds.\n\n    A Chunk represents a contiguous region of source code that has been extracted\n    for indexing. Chunks are created by the cAST chunker using SCIP symbol boundaries\n    to ensure that chunks respect semantic structure (functions, classes, etc.) rather\n    than arbitrary text splits.\n\n    Each chunk includes precise byte offsets (for exact text extraction) and line\n    numbers (for human-readable display). The chunk also tracks which SCIP symbols\n    it contains, enabling symbol-aware search and navigation.\n\n    Chunks are immutable (frozen dataclass) to ensure thread safety and prevent\n    accidental modification. They are designed to be stored in Parquet files with\n    their embeddings for efficient retrieval.\n\n    Attributes\n    ----------\n    uri : str\n        File path or URI identifying the source file. This is typically a relative\n        path from the repository root, matching the SCIP index format. Used for\n        filtering and grouping chunks by file.\n    start_byte : int\n        Starting byte offset (0-indexed) of the chunk within the source file.\n        Used for precise text extraction without re-parsing the file. Byte offsets\n        are more reliable than character offsets for multi-byte encodings.\n    end_byte : int\n        Ending byte offset (exclusive, 0-indexed) of the chunk. The chunk text\n        spans from start_byte to end_byte (exclusive).\n    start_line : int\n        Starting line number (0-indexed) for human-readable display. Used in search\n        results and code navigation. Line numbers are computed from byte offsets\n        using line start positions.\n    end_line : int\n        Ending line number (0-indexed, inclusive). The chunk spans from start_line\n        to end_line (inclusive). Used for displaying code ranges in search results.\n    text : str\n        The actual source code text of the chunk. This is the substring of the\n        source file from start_byte to end_byte. Stored explicitly for fast\n        retrieval without re-reading files.\n    symbols : tuple[str, ...]\n        Tuple of SCIP symbol strings that are defined or referenced within this\n        chunk. Symbols are in SCIP format (e.g., "python kgfoundry.core#Function.main").\n        Used for symbol-aware search and filtering. Empty tuple if no symbols.\n    language : str\n        Programming language of the source file containing this chunk. Used for\n        filtering results by language scope and derived from SCIP metadata.\n    ', lineno=22, col_offset=4, end_lineno=68, end_col_offset=7), lineno=22, col_offset=4, end_lineno=68, end_col_offset=7), AnnAssign(target=Name(id='uri', ctx=Store(), lineno=70, col_offset=4, end_lineno=70, end_col_offset=7), annotation=Name(id='str', ctx=Load(), lineno=70, col_offset=9, end_lineno=70, end_col_offset=12), simple=1, lineno=70, col_offset=4, end_lineno=70, end_col_offset=12), AnnAssign(target=Name(id='start_byte', ctx=Store(), lineno=71, col_offset=4, end_lineno=71, end_col_offset=14), annotation=Name(id='int', ctx=Load(), lineno=71, col_offset=16, end_lineno=71, end_col_offset=19), simple=1, lineno=71, col_offset=4, end_lineno=71, end_col_offset=19), AnnAssign(target=Name(id='end_byte', ctx=Store(), lineno=72, col_offset=4, end_lineno=72, end_col_offset=12), annotation=Name(id='int', ctx=Load(), lineno=72, col_offset=14, end_lineno=72, end_col_offset=17), simple=1, lineno=72, col_offset=4, end_lineno=72, end_col_offset=17), AnnAssign(target=Name(id='start_line', ctx=Store(), lineno=73, col_offset=4, end_lineno=73, end_col_offset=14), annotation=Name(id='int', ctx=Load(), lineno=73, col_offset=16, end_lineno=73, end_col_offset=19), simple=1, lineno=73, col_offset=4, end_lineno=73, end_col_offset=19), AnnAssign(target=Name(id='end_line', ctx=Store(), lineno=74, col_offset=4, end_lineno=74, end_col_offset=12), annotation=Name(id='int', ctx=Load(), lineno=74, col_offset=14, end_lineno=74, end_col_offset=17), simple=1, lineno=74, col_offset=4, end_lineno=74, end_col_offset=17), AnnAssign(target=Name(id='text', ctx=Store(), lineno=75, col_offset=4, end_lineno=75, end_col_offset=8), annotation=Name(id='str', ctx=Load(), lineno=75, col_offset=10, end_lineno=75, end_col_offset=13), simple=1, lineno=75, col_offset=4, end_lineno=75, end_col_offset=13), AnnAssign(target=Name(id='symbols', ctx=Store(), lineno=76, col_offset=4, end_lineno=76, end_col_offset=11), annotation=Subscript(value=Name(id='tuple', ctx=Load(), lineno=76, col_offset=13, end_lineno=76, end_col_offset=18), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=76, col_offset=19, end_lineno=76, end_col_offset=22), Constant(value=Ellipsis, lineno=76, col_offset=24, end_lineno=76, end_col_offset=27)], ctx=Load(), lineno=76, col_offset=19, end_lineno=76, end_col_offset=27), ctx=Load(), lineno=76, col_offset=13, end_lineno=76, end_col_offset=28), simple=1, lineno=76, col_offset=4, end_lineno=76, end_col_offset=28), AnnAssign(target=Name(id='language', ctx=Store(), lineno=77, col_offset=4, end_lineno=77, end_col_offset=12), annotation=Name(id='str', ctx=Load(), lineno=77, col_offset=14, end_lineno=77, end_col_offset=17), simple=1, lineno=77, col_offset=4, end_lineno=77, end_col_offset=17)], decorator_list=[Call(func=Name(id='dataclass', ctx=Load(), lineno=20, col_offset=1, end_lineno=20, end_col_offset=10), keywords=[keyword(arg='frozen', value=Constant(value=True, lineno=20, col_offset=18, end_lineno=20, end_col_offset=22), lineno=20, col_offset=11, end_lineno=20, end_col_offset=22)], lineno=20, col_offset=1, end_lineno=20, end_col_offset=23)], lineno=21, col_offset=0, end_lineno=77, end_col_offset=17), ClassDef(name='LineIndex', body=[Expr(value=Constant(value='Line start bookkeeping for both character and byte positions.', lineno=82, col_offset=4, end_lineno=82, end_col_offset=71), lineno=82, col_offset=4, end_lineno=82, end_col_offset=71), AnnAssign(target=Name(id='char_starts', ctx=Store(), lineno=84, col_offset=4, end_lineno=84, end_col_offset=15), annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=84, col_offset=17, end_lineno=84, end_col_offset=21), slice=Name(id='int', ctx=Load(), lineno=84, col_offset=22, end_lineno=84, end_col_offset=25), ctx=Load(), lineno=84, col_offset=17, end_lineno=84, end_col_offset=26), simple=1, lineno=84, col_offset=4, end_lineno=84, end_col_offset=26), AnnAssign(target=Name(id='byte_starts', ctx=Store(), lineno=85, col_offset=4, end_lineno=85, end_col_offset=15), annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=85, col_offset=17, end_lineno=85, end_col_offset=21), slice=Name(id='int', ctx=Load(), lineno=85, col_offset=22, end_lineno=85, end_col_offset=25), ctx=Load(), lineno=85, col_offset=17, end_lineno=85, end_col_offset=26), simple=1, lineno=85, col_offset=4, end_lineno=85, end_col_offset=26), AnnAssign(target=Name(id='char_to_byte', ctx=Store(), lineno=86, col_offset=4, end_lineno=86, end_col_offset=16), annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=86, col_offset=18, end_lineno=86, end_col_offset=22), slice=Name(id='int', ctx=Load(), lineno=86, col_offset=23, end_lineno=86, end_col_offset=26), ctx=Load(), lineno=86, col_offset=18, end_lineno=86, end_col_offset=27), simple=1, lineno=86, col_offset=4, end_lineno=86, end_col_offset=27), FunctionDef(name='text_length', args=arguments(args=[arg(arg='self', lineno=89, col_offset=20, end_lineno=89, end_col_offset=24)]), body=[Expr(value=Constant(value='Return the decoded text length in characters.', lineno=90, col_offset=8, end_lineno=90, end_col_offset=59), lineno=90, col_offset=8, end_lineno=90, end_col_offset=59), Return(value=BinOp(left=Call(func=Name(id='len', ctx=Load(), lineno=91, col_offset=15, end_lineno=91, end_col_offset=18), args=[Attribute(value=Name(id='self', ctx=Load(), lineno=91, col_offset=19, end_lineno=91, end_col_offset=23), attr='char_to_byte', ctx=Load(), lineno=91, col_offset=19, end_lineno=91, end_col_offset=36)], lineno=91, col_offset=15, end_lineno=91, end_col_offset=37), op=Sub(), right=Constant(value=1, lineno=91, col_offset=40, end_lineno=91, end_col_offset=41), lineno=91, col_offset=15, end_lineno=91, end_col_offset=41), lineno=91, col_offset=8, end_lineno=91, end_col_offset=41)], decorator_list=[Name(id='property', ctx=Load(), lineno=88, col_offset=5, end_lineno=88, end_col_offset=13)], returns=Name(id='int', ctx=Load(), lineno=89, col_offset=29, end_lineno=89, end_col_offset=32), lineno=89, col_offset=4, end_lineno=91, end_col_offset=41)], decorator_list=[Call(func=Name(id='dataclass', ctx=Load(), lineno=80, col_offset=1, end_lineno=80, end_col_offset=10), keywords=[keyword(arg='frozen', value=Constant(value=True, lineno=80, col_offset=18, end_lineno=80, end_col_offset=22), lineno=80, col_offset=11, end_lineno=80, end_col_offset=22)], lineno=80, col_offset=1, end_lineno=80, end_col_offset=23)], lineno=81, col_offset=0, end_lineno=91, end_col_offset=41), Assign(targets=[Name(id='_ONE_BYTE_MAX', ctx=Store(), lineno=94, col_offset=0, end_lineno=94, end_col_offset=13)], value=Constant(value=127, lineno=94, col_offset=16, end_lineno=94, end_col_offset=20), lineno=94, col_offset=0, end_lineno=94, end_col_offset=20), Assign(targets=[Name(id='_TWO_BYTE_MAX', ctx=Store(), lineno=95, col_offset=0, end_lineno=95, end_col_offset=13)], value=Constant(value=2047, lineno=95, col_offset=16, end_lineno=95, end_col_offset=21), lineno=95, col_offset=0, end_lineno=95, end_col_offset=21), Assign(targets=[Name(id='_THREE_BYTE_MAX', ctx=Store(), lineno=96, col_offset=0, end_lineno=96, end_col_offset=15)], value=Constant(value=65535, lineno=96, col_offset=18, end_lineno=96, end_col_offset=24), lineno=96, col_offset=0, end_lineno=96, end_col_offset=24), FunctionDef(name='_utf8_length', args=arguments(args=[arg(arg='ch', annotation=Name(id='str', ctx=Load(), lineno=99, col_offset=21, end_lineno=99, end_col_offset=24), lineno=99, col_offset=17, end_lineno=99, end_col_offset=24)]), body=[Expr(value=Constant(value='Return the UTF-8 encoded length for ``ch``.\n\n    Parameters\n    ----------\n    ch : str\n        Single character to measure.\n\n    Returns\n    -------\n    int\n        Number of bytes required to encode the character in UTF-8 (1-4).\n    ', lineno=100, col_offset=4, end_lineno=111, end_col_offset=7), lineno=100, col_offset=4, end_lineno=111, end_col_offset=7), Assign(targets=[Name(id='code_point', ctx=Store(), lineno=112, col_offset=4, end_lineno=112, end_col_offset=14)], value=Call(func=Name(id='ord', ctx=Load(), lineno=112, col_offset=17, end_lineno=112, end_col_offset=20), args=[Name(id='ch', ctx=Load(), lineno=112, col_offset=21, end_lineno=112, end_col_offset=23)], lineno=112, col_offset=17, end_lineno=112, end_col_offset=24), lineno=112, col_offset=4, end_lineno=112, end_col_offset=24), If(test=Compare(left=Name(id='code_point', ctx=Load(), lineno=113, col_offset=7, end_lineno=113, end_col_offset=17), ops=[LtE()], comparators=[Name(id='_ONE_BYTE_MAX', ctx=Load(), lineno=113, col_offset=21, end_lineno=113, end_col_offset=34)], lineno=113, col_offset=7, end_lineno=113, end_col_offset=34), body=[Return(value=Constant(value=1, lineno=114, col_offset=15, end_lineno=114, end_col_offset=16), lineno=114, col_offset=8, end_lineno=114, end_col_offset=16)], lineno=113, col_offset=4, end_lineno=114, end_col_offset=16), If(test=Compare(left=Name(id='code_point', ctx=Load(), lineno=115, col_offset=7, end_lineno=115, end_col_offset=17), ops=[LtE()], comparators=[Name(id='_TWO_BYTE_MAX', ctx=Load(), lineno=115, col_offset=21, end_lineno=115, end_col_offset=34)], lineno=115, col_offset=7, end_lineno=115, end_col_offset=34), body=[Return(value=Constant(value=2, lineno=116, col_offset=15, end_lineno=116, end_col_offset=16), lineno=116, col_offset=8, end_lineno=116, end_col_offset=16)], lineno=115, col_offset=4, end_lineno=116, end_col_offset=16), If(test=Compare(left=Name(id='code_point', ctx=Load(), lineno=117, col_offset=7, end_lineno=117, end_col_offset=17), ops=[LtE()], comparators=[Name(id='_THREE_BYTE_MAX', ctx=Load(), lineno=117, col_offset=21, end_lineno=117, end_col_offset=36)], lineno=117, col_offset=7, end_lineno=117, end_col_offset=36), body=[Return(value=Constant(value=3, lineno=118, col_offset=15, end_lineno=118, end_col_offset=16), lineno=118, col_offset=8, end_lineno=118, end_col_offset=16)], lineno=117, col_offset=4, end_lineno=118, end_col_offset=16), Return(value=Constant(value=4, lineno=119, col_offset=11, end_lineno=119, end_col_offset=12), lineno=119, col_offset=4, end_lineno=119, end_col_offset=12)], returns=Name(id='int', ctx=Load(), lineno=99, col_offset=29, end_lineno=99, end_col_offset=32), lineno=99, col_offset=0, end_lineno=119, end_col_offset=12), FunctionDef(name='line_starts', args=arguments(args=[arg(arg='text', annotation=Name(id='str', ctx=Load(), lineno=122, col_offset=22, end_lineno=122, end_col_offset=25), lineno=122, col_offset=16, end_lineno=122, end_col_offset=25)]), body=[Expr(value=Constant(value='Compute character and byte offsets for each line start.\n\n    Parameters\n    ----------\n    text : str\n        Input text to index.\n\n    Returns\n    -------\n    LineIndex\n        Index containing character starts, byte starts, and character-to-byte mapping.\n    ', lineno=123, col_offset=4, end_lineno=134, end_col_offset=7), lineno=123, col_offset=4, end_lineno=134, end_col_offset=7), Assign(targets=[Name(id='char_starts', ctx=Store(), lineno=135, col_offset=4, end_lineno=135, end_col_offset=15)], value=List(elts=[Constant(value=0, lineno=135, col_offset=19, end_lineno=135, end_col_offset=20)], ctx=Load(), lineno=135, col_offset=18, end_lineno=135, end_col_offset=21), lineno=135, col_offset=4, end_lineno=135, end_col_offset=21), Assign(targets=[Name(id='byte_starts', ctx=Store(), lineno=136, col_offset=4, end_lineno=136, end_col_offset=15)], value=List(elts=[Constant(value=0, lineno=136, col_offset=19, end_lineno=136, end_col_offset=20)], ctx=Load(), lineno=136, col_offset=18, end_lineno=136, end_col_offset=21), lineno=136, col_offset=4, end_lineno=136, end_col_offset=21), Assign(targets=[Name(id='char_to_byte', ctx=Store(), lineno=137, col_offset=4, end_lineno=137, end_col_offset=16)], value=List(elts=[Constant(value=0, lineno=137, col_offset=20, end_lineno=137, end_col_offset=21)], ctx=Load(), lineno=137, col_offset=19, end_lineno=137, end_col_offset=22), lineno=137, col_offset=4, end_lineno=137, end_col_offset=22), Assign(targets=[Name(id='byte_offset', ctx=Store(), lineno=138, col_offset=4, end_lineno=138, end_col_offset=15)], value=Constant(value=0, lineno=138, col_offset=18, end_lineno=138, end_col_offset=19), lineno=138, col_offset=4, end_lineno=138, end_col_offset=19), For(target=Tuple(elts=[Name(id='index', ctx=Store(), lineno=140, col_offset=8, end_lineno=140, end_col_offset=13), Name(id='ch', ctx=Store(), lineno=140, col_offset=15, end_lineno=140, end_col_offset=17)], ctx=Store(), lineno=140, col_offset=8, end_lineno=140, end_col_offset=17), iter=Call(func=Name(id='enumerate', ctx=Load(), lineno=140, col_offset=21, end_lineno=140, end_col_offset=30), args=[Name(id='text', ctx=Load(), lineno=140, col_offset=31, end_lineno=140, end_col_offset=35)], lineno=140, col_offset=21, end_lineno=140, end_col_offset=36), body=[AugAssign(target=Name(id='byte_offset', ctx=Store(), lineno=141, col_offset=8, end_lineno=141, end_col_offset=19), op=Add(), value=Call(func=Name(id='_utf8_length', ctx=Load(), lineno=141, col_offset=23, end_lineno=141, end_col_offset=35), args=[Name(id='ch', ctx=Load(), lineno=141, col_offset=36, end_lineno=141, end_col_offset=38)], lineno=141, col_offset=23, end_lineno=141, end_col_offset=39), lineno=141, col_offset=8, end_lineno=141, end_col_offset=39), Expr(value=Call(func=Attribute(value=Name(id='char_to_byte', ctx=Load(), lineno=142, col_offset=8, end_lineno=142, end_col_offset=20), attr='append', ctx=Load(), lineno=142, col_offset=8, end_lineno=142, end_col_offset=27), args=[Name(id='byte_offset', ctx=Load(), lineno=142, col_offset=28, end_lineno=142, end_col_offset=39)], lineno=142, col_offset=8, end_lineno=142, end_col_offset=40), lineno=142, col_offset=8, end_lineno=142, end_col_offset=40), If(test=Compare(left=Name(id='ch', ctx=Load(), lineno=143, col_offset=11, end_lineno=143, end_col_offset=13), ops=[Eq()], comparators=[Constant(value='\n', lineno=143, col_offset=17, end_lineno=143, end_col_offset=21)], lineno=143, col_offset=11, end_lineno=143, end_col_offset=21), body=[Expr(value=Call(func=Attribute(value=Name(id='char_starts', ctx=Load(), lineno=144, col_offset=12, end_lineno=144, end_col_offset=23), attr='append', ctx=Load(), lineno=144, col_offset=12, end_lineno=144, end_col_offset=30), args=[BinOp(left=Name(id='index', ctx=Load(), lineno=144, col_offset=31, end_lineno=144, end_col_offset=36), op=Add(), right=Constant(value=1, lineno=144, col_offset=39, end_lineno=144, end_col_offset=40), lineno=144, col_offset=31, end_lineno=144, end_col_offset=40)], lineno=144, col_offset=12, end_lineno=144, end_col_offset=41), lineno=144, col_offset=12, end_lineno=144, end_col_offset=41), Expr(value=Call(func=Attribute(value=Name(id='byte_starts', ctx=Load(), lineno=145, col_offset=12, end_lineno=145, end_col_offset=23), attr='append', ctx=Load(), lineno=145, col_offset=12, end_lineno=145, end_col_offset=30), args=[Name(id='byte_offset', ctx=Load(), lineno=145, col_offset=31, end_lineno=145, end_col_offset=42)], lineno=145, col_offset=12, end_lineno=145, end_col_offset=43), lineno=145, col_offset=12, end_lineno=145, end_col_offset=43)], lineno=143, col_offset=8, end_lineno=145, end_col_offset=43)], lineno=140, col_offset=4, end_lineno=145, end_col_offset=43), Return(value=Call(func=Name(id='LineIndex', ctx=Load(), lineno=147, col_offset=11, end_lineno=147, end_col_offset=20), keywords=[keyword(arg='char_starts', value=Name(id='char_starts', ctx=Load(), lineno=147, col_offset=33, end_lineno=147, end_col_offset=44), lineno=147, col_offset=21, end_lineno=147, end_col_offset=44), keyword(arg='byte_starts', value=Name(id='byte_starts', ctx=Load(), lineno=147, col_offset=58, end_lineno=147, end_col_offset=69), lineno=147, col_offset=46, end_lineno=147, end_col_offset=69), keyword(arg='char_to_byte', value=Name(id='char_to_byte', ctx=Load(), lineno=147, col_offset=84, end_lineno=147, end_col_offset=96), lineno=147, col_offset=71, end_lineno=147, end_col_offset=96)], lineno=147, col_offset=11, end_lineno=147, end_col_offset=97), lineno=147, col_offset=4, end_lineno=147, end_col_offset=97)], returns=Name(id='LineIndex', ctx=Load(), lineno=122, col_offset=30, end_lineno=122, end_col_offset=39), lineno=122, col_offset=0, end_lineno=147, end_col_offset=97), FunctionDef(name='_line_index_from_byte', args=arguments(args=[arg(arg='starts', annotation=Subscript(value=Name(id='Sequence', ctx=Load(), lineno=150, col_offset=34, end_lineno=150, end_col_offset=42), slice=Name(id='int', ctx=Load(), lineno=150, col_offset=43, end_lineno=150, end_col_offset=46), ctx=Load(), lineno=150, col_offset=34, end_lineno=150, end_col_offset=47), lineno=150, col_offset=26, end_lineno=150, end_col_offset=47), arg(arg='byte_offset', annotation=Name(id='int', ctx=Load(), lineno=150, col_offset=62, end_lineno=150, end_col_offset=65), lineno=150, col_offset=49, end_lineno=150, end_col_offset=65)]), body=[Expr(value=Constant(value='Return the zero-based line index containing ``byte_offset``.\n\n    Parameters\n    ----------\n    starts : Sequence[int]\n        Offsets for the beginning of each line.\n    byte_offset : int\n        Absolute byte offset within the text.\n\n    Returns\n    -------\n    int\n        Zero-based line index best matching the offset.\n    ', lineno=151, col_offset=4, end_lineno=164, end_col_offset=7), lineno=151, col_offset=4, end_lineno=164, end_col_offset=7), Assign(targets=[Name(id='index', ctx=Store(), lineno=165, col_offset=4, end_lineno=165, end_col_offset=9)], value=BinOp(left=Call(func=Name(id='bisect_right', ctx=Load(), lineno=165, col_offset=12, end_lineno=165, end_col_offset=24), args=[Name(id='starts', ctx=Load(), lineno=165, col_offset=25, end_lineno=165, end_col_offset=31), Name(id='byte_offset', ctx=Load(), lineno=165, col_offset=33, end_lineno=165, end_col_offset=44)], lineno=165, col_offset=12, end_lineno=165, end_col_offset=45), op=Sub(), right=Constant(value=1, lineno=165, col_offset=48, end_lineno=165, end_col_offset=49), lineno=165, col_offset=12, end_lineno=165, end_col_offset=49), lineno=165, col_offset=4, end_lineno=165, end_col_offset=49), If(test=Compare(left=Name(id='index', ctx=Load(), lineno=166, col_offset=7, end_lineno=166, end_col_offset=12), ops=[Lt()], comparators=[Constant(value=0, lineno=166, col_offset=15, end_lineno=166, end_col_offset=16)], lineno=166, col_offset=7, end_lineno=166, end_col_offset=16), body=[Return(value=Constant(value=0, lineno=167, col_offset=15, end_lineno=167, end_col_offset=16), lineno=167, col_offset=8, end_lineno=167, end_col_offset=16)], lineno=166, col_offset=4, end_lineno=167, end_col_offset=16), Return(value=Call(func=Name(id='min', ctx=Load(), lineno=168, col_offset=11, end_lineno=168, end_col_offset=14), args=[Name(id='index', ctx=Load(), lineno=168, col_offset=15, end_lineno=168, end_col_offset=20), BinOp(left=Call(func=Name(id='len', ctx=Load(), lineno=168, col_offset=22, end_lineno=168, end_col_offset=25), args=[Name(id='starts', ctx=Load(), lineno=168, col_offset=26, end_lineno=168, end_col_offset=32)], lineno=168, col_offset=22, end_lineno=168, end_col_offset=33), op=Sub(), right=Constant(value=1, lineno=168, col_offset=36, end_lineno=168, end_col_offset=37), lineno=168, col_offset=22, end_lineno=168, end_col_offset=37)], lineno=168, col_offset=11, end_lineno=168, end_col_offset=38), lineno=168, col_offset=4, end_lineno=168, end_col_offset=38)], returns=Name(id='int', ctx=Load(), lineno=150, col_offset=70, end_lineno=150, end_col_offset=73), lineno=150, col_offset=0, end_lineno=168, end_col_offset=38), FunctionDef(name='_char_index_for_line', args=arguments(args=[arg(arg='line_index', annotation=Name(id='LineIndex', ctx=Load(), lineno=171, col_offset=37, end_lineno=171, end_col_offset=46), lineno=171, col_offset=25, end_lineno=171, end_col_offset=46), arg(arg='line', annotation=Name(id='int', ctx=Load(), lineno=171, col_offset=54, end_lineno=171, end_col_offset=57), lineno=171, col_offset=48, end_lineno=171, end_col_offset=57), arg(arg='character', annotation=Name(id='int', ctx=Load(), lineno=171, col_offset=70, end_lineno=171, end_col_offset=73), lineno=171, col_offset=59, end_lineno=171, end_col_offset=73)]), body=[Expr(value=Constant(value='Map a line/character pair to an absolute character index.\n\n    Parameters\n    ----------\n    line_index : LineIndex\n        Line index containing character start positions.\n    line : int\n        Zero-based line number.\n    character : int\n        Zero-based character offset within the line.\n\n    Returns\n    -------\n    int\n        Absolute character index in the text, clamped to valid range.\n    ', lineno=172, col_offset=4, end_lineno=187, end_col_offset=7), lineno=172, col_offset=4, end_lineno=187, end_col_offset=7), If(test=Compare(left=Name(id='line', ctx=Load(), lineno=188, col_offset=7, end_lineno=188, end_col_offset=11), ops=[GtE()], comparators=[Call(func=Name(id='len', ctx=Load(), lineno=188, col_offset=15, end_lineno=188, end_col_offset=18), args=[Attribute(value=Name(id='line_index', ctx=Load(), lineno=188, col_offset=19, end_lineno=188, end_col_offset=29), attr='char_starts', ctx=Load(), lineno=188, col_offset=19, end_lineno=188, end_col_offset=41)], lineno=188, col_offset=15, end_lineno=188, end_col_offset=42)], lineno=188, col_offset=7, end_lineno=188, end_col_offset=42), body=[Return(value=Attribute(value=Name(id='line_index', ctx=Load(), lineno=189, col_offset=15, end_lineno=189, end_col_offset=25), attr='text_length', ctx=Load(), lineno=189, col_offset=15, end_lineno=189, end_col_offset=37), lineno=189, col_offset=8, end_lineno=189, end_col_offset=37)], lineno=188, col_offset=4, end_lineno=189, end_col_offset=37), Assign(targets=[Name(id='base', ctx=Store(), lineno=191, col_offset=4, end_lineno=191, end_col_offset=8)], value=Subscript(value=Attribute(value=Name(id='line_index', ctx=Load(), lineno=191, col_offset=11, end_lineno=191, end_col_offset=21), attr='char_starts', ctx=Load(), lineno=191, col_offset=11, end_lineno=191, end_col_offset=33), slice=Name(id='line', ctx=Load(), lineno=191, col_offset=34, end_lineno=191, end_col_offset=38), ctx=Load(), lineno=191, col_offset=11, end_lineno=191, end_col_offset=39), lineno=191, col_offset=4, end_lineno=191, end_col_offset=39), Assign(targets=[Name(id='candidate', ctx=Store(), lineno=192, col_offset=4, end_lineno=192, end_col_offset=13)], value=BinOp(left=Name(id='base', ctx=Load(), lineno=192, col_offset=16, end_lineno=192, end_col_offset=20), op=Add(), right=Name(id='character', ctx=Load(), lineno=192, col_offset=23, end_lineno=192, end_col_offset=32), lineno=192, col_offset=16, end_lineno=192, end_col_offset=32), lineno=192, col_offset=4, end_lineno=192, end_col_offset=32), If(test=Compare(left=Name(id='candidate', ctx=Load(), lineno=193, col_offset=7, end_lineno=193, end_col_offset=16), ops=[Gt()], comparators=[Attribute(value=Name(id='line_index', ctx=Load(), lineno=193, col_offset=19, end_lineno=193, end_col_offset=29), attr='text_length', ctx=Load(), lineno=193, col_offset=19, end_lineno=193, end_col_offset=41)], lineno=193, col_offset=7, end_lineno=193, end_col_offset=41), body=[Return(value=Attribute(value=Name(id='line_index', ctx=Load(), lineno=194, col_offset=15, end_lineno=194, end_col_offset=25), attr='text_length', ctx=Load(), lineno=194, col_offset=15, end_lineno=194, end_col_offset=37), lineno=194, col_offset=8, end_lineno=194, end_col_offset=37)], lineno=193, col_offset=4, end_lineno=194, end_col_offset=37), Return(value=Name(id='candidate', ctx=Load(), lineno=195, col_offset=11, end_lineno=195, end_col_offset=20), lineno=195, col_offset=4, end_lineno=195, end_col_offset=20)], returns=Name(id='int', ctx=Load(), lineno=171, col_offset=78, end_lineno=171, end_col_offset=81), lineno=171, col_offset=0, end_lineno=195, end_col_offset=20), FunctionDef(name='range_to_bytes', args=arguments(args=[arg(arg='text', annotation=Name(id='str', ctx=Load(), lineno=198, col_offset=25, end_lineno=198, end_col_offset=28), lineno=198, col_offset=19, end_lineno=198, end_col_offset=28), arg(arg='line_index', annotation=Name(id='LineIndex', ctx=Load(), lineno=198, col_offset=42, end_lineno=198, end_col_offset=51), lineno=198, col_offset=30, end_lineno=198, end_col_offset=51), arg(arg='rng', annotation=Name(id='Range', ctx=Load(), lineno=198, col_offset=58, end_lineno=198, end_col_offset=63), lineno=198, col_offset=53, end_lineno=198, end_col_offset=63)]), body=[Expr(value=Constant(value='Convert line/character range to byte offsets.\n\n    Parameters\n    ----------\n    text : str\n        Source text (unused, retained for backward compatibility).\n    line_index : LineIndex\n        Line index for character-to-byte conversion.\n    rng : Range\n        Range with start and end line/character positions.\n\n    Returns\n    -------\n    tuple[int, int]\n        Tuple of (start_byte, end_byte) offsets.\n    ', lineno=199, col_offset=4, end_lineno=214, end_col_offset=7), lineno=199, col_offset=4, end_lineno=214, end_col_offset=7), Delete(targets=[Name(id='text', ctx=Del(), lineno=215, col_offset=8, end_lineno=215, end_col_offset=12)], lineno=215, col_offset=4, end_lineno=215, end_col_offset=12), Assign(targets=[Name(id='start_char', ctx=Store(), lineno=217, col_offset=4, end_lineno=217, end_col_offset=14)], value=Call(func=Name(id='_char_index_for_line', ctx=Load(), lineno=217, col_offset=17, end_lineno=217, end_col_offset=37), args=[Name(id='line_index', ctx=Load(), lineno=217, col_offset=38, end_lineno=217, end_col_offset=48), Attribute(value=Name(id='rng', ctx=Load(), lineno=217, col_offset=50, end_lineno=217, end_col_offset=53), attr='start_line', ctx=Load(), lineno=217, col_offset=50, end_lineno=217, end_col_offset=64), Attribute(value=Name(id='rng', ctx=Load(), lineno=217, col_offset=66, end_lineno=217, end_col_offset=69), attr='start_character', ctx=Load(), lineno=217, col_offset=66, end_lineno=217, end_col_offset=85)], lineno=217, col_offset=17, end_lineno=217, end_col_offset=86), lineno=217, col_offset=4, end_lineno=217, end_col_offset=86), Assign(targets=[Name(id='end_char', ctx=Store(), lineno=218, col_offset=4, end_lineno=218, end_col_offset=12)], value=Call(func=Name(id='_char_index_for_line', ctx=Load(), lineno=218, col_offset=15, end_lineno=218, end_col_offset=35), args=[Name(id='line_index', ctx=Load(), lineno=218, col_offset=36, end_lineno=218, end_col_offset=46), Attribute(value=Name(id='rng', ctx=Load(), lineno=218, col_offset=48, end_lineno=218, end_col_offset=51), attr='end_line', ctx=Load(), lineno=218, col_offset=48, end_lineno=218, end_col_offset=60), Attribute(value=Name(id='rng', ctx=Load(), lineno=218, col_offset=62, end_lineno=218, end_col_offset=65), attr='end_character', ctx=Load(), lineno=218, col_offset=62, end_lineno=218, end_col_offset=79)], lineno=218, col_offset=15, end_lineno=218, end_col_offset=80), lineno=218, col_offset=4, end_lineno=218, end_col_offset=80), Assign(targets=[Name(id='start_byte', ctx=Store(), lineno=220, col_offset=4, end_lineno=220, end_col_offset=14)], value=Subscript(value=Attribute(value=Name(id='line_index', ctx=Load(), lineno=220, col_offset=17, end_lineno=220, end_col_offset=27), attr='char_to_byte', ctx=Load(), lineno=220, col_offset=17, end_lineno=220, end_col_offset=40), slice=Name(id='start_char', ctx=Load(), lineno=220, col_offset=41, end_lineno=220, end_col_offset=51), ctx=Load(), lineno=220, col_offset=17, end_lineno=220, end_col_offset=52), lineno=220, col_offset=4, end_lineno=220, end_col_offset=52), Assign(targets=[Name(id='end_byte', ctx=Store(), lineno=221, col_offset=4, end_lineno=221, end_col_offset=12)], value=Subscript(value=Attribute(value=Name(id='line_index', ctx=Load(), lineno=221, col_offset=15, end_lineno=221, end_col_offset=25), attr='char_to_byte', ctx=Load(), lineno=221, col_offset=15, end_lineno=221, end_col_offset=38), slice=Name(id='end_char', ctx=Load(), lineno=221, col_offset=39, end_lineno=221, end_col_offset=47), ctx=Load(), lineno=221, col_offset=15, end_lineno=221, end_col_offset=48), lineno=221, col_offset=4, end_lineno=221, end_col_offset=48), Return(value=Tuple(elts=[Name(id='start_byte', ctx=Load(), lineno=222, col_offset=11, end_lineno=222, end_col_offset=21), Name(id='end_byte', ctx=Load(), lineno=222, col_offset=23, end_lineno=222, end_col_offset=31)], ctx=Load(), lineno=222, col_offset=11, end_lineno=222, end_col_offset=31), lineno=222, col_offset=4, end_lineno=222, end_col_offset=31)], returns=Subscript(value=Name(id='tuple', ctx=Load(), lineno=198, col_offset=68, end_lineno=198, end_col_offset=73), slice=Tuple(elts=[Name(id='int', ctx=Load(), lineno=198, col_offset=74, end_lineno=198, end_col_offset=77), Name(id='int', ctx=Load(), lineno=198, col_offset=79, end_lineno=198, end_col_offset=82)], ctx=Load(), lineno=198, col_offset=74, end_lineno=198, end_col_offset=82), ctx=Load(), lineno=198, col_offset=68, end_lineno=198, end_col_offset=83), lineno=198, col_offset=0, end_lineno=222, end_col_offset=31), ClassDef(name='_ChunkAccumulator', body=[Expr(value=Constant(value='Immutable accumulator configuration; delegates mutation to a builder.', lineno=227, col_offset=4, end_lineno=227, end_col_offset=79), lineno=227, col_offset=4, end_lineno=227, end_col_offset=79), AnnAssign(target=Name(id='uri', ctx=Store(), lineno=229, col_offset=4, end_lineno=229, end_col_offset=7), annotation=Name(id='str', ctx=Load(), lineno=229, col_offset=9, end_lineno=229, end_col_offset=12), simple=1, lineno=229, col_offset=4, end_lineno=229, end_col_offset=12), AnnAssign(target=Name(id='text', ctx=Store(), lineno=230, col_offset=4, end_lineno=230, end_col_offset=8), annotation=Name(id='str', ctx=Load(), lineno=230, col_offset=10, end_lineno=230, end_col_offset=13), simple=1, lineno=230, col_offset=4, end_lineno=230, end_col_offset=13), AnnAssign(target=Name(id='encoded', ctx=Store(), lineno=231, col_offset=4, end_lineno=231, end_col_offset=11), annotation=Name(id='bytes', ctx=Load(), lineno=231, col_offset=13, end_lineno=231, end_col_offset=18), simple=1, lineno=231, col_offset=4, end_lineno=231, end_col_offset=18), AnnAssign(target=Name(id='line_index', ctx=Store(), lineno=232, col_offset=4, end_lineno=232, end_col_offset=14), annotation=Name(id='LineIndex', ctx=Load(), lineno=232, col_offset=16, end_lineno=232, end_col_offset=25), simple=1, lineno=232, col_offset=4, end_lineno=232, end_col_offset=25), AnnAssign(target=Name(id='budget', ctx=Store(), lineno=233, col_offset=4, end_lineno=233, end_col_offset=10), annotation=Name(id='int', ctx=Load(), lineno=233, col_offset=12, end_lineno=233, end_col_offset=15), simple=1, lineno=233, col_offset=4, end_lineno=233, end_col_offset=15), AnnAssign(target=Name(id='language', ctx=Store(), lineno=234, col_offset=4, end_lineno=234, end_col_offset=12), annotation=Name(id='str', ctx=Load(), lineno=234, col_offset=14, end_lineno=234, end_col_offset=17), simple=1, lineno=234, col_offset=4, end_lineno=234, end_col_offset=17), FunctionDef(name='build_chunks', args=arguments(args=[arg(arg='self', lineno=237, col_offset=8, end_lineno=237, end_col_offset=12), arg(arg='symbols_with_positions', annotation=Subscript(value=Name(id='Sequence', ctx=Load(), lineno=238, col_offset=32, end_lineno=238, end_col_offset=40), slice=Subscript(value=Name(id='tuple', ctx=Load(), lineno=238, col_offset=41, end_lineno=238, end_col_offset=46), slice=Tuple(elts=[Name(id='SymbolDef', ctx=Load(), lineno=238, col_offset=47, end_lineno=238, end_col_offset=56), Name(id='int', ctx=Load(), lineno=238, col_offset=58, end_lineno=238, end_col_offset=61), Name(id='int', ctx=Load(), lineno=238, col_offset=63, end_lineno=238, end_col_offset=66)], ctx=Load(), lineno=238, col_offset=47, end_lineno=238, end_col_offset=66), ctx=Load(), lineno=238, col_offset=41, end_lineno=238, end_col_offset=67), ctx=Load(), lineno=238, col_offset=32, end_lineno=238, end_col_offset=68), lineno=238, col_offset=8, end_lineno=238, end_col_offset=68)]), body=[Assign(targets=[Name(id='builder', ctx=Store(), lineno=240, col_offset=8, end_lineno=240, end_col_offset=15)], value=Call(func=Name(id='_ChunkBuilder', ctx=Load(), lineno=240, col_offset=18, end_lineno=240, end_col_offset=31), keywords=[keyword(arg='config', value=Name(id='self', ctx=Load(), lineno=240, col_offset=39, end_lineno=240, end_col_offset=43), lineno=240, col_offset=32, end_lineno=240, end_col_offset=43)], lineno=240, col_offset=18, end_lineno=240, end_col_offset=44), lineno=240, col_offset=8, end_lineno=240, end_col_offset=44), For(target=Tuple(elts=[Name(id='symbol', ctx=Store(), lineno=241, col_offset=12, end_lineno=241, end_col_offset=18), Name(id='start', ctx=Store(), lineno=241, col_offset=20, end_lineno=241, end_col_offset=25), Name(id='end', ctx=Store(), lineno=241, col_offset=27, end_lineno=241, end_col_offset=30)], ctx=Store(), lineno=241, col_offset=12, end_lineno=241, end_col_offset=30), iter=Name(id='symbols_with_positions', ctx=Load(), lineno=241, col_offset=34, end_lineno=241, end_col_offset=56), body=[Expr(value=Call(func=Attribute(value=Name(id='builder', ctx=Load(), lineno=242, col_offset=12, end_lineno=242, end_col_offset=19), attr='add_symbol', ctx=Load(), lineno=242, col_offset=12, end_lineno=242, end_col_offset=30), args=[Name(id='symbol', ctx=Load(), lineno=242, col_offset=31, end_lineno=242, end_col_offset=37), Name(id='start', ctx=Load(), lineno=242, col_offset=39, end_lineno=242, end_col_offset=44), Name(id='end', ctx=Load(), lineno=242, col_offset=46, end_lineno=242, end_col_offset=49)], lineno=242, col_offset=12, end_lineno=242, end_col_offset=50), lineno=242, col_offset=12, end_lineno=242, end_col_offset=50)], lineno=241, col_offset=8, end_lineno=242, end_col_offset=50), Return(value=Call(func=Attribute(value=Name(id='builder', ctx=Load(), lineno=243, col_offset=15, end_lineno=243, end_col_offset=22), attr='finalize', ctx=Load(), lineno=243, col_offset=15, end_lineno=243, end_col_offset=31), lineno=243, col_offset=15, end_lineno=243, end_col_offset=33), lineno=243, col_offset=8, end_lineno=243, end_col_offset=33)], returns=Subscript(value=Name(id='list', ctx=Load(), lineno=239, col_offset=9, end_lineno=239, end_col_offset=13), slice=Name(id='Chunk', ctx=Load(), lineno=239, col_offset=14, end_lineno=239, end_col_offset=19), ctx=Load(), lineno=239, col_offset=9, end_lineno=239, end_col_offset=20), lineno=236, col_offset=4, end_lineno=243, end_col_offset=33)], decorator_list=[Call(func=Name(id='dataclass', ctx=Load(), lineno=225, col_offset=1, end_lineno=225, end_col_offset=10), keywords=[keyword(arg='slots', value=Constant(value=True, lineno=225, col_offset=17, end_lineno=225, end_col_offset=21), lineno=225, col_offset=11, end_lineno=225, end_col_offset=21), keyword(arg='frozen', value=Constant(value=True, lineno=225, col_offset=30, end_lineno=225, end_col_offset=34), lineno=225, col_offset=23, end_lineno=225, end_col_offset=34)], lineno=225, col_offset=1, end_lineno=225, end_col_offset=35)], lineno=226, col_offset=0, end_lineno=243, end_col_offset=33), ClassDef(name='_ChunkBuilder', body=[Expr(value=Constant(value='Mutable helper that performs chunk assembly for a fixed configuration.', lineno=247, col_offset=4, end_lineno=247, end_col_offset=80), lineno=247, col_offset=4, end_lineno=247, end_col_offset=80), Assign(targets=[Name(id='__slots__', ctx=Store(), lineno=249, col_offset=4, end_lineno=249, end_col_offset=13)], value=Tuple(elts=[Constant(value='_chunks', lineno=250, col_offset=8, end_lineno=250, end_col_offset=17), Constant(value='_config', lineno=251, col_offset=8, end_lineno=251, end_col_offset=17), Constant(value='_current_end_char', lineno=252, col_offset=8, end_lineno=252, end_col_offset=27), Constant(value='_current_start_char', lineno=253, col_offset=8, end_lineno=253, end_col_offset=29), Constant(value='_current_symbols', lineno=254, col_offset=8, end_lineno=254, end_col_offset=26)], ctx=Load(), lineno=249, col_offset=16, end_lineno=255, end_col_offset=5), lineno=249, col_offset=4, end_lineno=255, end_col_offset=5), FunctionDef(name='__init__', args=arguments(args=[arg(arg='self', lineno=257, col_offset=17, end_lineno=257, end_col_offset=21), arg(arg='config', annotation=Name(id='_ChunkAccumulator', ctx=Load(), lineno=257, col_offset=31, end_lineno=257, end_col_offset=48), lineno=257, col_offset=23, end_lineno=257, end_col_offset=48)]), body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load(), lineno=258, col_offset=8, end_lineno=258, end_col_offset=12), attr='_config', ctx=Store(), lineno=258, col_offset=8, end_lineno=258, end_col_offset=20)], value=Name(id='config', ctx=Load(), lineno=258, col_offset=23, end_lineno=258, end_col_offset=29), lineno=258, col_offset=8, end_lineno=258, end_col_offset=29), AnnAssign(target=Attribute(value=Name(id='self', ctx=Load(), lineno=259, col_offset=8, end_lineno=259, end_col_offset=12), attr='_chunks', ctx=Store(), lineno=259, col_offset=8, end_lineno=259, end_col_offset=20), annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=259, col_offset=22, end_lineno=259, end_col_offset=26), slice=Name(id='Chunk', ctx=Load(), lineno=259, col_offset=27, end_lineno=259, end_col_offset=32), ctx=Load(), lineno=259, col_offset=22, end_lineno=259, end_col_offset=33), value=List(ctx=Load(), lineno=259, col_offset=36, end_lineno=259, end_col_offset=38), simple=0, lineno=259, col_offset=8, end_lineno=259, end_col_offset=38), AnnAssign(target=Attribute(value=Name(id='self', ctx=Load(), lineno=260, col_offset=8, end_lineno=260, end_col_offset=12), attr='_current_start_char', ctx=Store(), lineno=260, col_offset=8, end_lineno=260, end_col_offset=32), annotation=BinOp(left=Name(id='int', ctx=Load(), lineno=260, col_offset=34, end_lineno=260, end_col_offset=37), op=BitOr(), right=Constant(value=None, lineno=260, col_offset=40, end_lineno=260, end_col_offset=44), lineno=260, col_offset=34, end_lineno=260, end_col_offset=44), value=Constant(value=None, lineno=260, col_offset=47, end_lineno=260, end_col_offset=51), simple=0, lineno=260, col_offset=8, end_lineno=260, end_col_offset=51), AnnAssign(target=Attribute(value=Name(id='self', ctx=Load(), lineno=261, col_offset=8, end_lineno=261, end_col_offset=12), attr='_current_end_char', ctx=Store(), lineno=261, col_offset=8, end_lineno=261, end_col_offset=30), annotation=BinOp(left=Name(id='int', ctx=Load(), lineno=261, col_offset=32, end_lineno=261, end_col_offset=35), op=BitOr(), right=Constant(value=None, lineno=261, col_offset=38, end_lineno=261, end_col_offset=42), lineno=261, col_offset=32, end_lineno=261, end_col_offset=42), value=Constant(value=None, lineno=261, col_offset=45, end_lineno=261, end_col_offset=49), simple=0, lineno=261, col_offset=8, end_lineno=261, end_col_offset=49), AnnAssign(target=Attribute(value=Name(id='self', ctx=Load(), lineno=262, col_offset=8, end_lineno=262, end_col_offset=12), attr='_current_symbols', ctx=Store(), lineno=262, col_offset=8, end_lineno=262, end_col_offset=29), annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=262, col_offset=31, end_lineno=262, end_col_offset=35), slice=Name(id='str', ctx=Load(), lineno=262, col_offset=36, end_lineno=262, end_col_offset=39), ctx=Load(), lineno=262, col_offset=31, end_lineno=262, end_col_offset=40), value=List(ctx=Load(), lineno=262, col_offset=43, end_lineno=262, end_col_offset=45), simple=0, lineno=262, col_offset=8, end_lineno=262, end_col_offset=45)], returns=Constant(value=None, lineno=257, col_offset=53, end_lineno=257, end_col_offset=57), lineno=257, col_offset=4, end_lineno=262, end_col_offset=45), FunctionDef(name='add_symbol', args=arguments(args=[arg(arg='self', lineno=264, col_offset=19, end_lineno=264, end_col_offset=23), arg(arg='symbol', annotation=Name(id='SymbolDef', ctx=Load(), lineno=264, col_offset=33, end_lineno=264, end_col_offset=42), lineno=264, col_offset=25, end_lineno=264, end_col_offset=42), arg(arg='start', annotation=Name(id='int', ctx=Load(), lineno=264, col_offset=51, end_lineno=264, end_col_offset=54), lineno=264, col_offset=44, end_lineno=264, end_col_offset=54), arg(arg='end', annotation=Name(id='int', ctx=Load(), lineno=264, col_offset=61, end_lineno=264, end_col_offset=64), lineno=264, col_offset=56, end_lineno=264, end_col_offset=64)]), body=[If(test=BoolOp(op=Or(), values=[Compare(left=Attribute(value=Name(id='self', ctx=Load(), lineno=265, col_offset=11, end_lineno=265, end_col_offset=15), attr='_current_start_char', ctx=Load(), lineno=265, col_offset=11, end_lineno=265, end_col_offset=35), ops=[Is()], comparators=[Constant(value=None, lineno=265, col_offset=39, end_lineno=265, end_col_offset=43)], lineno=265, col_offset=11, end_lineno=265, end_col_offset=43), Compare(left=Attribute(value=Name(id='self', ctx=Load(), lineno=265, col_offset=47, end_lineno=265, end_col_offset=51), attr='_current_end_char', ctx=Load(), lineno=265, col_offset=47, end_lineno=265, end_col_offset=69), ops=[Is()], comparators=[Constant(value=None, lineno=265, col_offset=73, end_lineno=265, end_col_offset=77)], lineno=265, col_offset=47, end_lineno=265, end_col_offset=77)], lineno=265, col_offset=11, end_lineno=265, end_col_offset=77), body=[Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=266, col_offset=12, end_lineno=266, end_col_offset=16), attr='_start_chunk', ctx=Load(), lineno=266, col_offset=12, end_lineno=266, end_col_offset=29), args=[Name(id='start', ctx=Load(), lineno=266, col_offset=30, end_lineno=266, end_col_offset=35), Name(id='end', ctx=Load(), lineno=266, col_offset=37, end_lineno=266, end_col_offset=40), Attribute(value=Name(id='symbol', ctx=Load(), lineno=266, col_offset=42, end_lineno=266, end_col_offset=48), attr='symbol', ctx=Load(), lineno=266, col_offset=42, end_lineno=266, end_col_offset=55)], lineno=266, col_offset=12, end_lineno=266, end_col_offset=56), lineno=266, col_offset=12, end_lineno=266, end_col_offset=56), Return(lineno=267, col_offset=12, end_lineno=267, end_col_offset=18)], lineno=265, col_offset=8, end_lineno=267, end_col_offset=18), Assign(targets=[Name(id='merged_end', ctx=Store(), lineno=269, col_offset=8, end_lineno=269, end_col_offset=18)], value=Call(func=Name(id='max', ctx=Load(), lineno=269, col_offset=21, end_lineno=269, end_col_offset=24), args=[Attribute(value=Name(id='self', ctx=Load(), lineno=269, col_offset=25, end_lineno=269, end_col_offset=29), attr='_current_end_char', ctx=Load(), lineno=269, col_offset=25, end_lineno=269, end_col_offset=47), Name(id='end', ctx=Load(), lineno=269, col_offset=49, end_lineno=269, end_col_offset=52)], lineno=269, col_offset=21, end_lineno=269, end_col_offset=53), lineno=269, col_offset=8, end_lineno=269, end_col_offset=53), If(test=Compare(left=BinOp(left=Name(id='merged_end', ctx=Load(), lineno=270, col_offset=11, end_lineno=270, end_col_offset=21), op=Sub(), right=Attribute(value=Name(id='self', ctx=Load(), lineno=270, col_offset=24, end_lineno=270, end_col_offset=28), attr='_current_start_char', ctx=Load(), lineno=270, col_offset=24, end_lineno=270, end_col_offset=48), lineno=270, col_offset=11, end_lineno=270, end_col_offset=48), ops=[LtE()], comparators=[Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=270, col_offset=52, end_lineno=270, end_col_offset=56), attr='_config', ctx=Load(), lineno=270, col_offset=52, end_lineno=270, end_col_offset=64), attr='budget', ctx=Load(), lineno=270, col_offset=52, end_lineno=270, end_col_offset=71)], lineno=270, col_offset=11, end_lineno=270, end_col_offset=71), body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load(), lineno=271, col_offset=12, end_lineno=271, end_col_offset=16), attr='_current_end_char', ctx=Store(), lineno=271, col_offset=12, end_lineno=271, end_col_offset=34)], value=Name(id='merged_end', ctx=Load(), lineno=271, col_offset=37, end_lineno=271, end_col_offset=47), lineno=271, col_offset=12, end_lineno=271, end_col_offset=47), Expr(value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=272, col_offset=12, end_lineno=272, end_col_offset=16), attr='_current_symbols', ctx=Load(), lineno=272, col_offset=12, end_lineno=272, end_col_offset=33), attr='append', ctx=Load(), lineno=272, col_offset=12, end_lineno=272, end_col_offset=40), args=[Attribute(value=Name(id='symbol', ctx=Load(), lineno=272, col_offset=41, end_lineno=272, end_col_offset=47), attr='symbol', ctx=Load(), lineno=272, col_offset=41, end_lineno=272, end_col_offset=54)], lineno=272, col_offset=12, end_lineno=272, end_col_offset=55), lineno=272, col_offset=12, end_lineno=272, end_col_offset=55), Return(lineno=273, col_offset=12, end_lineno=273, end_col_offset=18)], lineno=270, col_offset=8, end_lineno=273, end_col_offset=18), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=275, col_offset=8, end_lineno=275, end_col_offset=12), attr='_flush_current', ctx=Load(), lineno=275, col_offset=8, end_lineno=275, end_col_offset=27), lineno=275, col_offset=8, end_lineno=275, end_col_offset=29), lineno=275, col_offset=8, end_lineno=275, end_col_offset=29), If(test=Compare(left=BinOp(left=Name(id='end', ctx=Load(), lineno=276, col_offset=11, end_lineno=276, end_col_offset=14), op=Sub(), right=Name(id='start', ctx=Load(), lineno=276, col_offset=17, end_lineno=276, end_col_offset=22), lineno=276, col_offset=11, end_lineno=276, end_col_offset=22), ops=[Gt()], comparators=[Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=276, col_offset=25, end_lineno=276, end_col_offset=29), attr='_config', ctx=Load(), lineno=276, col_offset=25, end_lineno=276, end_col_offset=37), attr='budget', ctx=Load(), lineno=276, col_offset=25, end_lineno=276, end_col_offset=44)], lineno=276, col_offset=11, end_lineno=276, end_col_offset=44), body=[Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=277, col_offset=12, end_lineno=277, end_col_offset=16), attr='_split_large_symbol', ctx=Load(), lineno=277, col_offset=12, end_lineno=277, end_col_offset=36), args=[Name(id='symbol', ctx=Load(), lineno=277, col_offset=37, end_lineno=277, end_col_offset=43), Name(id='start', ctx=Load(), lineno=277, col_offset=45, end_lineno=277, end_col_offset=50), Name(id='end', ctx=Load(), lineno=277, col_offset=52, end_lineno=277, end_col_offset=55)], lineno=277, col_offset=12, end_lineno=277, end_col_offset=56), lineno=277, col_offset=12, end_lineno=277, end_col_offset=56), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=278, col_offset=12, end_lineno=278, end_col_offset=16), attr='_reset', ctx=Load(), lineno=278, col_offset=12, end_lineno=278, end_col_offset=23), lineno=278, col_offset=12, end_lineno=278, end_col_offset=25), lineno=278, col_offset=12, end_lineno=278, end_col_offset=25), Return(lineno=279, col_offset=12, end_lineno=279, end_col_offset=18)], lineno=276, col_offset=8, end_lineno=279, end_col_offset=18), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=281, col_offset=8, end_lineno=281, end_col_offset=12), attr='_start_chunk', ctx=Load(), lineno=281, col_offset=8, end_lineno=281, end_col_offset=25), args=[Name(id='start', ctx=Load(), lineno=281, col_offset=26, end_lineno=281, end_col_offset=31), Name(id='end', ctx=Load(), lineno=281, col_offset=33, end_lineno=281, end_col_offset=36), Attribute(value=Name(id='symbol', ctx=Load(), lineno=281, col_offset=38, end_lineno=281, end_col_offset=44), attr='symbol', ctx=Load(), lineno=281, col_offset=38, end_lineno=281, end_col_offset=51)], lineno=281, col_offset=8, end_lineno=281, end_col_offset=52), lineno=281, col_offset=8, end_lineno=281, end_col_offset=52)], returns=Constant(value=None, lineno=264, col_offset=69, end_lineno=264, end_col_offset=73), lineno=264, col_offset=4, end_lineno=281, end_col_offset=52), FunctionDef(name='finalize', args=arguments(args=[arg(arg='self', lineno=283, col_offset=17, end_lineno=283, end_col_offset=21)]), body=[Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=284, col_offset=8, end_lineno=284, end_col_offset=12), attr='_flush_current', ctx=Load(), lineno=284, col_offset=8, end_lineno=284, end_col_offset=27), lineno=284, col_offset=8, end_lineno=284, end_col_offset=29), lineno=284, col_offset=8, end_lineno=284, end_col_offset=29), Return(value=Attribute(value=Name(id='self', ctx=Load(), lineno=285, col_offset=15, end_lineno=285, end_col_offset=19), attr='_chunks', ctx=Load(), lineno=285, col_offset=15, end_lineno=285, end_col_offset=27), lineno=285, col_offset=8, end_lineno=285, end_col_offset=27)], returns=Subscript(value=Name(id='list', ctx=Load(), lineno=283, col_offset=26, end_lineno=283, end_col_offset=30), slice=Name(id='Chunk', ctx=Load(), lineno=283, col_offset=31, end_lineno=283, end_col_offset=36), ctx=Load(), lineno=283, col_offset=26, end_lineno=283, end_col_offset=37), lineno=283, col_offset=4, end_lineno=285, end_col_offset=27), FunctionDef(name='_start_chunk', args=arguments(args=[arg(arg='self', lineno=287, col_offset=21, end_lineno=287, end_col_offset=25), arg(arg='start', annotation=Name(id='int', ctx=Load(), lineno=287, col_offset=34, end_lineno=287, end_col_offset=37), lineno=287, col_offset=27, end_lineno=287, end_col_offset=37), arg(arg='end', annotation=Name(id='int', ctx=Load(), lineno=287, col_offset=44, end_lineno=287, end_col_offset=47), lineno=287, col_offset=39, end_lineno=287, end_col_offset=47), arg(arg='symbol', annotation=Name(id='str', ctx=Load(), lineno=287, col_offset=57, end_lineno=287, end_col_offset=60), lineno=287, col_offset=49, end_lineno=287, end_col_offset=60)]), body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load(), lineno=288, col_offset=8, end_lineno=288, end_col_offset=12), attr='_current_start_char', ctx=Store(), lineno=288, col_offset=8, end_lineno=288, end_col_offset=32)], value=Name(id='start', ctx=Load(), lineno=288, col_offset=35, end_lineno=288, end_col_offset=40), lineno=288, col_offset=8, end_lineno=288, end_col_offset=40), Assign(targets=[Attribute(value=Name(id='self', ctx=Load(), lineno=289, col_offset=8, end_lineno=289, end_col_offset=12), attr='_current_end_char', ctx=Store(), lineno=289, col_offset=8, end_lineno=289, end_col_offset=30)], value=Name(id='end', ctx=Load(), lineno=289, col_offset=33, end_lineno=289, end_col_offset=36), lineno=289, col_offset=8, end_lineno=289, end_col_offset=36), Assign(targets=[Attribute(value=Name(id='self', ctx=Load(), lineno=290, col_offset=8, end_lineno=290, end_col_offset=12), attr='_current_symbols', ctx=Store(), lineno=290, col_offset=8, end_lineno=290, end_col_offset=29)], value=List(elts=[Name(id='symbol', ctx=Load(), lineno=290, col_offset=33, end_lineno=290, end_col_offset=39)], ctx=Load(), lineno=290, col_offset=32, end_lineno=290, end_col_offset=40), lineno=290, col_offset=8, end_lineno=290, end_col_offset=40)], returns=Constant(value=None, lineno=287, col_offset=65, end_lineno=287, end_col_offset=69), lineno=287, col_offset=4, end_lineno=290, end_col_offset=40), FunctionDef(name='_flush_current', args=arguments(args=[arg(arg='self', lineno=292, col_offset=23, end_lineno=292, end_col_offset=27)]), body=[If(test=BoolOp(op=Or(), values=[Compare(left=Attribute(value=Name(id='self', ctx=Load(), lineno=293, col_offset=11, end_lineno=293, end_col_offset=15), attr='_current_start_char', ctx=Load(), lineno=293, col_offset=11, end_lineno=293, end_col_offset=35), ops=[Is()], comparators=[Constant(value=None, lineno=293, col_offset=39, end_lineno=293, end_col_offset=43)], lineno=293, col_offset=11, end_lineno=293, end_col_offset=43), Compare(left=Attribute(value=Name(id='self', ctx=Load(), lineno=293, col_offset=47, end_lineno=293, end_col_offset=51), attr='_current_end_char', ctx=Load(), lineno=293, col_offset=47, end_lineno=293, end_col_offset=69), ops=[Is()], comparators=[Constant(value=None, lineno=293, col_offset=73, end_lineno=293, end_col_offset=77)], lineno=293, col_offset=47, end_lineno=293, end_col_offset=77)], lineno=293, col_offset=11, end_lineno=293, end_col_offset=77), body=[Return(lineno=294, col_offset=12, end_lineno=294, end_col_offset=18)], lineno=293, col_offset=8, end_lineno=294, end_col_offset=18), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=295, col_offset=8, end_lineno=295, end_col_offset=12), attr='_append_chunk', ctx=Load(), lineno=295, col_offset=8, end_lineno=295, end_col_offset=26), args=[Attribute(value=Name(id='self', ctx=Load(), lineno=296, col_offset=12, end_lineno=296, end_col_offset=16), attr='_current_start_char', ctx=Load(), lineno=296, col_offset=12, end_lineno=296, end_col_offset=36), Attribute(value=Name(id='self', ctx=Load(), lineno=297, col_offset=12, end_lineno=297, end_col_offset=16), attr='_current_end_char', ctx=Load(), lineno=297, col_offset=12, end_lineno=297, end_col_offset=34), Call(func=Name(id='tuple', ctx=Load(), lineno=298, col_offset=12, end_lineno=298, end_col_offset=17), args=[Attribute(value=Name(id='self', ctx=Load(), lineno=298, col_offset=18, end_lineno=298, end_col_offset=22), attr='_current_symbols', ctx=Load(), lineno=298, col_offset=18, end_lineno=298, end_col_offset=39)], lineno=298, col_offset=12, end_lineno=298, end_col_offset=40)], lineno=295, col_offset=8, end_lineno=299, end_col_offset=9), lineno=295, col_offset=8, end_lineno=299, end_col_offset=9), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=300, col_offset=8, end_lineno=300, end_col_offset=12), attr='_reset', ctx=Load(), lineno=300, col_offset=8, end_lineno=300, end_col_offset=19), lineno=300, col_offset=8, end_lineno=300, end_col_offset=21), lineno=300, col_offset=8, end_lineno=300, end_col_offset=21)], returns=Constant(value=None, lineno=292, col_offset=32, end_lineno=292, end_col_offset=36), lineno=292, col_offset=4, end_lineno=300, end_col_offset=21), FunctionDef(name='_append_chunk', args=arguments(args=[arg(arg='self', lineno=303, col_offset=8, end_lineno=303, end_col_offset=12), arg(arg='start', annotation=Name(id='int', ctx=Load(), lineno=304, col_offset=15, end_lineno=304, end_col_offset=18), lineno=304, col_offset=8, end_lineno=304, end_col_offset=18), arg(arg='end', annotation=Name(id='int', ctx=Load(), lineno=305, col_offset=13, end_lineno=305, end_col_offset=16), lineno=305, col_offset=8, end_lineno=305, end_col_offset=16), arg(arg='symbols', annotation=Subscript(value=Name(id='tuple', ctx=Load(), lineno=306, col_offset=17, end_lineno=306, end_col_offset=22), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=306, col_offset=23, end_lineno=306, end_col_offset=26), Constant(value=Ellipsis, lineno=306, col_offset=28, end_lineno=306, end_col_offset=31)], ctx=Load(), lineno=306, col_offset=23, end_lineno=306, end_col_offset=31), ctx=Load(), lineno=306, col_offset=17, end_lineno=306, end_col_offset=32), lineno=306, col_offset=8, end_lineno=306, end_col_offset=32)]), body=[If(test=Compare(left=Name(id='end', ctx=Load(), lineno=308, col_offset=11, end_lineno=308, end_col_offset=14), ops=[LtE()], comparators=[Name(id='start', ctx=Load(), lineno=308, col_offset=18, end_lineno=308, end_col_offset=23)], lineno=308, col_offset=11, end_lineno=308, end_col_offset=23), body=[Return(lineno=309, col_offset=12, end_lineno=309, end_col_offset=18)], lineno=308, col_offset=8, end_lineno=309, end_col_offset=18), Assign(targets=[Name(id='start_byte', ctx=Store(), lineno=310, col_offset=8, end_lineno=310, end_col_offset=18)], value=Subscript(value=Attribute(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=310, col_offset=21, end_lineno=310, end_col_offset=25), attr='_config', ctx=Load(), lineno=310, col_offset=21, end_lineno=310, end_col_offset=33), attr='line_index', ctx=Load(), lineno=310, col_offset=21, end_lineno=310, end_col_offset=44), attr='char_to_byte', ctx=Load(), lineno=310, col_offset=21, end_lineno=310, end_col_offset=57), slice=Name(id='start', ctx=Load(), lineno=310, col_offset=58, end_lineno=310, end_col_offset=63), ctx=Load(), lineno=310, col_offset=21, end_lineno=310, end_col_offset=64), lineno=310, col_offset=8, end_lineno=310, end_col_offset=64), Assign(targets=[Name(id='end_byte', ctx=Store(), lineno=311, col_offset=8, end_lineno=311, end_col_offset=16)], value=Subscript(value=Attribute(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=311, col_offset=19, end_lineno=311, end_col_offset=23), attr='_config', ctx=Load(), lineno=311, col_offset=19, end_lineno=311, end_col_offset=31), attr='line_index', ctx=Load(), lineno=311, col_offset=19, end_lineno=311, end_col_offset=42), attr='char_to_byte', ctx=Load(), lineno=311, col_offset=19, end_lineno=311, end_col_offset=55), slice=Name(id='end', ctx=Load(), lineno=311, col_offset=56, end_lineno=311, end_col_offset=59), ctx=Load(), lineno=311, col_offset=19, end_lineno=311, end_col_offset=60), lineno=311, col_offset=8, end_lineno=311, end_col_offset=60), If(test=Compare(left=Name(id='end_byte', ctx=Load(), lineno=312, col_offset=11, end_lineno=312, end_col_offset=19), ops=[LtE()], comparators=[Name(id='start_byte', ctx=Load(), lineno=312, col_offset=23, end_lineno=312, end_col_offset=33)], lineno=312, col_offset=11, end_lineno=312, end_col_offset=33), body=[Return(lineno=313, col_offset=12, end_lineno=313, end_col_offset=18)], lineno=312, col_offset=8, end_lineno=313, end_col_offset=18), Assign(targets=[Name(id='start_line', ctx=Store(), lineno=314, col_offset=8, end_lineno=314, end_col_offset=18)], value=Call(func=Name(id='_line_index_from_byte', ctx=Load(), lineno=314, col_offset=21, end_lineno=314, end_col_offset=42), args=[Attribute(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=314, col_offset=43, end_lineno=314, end_col_offset=47), attr='_config', ctx=Load(), lineno=314, col_offset=43, end_lineno=314, end_col_offset=55), attr='line_index', ctx=Load(), lineno=314, col_offset=43, end_lineno=314, end_col_offset=66), attr='byte_starts', ctx=Load(), lineno=314, col_offset=43, end_lineno=314, end_col_offset=78), Name(id='start_byte', ctx=Load(), lineno=314, col_offset=80, end_lineno=314, end_col_offset=90)], lineno=314, col_offset=21, end_lineno=314, end_col_offset=91), lineno=314, col_offset=8, end_lineno=314, end_col_offset=91), Assign(targets=[Name(id='end_line', ctx=Store(), lineno=315, col_offset=8, end_lineno=315, end_col_offset=16)], value=Call(func=Name(id='_line_index_from_byte', ctx=Load(), lineno=315, col_offset=19, end_lineno=315, end_col_offset=40), args=[Attribute(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=315, col_offset=41, end_lineno=315, end_col_offset=45), attr='_config', ctx=Load(), lineno=315, col_offset=41, end_lineno=315, end_col_offset=53), attr='line_index', ctx=Load(), lineno=315, col_offset=41, end_lineno=315, end_col_offset=64), attr='byte_starts', ctx=Load(), lineno=315, col_offset=41, end_lineno=315, end_col_offset=76), Call(func=Name(id='max', ctx=Load(), lineno=315, col_offset=78, end_lineno=315, end_col_offset=81), args=[BinOp(left=Name(id='end_byte', ctx=Load(), lineno=315, col_offset=82, end_lineno=315, end_col_offset=90), op=Sub(), right=Constant(value=1, lineno=315, col_offset=93, end_lineno=315, end_col_offset=94), lineno=315, col_offset=82, end_lineno=315, end_col_offset=94), Constant(value=0, lineno=315, col_offset=96, end_lineno=315, end_col_offset=97)], lineno=315, col_offset=78, end_lineno=315, end_col_offset=98)], lineno=315, col_offset=19, end_lineno=315, end_col_offset=99), lineno=315, col_offset=8, end_lineno=315, end_col_offset=99), Assign(targets=[Name(id='chunk_text', ctx=Store(), lineno=316, col_offset=8, end_lineno=316, end_col_offset=18)], value=Call(func=Attribute(value=Subscript(value=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=316, col_offset=21, end_lineno=316, end_col_offset=25), attr='_config', ctx=Load(), lineno=316, col_offset=21, end_lineno=316, end_col_offset=33), attr='encoded', ctx=Load(), lineno=316, col_offset=21, end_lineno=316, end_col_offset=41), slice=Slice(lower=Name(id='start_byte', ctx=Load(), lineno=316, col_offset=42, end_lineno=316, end_col_offset=52), upper=Name(id='end_byte', ctx=Load(), lineno=316, col_offset=53, end_lineno=316, end_col_offset=61), lineno=316, col_offset=42, end_lineno=316, end_col_offset=61), ctx=Load(), lineno=316, col_offset=21, end_lineno=316, end_col_offset=62), attr='decode', ctx=Load(), lineno=316, col_offset=21, end_lineno=316, end_col_offset=69), args=[Constant(value='utf-8', lineno=316, col_offset=70, end_lineno=316, end_col_offset=77)], lineno=316, col_offset=21, end_lineno=316, end_col_offset=78), lineno=316, col_offset=8, end_lineno=316, end_col_offset=78), Expr(value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=317, col_offset=8, end_lineno=317, end_col_offset=12), attr='_chunks', ctx=Load(), lineno=317, col_offset=8, end_lineno=317, end_col_offset=20), attr='append', ctx=Load(), lineno=317, col_offset=8, end_lineno=317, end_col_offset=27), args=[Call(func=Name(id='Chunk', ctx=Load(), lineno=318, col_offset=12, end_lineno=318, end_col_offset=17), keywords=[keyword(arg='uri', value=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=319, col_offset=20, end_lineno=319, end_col_offset=24), attr='_config', ctx=Load(), lineno=319, col_offset=20, end_lineno=319, end_col_offset=32), attr='uri', ctx=Load(), lineno=319, col_offset=20, end_lineno=319, end_col_offset=36), lineno=319, col_offset=16, end_lineno=319, end_col_offset=36), keyword(arg='start_byte', value=Name(id='start_byte', ctx=Load(), lineno=320, col_offset=27, end_lineno=320, end_col_offset=37), lineno=320, col_offset=16, end_lineno=320, end_col_offset=37), keyword(arg='end_byte', value=Name(id='end_byte', ctx=Load(), lineno=321, col_offset=25, end_lineno=321, end_col_offset=33), lineno=321, col_offset=16, end_lineno=321, end_col_offset=33), keyword(arg='start_line', value=Name(id='start_line', ctx=Load(), lineno=322, col_offset=27, end_lineno=322, end_col_offset=37), lineno=322, col_offset=16, end_lineno=322, end_col_offset=37), keyword(arg='end_line', value=Name(id='end_line', ctx=Load(), lineno=323, col_offset=25, end_lineno=323, end_col_offset=33), lineno=323, col_offset=16, end_lineno=323, end_col_offset=33), keyword(arg='text', value=Name(id='chunk_text', ctx=Load(), lineno=324, col_offset=21, end_lineno=324, end_col_offset=31), lineno=324, col_offset=16, end_lineno=324, end_col_offset=31), keyword(arg='symbols', value=Name(id='symbols', ctx=Load(), lineno=325, col_offset=24, end_lineno=325, end_col_offset=31), lineno=325, col_offset=16, end_lineno=325, end_col_offset=31), keyword(arg='language', value=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=326, col_offset=25, end_lineno=326, end_col_offset=29), attr='_config', ctx=Load(), lineno=326, col_offset=25, end_lineno=326, end_col_offset=37), attr='language', ctx=Load(), lineno=326, col_offset=25, end_lineno=326, end_col_offset=46), lineno=326, col_offset=16, end_lineno=326, end_col_offset=46)], lineno=318, col_offset=12, end_lineno=327, end_col_offset=13)], lineno=317, col_offset=8, end_lineno=328, end_col_offset=9), lineno=317, col_offset=8, end_lineno=328, end_col_offset=9)], returns=Constant(value=None, lineno=307, col_offset=9, end_lineno=307, end_col_offset=13), lineno=302, col_offset=4, end_lineno=328, end_col_offset=9), FunctionDef(name='_split_large_symbol', args=arguments(args=[arg(arg='self', lineno=330, col_offset=28, end_lineno=330, end_col_offset=32), arg(arg='symbol', annotation=Name(id='SymbolDef', ctx=Load(), lineno=330, col_offset=42, end_lineno=330, end_col_offset=51), lineno=330, col_offset=34, end_lineno=330, end_col_offset=51), arg(arg='start', annotation=Name(id='int', ctx=Load(), lineno=330, col_offset=60, end_lineno=330, end_col_offset=63), lineno=330, col_offset=53, end_lineno=330, end_col_offset=63), arg(arg='end', annotation=Name(id='int', ctx=Load(), lineno=330, col_offset=70, end_lineno=330, end_col_offset=73), lineno=330, col_offset=65, end_lineno=330, end_col_offset=73)]), body=[Assign(targets=[Name(id='budget', ctx=Store(), lineno=331, col_offset=8, end_lineno=331, end_col_offset=14)], value=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=331, col_offset=17, end_lineno=331, end_col_offset=21), attr='_config', ctx=Load(), lineno=331, col_offset=17, end_lineno=331, end_col_offset=29), attr='budget', ctx=Load(), lineno=331, col_offset=17, end_lineno=331, end_col_offset=36), lineno=331, col_offset=8, end_lineno=331, end_col_offset=36), Assign(targets=[Name(id='text', ctx=Store(), lineno=332, col_offset=8, end_lineno=332, end_col_offset=12)], value=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=332, col_offset=15, end_lineno=332, end_col_offset=19), attr='_config', ctx=Load(), lineno=332, col_offset=15, end_lineno=332, end_col_offset=27), attr='text', ctx=Load(), lineno=332, col_offset=15, end_lineno=332, end_col_offset=32), lineno=332, col_offset=8, end_lineno=332, end_col_offset=32), Assign(targets=[Name(id='position', ctx=Store(), lineno=333, col_offset=8, end_lineno=333, end_col_offset=16)], value=Name(id='start', ctx=Load(), lineno=333, col_offset=19, end_lineno=333, end_col_offset=24), lineno=333, col_offset=8, end_lineno=333, end_col_offset=24), While(test=Compare(left=Name(id='position', ctx=Load(), lineno=334, col_offset=14, end_lineno=334, end_col_offset=22), ops=[Lt()], comparators=[Name(id='end', ctx=Load(), lineno=334, col_offset=25, end_lineno=334, end_col_offset=28)], lineno=334, col_offset=14, end_lineno=334, end_col_offset=28), body=[Assign(targets=[Name(id='tentative_end', ctx=Store(), lineno=335, col_offset=12, end_lineno=335, end_col_offset=25)], value=Call(func=Name(id='min', ctx=Load(), lineno=335, col_offset=28, end_lineno=335, end_col_offset=31), args=[BinOp(left=Name(id='position', ctx=Load(), lineno=335, col_offset=32, end_lineno=335, end_col_offset=40), op=Add(), right=Name(id='budget', ctx=Load(), lineno=335, col_offset=43, end_lineno=335, end_col_offset=49), lineno=335, col_offset=32, end_lineno=335, end_col_offset=49), Name(id='end', ctx=Load(), lineno=335, col_offset=51, end_lineno=335, end_col_offset=54)], lineno=335, col_offset=28, end_lineno=335, end_col_offset=55), lineno=335, col_offset=12, end_lineno=335, end_col_offset=55), Assign(targets=[Name(id='search_start', ctx=Store(), lineno=336, col_offset=12, end_lineno=336, end_col_offset=24)], value=BinOp(left=Name(id='position', ctx=Load(), lineno=336, col_offset=27, end_lineno=336, end_col_offset=35), op=Add(), right=BinOp(left=Name(id='budget', ctx=Load(), lineno=336, col_offset=38, end_lineno=336, end_col_offset=44), op=FloorDiv(), right=Constant(value=2, lineno=336, col_offset=48, end_lineno=336, end_col_offset=49), lineno=336, col_offset=38, end_lineno=336, end_col_offset=49), lineno=336, col_offset=27, end_lineno=336, end_col_offset=49), lineno=336, col_offset=12, end_lineno=336, end_col_offset=49), Assign(targets=[Name(id='search_end', ctx=Store(), lineno=337, col_offset=12, end_lineno=337, end_col_offset=22)], value=Call(func=Name(id='min', ctx=Load(), lineno=337, col_offset=25, end_lineno=337, end_col_offset=28), args=[Name(id='tentative_end', ctx=Load(), lineno=337, col_offset=29, end_lineno=337, end_col_offset=42), Name(id='end', ctx=Load(), lineno=337, col_offset=44, end_lineno=337, end_col_offset=47)], lineno=337, col_offset=25, end_lineno=337, end_col_offset=48), lineno=337, col_offset=12, end_lineno=337, end_col_offset=48), Assign(targets=[Name(id='newline_idx', ctx=Store(), lineno=338, col_offset=12, end_lineno=338, end_col_offset=23)], value=Call(func=Attribute(value=Name(id='text', ctx=Load(), lineno=338, col_offset=26, end_lineno=338, end_col_offset=30), attr='rfind', ctx=Load(), lineno=338, col_offset=26, end_lineno=338, end_col_offset=36), args=[Constant(value='\n\n', lineno=338, col_offset=37, end_lineno=338, end_col_offset=43), Name(id='search_start', ctx=Load(), lineno=338, col_offset=45, end_lineno=338, end_col_offset=57), Name(id='search_end', ctx=Load(), lineno=338, col_offset=59, end_lineno=338, end_col_offset=69)], lineno=338, col_offset=26, end_lineno=338, end_col_offset=70), lineno=338, col_offset=12, end_lineno=338, end_col_offset=70), If(test=BoolOp(op=And(), values=[Compare(left=Name(id='newline_idx', ctx=Load(), lineno=339, col_offset=15, end_lineno=339, end_col_offset=26), ops=[NotEq()], comparators=[UnaryOp(op=USub(), operand=Constant(value=1, lineno=339, col_offset=31, end_lineno=339, end_col_offset=32), lineno=339, col_offset=30, end_lineno=339, end_col_offset=32)], lineno=339, col_offset=15, end_lineno=339, end_col_offset=32), Compare(left=Name(id='newline_idx', ctx=Load(), lineno=339, col_offset=37, end_lineno=339, end_col_offset=48), ops=[Gt()], comparators=[Name(id='position', ctx=Load(), lineno=339, col_offset=51, end_lineno=339, end_col_offset=59)], lineno=339, col_offset=37, end_lineno=339, end_col_offset=59)], lineno=339, col_offset=15, end_lineno=339, end_col_offset=59), body=[Assign(targets=[Name(id='tentative_end', ctx=Store(), lineno=340, col_offset=16, end_lineno=340, end_col_offset=29)], value=BinOp(left=Name(id='newline_idx', ctx=Load(), lineno=340, col_offset=32, end_lineno=340, end_col_offset=43), op=Add(), right=Constant(value=1, lineno=340, col_offset=46, end_lineno=340, end_col_offset=47), lineno=340, col_offset=32, end_lineno=340, end_col_offset=47), lineno=340, col_offset=16, end_lineno=340, end_col_offset=47)], lineno=339, col_offset=12, end_lineno=340, end_col_offset=47), If(test=Compare(left=Name(id='tentative_end', ctx=Load(), lineno=341, col_offset=15, end_lineno=341, end_col_offset=28), ops=[LtE()], comparators=[Name(id='position', ctx=Load(), lineno=341, col_offset=32, end_lineno=341, end_col_offset=40)], lineno=341, col_offset=15, end_lineno=341, end_col_offset=40), body=[Assign(targets=[Name(id='tentative_end', ctx=Store(), lineno=342, col_offset=16, end_lineno=342, end_col_offset=29)], value=Call(func=Name(id='min', ctx=Load(), lineno=342, col_offset=32, end_lineno=342, end_col_offset=35), args=[BinOp(left=Name(id='position', ctx=Load(), lineno=342, col_offset=36, end_lineno=342, end_col_offset=44), op=Add(), right=Name(id='budget', ctx=Load(), lineno=342, col_offset=47, end_lineno=342, end_col_offset=53), lineno=342, col_offset=36, end_lineno=342, end_col_offset=53), Name(id='end', ctx=Load(), lineno=342, col_offset=55, end_lineno=342, end_col_offset=58)], lineno=342, col_offset=32, end_lineno=342, end_col_offset=59), lineno=342, col_offset=16, end_lineno=342, end_col_offset=59), If(test=Compare(left=Name(id='tentative_end', ctx=Load(), lineno=343, col_offset=19, end_lineno=343, end_col_offset=32), ops=[LtE()], comparators=[Name(id='position', ctx=Load(), lineno=343, col_offset=36, end_lineno=343, end_col_offset=44)], lineno=343, col_offset=19, end_lineno=343, end_col_offset=44), body=[Assign(targets=[Name(id='tentative_end', ctx=Store(), lineno=344, col_offset=20, end_lineno=344, end_col_offset=33)], value=Name(id='end', ctx=Load(), lineno=344, col_offset=36, end_lineno=344, end_col_offset=39), lineno=344, col_offset=20, end_lineno=344, end_col_offset=39)], lineno=343, col_offset=16, end_lineno=344, end_col_offset=39)], lineno=341, col_offset=12, end_lineno=344, end_col_offset=39), Expr(value=Call(func=Attribute(value=Name(id='self', ctx=Load(), lineno=345, col_offset=12, end_lineno=345, end_col_offset=16), attr='_append_chunk', ctx=Load(), lineno=345, col_offset=12, end_lineno=345, end_col_offset=30), args=[Name(id='position', ctx=Load(), lineno=346, col_offset=16, end_lineno=346, end_col_offset=24), Name(id='tentative_end', ctx=Load(), lineno=347, col_offset=16, end_lineno=347, end_col_offset=29), Tuple(elts=[Attribute(value=Name(id='symbol', ctx=Load(), lineno=348, col_offset=17, end_lineno=348, end_col_offset=23), attr='symbol', ctx=Load(), lineno=348, col_offset=17, end_lineno=348, end_col_offset=30)], ctx=Load(), lineno=348, col_offset=16, end_lineno=348, end_col_offset=32)], lineno=345, col_offset=12, end_lineno=349, end_col_offset=13), lineno=345, col_offset=12, end_lineno=349, end_col_offset=13), Assign(targets=[Name(id='position', ctx=Store(), lineno=350, col_offset=12, end_lineno=350, end_col_offset=20)], value=Name(id='tentative_end', ctx=Load(), lineno=350, col_offset=23, end_lineno=350, end_col_offset=36), lineno=350, col_offset=12, end_lineno=350, end_col_offset=36)], lineno=334, col_offset=8, end_lineno=350, end_col_offset=36)], returns=Constant(value=None, lineno=330, col_offset=78, end_lineno=330, end_col_offset=82), lineno=330, col_offset=4, end_lineno=350, end_col_offset=36), FunctionDef(name='_reset', args=arguments(args=[arg(arg='self', lineno=352, col_offset=15, end_lineno=352, end_col_offset=19)]), body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load(), lineno=353, col_offset=8, end_lineno=353, end_col_offset=12), attr='_current_start_char', ctx=Store(), lineno=353, col_offset=8, end_lineno=353, end_col_offset=32)], value=Constant(value=None, lineno=353, col_offset=35, end_lineno=353, end_col_offset=39), lineno=353, col_offset=8, end_lineno=353, end_col_offset=39), Assign(targets=[Attribute(value=Name(id='self', ctx=Load(), lineno=354, col_offset=8, end_lineno=354, end_col_offset=12), attr='_current_end_char', ctx=Store(), lineno=354, col_offset=8, end_lineno=354, end_col_offset=30)], value=Constant(value=None, lineno=354, col_offset=33, end_lineno=354, end_col_offset=37), lineno=354, col_offset=8, end_lineno=354, end_col_offset=37), Assign(targets=[Attribute(value=Name(id='self', ctx=Load(), lineno=355, col_offset=8, end_lineno=355, end_col_offset=12), attr='_current_symbols', ctx=Store(), lineno=355, col_offset=8, end_lineno=355, end_col_offset=29)], value=List(ctx=Load(), lineno=355, col_offset=32, end_lineno=355, end_col_offset=34), lineno=355, col_offset=8, end_lineno=355, end_col_offset=34)], returns=Constant(value=None, lineno=352, col_offset=24, end_lineno=352, end_col_offset=28), lineno=352, col_offset=4, end_lineno=355, end_col_offset=34)], lineno=246, col_offset=0, end_lineno=355, end_col_offset=34), FunctionDef(name='chunk_file', args=arguments(args=[arg(arg='path', annotation=Name(id='Path', ctx=Load(), lineno=359, col_offset=10, end_lineno=359, end_col_offset=14), lineno=359, col_offset=4, end_lineno=359, end_col_offset=14), arg(arg='text', annotation=Name(id='str', ctx=Load(), lineno=360, col_offset=10, end_lineno=360, end_col_offset=13), lineno=360, col_offset=4, end_lineno=360, end_col_offset=13), arg(arg='definitions', annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=361, col_offset=17, end_lineno=361, end_col_offset=21), slice=Name(id='SymbolDef', ctx=Load(), lineno=361, col_offset=22, end_lineno=361, end_col_offset=31), ctx=Load(), lineno=361, col_offset=17, end_lineno=361, end_col_offset=32), lineno=361, col_offset=4, end_lineno=361, end_col_offset=32)], kwonlyargs=[arg(arg='options', annotation=BinOp(left=Name(id='ChunkOptions', ctx=Load(), lineno=363, col_offset=13, end_lineno=363, end_col_offset=25), op=BitOr(), right=Constant(value=None, lineno=363, col_offset=28, end_lineno=363, end_col_offset=32), lineno=363, col_offset=13, end_lineno=363, end_col_offset=32), lineno=363, col_offset=4, end_lineno=363, end_col_offset=32), arg(arg='budget', annotation=BinOp(left=Name(id='int', ctx=Load(), lineno=364, col_offset=12, end_lineno=364, end_col_offset=15), op=BitOr(), right=Constant(value=None, lineno=364, col_offset=18, end_lineno=364, end_col_offset=22), lineno=364, col_offset=12, end_lineno=364, end_col_offset=22), lineno=364, col_offset=4, end_lineno=364, end_col_offset=22)], kw_defaults=[Constant(value=None, lineno=363, col_offset=35, end_lineno=363, end_col_offset=39), Constant(value=None, lineno=364, col_offset=25, end_lineno=364, end_col_offset=29)]), body=[Expr(value=Constant(value='Chunk file using SCIP symbol boundaries.\n\n    Greedily packs top-level symbols up to a budget while optionally adding\n    related-symbol overlap snippets for better context.\n\n    Parameters\n    ----------\n    path : Path\n        File path for the source code being chunked.\n    text : str\n        Complete file content as a string.\n    definitions : list[SymbolDef]\n        List of SCIP symbol definitions extracted from the file.\n    options : ChunkOptions | None, optional\n        Chunk generation configuration. If None, uses default options.\n    budget : int | None, optional\n        Override for the character budget applied during chunk assembly.\n\n    Returns\n    -------\n    list[Chunk]\n        List of generated chunks in source order.\n    ', lineno=366, col_offset=4, end_lineno=388, end_col_offset=7), lineno=366, col_offset=4, end_lineno=388, end_col_offset=7), If(test=UnaryOp(op=Not(), operand=Name(id='definitions', ctx=Load(), lineno=389, col_offset=11, end_lineno=389, end_col_offset=22), lineno=389, col_offset=7, end_lineno=389, end_col_offset=22), body=[Return(value=List(ctx=Load(), lineno=390, col_offset=15, end_lineno=390, end_col_offset=17), lineno=390, col_offset=8, end_lineno=390, end_col_offset=17)], lineno=389, col_offset=4, end_lineno=390, end_col_offset=17), Assign(targets=[Name(id='opts', ctx=Store(), lineno=392, col_offset=4, end_lineno=392, end_col_offset=8)], value=BoolOp(op=Or(), values=[Name(id='options', ctx=Load(), lineno=392, col_offset=11, end_lineno=392, end_col_offset=18), Call(func=Name(id='ChunkOptions', ctx=Load(), lineno=392, col_offset=22, end_lineno=392, end_col_offset=34), lineno=392, col_offset=22, end_lineno=392, end_col_offset=36)], lineno=392, col_offset=11, end_lineno=392, end_col_offset=36), lineno=392, col_offset=4, end_lineno=392, end_col_offset=36), If(test=BoolOp(op=And(), values=[Compare(left=Name(id='budget', ctx=Load(), lineno=393, col_offset=7, end_lineno=393, end_col_offset=13), ops=[IsNot()], comparators=[Constant(value=None, lineno=393, col_offset=21, end_lineno=393, end_col_offset=25)], lineno=393, col_offset=7, end_lineno=393, end_col_offset=25), Compare(left=Name(id='budget', ctx=Load(), lineno=393, col_offset=30, end_lineno=393, end_col_offset=36), ops=[NotEq()], comparators=[Attribute(value=Name(id='opts', ctx=Load(), lineno=393, col_offset=40, end_lineno=393, end_col_offset=44), attr='budget', ctx=Load(), lineno=393, col_offset=40, end_lineno=393, end_col_offset=51)], lineno=393, col_offset=30, end_lineno=393, end_col_offset=51)], lineno=393, col_offset=7, end_lineno=393, end_col_offset=51), body=[Assign(targets=[Name(id='opts', ctx=Store(), lineno=394, col_offset=8, end_lineno=394, end_col_offset=12)], value=Call(func=Name(id='replace', ctx=Load(), lineno=394, col_offset=15, end_lineno=394, end_col_offset=22), args=[Name(id='opts', ctx=Load(), lineno=394, col_offset=23, end_lineno=394, end_col_offset=27)], keywords=[keyword(arg='budget', value=Name(id='budget', ctx=Load(), lineno=394, col_offset=36, end_lineno=394, end_col_offset=42), lineno=394, col_offset=29, end_lineno=394, end_col_offset=42)], lineno=394, col_offset=15, end_lineno=394, end_col_offset=43), lineno=394, col_offset=8, end_lineno=394, end_col_offset=43)], lineno=393, col_offset=4, end_lineno=394, end_col_offset=43), Assign(targets=[Name(id='chunk_language', ctx=Store(), lineno=395, col_offset=4, end_lineno=395, end_col_offset=18)], value=IfExp(test=Compare(left=Attribute(value=Name(id='opts', ctx=Load(), lineno=395, col_offset=38, end_lineno=395, end_col_offset=42), attr='language', ctx=Load(), lineno=395, col_offset=38, end_lineno=395, end_col_offset=51), ops=[IsNot()], comparators=[Constant(value=None, lineno=395, col_offset=59, end_lineno=395, end_col_offset=63)], lineno=395, col_offset=38, end_lineno=395, end_col_offset=63), body=Attribute(value=Name(id='opts', ctx=Load(), lineno=395, col_offset=21, end_lineno=395, end_col_offset=25), attr='language', ctx=Load(), lineno=395, col_offset=21, end_lineno=395, end_col_offset=34), orelse=Attribute(value=Subscript(value=Name(id='definitions', ctx=Load(), lineno=395, col_offset=69, end_lineno=395, end_col_offset=80), slice=Constant(value=0, lineno=395, col_offset=81, end_lineno=395, end_col_offset=82), ctx=Load(), lineno=395, col_offset=69, end_lineno=395, end_col_offset=83), attr='language', ctx=Load(), lineno=395, col_offset=69, end_lineno=395, end_col_offset=92), lineno=395, col_offset=21, end_lineno=395, end_col_offset=92), lineno=395, col_offset=4, end_lineno=395, end_col_offset=92), Assign(targets=[Name(id='uri', ctx=Store(), lineno=397, col_offset=4, end_lineno=397, end_col_offset=7)], value=Call(func=Name(id='str', ctx=Load(), lineno=397, col_offset=10, end_lineno=397, end_col_offset=13), args=[Name(id='path', ctx=Load(), lineno=397, col_offset=14, end_lineno=397, end_col_offset=18)], lineno=397, col_offset=10, end_lineno=397, end_col_offset=19), lineno=397, col_offset=4, end_lineno=397, end_col_offset=19), Assign(targets=[Name(id='line_index', ctx=Store(), lineno=398, col_offset=4, end_lineno=398, end_col_offset=14)], value=Call(func=Name(id='line_starts', ctx=Load(), lineno=398, col_offset=17, end_lineno=398, end_col_offset=28), args=[Name(id='text', ctx=Load(), lineno=398, col_offset=29, end_lineno=398, end_col_offset=33)], lineno=398, col_offset=17, end_lineno=398, end_col_offset=34), lineno=398, col_offset=4, end_lineno=398, end_col_offset=34), Assign(targets=[Name(id='encoded', ctx=Store(), lineno=399, col_offset=4, end_lineno=399, end_col_offset=11)], value=Call(func=Attribute(value=Name(id='text', ctx=Load(), lineno=399, col_offset=14, end_lineno=399, end_col_offset=18), attr='encode', ctx=Load(), lineno=399, col_offset=14, end_lineno=399, end_col_offset=25), args=[Constant(value='utf-8', lineno=399, col_offset=26, end_lineno=399, end_col_offset=33)], lineno=399, col_offset=14, end_lineno=399, end_col_offset=34), lineno=399, col_offset=4, end_lineno=399, end_col_offset=34), Assign(targets=[Name(id='accumulator', ctx=Store(), lineno=400, col_offset=4, end_lineno=400, end_col_offset=15)], value=Call(func=Name(id='_ChunkAccumulator', ctx=Load(), lineno=400, col_offset=18, end_lineno=400, end_col_offset=35), keywords=[keyword(arg='uri', value=Name(id='uri', ctx=Load(), lineno=401, col_offset=12, end_lineno=401, end_col_offset=15), lineno=401, col_offset=8, end_lineno=401, end_col_offset=15), keyword(arg='text', value=Name(id='text', ctx=Load(), lineno=402, col_offset=13, end_lineno=402, end_col_offset=17), lineno=402, col_offset=8, end_lineno=402, end_col_offset=17), keyword(arg='encoded', value=Name(id='encoded', ctx=Load(), lineno=403, col_offset=16, end_lineno=403, end_col_offset=23), lineno=403, col_offset=8, end_lineno=403, end_col_offset=23), keyword(arg='line_index', value=Name(id='line_index', ctx=Load(), lineno=404, col_offset=19, end_lineno=404, end_col_offset=29), lineno=404, col_offset=8, end_lineno=404, end_col_offset=29), keyword(arg='budget', value=Attribute(value=Name(id='opts', ctx=Load(), lineno=405, col_offset=15, end_lineno=405, end_col_offset=19), attr='budget', ctx=Load(), lineno=405, col_offset=15, end_lineno=405, end_col_offset=26), lineno=405, col_offset=8, end_lineno=405, end_col_offset=26), keyword(arg='language', value=Name(id='chunk_language', ctx=Load(), lineno=406, col_offset=17, end_lineno=406, end_col_offset=31), lineno=406, col_offset=8, end_lineno=406, end_col_offset=31)], lineno=400, col_offset=18, end_lineno=407, end_col_offset=5), lineno=400, col_offset=4, end_lineno=407, end_col_offset=5), Assign(targets=[Name(id='symbols_with_positions', ctx=Store(), lineno=409, col_offset=4, end_lineno=409, end_col_offset=26)], value=Call(func=Name(id='sorted', ctx=Load(), lineno=409, col_offset=29, end_lineno=409, end_col_offset=35), args=[GeneratorExp(elt=Tuple(elts=[Name(id='sym_def', ctx=Load(), lineno=412, col_offset=16, end_lineno=412, end_col_offset=23), Call(func=Name(id='_char_index_for_line', ctx=Load(), lineno=413, col_offset=16, end_lineno=413, end_col_offset=36), args=[Name(id='line_index', ctx=Load(), lineno=414, col_offset=20, end_lineno=414, end_col_offset=30), Attribute(value=Attribute(value=Name(id='sym_def', ctx=Load(), lineno=414, col_offset=32, end_lineno=414, end_col_offset=39), attr='range', ctx=Load(), lineno=414, col_offset=32, end_lineno=414, end_col_offset=45), attr='start_line', ctx=Load(), lineno=414, col_offset=32, end_lineno=414, end_col_offset=56), Attribute(value=Attribute(value=Name(id='sym_def', ctx=Load(), lineno=414, col_offset=58, end_lineno=414, end_col_offset=65), attr='range', ctx=Load(), lineno=414, col_offset=58, end_lineno=414, end_col_offset=71), attr='start_character', ctx=Load(), lineno=414, col_offset=58, end_lineno=414, end_col_offset=87)], lineno=413, col_offset=16, end_lineno=415, end_col_offset=17), Call(func=Name(id='_char_index_for_line', ctx=Load(), lineno=416, col_offset=16, end_lineno=416, end_col_offset=36), args=[Name(id='line_index', ctx=Load(), lineno=417, col_offset=20, end_lineno=417, end_col_offset=30), Attribute(value=Attribute(value=Name(id='sym_def', ctx=Load(), lineno=417, col_offset=32, end_lineno=417, end_col_offset=39), attr='range', ctx=Load(), lineno=417, col_offset=32, end_lineno=417, end_col_offset=45), attr='end_line', ctx=Load(), lineno=417, col_offset=32, end_lineno=417, end_col_offset=54), Attribute(value=Attribute(value=Name(id='sym_def', ctx=Load(), lineno=417, col_offset=56, end_lineno=417, end_col_offset=63), attr='range', ctx=Load(), lineno=417, col_offset=56, end_lineno=417, end_col_offset=69), attr='end_character', ctx=Load(), lineno=417, col_offset=56, end_lineno=417, end_col_offset=83)], lineno=416, col_offset=16, end_lineno=418, end_col_offset=17)], ctx=Load(), lineno=411, col_offset=12, end_lineno=419, end_col_offset=13), generators=[comprehension(target=Name(id='sym_def', ctx=Store(), lineno=420, col_offset=16, end_lineno=420, end_col_offset=23), iter=Name(id='definitions', ctx=Load(), lineno=420, col_offset=27, end_lineno=420, end_col_offset=38), is_async=0)], lineno=410, col_offset=8, end_lineno=421, end_col_offset=9)], keywords=[keyword(arg='key', value=Lambda(args=arguments(args=[arg(arg='item', lineno=422, col_offset=19, end_lineno=422, end_col_offset=23)]), body=Subscript(value=Name(id='item', ctx=Load(), lineno=422, col_offset=25, end_lineno=422, end_col_offset=29), slice=Constant(value=1, lineno=422, col_offset=30, end_lineno=422, end_col_offset=31), ctx=Load(), lineno=422, col_offset=25, end_lineno=422, end_col_offset=32), lineno=422, col_offset=12, end_lineno=422, end_col_offset=32), lineno=422, col_offset=8, end_lineno=422, end_col_offset=32)], lineno=409, col_offset=29, end_lineno=423, end_col_offset=5), lineno=409, col_offset=4, end_lineno=423, end_col_offset=5), Assign(targets=[Name(id='chunks', ctx=Store(), lineno=425, col_offset=4, end_lineno=425, end_col_offset=10)], value=Call(func=Attribute(value=Name(id='accumulator', ctx=Load(), lineno=425, col_offset=13, end_lineno=425, end_col_offset=24), attr='build_chunks', ctx=Load(), lineno=425, col_offset=13, end_lineno=425, end_col_offset=37), args=[Name(id='symbols_with_positions', ctx=Load(), lineno=425, col_offset=38, end_lineno=425, end_col_offset=60)], lineno=425, col_offset=13, end_lineno=425, end_col_offset=61), lineno=425, col_offset=4, end_lineno=425, end_col_offset=61), If(test=Compare(left=Attribute(value=Name(id='opts', ctx=Load(), lineno=427, col_offset=7, end_lineno=427, end_col_offset=11), attr='overlap', ctx=Load(), lineno=427, col_offset=7, end_lineno=427, end_col_offset=19), ops=[IsNot()], comparators=[Constant(value=None, lineno=427, col_offset=27, end_lineno=427, end_col_offset=31)], lineno=427, col_offset=7, end_lineno=427, end_col_offset=31), body=[Assign(targets=[Name(id='chunks', ctx=Store(), lineno=428, col_offset=8, end_lineno=428, end_col_offset=14)], value=Call(func=Name(id='_apply_call_site_overlap', ctx=Load(), lineno=428, col_offset=17, end_lineno=428, end_col_offset=41), keywords=[keyword(arg='chunks', value=Name(id='chunks', ctx=Load(), lineno=429, col_offset=19, end_lineno=429, end_col_offset=25), lineno=429, col_offset=12, end_lineno=429, end_col_offset=25), keyword(arg='encoded', value=Name(id='encoded', ctx=Load(), lineno=430, col_offset=20, end_lineno=430, end_col_offset=27), lineno=430, col_offset=12, end_lineno=430, end_col_offset=27), keyword(arg='byte_starts', value=Attribute(value=Name(id='line_index', ctx=Load(), lineno=431, col_offset=24, end_lineno=431, end_col_offset=34), attr='byte_starts', ctx=Load(), lineno=431, col_offset=24, end_lineno=431, end_col_offset=46), lineno=431, col_offset=12, end_lineno=431, end_col_offset=46), keyword(arg='options', value=Attribute(value=Name(id='opts', ctx=Load(), lineno=432, col_offset=20, end_lineno=432, end_col_offset=24), attr='overlap', ctx=Load(), lineno=432, col_offset=20, end_lineno=432, end_col_offset=32), lineno=432, col_offset=12, end_lineno=432, end_col_offset=32)], lineno=428, col_offset=17, end_lineno=433, end_col_offset=9), lineno=428, col_offset=8, end_lineno=433, end_col_offset=9)], lineno=427, col_offset=4, end_lineno=433, end_col_offset=9), Return(value=Name(id='chunks', ctx=Load(), lineno=435, col_offset=11, end_lineno=435, end_col_offset=17), lineno=435, col_offset=4, end_lineno=435, end_col_offset=17)], returns=Subscript(value=Name(id='list', ctx=Load(), lineno=365, col_offset=5, end_lineno=365, end_col_offset=9), slice=Name(id='Chunk', ctx=Load(), lineno=365, col_offset=10, end_lineno=365, end_col_offset=15), ctx=Load(), lineno=365, col_offset=5, end_lineno=365, end_col_offset=16), lineno=358, col_offset=0, end_lineno=435, end_col_offset=17), ClassDef(name='ChunkOverlapOptions', body=[Expr(value=Constant(value='Configuration for adding call-site overlap snippets.', lineno=440, col_offset=4, end_lineno=440, end_col_offset=62), lineno=440, col_offset=4, end_lineno=440, end_col_offset=62), AnnAssign(target=Name(id='file_occurrences', ctx=Store(), lineno=442, col_offset=4, end_lineno=442, end_col_offset=20), annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=442, col_offset=22, end_lineno=442, end_col_offset=26), slice=Subscript(value=Name(id='tuple', ctx=Load(), lineno=442, col_offset=27, end_lineno=442, end_col_offset=32), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=442, col_offset=33, end_lineno=442, end_col_offset=36), Name(id='int', ctx=Load(), lineno=442, col_offset=38, end_lineno=442, end_col_offset=41), Name(id='int', ctx=Load(), lineno=442, col_offset=43, end_lineno=442, end_col_offset=46), Name(id='int', ctx=Load(), lineno=442, col_offset=48, end_lineno=442, end_col_offset=51), Name(id='int', ctx=Load(), lineno=442, col_offset=53, end_lineno=442, end_col_offset=56)], ctx=Load(), lineno=442, col_offset=33, end_lineno=442, end_col_offset=56), ctx=Load(), lineno=442, col_offset=27, end_lineno=442, end_col_offset=57), ctx=Load(), lineno=442, col_offset=22, end_lineno=442, end_col_offset=58), simple=1, lineno=442, col_offset=4, end_lineno=442, end_col_offset=58), AnnAssign(target=Name(id='def_chunk_lookup', ctx=Store(), lineno=443, col_offset=4, end_lineno=443, end_col_offset=20), annotation=Subscript(value=Name(id='dict', ctx=Load(), lineno=443, col_offset=22, end_lineno=443, end_col_offset=26), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=443, col_offset=27, end_lineno=443, end_col_offset=30), Name(id='int', ctx=Load(), lineno=443, col_offset=32, end_lineno=443, end_col_offset=35)], ctx=Load(), lineno=443, col_offset=27, end_lineno=443, end_col_offset=35), ctx=Load(), lineno=443, col_offset=22, end_lineno=443, end_col_offset=36), simple=1, lineno=443, col_offset=4, end_lineno=443, end_col_offset=36), AnnAssign(target=Name(id='max_related', ctx=Store(), lineno=444, col_offset=4, end_lineno=444, end_col_offset=15), annotation=Name(id='int', ctx=Load(), lineno=444, col_offset=17, end_lineno=444, end_col_offset=20), value=Constant(value=8, lineno=444, col_offset=23, end_lineno=444, end_col_offset=24), simple=1, lineno=444, col_offset=4, end_lineno=444, end_col_offset=24), AnnAssign(target=Name(id='overlap_lines', ctx=Store(), lineno=445, col_offset=4, end_lineno=445, end_col_offset=17), annotation=Name(id='int', ctx=Load(), lineno=445, col_offset=19, end_lineno=445, end_col_offset=22), value=Constant(value=8, lineno=445, col_offset=25, end_lineno=445, end_col_offset=26), simple=1, lineno=445, col_offset=4, end_lineno=445, end_col_offset=26)], decorator_list=[Call(func=Name(id='dataclass', ctx=Load(), lineno=438, col_offset=1, end_lineno=438, end_col_offset=10), keywords=[keyword(arg='frozen', value=Constant(value=True, lineno=438, col_offset=18, end_lineno=438, end_col_offset=22), lineno=438, col_offset=11, end_lineno=438, end_col_offset=22)], lineno=438, col_offset=1, end_lineno=438, end_col_offset=23)], lineno=439, col_offset=0, end_lineno=445, end_col_offset=26), ClassDef(name='ChunkOptions', body=[Expr(value=Constant(value='Chunk generation configuration.', lineno=450, col_offset=4, end_lineno=450, end_col_offset=41), lineno=450, col_offset=4, end_lineno=450, end_col_offset=41), AnnAssign(target=Name(id='budget', ctx=Store(), lineno=452, col_offset=4, end_lineno=452, end_col_offset=10), annotation=Name(id='int', ctx=Load(), lineno=452, col_offset=12, end_lineno=452, end_col_offset=15), value=Constant(value=2200, lineno=452, col_offset=18, end_lineno=452, end_col_offset=22), simple=1, lineno=452, col_offset=4, end_lineno=452, end_col_offset=22), AnnAssign(target=Name(id='language', ctx=Store(), lineno=453, col_offset=4, end_lineno=453, end_col_offset=12), annotation=BinOp(left=Name(id='str', ctx=Load(), lineno=453, col_offset=14, end_lineno=453, end_col_offset=17), op=BitOr(), right=Constant(value=None, lineno=453, col_offset=20, end_lineno=453, end_col_offset=24), lineno=453, col_offset=14, end_lineno=453, end_col_offset=24), value=Constant(value=None, lineno=453, col_offset=27, end_lineno=453, end_col_offset=31), simple=1, lineno=453, col_offset=4, end_lineno=453, end_col_offset=31), AnnAssign(target=Name(id='overlap', ctx=Store(), lineno=454, col_offset=4, end_lineno=454, end_col_offset=11), annotation=BinOp(left=Name(id='ChunkOverlapOptions', ctx=Load(), lineno=454, col_offset=13, end_lineno=454, end_col_offset=32), op=BitOr(), right=Constant(value=None, lineno=454, col_offset=35, end_lineno=454, end_col_offset=39), lineno=454, col_offset=13, end_lineno=454, end_col_offset=39), value=Constant(value=None, lineno=454, col_offset=42, end_lineno=454, end_col_offset=46), simple=1, lineno=454, col_offset=4, end_lineno=454, end_col_offset=46)], decorator_list=[Call(func=Name(id='dataclass', ctx=Load(), lineno=448, col_offset=1, end_lineno=448, end_col_offset=10), keywords=[keyword(arg='frozen', value=Constant(value=True, lineno=448, col_offset=18, end_lineno=448, end_col_offset=22), lineno=448, col_offset=11, end_lineno=448, end_col_offset=22)], lineno=448, col_offset=1, end_lineno=448, end_col_offset=23)], lineno=449, col_offset=0, end_lineno=454, end_col_offset=46), FunctionDef(name='_apply_call_site_overlap', args=arguments(kwonlyargs=[arg(arg='chunks', annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=459, col_offset=12, end_lineno=459, end_col_offset=16), slice=Name(id='Chunk', ctx=Load(), lineno=459, col_offset=17, end_lineno=459, end_col_offset=22), ctx=Load(), lineno=459, col_offset=12, end_lineno=459, end_col_offset=23), lineno=459, col_offset=4, end_lineno=459, end_col_offset=23), arg(arg='encoded', annotation=Name(id='bytes', ctx=Load(), lineno=460, col_offset=13, end_lineno=460, end_col_offset=18), lineno=460, col_offset=4, end_lineno=460, end_col_offset=18), arg(arg='byte_starts', annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=461, col_offset=17, end_lineno=461, end_col_offset=21), slice=Name(id='int', ctx=Load(), lineno=461, col_offset=22, end_lineno=461, end_col_offset=25), ctx=Load(), lineno=461, col_offset=17, end_lineno=461, end_col_offset=26), lineno=461, col_offset=4, end_lineno=461, end_col_offset=26), arg(arg='options', annotation=Name(id='ChunkOverlapOptions', ctx=Load(), lineno=462, col_offset=13, end_lineno=462, end_col_offset=32), lineno=462, col_offset=4, end_lineno=462, end_col_offset=32)], kw_defaults=[None, None, None, None]), body=[Expr(value=Constant(value='Add call-site overlap snippets to chunks.\n\n    Parameters\n    ----------\n    chunks : list[Chunk]\n        Initial chunks to enhance with overlap snippets.\n    encoded : bytes\n        UTF-8 encoded file content.\n    byte_starts : list[int]\n        Byte offsets for each line start.\n    options : ChunkOverlapOptions\n        Overlap configuration including file occurrences and chunk lookup.\n\n    Returns\n    -------\n    list[Chunk]\n        Modified chunks with call-site overlap snippets added.\n    ', lineno=464, col_offset=4, end_lineno=481, end_col_offset=7), lineno=464, col_offset=4, end_lineno=481, end_col_offset=7), FunctionDef(name='_slice_lines', args=arguments(args=[arg(arg='beg_line', annotation=Name(id='int', ctx=Load(), lineno=483, col_offset=31, end_lineno=483, end_col_offset=34), lineno=483, col_offset=21, end_lineno=483, end_col_offset=34), arg(arg='end_line', annotation=Name(id='int', ctx=Load(), lineno=483, col_offset=46, end_lineno=483, end_col_offset=49), lineno=483, col_offset=36, end_lineno=483, end_col_offset=49)]), body=[Assign(targets=[Name(id='bounded_start', ctx=Store(), lineno=484, col_offset=8, end_lineno=484, end_col_offset=21)], value=Call(func=Name(id='min', ctx=Load(), lineno=484, col_offset=24, end_lineno=484, end_col_offset=27), args=[Call(func=Name(id='max', ctx=Load(), lineno=484, col_offset=28, end_lineno=484, end_col_offset=31), args=[Name(id='beg_line', ctx=Load(), lineno=484, col_offset=32, end_lineno=484, end_col_offset=40), Constant(value=0, lineno=484, col_offset=42, end_lineno=484, end_col_offset=43)], lineno=484, col_offset=28, end_lineno=484, end_col_offset=44), BinOp(left=Call(func=Name(id='len', ctx=Load(), lineno=484, col_offset=46, end_lineno=484, end_col_offset=49), args=[Name(id='byte_starts', ctx=Load(), lineno=484, col_offset=50, end_lineno=484, end_col_offset=61)], lineno=484, col_offset=46, end_lineno=484, end_col_offset=62), op=Sub(), right=Constant(value=1, lineno=484, col_offset=65, end_lineno=484, end_col_offset=66), lineno=484, col_offset=46, end_lineno=484, end_col_offset=66)], lineno=484, col_offset=24, end_lineno=484, end_col_offset=67), lineno=484, col_offset=8, end_lineno=484, end_col_offset=67), Assign(targets=[Name(id='bounded_end', ctx=Store(), lineno=485, col_offset=8, end_lineno=485, end_col_offset=19)], value=Call(func=Name(id='min', ctx=Load(), lineno=485, col_offset=22, end_lineno=485, end_col_offset=25), args=[Call(func=Name(id='max', ctx=Load(), lineno=485, col_offset=26, end_lineno=485, end_col_offset=29), args=[Name(id='end_line', ctx=Load(), lineno=485, col_offset=30, end_lineno=485, end_col_offset=38), Constant(value=0, lineno=485, col_offset=40, end_lineno=485, end_col_offset=41)], lineno=485, col_offset=26, end_lineno=485, end_col_offset=42), BinOp(left=Call(func=Name(id='len', ctx=Load(), lineno=485, col_offset=44, end_lineno=485, end_col_offset=47), args=[Name(id='byte_starts', ctx=Load(), lineno=485, col_offset=48, end_lineno=485, end_col_offset=59)], lineno=485, col_offset=44, end_lineno=485, end_col_offset=60), op=Sub(), right=Constant(value=1, lineno=485, col_offset=63, end_lineno=485, end_col_offset=64), lineno=485, col_offset=44, end_lineno=485, end_col_offset=64)], lineno=485, col_offset=22, end_lineno=485, end_col_offset=65), lineno=485, col_offset=8, end_lineno=485, end_col_offset=65), Assign(targets=[Name(id='start_byte', ctx=Store(), lineno=486, col_offset=8, end_lineno=486, end_col_offset=18)], value=Subscript(value=Name(id='byte_starts', ctx=Load(), lineno=486, col_offset=21, end_lineno=486, end_col_offset=32), slice=Name(id='bounded_start', ctx=Load(), lineno=486, col_offset=33, end_lineno=486, end_col_offset=46), ctx=Load(), lineno=486, col_offset=21, end_lineno=486, end_col_offset=47), lineno=486, col_offset=8, end_lineno=486, end_col_offset=47), Assign(targets=[Name(id='end_byte', ctx=Store(), lineno=487, col_offset=8, end_lineno=487, end_col_offset=16)], value=Subscript(value=Name(id='byte_starts', ctx=Load(), lineno=487, col_offset=19, end_lineno=487, end_col_offset=30), slice=Name(id='bounded_end', ctx=Load(), lineno=487, col_offset=31, end_lineno=487, end_col_offset=42), ctx=Load(), lineno=487, col_offset=19, end_lineno=487, end_col_offset=43), lineno=487, col_offset=8, end_lineno=487, end_col_offset=43), Return(value=Call(func=Attribute(value=Subscript(value=Name(id='encoded', ctx=Load(), lineno=488, col_offset=15, end_lineno=488, end_col_offset=22), slice=Slice(lower=Name(id='start_byte', ctx=Load(), lineno=488, col_offset=23, end_lineno=488, end_col_offset=33), upper=Name(id='end_byte', ctx=Load(), lineno=488, col_offset=34, end_lineno=488, end_col_offset=42), lineno=488, col_offset=23, end_lineno=488, end_col_offset=42), ctx=Load(), lineno=488, col_offset=15, end_lineno=488, end_col_offset=43), attr='decode', ctx=Load(), lineno=488, col_offset=15, end_lineno=488, end_col_offset=50), args=[Constant(value='utf-8', lineno=488, col_offset=51, end_lineno=488, end_col_offset=58)], keywords=[keyword(arg='errors', value=Constant(value='ignore', lineno=488, col_offset=67, end_lineno=488, end_col_offset=75), lineno=488, col_offset=60, end_lineno=488, end_col_offset=75)], lineno=488, col_offset=15, end_lineno=488, end_col_offset=76), lineno=488, col_offset=8, end_lineno=488, end_col_offset=76)], returns=Name(id='str', ctx=Load(), lineno=483, col_offset=54, end_lineno=483, end_col_offset=57), lineno=483, col_offset=4, end_lineno=488, end_col_offset=76), Assign(targets=[Name(id='mutable', ctx=Store(), lineno=490, col_offset=4, end_lineno=490, end_col_offset=11)], value=Call(func=Name(id='list', ctx=Load(), lineno=490, col_offset=14, end_lineno=490, end_col_offset=18), args=[Name(id='chunks', ctx=Load(), lineno=490, col_offset=19, end_lineno=490, end_col_offset=25)], lineno=490, col_offset=14, end_lineno=490, end_col_offset=26), lineno=490, col_offset=4, end_lineno=490, end_col_offset=26), For(target=Tuple(elts=[Name(id='idx', ctx=Store(), lineno=491, col_offset=8, end_lineno=491, end_col_offset=11), Name(id='chunk', ctx=Store(), lineno=491, col_offset=13, end_lineno=491, end_col_offset=18)], ctx=Store(), lineno=491, col_offset=8, end_lineno=491, end_col_offset=18), iter=Call(func=Name(id='enumerate', ctx=Load(), lineno=491, col_offset=22, end_lineno=491, end_col_offset=31), args=[Name(id='mutable', ctx=Load(), lineno=491, col_offset=32, end_lineno=491, end_col_offset=39)], lineno=491, col_offset=22, end_lineno=491, end_col_offset=40), body=[Assign(targets=[Tuple(elts=[Name(id='begin', ctx=Store(), lineno=492, col_offset=8, end_lineno=492, end_col_offset=13), Name(id='end', ctx=Store(), lineno=492, col_offset=15, end_lineno=492, end_col_offset=18)], ctx=Store(), lineno=492, col_offset=8, end_lineno=492, end_col_offset=18)], value=Tuple(elts=[Attribute(value=Name(id='chunk', ctx=Load(), lineno=492, col_offset=21, end_lineno=492, end_col_offset=26), attr='start_line', ctx=Load(), lineno=492, col_offset=21, end_lineno=492, end_col_offset=37), Attribute(value=Name(id='chunk', ctx=Load(), lineno=492, col_offset=39, end_lineno=492, end_col_offset=44), attr='end_line', ctx=Load(), lineno=492, col_offset=39, end_lineno=492, end_col_offset=53)], ctx=Load(), lineno=492, col_offset=21, end_lineno=492, end_col_offset=53), lineno=492, col_offset=8, end_lineno=492, end_col_offset=53), AnnAssign(target=Name(id='seen', ctx=Store(), lineno=493, col_offset=8, end_lineno=493, end_col_offset=12), annotation=Subscript(value=Name(id='set', ctx=Load(), lineno=493, col_offset=14, end_lineno=493, end_col_offset=17), slice=Name(id='str', ctx=Load(), lineno=493, col_offset=18, end_lineno=493, end_col_offset=21), ctx=Load(), lineno=493, col_offset=14, end_lineno=493, end_col_offset=22), value=Call(func=Name(id='set', ctx=Load(), lineno=493, col_offset=25, end_lineno=493, end_col_offset=28), lineno=493, col_offset=25, end_lineno=493, end_col_offset=30), simple=1, lineno=493, col_offset=8, end_lineno=493, end_col_offset=30), For(target=Tuple(elts=[Name(id='sym', ctx=Store(), lineno=494, col_offset=12, end_lineno=494, end_col_offset=15), Name(id='sl', ctx=Store(), lineno=494, col_offset=17, end_lineno=494, end_col_offset=19), Name(id='_sc', ctx=Store(), lineno=494, col_offset=21, end_lineno=494, end_col_offset=24), Name(id='_el', ctx=Store(), lineno=494, col_offset=26, end_lineno=494, end_col_offset=29), Name(id='_ec', ctx=Store(), lineno=494, col_offset=31, end_lineno=494, end_col_offset=34)], ctx=Store(), lineno=494, col_offset=12, end_lineno=494, end_col_offset=34), iter=Attribute(value=Name(id='options', ctx=Load(), lineno=494, col_offset=38, end_lineno=494, end_col_offset=45), attr='file_occurrences', ctx=Load(), lineno=494, col_offset=38, end_lineno=494, end_col_offset=62), body=[If(test=BoolOp(op=Or(), values=[Compare(left=Name(id='sl', ctx=Load(), lineno=495, col_offset=15, end_lineno=495, end_col_offset=17), ops=[Lt()], comparators=[Name(id='begin', ctx=Load(), lineno=495, col_offset=20, end_lineno=495, end_col_offset=25)], lineno=495, col_offset=15, end_lineno=495, end_col_offset=25), Compare(left=Name(id='sl', ctx=Load(), lineno=495, col_offset=29, end_lineno=495, end_col_offset=31), ops=[Gt()], comparators=[Name(id='end', ctx=Load(), lineno=495, col_offset=34, end_lineno=495, end_col_offset=37)], lineno=495, col_offset=29, end_lineno=495, end_col_offset=37), Compare(left=Name(id='sym', ctx=Load(), lineno=495, col_offset=41, end_lineno=495, end_col_offset=44), ops=[NotIn()], comparators=[Attribute(value=Name(id='options', ctx=Load(), lineno=495, col_offset=52, end_lineno=495, end_col_offset=59), attr='def_chunk_lookup', ctx=Load(), lineno=495, col_offset=52, end_lineno=495, end_col_offset=76)], lineno=495, col_offset=41, end_lineno=495, end_col_offset=76), Compare(left=Name(id='sym', ctx=Load(), lineno=495, col_offset=80, end_lineno=495, end_col_offset=83), ops=[In()], comparators=[Name(id='seen', ctx=Load(), lineno=495, col_offset=87, end_lineno=495, end_col_offset=91)], lineno=495, col_offset=80, end_lineno=495, end_col_offset=91)], lineno=495, col_offset=15, end_lineno=495, end_col_offset=91), body=[Continue(lineno=496, col_offset=16, end_lineno=496, end_col_offset=24)], lineno=495, col_offset=12, end_lineno=496, end_col_offset=24), Expr(value=Call(func=Attribute(value=Name(id='seen', ctx=Load(), lineno=497, col_offset=12, end_lineno=497, end_col_offset=16), attr='add', ctx=Load(), lineno=497, col_offset=12, end_lineno=497, end_col_offset=20), args=[Name(id='sym', ctx=Load(), lineno=497, col_offset=21, end_lineno=497, end_col_offset=24)], lineno=497, col_offset=12, end_lineno=497, end_col_offset=25), lineno=497, col_offset=12, end_lineno=497, end_col_offset=25), Assign(targets=[Name(id='callee_chunk_id', ctx=Store(), lineno=498, col_offset=12, end_lineno=498, end_col_offset=27)], value=Subscript(value=Attribute(value=Name(id='options', ctx=Load(), lineno=498, col_offset=30, end_lineno=498, end_col_offset=37), attr='def_chunk_lookup', ctx=Load(), lineno=498, col_offset=30, end_lineno=498, end_col_offset=54), slice=Name(id='sym', ctx=Load(), lineno=498, col_offset=55, end_lineno=498, end_col_offset=58), ctx=Load(), lineno=498, col_offset=30, end_lineno=498, end_col_offset=59), lineno=498, col_offset=12, end_lineno=498, end_col_offset=59), If(test=Compare(left=Name(id='callee_chunk_id', ctx=Load(), lineno=499, col_offset=15, end_lineno=499, end_col_offset=30), ops=[Eq()], comparators=[Name(id='idx', ctx=Load(), lineno=499, col_offset=34, end_lineno=499, end_col_offset=37)], lineno=499, col_offset=15, end_lineno=499, end_col_offset=37), body=[Continue(lineno=500, col_offset=16, end_lineno=500, end_col_offset=24)], lineno=499, col_offset=12, end_lineno=500, end_col_offset=24), Assign(targets=[Name(id='callee', ctx=Store(), lineno=501, col_offset=12, end_lineno=501, end_col_offset=18)], value=Subscript(value=Name(id='chunks', ctx=Load(), lineno=501, col_offset=21, end_lineno=501, end_col_offset=27), slice=Name(id='callee_chunk_id', ctx=Load(), lineno=501, col_offset=28, end_lineno=501, end_col_offset=43), ctx=Load(), lineno=501, col_offset=21, end_lineno=501, end_col_offset=44), lineno=501, col_offset=12, end_lineno=501, end_col_offset=44), Assign(targets=[Name(id='footer', ctx=Store(), lineno=502, col_offset=12, end_lineno=502, end_col_offset=18)], value=BinOp(left=BinOp(left=BinOp(left=Constant(value='\n\n# related: ', lineno=503, col_offset=16, end_lineno=503, end_col_offset=33), op=Add(), right=Name(id='sym', ctx=Load(), lineno=504, col_offset=18, end_lineno=504, end_col_offset=21), lineno=503, col_offset=16, end_lineno=504, end_col_offset=21), op=Add(), right=Constant(value='\n', lineno=505, col_offset=18, end_lineno=505, end_col_offset=22), lineno=503, col_offset=16, end_lineno=505, end_col_offset=22), op=Add(), right=Call(func=Name(id='_slice_lines', ctx=Load(), lineno=506, col_offset=18, end_lineno=506, end_col_offset=30), args=[Call(func=Name(id='max', ctx=Load(), lineno=507, col_offset=20, end_lineno=507, end_col_offset=23), args=[BinOp(left=Attribute(value=Name(id='callee', ctx=Load(), lineno=507, col_offset=24, end_lineno=507, end_col_offset=30), attr='start_line', ctx=Load(), lineno=507, col_offset=24, end_lineno=507, end_col_offset=41), op=Sub(), right=Attribute(value=Name(id='options', ctx=Load(), lineno=507, col_offset=44, end_lineno=507, end_col_offset=51), attr='overlap_lines', ctx=Load(), lineno=507, col_offset=44, end_lineno=507, end_col_offset=65), lineno=507, col_offset=24, end_lineno=507, end_col_offset=65), Constant(value=0, lineno=507, col_offset=67, end_lineno=507, end_col_offset=68)], lineno=507, col_offset=20, end_lineno=507, end_col_offset=69), Call(func=Name(id='min', ctx=Load(), lineno=508, col_offset=20, end_lineno=508, end_col_offset=23), args=[BinOp(left=Attribute(value=Name(id='callee', ctx=Load(), lineno=508, col_offset=24, end_lineno=508, end_col_offset=30), attr='end_line', ctx=Load(), lineno=508, col_offset=24, end_lineno=508, end_col_offset=39), op=Add(), right=Attribute(value=Name(id='options', ctx=Load(), lineno=508, col_offset=42, end_lineno=508, end_col_offset=49), attr='overlap_lines', ctx=Load(), lineno=508, col_offset=42, end_lineno=508, end_col_offset=63), lineno=508, col_offset=24, end_lineno=508, end_col_offset=63), BinOp(left=Attribute(value=Name(id='callee', ctx=Load(), lineno=508, col_offset=65, end_lineno=508, end_col_offset=71), attr='end_line', ctx=Load(), lineno=508, col_offset=65, end_lineno=508, end_col_offset=80), op=Add(), right=Constant(value=1, lineno=508, col_offset=83, end_lineno=508, end_col_offset=84), lineno=508, col_offset=65, end_lineno=508, end_col_offset=84)], lineno=508, col_offset=20, end_lineno=508, end_col_offset=85)], lineno=506, col_offset=18, end_lineno=509, end_col_offset=17), lineno=503, col_offset=16, end_lineno=509, end_col_offset=17), lineno=502, col_offset=12, end_lineno=510, end_col_offset=13), Assign(targets=[Subscript(value=Name(id='mutable', ctx=Load(), lineno=511, col_offset=12, end_lineno=511, end_col_offset=19), slice=Name(id='idx', ctx=Load(), lineno=511, col_offset=20, end_lineno=511, end_col_offset=23), ctx=Store(), lineno=511, col_offset=12, end_lineno=511, end_col_offset=24)], value=Call(func=Name(id='Chunk', ctx=Load(), lineno=511, col_offset=27, end_lineno=511, end_col_offset=32), keywords=[keyword(arg='uri', value=Attribute(value=Name(id='chunk', ctx=Load(), lineno=512, col_offset=20, end_lineno=512, end_col_offset=25), attr='uri', ctx=Load(), lineno=512, col_offset=20, end_lineno=512, end_col_offset=29), lineno=512, col_offset=16, end_lineno=512, end_col_offset=29), keyword(arg='start_byte', value=Attribute(value=Name(id='chunk', ctx=Load(), lineno=513, col_offset=27, end_lineno=513, end_col_offset=32), attr='start_byte', ctx=Load(), lineno=513, col_offset=27, end_lineno=513, end_col_offset=43), lineno=513, col_offset=16, end_lineno=513, end_col_offset=43), keyword(arg='end_byte', value=Attribute(value=Name(id='chunk', ctx=Load(), lineno=514, col_offset=25, end_lineno=514, end_col_offset=30), attr='end_byte', ctx=Load(), lineno=514, col_offset=25, end_lineno=514, end_col_offset=39), lineno=514, col_offset=16, end_lineno=514, end_col_offset=39), keyword(arg='start_line', value=Attribute(value=Name(id='chunk', ctx=Load(), lineno=515, col_offset=27, end_lineno=515, end_col_offset=32), attr='start_line', ctx=Load(), lineno=515, col_offset=27, end_lineno=515, end_col_offset=43), lineno=515, col_offset=16, end_lineno=515, end_col_offset=43), keyword(arg='end_line', value=Attribute(value=Name(id='chunk', ctx=Load(), lineno=516, col_offset=25, end_lineno=516, end_col_offset=30), attr='end_line', ctx=Load(), lineno=516, col_offset=25, end_lineno=516, end_col_offset=39), lineno=516, col_offset=16, end_lineno=516, end_col_offset=39), keyword(arg='text', value=BinOp(left=BinOp(left=Attribute(value=Name(id='chunk', ctx=Load(), lineno=517, col_offset=21, end_lineno=517, end_col_offset=26), attr='text', ctx=Load(), lineno=517, col_offset=21, end_lineno=517, end_col_offset=31), op=Add(), right=Constant(value='\n', lineno=517, col_offset=34, end_lineno=517, end_col_offset=38), lineno=517, col_offset=21, end_lineno=517, end_col_offset=38), op=Add(), right=Name(id='footer', ctx=Load(), lineno=517, col_offset=41, end_lineno=517, end_col_offset=47), lineno=517, col_offset=21, end_lineno=517, end_col_offset=47), lineno=517, col_offset=16, end_lineno=517, end_col_offset=47), keyword(arg='symbols', value=Call(func=Name(id='tuple', ctx=Load(), lineno=518, col_offset=24, end_lineno=518, end_col_offset=29), args=[Call(func=Name(id='sorted', ctx=Load(), lineno=518, col_offset=30, end_lineno=518, end_col_offset=36), args=[BinOp(left=Call(func=Name(id='set', ctx=Load(), lineno=518, col_offset=37, end_lineno=518, end_col_offset=40), args=[Attribute(value=Name(id='chunk', ctx=Load(), lineno=518, col_offset=41, end_lineno=518, end_col_offset=46), attr='symbols', ctx=Load(), lineno=518, col_offset=41, end_lineno=518, end_col_offset=54)], lineno=518, col_offset=37, end_lineno=518, end_col_offset=55), op=BitOr(), right=Set(elts=[Name(id='sym', ctx=Load(), lineno=518, col_offset=59, end_lineno=518, end_col_offset=62)], lineno=518, col_offset=58, end_lineno=518, end_col_offset=63), lineno=518, col_offset=37, end_lineno=518, end_col_offset=63)], lineno=518, col_offset=30, end_lineno=518, end_col_offset=64)], lineno=518, col_offset=24, end_lineno=518, end_col_offset=65), lineno=518, col_offset=16, end_lineno=518, end_col_offset=65), keyword(arg='language', value=Attribute(value=Name(id='chunk', ctx=Load(), lineno=519, col_offset=25, end_lineno=519, end_col_offset=30), attr='language', ctx=Load(), lineno=519, col_offset=25, end_lineno=519, end_col_offset=39), lineno=519, col_offset=16, end_lineno=519, end_col_offset=39)], lineno=511, col_offset=27, end_lineno=520, end_col_offset=13), lineno=511, col_offset=12, end_lineno=520, end_col_offset=13), If(test=Compare(left=Call(func=Name(id='len', ctx=Load(), lineno=521, col_offset=15, end_lineno=521, end_col_offset=18), args=[Name(id='seen', ctx=Load(), lineno=521, col_offset=19, end_lineno=521, end_col_offset=23)], lineno=521, col_offset=15, end_lineno=521, end_col_offset=24), ops=[GtE()], comparators=[Attribute(value=Name(id='options', ctx=Load(), lineno=521, col_offset=28, end_lineno=521, end_col_offset=35), attr='max_related', ctx=Load(), lineno=521, col_offset=28, end_lineno=521, end_col_offset=47)], lineno=521, col_offset=15, end_lineno=521, end_col_offset=47), body=[Break(lineno=522, col_offset=16, end_lineno=522, end_col_offset=21)], lineno=521, col_offset=12, end_lineno=522, end_col_offset=21)], lineno=494, col_offset=8, end_lineno=522, end_col_offset=21)], lineno=491, col_offset=4, end_lineno=522, end_col_offset=21), Return(value=Name(id='mutable', ctx=Load(), lineno=524, col_offset=11, end_lineno=524, end_col_offset=18), lineno=524, col_offset=4, end_lineno=524, end_col_offset=18)], returns=Subscript(value=Name(id='list', ctx=Load(), lineno=463, col_offset=5, end_lineno=463, end_col_offset=9), slice=Name(id='Chunk', ctx=Load(), lineno=463, col_offset=10, end_lineno=463, end_col_offset=15), ctx=Load(), lineno=463, col_offset=5, end_lineno=463, end_col_offset=16), lineno=457, col_offset=0, end_lineno=524, end_col_offset=18), Assign(targets=[Name(id='__all__', ctx=Store(), lineno=527, col_offset=0, end_lineno=527, end_col_offset=7)], value=List(elts=[Constant(value='Chunk', lineno=528, col_offset=4, end_lineno=528, end_col_offset=11), Constant(value='chunk_file', lineno=529, col_offset=4, end_lineno=529, end_col_offset=16), Constant(value='line_starts', lineno=530, col_offset=4, end_lineno=530, end_col_offset=17), Constant(value='range_to_bytes', lineno=531, col_offset=4, end_lineno=531, end_col_offset=20)], ctx=Load(), lineno=527, col_offset=10, end_lineno=532, end_col_offset=1), lineno=527, col_offset=0, end_lineno=532, end_col_offset=1)])