Module(body=[Expr(value=Constant(value='DuckDB symbol catalog writer.', lineno=1, col_offset=0, end_lineno=1, end_col_offset=35), lineno=1, col_offset=0, end_lineno=1, end_col_offset=35), ImportFrom(module='__future__', names=[alias(name='annotations', lineno=3, col_offset=23, end_lineno=3, end_col_offset=34)], level=0, lineno=3, col_offset=0, end_lineno=3, end_col_offset=34), ImportFrom(module='collections.abc', names=[alias(name='Iterable', lineno=5, col_offset=28, end_lineno=5, end_col_offset=36), alias(name='Sequence', lineno=5, col_offset=38, end_lineno=5, end_col_offset=46)], level=0, lineno=5, col_offset=0, end_lineno=5, end_col_offset=46), ImportFrom(module='dataclasses', names=[alias(name='dataclass', lineno=6, col_offset=24, end_lineno=6, end_col_offset=33)], level=0, lineno=6, col_offset=0, end_lineno=6, end_col_offset=33), ImportFrom(module='codeintel_rev.io.duckdb_manager', names=[alias(name='DuckDBManager', lineno=8, col_offset=44, end_lineno=8, end_col_offset=57)], level=0, lineno=8, col_offset=0, end_lineno=8, end_col_offset=57), ClassDef(name='SymbolDefRow', body=[Expr(value=Constant(value='Immutable row describing a symbol definition.', lineno=13, col_offset=4, end_lineno=13, end_col_offset=55), lineno=13, col_offset=4, end_lineno=13, end_col_offset=55), AnnAssign(target=Name(id='symbol', ctx=Store(), lineno=15, col_offset=4, end_lineno=15, end_col_offset=10), annotation=Name(id='str', ctx=Load(), lineno=15, col_offset=12, end_lineno=15, end_col_offset=15), simple=1, lineno=15, col_offset=4, end_lineno=15, end_col_offset=15), AnnAssign(target=Name(id='display_name', ctx=Store(), lineno=16, col_offset=4, end_lineno=16, end_col_offset=16), annotation=Name(id='str', ctx=Load(), lineno=16, col_offset=18, end_lineno=16, end_col_offset=21), simple=1, lineno=16, col_offset=4, end_lineno=16, end_col_offset=21), AnnAssign(target=Name(id='kind', ctx=Store(), lineno=17, col_offset=4, end_lineno=17, end_col_offset=8), annotation=Name(id='str', ctx=Load(), lineno=17, col_offset=10, end_lineno=17, end_col_offset=13), simple=1, lineno=17, col_offset=4, end_lineno=17, end_col_offset=13), AnnAssign(target=Name(id='language', ctx=Store(), lineno=18, col_offset=4, end_lineno=18, end_col_offset=12), annotation=Name(id='str', ctx=Load(), lineno=18, col_offset=14, end_lineno=18, end_col_offset=17), simple=1, lineno=18, col_offset=4, end_lineno=18, end_col_offset=17), AnnAssign(target=Name(id='uri', ctx=Store(), lineno=19, col_offset=4, end_lineno=19, end_col_offset=7), annotation=Name(id='str', ctx=Load(), lineno=19, col_offset=9, end_lineno=19, end_col_offset=12), simple=1, lineno=19, col_offset=4, end_lineno=19, end_col_offset=12), AnnAssign(target=Name(id='start_line', ctx=Store(), lineno=20, col_offset=4, end_lineno=20, end_col_offset=14), annotation=Name(id='int', ctx=Load(), lineno=20, col_offset=16, end_lineno=20, end_col_offset=19), simple=1, lineno=20, col_offset=4, end_lineno=20, end_col_offset=19), AnnAssign(target=Name(id='start_col', ctx=Store(), lineno=21, col_offset=4, end_lineno=21, end_col_offset=13), annotation=Name(id='int', ctx=Load(), lineno=21, col_offset=15, end_lineno=21, end_col_offset=18), simple=1, lineno=21, col_offset=4, end_lineno=21, end_col_offset=18), AnnAssign(target=Name(id='end_line', ctx=Store(), lineno=22, col_offset=4, end_lineno=22, end_col_offset=12), annotation=Name(id='int', ctx=Load(), lineno=22, col_offset=14, end_lineno=22, end_col_offset=17), simple=1, lineno=22, col_offset=4, end_lineno=22, end_col_offset=17), AnnAssign(target=Name(id='end_col', ctx=Store(), lineno=23, col_offset=4, end_lineno=23, end_col_offset=11), annotation=Name(id='int', ctx=Load(), lineno=23, col_offset=13, end_lineno=23, end_col_offset=16), simple=1, lineno=23, col_offset=4, end_lineno=23, end_col_offset=16), AnnAssign(target=Name(id='chunk_id', ctx=Store(), lineno=24, col_offset=4, end_lineno=24, end_col_offset=12), annotation=Name(id='int', ctx=Load(), lineno=24, col_offset=14, end_lineno=24, end_col_offset=17), simple=1, lineno=24, col_offset=4, end_lineno=24, end_col_offset=17), AnnAssign(target=Name(id='docstring', ctx=Store(), lineno=25, col_offset=4, end_lineno=25, end_col_offset=13), annotation=BinOp(left=Name(id='str', ctx=Load(), lineno=25, col_offset=15, end_lineno=25, end_col_offset=18), op=BitOr(), right=Constant(value=None, lineno=25, col_offset=21, end_lineno=25, end_col_offset=25), lineno=25, col_offset=15, end_lineno=25, end_col_offset=25), value=Constant(value=None, lineno=25, col_offset=28, end_lineno=25, end_col_offset=32), simple=1, lineno=25, col_offset=4, end_lineno=25, end_col_offset=32), AnnAssign(target=Name(id='signature', ctx=Store(), lineno=26, col_offset=4, end_lineno=26, end_col_offset=13), annotation=BinOp(left=Name(id='str', ctx=Load(), lineno=26, col_offset=15, end_lineno=26, end_col_offset=18), op=BitOr(), right=Constant(value=None, lineno=26, col_offset=21, end_lineno=26, end_col_offset=25), lineno=26, col_offset=15, end_lineno=26, end_col_offset=25), value=Constant(value=None, lineno=26, col_offset=28, end_lineno=26, end_col_offset=32), simple=1, lineno=26, col_offset=4, end_lineno=26, end_col_offset=32)], decorator_list=[Call(func=Name(id='dataclass', ctx=Load(), lineno=11, col_offset=1, end_lineno=11, end_col_offset=10), keywords=[keyword(arg='frozen', value=Constant(value=True, lineno=11, col_offset=18, end_lineno=11, end_col_offset=22), lineno=11, col_offset=11, end_lineno=11, end_col_offset=22)], lineno=11, col_offset=1, end_lineno=11, end_col_offset=23)], lineno=12, col_offset=0, end_lineno=26, end_col_offset=32), ClassDef(name='SymbolOccurrenceRow', body=[Expr(value=Constant(value='Service row for individual symbol occurrences.', lineno=31, col_offset=4, end_lineno=31, end_col_offset=56), lineno=31, col_offset=4, end_lineno=31, end_col_offset=56), AnnAssign(target=Name(id='symbol', ctx=Store(), lineno=33, col_offset=4, end_lineno=33, end_col_offset=10), annotation=Name(id='str', ctx=Load(), lineno=33, col_offset=12, end_lineno=33, end_col_offset=15), simple=1, lineno=33, col_offset=4, end_lineno=33, end_col_offset=15), AnnAssign(target=Name(id='uri', ctx=Store(), lineno=34, col_offset=4, end_lineno=34, end_col_offset=7), annotation=Name(id='str', ctx=Load(), lineno=34, col_offset=9, end_lineno=34, end_col_offset=12), simple=1, lineno=34, col_offset=4, end_lineno=34, end_col_offset=12), AnnAssign(target=Name(id='start_line', ctx=Store(), lineno=35, col_offset=4, end_lineno=35, end_col_offset=14), annotation=Name(id='int', ctx=Load(), lineno=35, col_offset=16, end_lineno=35, end_col_offset=19), simple=1, lineno=35, col_offset=4, end_lineno=35, end_col_offset=19), AnnAssign(target=Name(id='start_col', ctx=Store(), lineno=36, col_offset=4, end_lineno=36, end_col_offset=13), annotation=Name(id='int', ctx=Load(), lineno=36, col_offset=15, end_lineno=36, end_col_offset=18), simple=1, lineno=36, col_offset=4, end_lineno=36, end_col_offset=18), AnnAssign(target=Name(id='end_line', ctx=Store(), lineno=37, col_offset=4, end_lineno=37, end_col_offset=12), annotation=Name(id='int', ctx=Load(), lineno=37, col_offset=14, end_lineno=37, end_col_offset=17), simple=1, lineno=37, col_offset=4, end_lineno=37, end_col_offset=17), AnnAssign(target=Name(id='end_col', ctx=Store(), lineno=38, col_offset=4, end_lineno=38, end_col_offset=11), annotation=Name(id='int', ctx=Load(), lineno=38, col_offset=13, end_lineno=38, end_col_offset=16), simple=1, lineno=38, col_offset=4, end_lineno=38, end_col_offset=16), AnnAssign(target=Name(id='roles', ctx=Store(), lineno=39, col_offset=4, end_lineno=39, end_col_offset=9), annotation=Name(id='int', ctx=Load(), lineno=39, col_offset=11, end_lineno=39, end_col_offset=14), simple=1, lineno=39, col_offset=4, end_lineno=39, end_col_offset=14), AnnAssign(target=Name(id='kind', ctx=Store(), lineno=40, col_offset=4, end_lineno=40, end_col_offset=8), annotation=BinOp(left=Name(id='str', ctx=Load(), lineno=40, col_offset=10, end_lineno=40, end_col_offset=13), op=BitOr(), right=Constant(value=None, lineno=40, col_offset=16, end_lineno=40, end_col_offset=20), lineno=40, col_offset=10, end_lineno=40, end_col_offset=20), simple=1, lineno=40, col_offset=4, end_lineno=40, end_col_offset=20), AnnAssign(target=Name(id='language', ctx=Store(), lineno=41, col_offset=4, end_lineno=41, end_col_offset=12), annotation=Name(id='str', ctx=Load(), lineno=41, col_offset=14, end_lineno=41, end_col_offset=17), simple=1, lineno=41, col_offset=4, end_lineno=41, end_col_offset=17), AnnAssign(target=Name(id='chunk_id', ctx=Store(), lineno=42, col_offset=4, end_lineno=42, end_col_offset=12), annotation=Name(id='int', ctx=Load(), lineno=42, col_offset=14, end_lineno=42, end_col_offset=17), simple=1, lineno=42, col_offset=4, end_lineno=42, end_col_offset=17)], decorator_list=[Call(func=Name(id='dataclass', ctx=Load(), lineno=29, col_offset=1, end_lineno=29, end_col_offset=10), keywords=[keyword(arg='frozen', value=Constant(value=True, lineno=29, col_offset=18, end_lineno=29, end_col_offset=22), lineno=29, col_offset=11, end_lineno=29, end_col_offset=22)], lineno=29, col_offset=1, end_lineno=29, end_col_offset=23)], lineno=30, col_offset=0, end_lineno=42, end_col_offset=17), ClassDef(name='SymbolCatalog', body=[Expr(value=Constant(value='Writer for symbol metadata tables alongside `chunks`.', lineno=46, col_offset=4, end_lineno=46, end_col_offset=63), lineno=46, col_offset=4, end_lineno=46, end_col_offset=63), FunctionDef(name='__init__', args=arguments(args=[arg(arg='self', lineno=48, col_offset=17, end_lineno=48, end_col_offset=21), arg(arg='manager', annotation=Name(id='DuckDBManager', ctx=Load(), lineno=48, col_offset=32, end_lineno=48, end_col_offset=45), lineno=48, col_offset=23, end_lineno=48, end_col_offset=45)]), body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load(), lineno=49, col_offset=8, end_lineno=49, end_col_offset=12), attr='_manager', ctx=Store(), lineno=49, col_offset=8, end_lineno=49, end_col_offset=21)], value=Name(id='manager', ctx=Load(), lineno=49, col_offset=24, end_lineno=49, end_col_offset=31), lineno=49, col_offset=8, end_lineno=49, end_col_offset=31)], returns=Constant(value=None, lineno=48, col_offset=50, end_lineno=48, end_col_offset=54), lineno=48, col_offset=4, end_lineno=49, end_col_offset=31), FunctionDef(name='ensure_schema', args=arguments(args=[arg(arg='self', lineno=51, col_offset=22, end_lineno=51, end_col_offset=26)]), body=[Expr(value=Constant(value='Ensure symbol tables and indexes exist in DuckDB.', lineno=52, col_offset=8, end_lineno=52, end_col_offset=63), lineno=52, col_offset=8, end_lineno=52, end_col_offset=63), With(items=[withitem(context_expr=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=53, col_offset=13, end_lineno=53, end_col_offset=17), attr='_manager', ctx=Load(), lineno=53, col_offset=13, end_lineno=53, end_col_offset=26), attr='connection', ctx=Load(), lineno=53, col_offset=13, end_lineno=53, end_col_offset=37), lineno=53, col_offset=13, end_lineno=53, end_col_offset=39), optional_vars=Name(id='conn', ctx=Store(), lineno=53, col_offset=43, end_lineno=53, end_col_offset=47))], body=[Expr(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=54, col_offset=12, end_lineno=54, end_col_offset=16), attr='execute', ctx=Load(), lineno=54, col_offset=12, end_lineno=54, end_col_offset=24), args=[Constant(value='\n                CREATE TABLE IF NOT EXISTS symbol_defs(\n                  symbol TEXT PRIMARY KEY,\n                  display_name TEXT,\n                  kind TEXT,\n                  language TEXT,\n                  uri TEXT,\n                  start_line INTEGER,\n                  start_col INTEGER,\n                  end_line INTEGER,\n                  end_col INTEGER,\n                  chunk_id INTEGER,\n                  docstring TEXT,\n                  signature TEXT\n                )', lineno=55, col_offset=16, end_lineno=69, end_col_offset=20)], lineno=54, col_offset=12, end_lineno=70, end_col_offset=13), lineno=54, col_offset=12, end_lineno=70, end_col_offset=13), Expr(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=71, col_offset=12, end_lineno=71, end_col_offset=16), attr='execute', ctx=Load(), lineno=71, col_offset=12, end_lineno=71, end_col_offset=24), args=[Constant(value='CREATE INDEX IF NOT EXISTS idx_symbol_defs_name ON symbol_defs(display_name)', lineno=72, col_offset=16, end_lineno=72, end_col_offset=94)], lineno=71, col_offset=12, end_lineno=73, end_col_offset=13), lineno=71, col_offset=12, end_lineno=73, end_col_offset=13), Expr(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=74, col_offset=12, end_lineno=74, end_col_offset=16), attr='execute', ctx=Load(), lineno=74, col_offset=12, end_lineno=74, end_col_offset=24), args=[Constant(value='CREATE INDEX IF NOT EXISTS idx_symbol_defs_uri ON symbol_defs(uri)', lineno=74, col_offset=25, end_lineno=74, end_col_offset=93)], lineno=74, col_offset=12, end_lineno=74, end_col_offset=94), lineno=74, col_offset=12, end_lineno=74, end_col_offset=94), Expr(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=76, col_offset=12, end_lineno=76, end_col_offset=16), attr='execute', ctx=Load(), lineno=76, col_offset=12, end_lineno=76, end_col_offset=24), args=[Constant(value='\n                CREATE TABLE IF NOT EXISTS symbol_occurrences(\n                  symbol TEXT,\n                  uri TEXT,\n                  start_line INTEGER,\n                  start_col INTEGER,\n                  end_line INTEGER,\n                  end_col INTEGER,\n                  roles INTEGER,\n                  kind TEXT,\n                  language TEXT,\n                  chunk_id INTEGER\n                )', lineno=77, col_offset=16, end_lineno=89, end_col_offset=20)], lineno=76, col_offset=12, end_lineno=90, end_col_offset=13), lineno=76, col_offset=12, end_lineno=90, end_col_offset=13), Expr(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=91, col_offset=12, end_lineno=91, end_col_offset=16), attr='execute', ctx=Load(), lineno=91, col_offset=12, end_lineno=91, end_col_offset=24), args=[Constant(value='CREATE INDEX IF NOT EXISTS idx_occ_sym ON symbol_occurrences(symbol)', lineno=91, col_offset=25, end_lineno=91, end_col_offset=95)], lineno=91, col_offset=12, end_lineno=91, end_col_offset=96), lineno=91, col_offset=12, end_lineno=91, end_col_offset=96), Expr(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=92, col_offset=12, end_lineno=92, end_col_offset=16), attr='execute', ctx=Load(), lineno=92, col_offset=12, end_lineno=92, end_col_offset=24), args=[Constant(value='CREATE INDEX IF NOT EXISTS idx_occ_uri_pos ON symbol_occurrences(uri, start_line)', lineno=93, col_offset=16, end_lineno=93, end_col_offset=99)], lineno=92, col_offset=12, end_lineno=94, end_col_offset=13), lineno=92, col_offset=12, end_lineno=94, end_col_offset=13), Expr(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=96, col_offset=12, end_lineno=96, end_col_offset=16), attr='execute', ctx=Load(), lineno=96, col_offset=12, end_lineno=96, end_col_offset=24), args=[Constant(value='\n                CREATE TABLE IF NOT EXISTS chunk_symbols(\n                  chunk_id INTEGER,\n                  symbol TEXT\n                )', lineno=97, col_offset=16, end_lineno=101, end_col_offset=20)], lineno=96, col_offset=12, end_lineno=102, end_col_offset=13), lineno=96, col_offset=12, end_lineno=102, end_col_offset=13), Expr(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=103, col_offset=12, end_lineno=103, end_col_offset=16), attr='execute', ctx=Load(), lineno=103, col_offset=12, end_lineno=103, end_col_offset=24), args=[Constant(value='CREATE INDEX IF NOT EXISTS idx_chunk_symbols_chunk ON chunk_symbols(chunk_id)', lineno=104, col_offset=16, end_lineno=104, end_col_offset=95)], lineno=103, col_offset=12, end_lineno=105, end_col_offset=13), lineno=103, col_offset=12, end_lineno=105, end_col_offset=13), Expr(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=106, col_offset=12, end_lineno=106, end_col_offset=16), attr='execute', ctx=Load(), lineno=106, col_offset=12, end_lineno=106, end_col_offset=24), args=[Constant(value='CREATE INDEX IF NOT EXISTS idx_chunk_symbols_sym ON chunk_symbols(symbol)', lineno=107, col_offset=16, end_lineno=107, end_col_offset=91)], lineno=106, col_offset=12, end_lineno=108, end_col_offset=13), lineno=106, col_offset=12, end_lineno=108, end_col_offset=13), Expr(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=110, col_offset=12, end_lineno=110, end_col_offset=16), attr='execute', ctx=Load(), lineno=110, col_offset=12, end_lineno=110, end_col_offset=24), args=[Constant(value='\n                CREATE TABLE IF NOT EXISTS path_weights(\n                  glob TEXT PRIMARY KEY,\n                  weight DOUBLE\n                )', lineno=111, col_offset=16, end_lineno=115, end_col_offset=20)], lineno=110, col_offset=12, end_lineno=116, end_col_offset=13), lineno=110, col_offset=12, end_lineno=116, end_col_offset=13), Expr(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=117, col_offset=12, end_lineno=117, end_col_offset=16), attr='execute', ctx=Load(), lineno=117, col_offset=12, end_lineno=117, end_col_offset=24), args=[Constant(value='\n                CREATE TABLE IF NOT EXISTS kind_weights(\n                  kind TEXT PRIMARY KEY,\n                  weight DOUBLE\n                )', lineno=118, col_offset=16, end_lineno=122, end_col_offset=20)], lineno=117, col_offset=12, end_lineno=123, end_col_offset=13), lineno=117, col_offset=12, end_lineno=123, end_col_offset=13)], lineno=53, col_offset=8, end_lineno=123, end_col_offset=13)], returns=Constant(value=None, lineno=51, col_offset=31, end_lineno=51, end_col_offset=35), lineno=51, col_offset=4, end_lineno=123, end_col_offset=13), FunctionDef(name='upsert_symbol_defs', args=arguments(args=[arg(arg='self', lineno=125, col_offset=27, end_lineno=125, end_col_offset=31), arg(arg='rows', annotation=Subscript(value=Name(id='Sequence', ctx=Load(), lineno=125, col_offset=39, end_lineno=125, end_col_offset=47), slice=Name(id='SymbolDefRow', ctx=Load(), lineno=125, col_offset=48, end_lineno=125, end_col_offset=60), ctx=Load(), lineno=125, col_offset=39, end_lineno=125, end_col_offset=61), lineno=125, col_offset=33, end_lineno=125, end_col_offset=61)]), body=[Expr(value=Constant(value='Insert or replace symbol definitions in bulk.', lineno=126, col_offset=8, end_lineno=126, end_col_offset=59), lineno=126, col_offset=8, end_lineno=126, end_col_offset=59), If(test=UnaryOp(op=Not(), operand=Name(id='rows', ctx=Load(), lineno=127, col_offset=15, end_lineno=127, end_col_offset=19), lineno=127, col_offset=11, end_lineno=127, end_col_offset=19), body=[Return(lineno=128, col_offset=12, end_lineno=128, end_col_offset=18)], lineno=127, col_offset=8, end_lineno=128, end_col_offset=18), With(items=[withitem(context_expr=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=130, col_offset=13, end_lineno=130, end_col_offset=17), attr='_manager', ctx=Load(), lineno=130, col_offset=13, end_lineno=130, end_col_offset=26), attr='connection', ctx=Load(), lineno=130, col_offset=13, end_lineno=130, end_col_offset=37), lineno=130, col_offset=13, end_lineno=130, end_col_offset=39), optional_vars=Name(id='conn', ctx=Store(), lineno=130, col_offset=43, end_lineno=130, end_col_offset=47))], body=[Expr(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=131, col_offset=12, end_lineno=131, end_col_offset=16), attr='execute', ctx=Load(), lineno=131, col_offset=12, end_lineno=131, end_col_offset=24), args=[Constant(value='BEGIN', lineno=131, col_offset=25, end_lineno=131, end_col_offset=32)], lineno=131, col_offset=12, end_lineno=131, end_col_offset=33), lineno=131, col_offset=12, end_lineno=131, end_col_offset=33), Try(body=[Expr(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=133, col_offset=16, end_lineno=133, end_col_offset=20), attr='execute', ctx=Load(), lineno=133, col_offset=16, end_lineno=133, end_col_offset=28), args=[Constant(value="CREATE TEMP TABLE _defs AS SELECT * FROM (SELECT ''::TEXT AS symbol) WHERE 1=0", lineno=134, col_offset=20, end_lineno=134, end_col_offset=100)], lineno=133, col_offset=16, end_lineno=135, end_col_offset=17), lineno=133, col_offset=16, end_lineno=135, end_col_offset=17), Expr(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=136, col_offset=16, end_lineno=136, end_col_offset=20), attr='register', ctx=Load(), lineno=136, col_offset=16, end_lineno=136, end_col_offset=29), args=[Constant(value='_tmp_defs', lineno=136, col_offset=30, end_lineno=136, end_col_offset=41), Name(id='rows', ctx=Load(), lineno=136, col_offset=43, end_lineno=136, end_col_offset=47)], lineno=136, col_offset=16, end_lineno=136, end_col_offset=48), lineno=136, col_offset=16, end_lineno=136, end_col_offset=48), Expr(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=137, col_offset=16, end_lineno=137, end_col_offset=20), attr='execute', ctx=Load(), lineno=137, col_offset=16, end_lineno=137, end_col_offset=28), args=[Constant(value='INSERT OR REPLACE INTO symbol_defs SELECT * FROM _tmp_defs', lineno=137, col_offset=29, end_lineno=137, end_col_offset=89)], lineno=137, col_offset=16, end_lineno=137, end_col_offset=90), lineno=137, col_offset=16, end_lineno=137, end_col_offset=90)], handlers=[ExceptHandler(type=Name(id='Exception', ctx=Load(), lineno=138, col_offset=19, end_lineno=138, end_col_offset=28), body=[Expr(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=139, col_offset=16, end_lineno=139, end_col_offset=20), attr='execute', ctx=Load(), lineno=139, col_offset=16, end_lineno=139, end_col_offset=28), args=[Constant(value='ROLLBACK', lineno=139, col_offset=29, end_lineno=139, end_col_offset=39)], lineno=139, col_offset=16, end_lineno=139, end_col_offset=40), lineno=139, col_offset=16, end_lineno=139, end_col_offset=40), Raise(lineno=140, col_offset=16, end_lineno=140, end_col_offset=21)], lineno=138, col_offset=12, end_lineno=140, end_col_offset=21)], orelse=[Expr(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=142, col_offset=16, end_lineno=142, end_col_offset=20), attr='execute', ctx=Load(), lineno=142, col_offset=16, end_lineno=142, end_col_offset=28), args=[Constant(value='COMMIT', lineno=142, col_offset=29, end_lineno=142, end_col_offset=37)], lineno=142, col_offset=16, end_lineno=142, end_col_offset=38), lineno=142, col_offset=16, end_lineno=142, end_col_offset=38)], lineno=132, col_offset=12, end_lineno=142, end_col_offset=38)], lineno=130, col_offset=8, end_lineno=142, end_col_offset=38)], returns=Constant(value=None, lineno=125, col_offset=66, end_lineno=125, end_col_offset=70), lineno=125, col_offset=4, end_lineno=142, end_col_offset=38), FunctionDef(name='bulk_insert_occurrences', args=arguments(args=[arg(arg='self', lineno=144, col_offset=32, end_lineno=144, end_col_offset=36), arg(arg='rows', annotation=Subscript(value=Name(id='Sequence', ctx=Load(), lineno=144, col_offset=44, end_lineno=144, end_col_offset=52), slice=Name(id='SymbolOccurrenceRow', ctx=Load(), lineno=144, col_offset=53, end_lineno=144, end_col_offset=72), ctx=Load(), lineno=144, col_offset=44, end_lineno=144, end_col_offset=73), lineno=144, col_offset=38, end_lineno=144, end_col_offset=73)]), body=[Expr(value=Constant(value='Bulk load symbol occurrences.', lineno=145, col_offset=8, end_lineno=145, end_col_offset=43), lineno=145, col_offset=8, end_lineno=145, end_col_offset=43), If(test=UnaryOp(op=Not(), operand=Name(id='rows', ctx=Load(), lineno=146, col_offset=15, end_lineno=146, end_col_offset=19), lineno=146, col_offset=11, end_lineno=146, end_col_offset=19), body=[Return(lineno=147, col_offset=12, end_lineno=147, end_col_offset=18)], lineno=146, col_offset=8, end_lineno=147, end_col_offset=18), With(items=[withitem(context_expr=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=148, col_offset=13, end_lineno=148, end_col_offset=17), attr='_manager', ctx=Load(), lineno=148, col_offset=13, end_lineno=148, end_col_offset=26), attr='connection', ctx=Load(), lineno=148, col_offset=13, end_lineno=148, end_col_offset=37), lineno=148, col_offset=13, end_lineno=148, end_col_offset=39), optional_vars=Name(id='conn', ctx=Store(), lineno=148, col_offset=43, end_lineno=148, end_col_offset=47))], body=[Expr(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=149, col_offset=12, end_lineno=149, end_col_offset=16), attr='register', ctx=Load(), lineno=149, col_offset=12, end_lineno=149, end_col_offset=25), args=[Constant(value='_tmp_occs', lineno=149, col_offset=26, end_lineno=149, end_col_offset=37), Name(id='rows', ctx=Load(), lineno=149, col_offset=39, end_lineno=149, end_col_offset=43)], lineno=149, col_offset=12, end_lineno=149, end_col_offset=44), lineno=149, col_offset=12, end_lineno=149, end_col_offset=44), Expr(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=150, col_offset=12, end_lineno=150, end_col_offset=16), attr='execute', ctx=Load(), lineno=150, col_offset=12, end_lineno=150, end_col_offset=24), args=[Constant(value='INSERT INTO symbol_occurrences SELECT * FROM _tmp_occs', lineno=150, col_offset=25, end_lineno=150, end_col_offset=81)], lineno=150, col_offset=12, end_lineno=150, end_col_offset=82), lineno=150, col_offset=12, end_lineno=150, end_col_offset=82)], lineno=148, col_offset=8, end_lineno=150, end_col_offset=82)], returns=Constant(value=None, lineno=144, col_offset=78, end_lineno=144, end_col_offset=82), lineno=144, col_offset=4, end_lineno=150, end_col_offset=82), FunctionDef(name='bulk_insert_chunk_symbols', args=arguments(args=[arg(arg='self', lineno=152, col_offset=34, end_lineno=152, end_col_offset=38), arg(arg='pairs', annotation=Subscript(value=Name(id='Iterable', ctx=Load(), lineno=152, col_offset=47, end_lineno=152, end_col_offset=55), slice=Subscript(value=Name(id='tuple', ctx=Load(), lineno=152, col_offset=56, end_lineno=152, end_col_offset=61), slice=Tuple(elts=[Name(id='int', ctx=Load(), lineno=152, col_offset=62, end_lineno=152, end_col_offset=65), Name(id='str', ctx=Load(), lineno=152, col_offset=67, end_lineno=152, end_col_offset=70)], ctx=Load(), lineno=152, col_offset=62, end_lineno=152, end_col_offset=70), ctx=Load(), lineno=152, col_offset=56, end_lineno=152, end_col_offset=71), ctx=Load(), lineno=152, col_offset=47, end_lineno=152, end_col_offset=72), lineno=152, col_offset=40, end_lineno=152, end_col_offset=72)]), body=[Expr(value=Constant(value='Associate chunks with the symbols they contain.', lineno=153, col_offset=8, end_lineno=153, end_col_offset=61), lineno=153, col_offset=8, end_lineno=153, end_col_offset=61), Assign(targets=[Name(id='pairs', ctx=Store(), lineno=154, col_offset=8, end_lineno=154, end_col_offset=13)], value=Call(func=Name(id='list', ctx=Load(), lineno=154, col_offset=16, end_lineno=154, end_col_offset=20), args=[Name(id='pairs', ctx=Load(), lineno=154, col_offset=21, end_lineno=154, end_col_offset=26)], lineno=154, col_offset=16, end_lineno=154, end_col_offset=27), lineno=154, col_offset=8, end_lineno=154, end_col_offset=27), If(test=UnaryOp(op=Not(), operand=Name(id='pairs', ctx=Load(), lineno=155, col_offset=15, end_lineno=155, end_col_offset=20), lineno=155, col_offset=11, end_lineno=155, end_col_offset=20), body=[Return(lineno=156, col_offset=12, end_lineno=156, end_col_offset=18)], lineno=155, col_offset=8, end_lineno=156, end_col_offset=18), With(items=[withitem(context_expr=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load(), lineno=157, col_offset=13, end_lineno=157, end_col_offset=17), attr='_manager', ctx=Load(), lineno=157, col_offset=13, end_lineno=157, end_col_offset=26), attr='connection', ctx=Load(), lineno=157, col_offset=13, end_lineno=157, end_col_offset=37), lineno=157, col_offset=13, end_lineno=157, end_col_offset=39), optional_vars=Name(id='conn', ctx=Store(), lineno=157, col_offset=43, end_lineno=157, end_col_offset=47))], body=[Expr(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=158, col_offset=12, end_lineno=158, end_col_offset=16), attr='register', ctx=Load(), lineno=158, col_offset=12, end_lineno=158, end_col_offset=25), args=[Constant(value='_tmp_pairs', lineno=159, col_offset=16, end_lineno=159, end_col_offset=28), ListComp(elt=Dict(keys=[Constant(value='chunk_id', lineno=160, col_offset=18, end_lineno=160, end_col_offset=28), Constant(value='symbol', lineno=160, col_offset=40, end_lineno=160, end_col_offset=48)], values=[Name(id='chunk_id', ctx=Load(), lineno=160, col_offset=30, end_lineno=160, end_col_offset=38), Name(id='symbol', ctx=Load(), lineno=160, col_offset=50, end_lineno=160, end_col_offset=56)], lineno=160, col_offset=17, end_lineno=160, end_col_offset=57), generators=[comprehension(target=Tuple(elts=[Name(id='chunk_id', ctx=Store(), lineno=160, col_offset=62, end_lineno=160, end_col_offset=70), Name(id='symbol', ctx=Store(), lineno=160, col_offset=72, end_lineno=160, end_col_offset=78)], ctx=Store(), lineno=160, col_offset=62, end_lineno=160, end_col_offset=78), iter=Name(id='pairs', ctx=Load(), lineno=160, col_offset=82, end_lineno=160, end_col_offset=87), is_async=0)], lineno=160, col_offset=16, end_lineno=160, end_col_offset=88)], lineno=158, col_offset=12, end_lineno=161, end_col_offset=13), lineno=158, col_offset=12, end_lineno=161, end_col_offset=13), Expr(value=Call(func=Attribute(value=Name(id='conn', ctx=Load(), lineno=162, col_offset=12, end_lineno=162, end_col_offset=16), attr='execute', ctx=Load(), lineno=162, col_offset=12, end_lineno=162, end_col_offset=24), args=[Constant(value='INSERT INTO chunk_symbols SELECT * FROM _tmp_pairs', lineno=162, col_offset=25, end_lineno=162, end_col_offset=77)], lineno=162, col_offset=12, end_lineno=162, end_col_offset=78), lineno=162, col_offset=12, end_lineno=162, end_col_offset=78)], lineno=157, col_offset=8, end_lineno=162, end_col_offset=78)], returns=Constant(value=None, lineno=152, col_offset=77, end_lineno=152, end_col_offset=81), lineno=152, col_offset=4, end_lineno=162, end_col_offset=78)], lineno=45, col_offset=0, end_lineno=162, end_col_offset=78)])