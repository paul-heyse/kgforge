Module(body=[Expr(value=Constant(value='Utility to apply postponed annotations (PEP 563) to Python modules.\n\nThis script automatically inserts `from __future__ import annotations` into\nPython modules, ensuring that type hints are no longer evaluated at import time.\nIt respects module docstrings, encoding declarations, and shebang lines.\n\n## Design\n\n1. Scans targeted directories for .py files\n2. Checks if `from __future__ import annotations` is already present\n3. If missing, inserts it after:\n   - Shebang (#!/usr/bin/env python, etc.)\n   - Encoding declaration (# -*- coding: utf-8 -*-)\n   - Module docstring (triple-quoted strings at top)\n4. Leaves other imports and code untouched\n5. Reports summary: files processed, inserted count, errors\n\n## Usage\n\n    # Apply to entire src/ directory\n    python -m tools.lint.apply_postponed_annotations src/\n\n    # Apply to specific modules\n    python -m tools.lint.apply_postponed_annotations docs/_scripts/ tools/\n\n    # Check without modifying (dry-run)\n    python -m tools.lint.apply_postponed_annotations --check-only src/\n', lineno=1, col_offset=0, end_lineno=28, end_col_offset=3), lineno=1, col_offset=0, end_lineno=28, end_col_offset=3), ImportFrom(module='__future__', names=[alias(name='annotations', lineno=30, col_offset=23, end_lineno=30, end_col_offset=34)], level=0, lineno=30, col_offset=0, end_lineno=30, end_col_offset=34), Import(names=[alias(name='argparse', lineno=32, col_offset=7, end_lineno=32, end_col_offset=15)], lineno=32, col_offset=0, end_lineno=32, end_col_offset=15), Import(names=[alias(name='ast', lineno=33, col_offset=7, end_lineno=33, end_col_offset=10)], lineno=33, col_offset=0, end_lineno=33, end_col_offset=10), Import(names=[alias(name='sys', lineno=34, col_offset=7, end_lineno=34, end_col_offset=10)], lineno=34, col_offset=0, end_lineno=34, end_col_offset=10), ImportFrom(module='dataclasses', names=[alias(name='dataclass', lineno=35, col_offset=24, end_lineno=35, end_col_offset=33)], level=0, lineno=35, col_offset=0, end_lineno=35, end_col_offset=33), ImportFrom(module='pathlib', names=[alias(name='Path', lineno=36, col_offset=20, end_lineno=36, end_col_offset=24)], level=0, lineno=36, col_offset=0, end_lineno=36, end_col_offset=24), ImportFrom(module='typing', names=[alias(name='TYPE_CHECKING', lineno=37, col_offset=19, end_lineno=37, end_col_offset=32), alias(name='cast', lineno=37, col_offset=34, end_lineno=37, end_col_offset=38)], level=0, lineno=37, col_offset=0, end_lineno=37, end_col_offset=38), If(test=Name(id='TYPE_CHECKING', ctx=Load(), lineno=39, col_offset=3, end_lineno=39, end_col_offset=16), body=[ImportFrom(module='collections.abc', names=[alias(name='Sequence', lineno=40, col_offset=32, end_lineno=40, end_col_offset=40)], level=0, lineno=40, col_offset=4, end_lineno=40, end_col_offset=40), ImportFrom(module='tools._shared.logging', names=[alias(name='LoggerAdapter', lineno=42, col_offset=38, end_lineno=42, end_col_offset=51)], level=0, lineno=42, col_offset=4, end_lineno=42, end_col_offset=51)], lineno=39, col_offset=0, end_lineno=42, end_col_offset=51), ImportFrom(module='tools._shared.logging', names=[alias(name='get_logger', lineno=44, col_offset=34, end_lineno=44, end_col_offset=44)], level=0, lineno=44, col_offset=0, end_lineno=44, end_col_offset=44), FunctionDef(name='should_skip_file', args=arguments(args=[arg(arg='path', annotation=Name(id='Path', ctx=Load(), lineno=47, col_offset=27, end_lineno=47, end_col_offset=31), lineno=47, col_offset=21, end_lineno=47, end_col_offset=31)]), body=[Expr(value=Constant(value='Determine if a file should be skipped.\n\n    Parameters\n    ----------\n    path : Path\n        File path to check.\n\n    Returns\n    -------\n    bool\n        True if the file should be skipped (hidden or cache directories).\n    ', lineno=48, col_offset=4, end_lineno=59, end_col_offset=7), lineno=48, col_offset=4, end_lineno=59, end_col_offset=7), If(test=Call(func=Name(id='any', ctx=Load(), lineno=61, col_offset=7, end_lineno=61, end_col_offset=10), args=[GeneratorExp(elt=Call(func=Attribute(value=Name(id='part', ctx=Load(), lineno=61, col_offset=11, end_lineno=61, end_col_offset=15), attr='startswith', ctx=Load(), lineno=61, col_offset=11, end_lineno=61, end_col_offset=26), args=[Constant(value='.', lineno=61, col_offset=27, end_lineno=61, end_col_offset=30)], lineno=61, col_offset=11, end_lineno=61, end_col_offset=31), generators=[comprehension(target=Name(id='part', ctx=Store(), lineno=61, col_offset=36, end_lineno=61, end_col_offset=40), iter=Attribute(value=Name(id='path', ctx=Load(), lineno=61, col_offset=44, end_lineno=61, end_col_offset=48), attr='parts', ctx=Load(), lineno=61, col_offset=44, end_lineno=61, end_col_offset=54), is_async=0)], lineno=61, col_offset=10, end_lineno=61, end_col_offset=55)], lineno=61, col_offset=7, end_lineno=61, end_col_offset=55), body=[Return(value=Constant(value=True, lineno=62, col_offset=15, end_lineno=62, end_col_offset=19), lineno=62, col_offset=8, end_lineno=62, end_col_offset=19)], lineno=61, col_offset=4, end_lineno=62, end_col_offset=19), Return(value=Compare(left=Constant(value='pycache', lineno=63, col_offset=11, end_lineno=63, end_col_offset=20), ops=[In()], comparators=[Attribute(value=Name(id='path', ctx=Load(), lineno=63, col_offset=24, end_lineno=63, end_col_offset=28), attr='parts', ctx=Load(), lineno=63, col_offset=24, end_lineno=63, end_col_offset=34)], lineno=63, col_offset=11, end_lineno=63, end_col_offset=34), lineno=63, col_offset=4, end_lineno=63, end_col_offset=34)], returns=Name(id='bool', ctx=Load(), lineno=47, col_offset=36, end_lineno=47, end_col_offset=40), lineno=47, col_offset=0, end_lineno=63, end_col_offset=34), FunctionDef(name='has_postponed_annotations', args=arguments(args=[arg(arg='content', annotation=Name(id='str', ctx=Load(), lineno=66, col_offset=39, end_lineno=66, end_col_offset=42), lineno=66, col_offset=30, end_lineno=66, end_col_offset=42)]), body=[Expr(value=Constant(value='Check if file already has postponed annotations import.\n\n    Parameters\n    ----------\n    content : str\n        File content to check.\n\n    Returns\n    -------\n    bool\n        True if the content contains the postponed annotations import.\n    ', lineno=67, col_offset=4, end_lineno=78, end_col_offset=7), lineno=67, col_offset=4, end_lineno=78, end_col_offset=7), Return(value=Compare(left=Constant(value='from __future__ import annotations', lineno=79, col_offset=11, end_lineno=79, end_col_offset=47), ops=[In()], comparators=[Name(id='content', ctx=Load(), lineno=79, col_offset=51, end_lineno=79, end_col_offset=58)], lineno=79, col_offset=11, end_lineno=79, end_col_offset=58), lineno=79, col_offset=4, end_lineno=79, end_col_offset=58)], returns=Name(id='bool', ctx=Load(), lineno=66, col_offset=47, end_lineno=66, end_col_offset=51), lineno=66, col_offset=0, end_lineno=79, end_col_offset=58), FunctionDef(name='extract_header_and_body', args=arguments(args=[arg(arg='content', annotation=Name(id='str', ctx=Load(), lineno=82, col_offset=37, end_lineno=82, end_col_offset=40), lineno=82, col_offset=28, end_lineno=82, end_col_offset=40)]), body=[Expr(value=Constant(value='Extract header (shebang, encoding, docstring) from body.\n\n    Parameters\n    ----------\n    content : str\n        File content to parse.\n\n    Returns\n    -------\n    tuple[str, str]\n        (header_section, remaining_body)\n    ', lineno=83, col_offset=4, end_lineno=94, end_col_offset=7), lineno=83, col_offset=4, end_lineno=94, end_col_offset=7), Assign(targets=[Name(id='lines', ctx=Store(), lineno=95, col_offset=4, end_lineno=95, end_col_offset=9)], value=Call(func=Attribute(value=Name(id='content', ctx=Load(), lineno=95, col_offset=12, end_lineno=95, end_col_offset=19), attr='split', ctx=Load(), lineno=95, col_offset=12, end_lineno=95, end_col_offset=25), args=[Constant(value='\n', lineno=95, col_offset=26, end_lineno=95, end_col_offset=30)], lineno=95, col_offset=12, end_lineno=95, end_col_offset=31), lineno=95, col_offset=4, end_lineno=95, end_col_offset=31), AnnAssign(target=Name(id='header_lines', ctx=Store(), lineno=96, col_offset=4, end_lineno=96, end_col_offset=16), annotation=Subscript(value=Name(id='list', ctx=Load(), lineno=96, col_offset=18, end_lineno=96, end_col_offset=22), slice=Name(id='str', ctx=Load(), lineno=96, col_offset=23, end_lineno=96, end_col_offset=26), ctx=Load(), lineno=96, col_offset=18, end_lineno=96, end_col_offset=27), value=List(ctx=Load(), lineno=96, col_offset=30, end_lineno=96, end_col_offset=32), simple=1, lineno=96, col_offset=4, end_lineno=96, end_col_offset=32), Assign(targets=[Name(id='idx', ctx=Store(), lineno=97, col_offset=4, end_lineno=97, end_col_offset=7)], value=Constant(value=0, lineno=97, col_offset=10, end_lineno=97, end_col_offset=11), lineno=97, col_offset=4, end_lineno=97, end_col_offset=11), If(test=BoolOp(op=And(), values=[Compare(left=Name(id='idx', ctx=Load(), lineno=100, col_offset=7, end_lineno=100, end_col_offset=10), ops=[Lt()], comparators=[Call(func=Name(id='len', ctx=Load(), lineno=100, col_offset=13, end_lineno=100, end_col_offset=16), args=[Name(id='lines', ctx=Load(), lineno=100, col_offset=17, end_lineno=100, end_col_offset=22)], lineno=100, col_offset=13, end_lineno=100, end_col_offset=23)], lineno=100, col_offset=7, end_lineno=100, end_col_offset=23), Call(func=Attribute(value=Subscript(value=Name(id='lines', ctx=Load(), lineno=100, col_offset=28, end_lineno=100, end_col_offset=33), slice=Name(id='idx', ctx=Load(), lineno=100, col_offset=34, end_lineno=100, end_col_offset=37), ctx=Load(), lineno=100, col_offset=28, end_lineno=100, end_col_offset=38), attr='startswith', ctx=Load(), lineno=100, col_offset=28, end_lineno=100, end_col_offset=49), args=[Constant(value='#!', lineno=100, col_offset=50, end_lineno=100, end_col_offset=54)], lineno=100, col_offset=28, end_lineno=100, end_col_offset=55)], lineno=100, col_offset=7, end_lineno=100, end_col_offset=55), body=[Expr(value=Call(func=Attribute(value=Name(id='header_lines', ctx=Load(), lineno=101, col_offset=8, end_lineno=101, end_col_offset=20), attr='append', ctx=Load(), lineno=101, col_offset=8, end_lineno=101, end_col_offset=27), args=[Subscript(value=Name(id='lines', ctx=Load(), lineno=101, col_offset=28, end_lineno=101, end_col_offset=33), slice=Name(id='idx', ctx=Load(), lineno=101, col_offset=34, end_lineno=101, end_col_offset=37), ctx=Load(), lineno=101, col_offset=28, end_lineno=101, end_col_offset=38)], lineno=101, col_offset=8, end_lineno=101, end_col_offset=39), lineno=101, col_offset=8, end_lineno=101, end_col_offset=39), AugAssign(target=Name(id='idx', ctx=Store(), lineno=102, col_offset=8, end_lineno=102, end_col_offset=11), op=Add(), value=Constant(value=1, lineno=102, col_offset=15, end_lineno=102, end_col_offset=16), lineno=102, col_offset=8, end_lineno=102, end_col_offset=16)], lineno=100, col_offset=4, end_lineno=102, end_col_offset=16), If(test=BoolOp(op=And(), values=[Compare(left=Name(id='idx', ctx=Load(), lineno=105, col_offset=7, end_lineno=105, end_col_offset=10), ops=[Lt()], comparators=[Call(func=Name(id='len', ctx=Load(), lineno=105, col_offset=13, end_lineno=105, end_col_offset=16), args=[Name(id='lines', ctx=Load(), lineno=105, col_offset=17, end_lineno=105, end_col_offset=22)], lineno=105, col_offset=13, end_lineno=105, end_col_offset=23)], lineno=105, col_offset=7, end_lineno=105, end_col_offset=23), BoolOp(op=Or(), values=[Compare(left=Constant(value='coding:', lineno=105, col_offset=29, end_lineno=105, end_col_offset=38), ops=[In()], comparators=[Subscript(value=Name(id='lines', ctx=Load(), lineno=105, col_offset=42, end_lineno=105, end_col_offset=47), slice=Name(id='idx', ctx=Load(), lineno=105, col_offset=48, end_lineno=105, end_col_offset=51), ctx=Load(), lineno=105, col_offset=42, end_lineno=105, end_col_offset=52)], lineno=105, col_offset=29, end_lineno=105, end_col_offset=52), Compare(left=Constant(value='coding=', lineno=105, col_offset=56, end_lineno=105, end_col_offset=65), ops=[In()], comparators=[Subscript(value=Name(id='lines', ctx=Load(), lineno=105, col_offset=69, end_lineno=105, end_col_offset=74), slice=Name(id='idx', ctx=Load(), lineno=105, col_offset=75, end_lineno=105, end_col_offset=78), ctx=Load(), lineno=105, col_offset=69, end_lineno=105, end_col_offset=79)], lineno=105, col_offset=56, end_lineno=105, end_col_offset=79)], lineno=105, col_offset=29, end_lineno=105, end_col_offset=79)], lineno=105, col_offset=7, end_lineno=105, end_col_offset=80), body=[Expr(value=Call(func=Attribute(value=Name(id='header_lines', ctx=Load(), lineno=106, col_offset=8, end_lineno=106, end_col_offset=20), attr='append', ctx=Load(), lineno=106, col_offset=8, end_lineno=106, end_col_offset=27), args=[Subscript(value=Name(id='lines', ctx=Load(), lineno=106, col_offset=28, end_lineno=106, end_col_offset=33), slice=Name(id='idx', ctx=Load(), lineno=106, col_offset=34, end_lineno=106, end_col_offset=37), ctx=Load(), lineno=106, col_offset=28, end_lineno=106, end_col_offset=38)], lineno=106, col_offset=8, end_lineno=106, end_col_offset=39), lineno=106, col_offset=8, end_lineno=106, end_col_offset=39), AugAssign(target=Name(id='idx', ctx=Store(), lineno=107, col_offset=8, end_lineno=107, end_col_offset=11), op=Add(), value=Constant(value=1, lineno=107, col_offset=15, end_lineno=107, end_col_offset=16), lineno=107, col_offset=8, end_lineno=107, end_col_offset=16)], lineno=105, col_offset=4, end_lineno=107, end_col_offset=16), If(test=Compare(left=Name(id='idx', ctx=Load(), lineno=110, col_offset=7, end_lineno=110, end_col_offset=10), ops=[Lt()], comparators=[Call(func=Name(id='len', ctx=Load(), lineno=110, col_offset=13, end_lineno=110, end_col_offset=16), args=[Name(id='lines', ctx=Load(), lineno=110, col_offset=17, end_lineno=110, end_col_offset=22)], lineno=110, col_offset=13, end_lineno=110, end_col_offset=23)], lineno=110, col_offset=7, end_lineno=110, end_col_offset=23), body=[Assign(targets=[Name(id='remaining', ctx=Store(), lineno=112, col_offset=8, end_lineno=112, end_col_offset=17)], value=Call(func=Attribute(value=Constant(value='\n', lineno=112, col_offset=20, end_lineno=112, end_col_offset=24), attr='join', ctx=Load(), lineno=112, col_offset=20, end_lineno=112, end_col_offset=29), args=[Subscript(value=Name(id='lines', ctx=Load(), lineno=112, col_offset=30, end_lineno=112, end_col_offset=35), slice=Slice(lower=Name(id='idx', ctx=Load(), lineno=112, col_offset=36, end_lineno=112, end_col_offset=39), lineno=112, col_offset=36, end_lineno=112, end_col_offset=40), ctx=Load(), lineno=112, col_offset=30, end_lineno=112, end_col_offset=41)], lineno=112, col_offset=20, end_lineno=112, end_col_offset=42), lineno=112, col_offset=8, end_lineno=112, end_col_offset=42), Try(body=[Assign(targets=[Name(id='tree', ctx=Store(), lineno=114, col_offset=12, end_lineno=114, end_col_offset=16)], value=Call(func=Attribute(value=Name(id='ast', ctx=Load(), lineno=114, col_offset=19, end_lineno=114, end_col_offset=22), attr='parse', ctx=Load(), lineno=114, col_offset=19, end_lineno=114, end_col_offset=28), args=[Name(id='remaining', ctx=Load(), lineno=114, col_offset=29, end_lineno=114, end_col_offset=38)], lineno=114, col_offset=19, end_lineno=114, end_col_offset=39), lineno=114, col_offset=12, end_lineno=114, end_col_offset=39), If(test=BoolOp(op=And(), values=[Attribute(value=Name(id='tree', ctx=Load(), lineno=117, col_offset=16, end_lineno=117, end_col_offset=20), attr='body', ctx=Load(), lineno=117, col_offset=16, end_lineno=117, end_col_offset=25), Call(func=Name(id='isinstance', ctx=Load(), lineno=118, col_offset=20, end_lineno=118, end_col_offset=30), args=[Subscript(value=Attribute(value=Name(id='tree', ctx=Load(), lineno=118, col_offset=31, end_lineno=118, end_col_offset=35), attr='body', ctx=Load(), lineno=118, col_offset=31, end_lineno=118, end_col_offset=40), slice=Constant(value=0, lineno=118, col_offset=41, end_lineno=118, end_col_offset=42), ctx=Load(), lineno=118, col_offset=31, end_lineno=118, end_col_offset=43), Attribute(value=Name(id='ast', ctx=Load(), lineno=118, col_offset=45, end_lineno=118, end_col_offset=48), attr='Expr', ctx=Load(), lineno=118, col_offset=45, end_lineno=118, end_col_offset=53)], lineno=118, col_offset=20, end_lineno=118, end_col_offset=54), Call(func=Name(id='isinstance', ctx=Load(), lineno=119, col_offset=20, end_lineno=119, end_col_offset=30), args=[Attribute(value=Subscript(value=Attribute(value=Name(id='tree', ctx=Load(), lineno=119, col_offset=31, end_lineno=119, end_col_offset=35), attr='body', ctx=Load(), lineno=119, col_offset=31, end_lineno=119, end_col_offset=40), slice=Constant(value=0, lineno=119, col_offset=41, end_lineno=119, end_col_offset=42), ctx=Load(), lineno=119, col_offset=31, end_lineno=119, end_col_offset=43), attr='value', ctx=Load(), lineno=119, col_offset=31, end_lineno=119, end_col_offset=49), Attribute(value=Name(id='ast', ctx=Load(), lineno=119, col_offset=51, end_lineno=119, end_col_offset=54), attr='Constant', ctx=Load(), lineno=119, col_offset=51, end_lineno=119, end_col_offset=63)], lineno=119, col_offset=20, end_lineno=119, end_col_offset=64), Call(func=Name(id='isinstance', ctx=Load(), lineno=120, col_offset=20, end_lineno=120, end_col_offset=30), args=[Attribute(value=Attribute(value=Subscript(value=Attribute(value=Name(id='tree', ctx=Load(), lineno=120, col_offset=31, end_lineno=120, end_col_offset=35), attr='body', ctx=Load(), lineno=120, col_offset=31, end_lineno=120, end_col_offset=40), slice=Constant(value=0, lineno=120, col_offset=41, end_lineno=120, end_col_offset=42), ctx=Load(), lineno=120, col_offset=31, end_lineno=120, end_col_offset=43), attr='value', ctx=Load(), lineno=120, col_offset=31, end_lineno=120, end_col_offset=49), attr='value', ctx=Load(), lineno=120, col_offset=31, end_lineno=120, end_col_offset=55), Name(id='str', ctx=Load(), lineno=120, col_offset=57, end_lineno=120, end_col_offset=60)], lineno=120, col_offset=20, end_lineno=120, end_col_offset=61)], lineno=117, col_offset=16, end_lineno=120, end_col_offset=61), body=[Assign(targets=[Name(id='docstring_node', ctx=Store(), lineno=123, col_offset=16, end_lineno=123, end_col_offset=30)], value=Subscript(value=Attribute(value=Name(id='tree', ctx=Load(), lineno=123, col_offset=33, end_lineno=123, end_col_offset=37), attr='body', ctx=Load(), lineno=123, col_offset=33, end_lineno=123, end_col_offset=42), slice=Constant(value=0, lineno=123, col_offset=43, end_lineno=123, end_col_offset=44), ctx=Load(), lineno=123, col_offset=33, end_lineno=123, end_col_offset=45), lineno=123, col_offset=16, end_lineno=123, end_col_offset=45), Assign(targets=[Name(id='start_line', ctx=Store(), lineno=125, col_offset=16, end_lineno=125, end_col_offset=26)], value=BoolOp(op=Or(), values=[Attribute(value=Name(id='docstring_node', ctx=Load(), lineno=125, col_offset=29, end_lineno=125, end_col_offset=43), attr='lineno', ctx=Load(), lineno=125, col_offset=29, end_lineno=125, end_col_offset=50), Constant(value=1, lineno=125, col_offset=54, end_lineno=125, end_col_offset=55)], lineno=125, col_offset=29, end_lineno=125, end_col_offset=55), lineno=125, col_offset=16, end_lineno=125, end_col_offset=55), Assign(targets=[Name(id='end_line', ctx=Store(), lineno=126, col_offset=16, end_lineno=126, end_col_offset=24)], value=BoolOp(op=Or(), values=[Attribute(value=Name(id='docstring_node', ctx=Load(), lineno=126, col_offset=27, end_lineno=126, end_col_offset=41), attr='end_lineno', ctx=Load(), lineno=126, col_offset=27, end_lineno=126, end_col_offset=52), Name(id='start_line', ctx=Load(), lineno=126, col_offset=56, end_lineno=126, end_col_offset=66)], lineno=126, col_offset=27, end_lineno=126, end_col_offset=66), lineno=126, col_offset=16, end_lineno=126, end_col_offset=66), Assign(targets=[Name(id='docstring_lineno', ctx=Store(), lineno=127, col_offset=16, end_lineno=127, end_col_offset=32)], value=BinOp(left=BinOp(left=Name(id='end_line', ctx=Load(), lineno=127, col_offset=35, end_lineno=127, end_col_offset=43), op=Sub(), right=Name(id='start_line', ctx=Load(), lineno=127, col_offset=46, end_lineno=127, end_col_offset=56), lineno=127, col_offset=35, end_lineno=127, end_col_offset=56), op=Add(), right=Constant(value=1, lineno=127, col_offset=59, end_lineno=127, end_col_offset=60), lineno=127, col_offset=35, end_lineno=127, end_col_offset=60), lineno=127, col_offset=16, end_lineno=127, end_col_offset=60), Expr(value=Call(func=Attribute(value=Name(id='header_lines', ctx=Load(), lineno=128, col_offset=16, end_lineno=128, end_col_offset=28), attr='extend', ctx=Load(), lineno=128, col_offset=16, end_lineno=128, end_col_offset=35), args=[Subscript(value=Name(id='lines', ctx=Load(), lineno=128, col_offset=36, end_lineno=128, end_col_offset=41), slice=Slice(lower=Name(id='idx', ctx=Load(), lineno=128, col_offset=42, end_lineno=128, end_col_offset=45), upper=BinOp(left=Name(id='idx', ctx=Load(), lineno=128, col_offset=48, end_lineno=128, end_col_offset=51), op=Add(), right=Name(id='docstring_lineno', ctx=Load(), lineno=128, col_offset=54, end_lineno=128, end_col_offset=70), lineno=128, col_offset=48, end_lineno=128, end_col_offset=70), lineno=128, col_offset=42, end_lineno=128, end_col_offset=70), ctx=Load(), lineno=128, col_offset=36, end_lineno=128, end_col_offset=71)], lineno=128, col_offset=16, end_lineno=128, end_col_offset=72), lineno=128, col_offset=16, end_lineno=128, end_col_offset=72), AugAssign(target=Name(id='idx', ctx=Store(), lineno=129, col_offset=16, end_lineno=129, end_col_offset=19), op=Add(), value=Name(id='docstring_lineno', ctx=Load(), lineno=129, col_offset=23, end_lineno=129, end_col_offset=39), lineno=129, col_offset=16, end_lineno=129, end_col_offset=39)], lineno=116, col_offset=12, end_lineno=129, end_col_offset=39)], handlers=[ExceptHandler(type=Tuple(elts=[Name(id='SyntaxError', ctx=Load(), lineno=130, col_offset=16, end_lineno=130, end_col_offset=27), Name(id='IndexError', ctx=Load(), lineno=130, col_offset=29, end_lineno=130, end_col_offset=39)], ctx=Load(), lineno=130, col_offset=15, end_lineno=130, end_col_offset=40), body=[Pass(lineno=132, col_offset=12, end_lineno=132, end_col_offset=16)], lineno=130, col_offset=8, end_lineno=132, end_col_offset=16)], lineno=113, col_offset=8, end_lineno=132, end_col_offset=16)], lineno=110, col_offset=4, end_lineno=132, end_col_offset=16), Assign(targets=[Name(id='header', ctx=Store(), lineno=134, col_offset=4, end_lineno=134, end_col_offset=10)], value=Call(func=Attribute(value=Constant(value='\n', lineno=134, col_offset=13, end_lineno=134, end_col_offset=17), attr='join', ctx=Load(), lineno=134, col_offset=13, end_lineno=134, end_col_offset=22), args=[Name(id='header_lines', ctx=Load(), lineno=134, col_offset=23, end_lineno=134, end_col_offset=35)], lineno=134, col_offset=13, end_lineno=134, end_col_offset=36), lineno=134, col_offset=4, end_lineno=134, end_col_offset=36), Assign(targets=[Name(id='body', ctx=Store(), lineno=135, col_offset=4, end_lineno=135, end_col_offset=8)], value=Call(func=Attribute(value=Constant(value='\n', lineno=135, col_offset=11, end_lineno=135, end_col_offset=15), attr='join', ctx=Load(), lineno=135, col_offset=11, end_lineno=135, end_col_offset=20), args=[Subscript(value=Name(id='lines', ctx=Load(), lineno=135, col_offset=21, end_lineno=135, end_col_offset=26), slice=Slice(lower=Name(id='idx', ctx=Load(), lineno=135, col_offset=27, end_lineno=135, end_col_offset=30), lineno=135, col_offset=27, end_lineno=135, end_col_offset=31), ctx=Load(), lineno=135, col_offset=21, end_lineno=135, end_col_offset=32)], lineno=135, col_offset=11, end_lineno=135, end_col_offset=33), lineno=135, col_offset=4, end_lineno=135, end_col_offset=33), Return(value=Tuple(elts=[Name(id='header', ctx=Load(), lineno=136, col_offset=11, end_lineno=136, end_col_offset=17), Name(id='body', ctx=Load(), lineno=136, col_offset=19, end_lineno=136, end_col_offset=23)], ctx=Load(), lineno=136, col_offset=11, end_lineno=136, end_col_offset=23), lineno=136, col_offset=4, end_lineno=136, end_col_offset=23)], returns=Subscript(value=Name(id='tuple', ctx=Load(), lineno=82, col_offset=45, end_lineno=82, end_col_offset=50), slice=Tuple(elts=[Name(id='str', ctx=Load(), lineno=82, col_offset=51, end_lineno=82, end_col_offset=54), Name(id='str', ctx=Load(), lineno=82, col_offset=56, end_lineno=82, end_col_offset=59)], ctx=Load(), lineno=82, col_offset=51, end_lineno=82, end_col_offset=59), ctx=Load(), lineno=82, col_offset=45, end_lineno=82, end_col_offset=60), lineno=82, col_offset=0, end_lineno=136, end_col_offset=23), FunctionDef(name='apply_postponed_annotations', args=arguments(args=[arg(arg='content', annotation=Name(id='str', ctx=Load(), lineno=139, col_offset=41, end_lineno=139, end_col_offset=44), lineno=139, col_offset=32, end_lineno=139, end_col_offset=44)]), body=[Expr(value=Constant(value='Insert postponed annotations import if not present.\n\n    Respects shebang, encoding, and module docstring.\n\n    Parameters\n    ----------\n    content : str\n        File content.\n\n    Returns\n    -------\n    str\n        Modified content with postponed annotations inserted.\n    ', lineno=140, col_offset=4, end_lineno=153, end_col_offset=7), lineno=140, col_offset=4, end_lineno=153, end_col_offset=7), If(test=Call(func=Name(id='has_postponed_annotations', ctx=Load(), lineno=154, col_offset=7, end_lineno=154, end_col_offset=32), args=[Name(id='content', ctx=Load(), lineno=154, col_offset=33, end_lineno=154, end_col_offset=40)], lineno=154, col_offset=7, end_lineno=154, end_col_offset=41), body=[Return(value=Name(id='content', ctx=Load(), lineno=155, col_offset=15, end_lineno=155, end_col_offset=22), lineno=155, col_offset=8, end_lineno=155, end_col_offset=22)], lineno=154, col_offset=4, end_lineno=155, end_col_offset=22), Assign(targets=[Tuple(elts=[Name(id='header', ctx=Store(), lineno=157, col_offset=4, end_lineno=157, end_col_offset=10), Name(id='body', ctx=Store(), lineno=157, col_offset=12, end_lineno=157, end_col_offset=16)], ctx=Store(), lineno=157, col_offset=4, end_lineno=157, end_col_offset=16)], value=Call(func=Name(id='extract_header_and_body', ctx=Load(), lineno=157, col_offset=19, end_lineno=157, end_col_offset=42), args=[Name(id='content', ctx=Load(), lineno=157, col_offset=43, end_lineno=157, end_col_offset=50)], lineno=157, col_offset=19, end_lineno=157, end_col_offset=51), lineno=157, col_offset=4, end_lineno=157, end_col_offset=51), Assign(targets=[Name(id='import_line', ctx=Store(), lineno=160, col_offset=4, end_lineno=160, end_col_offset=15)], value=Constant(value='from __future__ import annotations\n', lineno=160, col_offset=18, end_lineno=160, end_col_offset=56), lineno=160, col_offset=4, end_lineno=160, end_col_offset=56), If(test=Name(id='header', ctx=Load(), lineno=163, col_offset=7, end_lineno=163, end_col_offset=13), body=[If(test=Call(func=Attribute(value=Name(id='header', ctx=Load(), lineno=165, col_offset=11, end_lineno=165, end_col_offset=17), attr='endswith', ctx=Load(), lineno=165, col_offset=11, end_lineno=165, end_col_offset=26), args=[Constant(value='\n', lineno=165, col_offset=27, end_lineno=165, end_col_offset=31)], lineno=165, col_offset=11, end_lineno=165, end_col_offset=32), body=[Return(value=BinOp(left=BinOp(left=Name(id='header', ctx=Load(), lineno=166, col_offset=19, end_lineno=166, end_col_offset=25), op=Add(), right=Name(id='import_line', ctx=Load(), lineno=166, col_offset=28, end_lineno=166, end_col_offset=39), lineno=166, col_offset=19, end_lineno=166, end_col_offset=39), op=Add(), right=Name(id='body', ctx=Load(), lineno=166, col_offset=42, end_lineno=166, end_col_offset=46), lineno=166, col_offset=19, end_lineno=166, end_col_offset=46), lineno=166, col_offset=12, end_lineno=166, end_col_offset=46)], lineno=165, col_offset=8, end_lineno=166, end_col_offset=46), Return(value=BinOp(left=BinOp(left=BinOp(left=Name(id='header', ctx=Load(), lineno=167, col_offset=15, end_lineno=167, end_col_offset=21), op=Add(), right=Constant(value='\n', lineno=167, col_offset=24, end_lineno=167, end_col_offset=28), lineno=167, col_offset=15, end_lineno=167, end_col_offset=28), op=Add(), right=Name(id='import_line', ctx=Load(), lineno=167, col_offset=31, end_lineno=167, end_col_offset=42), lineno=167, col_offset=15, end_lineno=167, end_col_offset=42), op=Add(), right=Name(id='body', ctx=Load(), lineno=167, col_offset=45, end_lineno=167, end_col_offset=49), lineno=167, col_offset=15, end_lineno=167, end_col_offset=49), lineno=167, col_offset=8, end_lineno=167, end_col_offset=49)], lineno=163, col_offset=4, end_lineno=167, end_col_offset=49), Return(value=BinOp(left=Name(id='import_line', ctx=Load(), lineno=169, col_offset=11, end_lineno=169, end_col_offset=22), op=Add(), right=Name(id='body', ctx=Load(), lineno=169, col_offset=25, end_lineno=169, end_col_offset=29), lineno=169, col_offset=11, end_lineno=169, end_col_offset=29), lineno=169, col_offset=4, end_lineno=169, end_col_offset=29)], returns=Name(id='str', ctx=Load(), lineno=139, col_offset=49, end_lineno=139, end_col_offset=52), lineno=139, col_offset=0, end_lineno=169, end_col_offset=29), ClassDef(name='RewriteConfig', body=[Expr(value=Constant(value='Configuration describing how a module should be rewritten.', lineno=174, col_offset=4, end_lineno=174, end_col_offset=68), lineno=174, col_offset=4, end_lineno=174, end_col_offset=68), AnnAssign(target=Name(id='path', ctx=Store(), lineno=176, col_offset=4, end_lineno=176, end_col_offset=8), annotation=Name(id='Path', ctx=Load(), lineno=176, col_offset=10, end_lineno=176, end_col_offset=14), simple=1, lineno=176, col_offset=4, end_lineno=176, end_col_offset=14), AnnAssign(target=Name(id='check_only', ctx=Store(), lineno=177, col_offset=4, end_lineno=177, end_col_offset=14), annotation=Name(id='bool', ctx=Load(), lineno=177, col_offset=16, end_lineno=177, end_col_offset=20), simple=1, lineno=177, col_offset=4, end_lineno=177, end_col_offset=20), AnnAssign(target=Name(id='encoding', ctx=Store(), lineno=178, col_offset=4, end_lineno=178, end_col_offset=12), annotation=Name(id='str', ctx=Load(), lineno=178, col_offset=14, end_lineno=178, end_col_offset=17), value=Constant(value='utf-8', lineno=178, col_offset=20, end_lineno=178, end_col_offset=27), simple=1, lineno=178, col_offset=4, end_lineno=178, end_col_offset=27)], decorator_list=[Call(func=Name(id='dataclass', ctx=Load(), lineno=172, col_offset=1, end_lineno=172, end_col_offset=10), keywords=[keyword(arg='frozen', value=Constant(value=True, lineno=172, col_offset=18, end_lineno=172, end_col_offset=22), lineno=172, col_offset=11, end_lineno=172, end_col_offset=22), keyword(arg='slots', value=Constant(value=True, lineno=172, col_offset=30, end_lineno=172, end_col_offset=34), lineno=172, col_offset=24, end_lineno=172, end_col_offset=34)], lineno=172, col_offset=1, end_lineno=172, end_col_offset=35)], lineno=173, col_offset=0, end_lineno=178, end_col_offset=27), ClassDef(name='RewritePlan', body=[Expr(value=Constant(value='Plan capturing original and rewritten module contents.', lineno=183, col_offset=4, end_lineno=183, end_col_offset=64), lineno=183, col_offset=4, end_lineno=183, end_col_offset=64), AnnAssign(target=Name(id='config', ctx=Store(), lineno=185, col_offset=4, end_lineno=185, end_col_offset=10), annotation=Name(id='RewriteConfig', ctx=Load(), lineno=185, col_offset=12, end_lineno=185, end_col_offset=25), simple=1, lineno=185, col_offset=4, end_lineno=185, end_col_offset=25), AnnAssign(target=Name(id='original', ctx=Store(), lineno=186, col_offset=4, end_lineno=186, end_col_offset=12), annotation=Name(id='str', ctx=Load(), lineno=186, col_offset=14, end_lineno=186, end_col_offset=17), simple=1, lineno=186, col_offset=4, end_lineno=186, end_col_offset=17), AnnAssign(target=Name(id='updated', ctx=Store(), lineno=187, col_offset=4, end_lineno=187, end_col_offset=11), annotation=Name(id='str', ctx=Load(), lineno=187, col_offset=13, end_lineno=187, end_col_offset=16), simple=1, lineno=187, col_offset=4, end_lineno=187, end_col_offset=16), FunctionDef(name='has_changes', args=arguments(args=[arg(arg='self', lineno=190, col_offset=20, end_lineno=190, end_col_offset=24)]), body=[Expr(value=Constant(value='Return True when the rewritten content differs from the original.', lineno=191, col_offset=8, end_lineno=191, end_col_offset=79), lineno=191, col_offset=8, end_lineno=191, end_col_offset=79), Return(value=Compare(left=Attribute(value=Name(id='self', ctx=Load(), lineno=192, col_offset=15, end_lineno=192, end_col_offset=19), attr='original', ctx=Load(), lineno=192, col_offset=15, end_lineno=192, end_col_offset=28), ops=[NotEq()], comparators=[Attribute(value=Name(id='self', ctx=Load(), lineno=192, col_offset=32, end_lineno=192, end_col_offset=36), attr='updated', ctx=Load(), lineno=192, col_offset=32, end_lineno=192, end_col_offset=44)], lineno=192, col_offset=15, end_lineno=192, end_col_offset=44), lineno=192, col_offset=8, end_lineno=192, end_col_offset=44)], decorator_list=[Name(id='property', ctx=Load(), lineno=189, col_offset=5, end_lineno=189, end_col_offset=13)], returns=Name(id='bool', ctx=Load(), lineno=190, col_offset=29, end_lineno=190, end_col_offset=33), lineno=190, col_offset=4, end_lineno=192, end_col_offset=44)], decorator_list=[Call(func=Name(id='dataclass', ctx=Load(), lineno=181, col_offset=1, end_lineno=181, end_col_offset=10), keywords=[keyword(arg='frozen', value=Constant(value=True, lineno=181, col_offset=18, end_lineno=181, end_col_offset=22), lineno=181, col_offset=11, end_lineno=181, end_col_offset=22), keyword(arg='slots', value=Constant(value=True, lineno=181, col_offset=30, end_lineno=181, end_col_offset=34), lineno=181, col_offset=24, end_lineno=181, end_col_offset=34)], lineno=181, col_offset=1, end_lineno=181, end_col_offset=35)], lineno=182, col_offset=0, end_lineno=192, end_col_offset=44), FunctionDef(name='_parse_rewrite_config', args=arguments(args=[arg(arg='path', annotation=Name(id='Path', ctx=Load(), lineno=195, col_offset=32, end_lineno=195, end_col_offset=36), lineno=195, col_offset=26, end_lineno=195, end_col_offset=36)], kwonlyargs=[arg(arg='check_only', annotation=Name(id='bool', ctx=Load(), lineno=195, col_offset=53, end_lineno=195, end_col_offset=57), lineno=195, col_offset=41, end_lineno=195, end_col_offset=57)], kw_defaults=[None]), body=[Expr(value=Constant(value='Create rewrite configuration for ``path``.\n\n    Parameters\n    ----------\n    path : Path\n        File path to configure.\n    check_only : bool\n        Whether to only check without modifying files.\n\n    Returns\n    -------\n    RewriteConfig\n        Configuration for the rewrite operation.\n    ', lineno=196, col_offset=4, end_lineno=209, end_col_offset=7), lineno=196, col_offset=4, end_lineno=209, end_col_offset=7), Return(value=Call(func=Name(id='RewriteConfig', ctx=Load(), lineno=210, col_offset=11, end_lineno=210, end_col_offset=24), keywords=[keyword(arg='path', value=Name(id='path', ctx=Load(), lineno=210, col_offset=30, end_lineno=210, end_col_offset=34), lineno=210, col_offset=25, end_lineno=210, end_col_offset=34), keyword(arg='check_only', value=Name(id='check_only', ctx=Load(), lineno=210, col_offset=47, end_lineno=210, end_col_offset=57), lineno=210, col_offset=36, end_lineno=210, end_col_offset=57)], lineno=210, col_offset=11, end_lineno=210, end_col_offset=58), lineno=210, col_offset=4, end_lineno=210, end_col_offset=58)], returns=Name(id='RewriteConfig', ctx=Load(), lineno=195, col_offset=62, end_lineno=195, end_col_offset=75), lineno=195, col_offset=0, end_lineno=210, end_col_offset=58), FunctionDef(name='_update_imports', args=arguments(args=[arg(arg='config', annotation=Name(id='RewriteConfig', ctx=Load(), lineno=213, col_offset=28, end_lineno=213, end_col_offset=41), lineno=213, col_offset=20, end_lineno=213, end_col_offset=41)]), body=[Expr(value=Constant(value='Compute rewritten content for the provided configuration.\n\n    Parameters\n    ----------\n    config : RewriteConfig\n        Configuration for the rewrite operation.\n\n    Returns\n    -------\n    RewritePlan\n        Plan containing original and updated content.\n    ', lineno=214, col_offset=4, end_lineno=225, end_col_offset=7), lineno=214, col_offset=4, end_lineno=225, end_col_offset=7), Assign(targets=[Name(id='original', ctx=Store(), lineno=226, col_offset=4, end_lineno=226, end_col_offset=12)], value=Call(func=Attribute(value=Attribute(value=Name(id='config', ctx=Load(), lineno=226, col_offset=15, end_lineno=226, end_col_offset=21), attr='path', ctx=Load(), lineno=226, col_offset=15, end_lineno=226, end_col_offset=26), attr='read_text', ctx=Load(), lineno=226, col_offset=15, end_lineno=226, end_col_offset=36), keywords=[keyword(arg='encoding', value=Attribute(value=Name(id='config', ctx=Load(), lineno=226, col_offset=46, end_lineno=226, end_col_offset=52), attr='encoding', ctx=Load(), lineno=226, col_offset=46, end_lineno=226, end_col_offset=61), lineno=226, col_offset=37, end_lineno=226, end_col_offset=61)], lineno=226, col_offset=15, end_lineno=226, end_col_offset=62), lineno=226, col_offset=4, end_lineno=226, end_col_offset=62), Assign(targets=[Name(id='updated', ctx=Store(), lineno=227, col_offset=4, end_lineno=227, end_col_offset=11)], value=Call(func=Name(id='apply_postponed_annotations', ctx=Load(), lineno=227, col_offset=14, end_lineno=227, end_col_offset=41), args=[Name(id='original', ctx=Load(), lineno=227, col_offset=42, end_lineno=227, end_col_offset=50)], lineno=227, col_offset=14, end_lineno=227, end_col_offset=51), lineno=227, col_offset=4, end_lineno=227, end_col_offset=51), Return(value=Call(func=Name(id='RewritePlan', ctx=Load(), lineno=228, col_offset=11, end_lineno=228, end_col_offset=22), keywords=[keyword(arg='config', value=Name(id='config', ctx=Load(), lineno=228, col_offset=30, end_lineno=228, end_col_offset=36), lineno=228, col_offset=23, end_lineno=228, end_col_offset=36), keyword(arg='original', value=Name(id='original', ctx=Load(), lineno=228, col_offset=47, end_lineno=228, end_col_offset=55), lineno=228, col_offset=38, end_lineno=228, end_col_offset=55), keyword(arg='updated', value=Name(id='updated', ctx=Load(), lineno=228, col_offset=65, end_lineno=228, end_col_offset=72), lineno=228, col_offset=57, end_lineno=228, end_col_offset=72)], lineno=228, col_offset=11, end_lineno=228, end_col_offset=73), lineno=228, col_offset=4, end_lineno=228, end_col_offset=73)], returns=Name(id='RewritePlan', ctx=Load(), lineno=213, col_offset=46, end_lineno=213, end_col_offset=57), lineno=213, col_offset=0, end_lineno=228, end_col_offset=73), FunctionDef(name='_write_back', args=arguments(args=[arg(arg='plan', annotation=Name(id='RewritePlan', ctx=Load(), lineno=231, col_offset=22, end_lineno=231, end_col_offset=33), lineno=231, col_offset=16, end_lineno=231, end_col_offset=33)]), body=[Expr(value=Constant(value='Persist rewritten content when changes are detected.\n\n    Parameters\n    ----------\n    plan : RewritePlan\n        Plan containing changes to persist.\n\n    Returns\n    -------\n    bool\n        True if changes were detected (and written if not check-only).\n    ', lineno=232, col_offset=4, end_lineno=243, end_col_offset=7), lineno=232, col_offset=4, end_lineno=243, end_col_offset=7), If(test=UnaryOp(op=Not(), operand=Attribute(value=Name(id='plan', ctx=Load(), lineno=244, col_offset=11, end_lineno=244, end_col_offset=15), attr='has_changes', ctx=Load(), lineno=244, col_offset=11, end_lineno=244, end_col_offset=27), lineno=244, col_offset=7, end_lineno=244, end_col_offset=27), body=[Return(value=Constant(value=False, lineno=245, col_offset=15, end_lineno=245, end_col_offset=20), lineno=245, col_offset=8, end_lineno=245, end_col_offset=20)], lineno=244, col_offset=4, end_lineno=245, end_col_offset=20), If(test=Attribute(value=Attribute(value=Name(id='plan', ctx=Load(), lineno=246, col_offset=7, end_lineno=246, end_col_offset=11), attr='config', ctx=Load(), lineno=246, col_offset=7, end_lineno=246, end_col_offset=18), attr='check_only', ctx=Load(), lineno=246, col_offset=7, end_lineno=246, end_col_offset=29), body=[Return(value=Constant(value=True, lineno=247, col_offset=15, end_lineno=247, end_col_offset=19), lineno=247, col_offset=8, end_lineno=247, end_col_offset=19)], lineno=246, col_offset=4, end_lineno=247, end_col_offset=19), Expr(value=Call(func=Attribute(value=Attribute(value=Attribute(value=Name(id='plan', ctx=Load(), lineno=248, col_offset=4, end_lineno=248, end_col_offset=8), attr='config', ctx=Load(), lineno=248, col_offset=4, end_lineno=248, end_col_offset=15), attr='path', ctx=Load(), lineno=248, col_offset=4, end_lineno=248, end_col_offset=20), attr='write_text', ctx=Load(), lineno=248, col_offset=4, end_lineno=248, end_col_offset=31), args=[Attribute(value=Name(id='plan', ctx=Load(), lineno=248, col_offset=32, end_lineno=248, end_col_offset=36), attr='updated', ctx=Load(), lineno=248, col_offset=32, end_lineno=248, end_col_offset=44)], keywords=[keyword(arg='encoding', value=Attribute(value=Attribute(value=Name(id='plan', ctx=Load(), lineno=248, col_offset=55, end_lineno=248, end_col_offset=59), attr='config', ctx=Load(), lineno=248, col_offset=55, end_lineno=248, end_col_offset=66), attr='encoding', ctx=Load(), lineno=248, col_offset=55, end_lineno=248, end_col_offset=75), lineno=248, col_offset=46, end_lineno=248, end_col_offset=75)], lineno=248, col_offset=4, end_lineno=248, end_col_offset=76), lineno=248, col_offset=4, end_lineno=248, end_col_offset=76), Return(value=Constant(value=True, lineno=249, col_offset=11, end_lineno=249, end_col_offset=15), lineno=249, col_offset=4, end_lineno=249, end_col_offset=15)], returns=Name(id='bool', ctx=Load(), lineno=231, col_offset=38, end_lineno=231, end_col_offset=42), lineno=231, col_offset=0, end_lineno=249, end_col_offset=15), FunctionDef(name='rewrite_file', args=arguments(args=[arg(arg='path', annotation=Name(id='Path', ctx=Load(), lineno=252, col_offset=23, end_lineno=252, end_col_offset=27), lineno=252, col_offset=17, end_lineno=252, end_col_offset=27)], kwonlyargs=[arg(arg='check_only', annotation=Name(id='bool', ctx=Load(), lineno=252, col_offset=44, end_lineno=252, end_col_offset=48), lineno=252, col_offset=32, end_lineno=252, end_col_offset=48)], kw_defaults=[None]), body=[Expr(value=Constant(value='Rewrite a Python file and return True when the content changes.\n\n    Parameters\n    ----------\n    path : Path\n        File path to rewrite.\n    check_only : bool\n        Whether to only check without modifying files.\n\n    Returns\n    -------\n    bool\n        True if the file content would change (or was changed).\n    ', lineno=253, col_offset=4, end_lineno=266, end_col_offset=7), lineno=253, col_offset=4, end_lineno=266, end_col_offset=7), Assign(targets=[Name(id='config', ctx=Store(), lineno=267, col_offset=4, end_lineno=267, end_col_offset=10)], value=Call(func=Name(id='_parse_rewrite_config', ctx=Load(), lineno=267, col_offset=13, end_lineno=267, end_col_offset=34), args=[Name(id='path', ctx=Load(), lineno=267, col_offset=35, end_lineno=267, end_col_offset=39)], keywords=[keyword(arg='check_only', value=Name(id='check_only', ctx=Load(), lineno=267, col_offset=52, end_lineno=267, end_col_offset=62), lineno=267, col_offset=41, end_lineno=267, end_col_offset=62)], lineno=267, col_offset=13, end_lineno=267, end_col_offset=63), lineno=267, col_offset=4, end_lineno=267, end_col_offset=63), Assign(targets=[Name(id='plan', ctx=Store(), lineno=268, col_offset=4, end_lineno=268, end_col_offset=8)], value=Call(func=Name(id='_update_imports', ctx=Load(), lineno=268, col_offset=11, end_lineno=268, end_col_offset=26), args=[Name(id='config', ctx=Load(), lineno=268, col_offset=27, end_lineno=268, end_col_offset=33)], lineno=268, col_offset=11, end_lineno=268, end_col_offset=34), lineno=268, col_offset=4, end_lineno=268, end_col_offset=34), Return(value=Call(func=Name(id='_write_back', ctx=Load(), lineno=269, col_offset=11, end_lineno=269, end_col_offset=22), args=[Name(id='plan', ctx=Load(), lineno=269, col_offset=23, end_lineno=269, end_col_offset=27)], lineno=269, col_offset=11, end_lineno=269, end_col_offset=28), lineno=269, col_offset=4, end_lineno=269, end_col_offset=28)], returns=Name(id='bool', ctx=Load(), lineno=252, col_offset=53, end_lineno=252, end_col_offset=57), lineno=252, col_offset=0, end_lineno=269, end_col_offset=28), FunctionDef(name='_normalize_directories', args=arguments(args=[arg(arg='raw_directories', annotation=Subscript(value=Name(id='Sequence', ctx=Load(), lineno=272, col_offset=44, end_lineno=272, end_col_offset=52), slice=Name(id='Path', ctx=Load(), lineno=272, col_offset=53, end_lineno=272, end_col_offset=57), ctx=Load(), lineno=272, col_offset=44, end_lineno=272, end_col_offset=58), lineno=272, col_offset=27, end_lineno=272, end_col_offset=58)]), body=[Expr(value=Constant(value='Normalize user-provided directories, defaulting to ``src/``.\n\n    Parameters\n    ----------\n    raw_directories : Sequence[Path]\n        User-provided directory paths.\n\n    Returns\n    -------\n    list[Path]\n        Normalized list of directories, or [Path("src")] if empty.\n    ', lineno=273, col_offset=4, end_lineno=284, end_col_offset=7), lineno=273, col_offset=4, end_lineno=284, end_col_offset=7), Return(value=IfExp(test=Name(id='raw_directories', ctx=Load(), lineno=285, col_offset=36, end_lineno=285, end_col_offset=51), body=Call(func=Name(id='list', ctx=Load(), lineno=285, col_offset=11, end_lineno=285, end_col_offset=15), args=[Name(id='raw_directories', ctx=Load(), lineno=285, col_offset=16, end_lineno=285, end_col_offset=31)], lineno=285, col_offset=11, end_lineno=285, end_col_offset=32), orelse=List(elts=[Call(func=Name(id='Path', ctx=Load(), lineno=285, col_offset=58, end_lineno=285, end_col_offset=62), args=[Constant(value='src', lineno=285, col_offset=63, end_lineno=285, end_col_offset=68)], lineno=285, col_offset=58, end_lineno=285, end_col_offset=69)], ctx=Load(), lineno=285, col_offset=57, end_lineno=285, end_col_offset=70), lineno=285, col_offset=11, end_lineno=285, end_col_offset=70), lineno=285, col_offset=4, end_lineno=285, end_col_offset=70)], returns=Subscript(value=Name(id='list', ctx=Load(), lineno=272, col_offset=63, end_lineno=272, end_col_offset=67), slice=Name(id='Path', ctx=Load(), lineno=272, col_offset=68, end_lineno=272, end_col_offset=72), ctx=Load(), lineno=272, col_offset=63, end_lineno=272, end_col_offset=73), lineno=272, col_offset=0, end_lineno=285, end_col_offset=70), FunctionDef(name='_aggregate_results', args=arguments(args=[arg(arg='directories', annotation=Subscript(value=Name(id='Sequence', ctx=Load(), lineno=289, col_offset=17, end_lineno=289, end_col_offset=25), slice=Name(id='Path', ctx=Load(), lineno=289, col_offset=26, end_lineno=289, end_col_offset=30), ctx=Load(), lineno=289, col_offset=17, end_lineno=289, end_col_offset=31), lineno=289, col_offset=4, end_lineno=289, end_col_offset=31)], kwonlyargs=[arg(arg='check_only', annotation=Name(id='bool', ctx=Load(), lineno=291, col_offset=16, end_lineno=291, end_col_offset=20), lineno=291, col_offset=4, end_lineno=291, end_col_offset=20), arg(arg='logger', annotation=Name(id='LoggerAdapter', ctx=Load(), lineno=292, col_offset=12, end_lineno=292, end_col_offset=25), lineno=292, col_offset=4, end_lineno=292, end_col_offset=25)], kw_defaults=[None, None]), body=[Expr(value=Constant(value='Process each directory and return aggregate statistics.\n\n    Parameters\n    ----------\n    directories : Sequence[Path]\n        Directories to process.\n    check_only : bool\n        Whether to only check without modifying files.\n    logger : LoggerAdapter\n        Logger instance for reporting.\n\n    Returns\n    -------\n    tuple[int, int, int]\n        (files_processed, files_modified, errors) statistics.\n    ', lineno=294, col_offset=4, end_lineno=309, end_col_offset=7), lineno=294, col_offset=4, end_lineno=309, end_col_offset=7), Assign(targets=[Name(id='total_processed', ctx=Store(), lineno=310, col_offset=4, end_lineno=310, end_col_offset=19)], value=Constant(value=0, lineno=310, col_offset=22, end_lineno=310, end_col_offset=23), lineno=310, col_offset=4, end_lineno=310, end_col_offset=23), Assign(targets=[Name(id='total_modified', ctx=Store(), lineno=311, col_offset=4, end_lineno=311, end_col_offset=18)], value=Constant(value=0, lineno=311, col_offset=21, end_lineno=311, end_col_offset=22), lineno=311, col_offset=4, end_lineno=311, end_col_offset=22), Assign(targets=[Name(id='total_errors', ctx=Store(), lineno=312, col_offset=4, end_lineno=312, end_col_offset=16)], value=Constant(value=0, lineno=312, col_offset=19, end_lineno=312, end_col_offset=20), lineno=312, col_offset=4, end_lineno=312, end_col_offset=20), For(target=Name(id='directory', ctx=Store(), lineno=314, col_offset=8, end_lineno=314, end_col_offset=17), iter=Name(id='directories', ctx=Load(), lineno=314, col_offset=21, end_lineno=314, end_col_offset=32), body=[If(test=UnaryOp(op=Not(), operand=Call(func=Attribute(value=Name(id='directory', ctx=Load(), lineno=315, col_offset=15, end_lineno=315, end_col_offset=24), attr='exists', ctx=Load(), lineno=315, col_offset=15, end_lineno=315, end_col_offset=31), lineno=315, col_offset=15, end_lineno=315, end_col_offset=33), lineno=315, col_offset=11, end_lineno=315, end_col_offset=33), body=[Assign(targets=[Name(id='msg', ctx=Store(), lineno=316, col_offset=12, end_lineno=316, end_col_offset=15)], value=JoinedStr(values=[Constant(value='Directory not found: ', lineno=316, col_offset=20, end_lineno=316, end_col_offset=41), FormattedValue(value=Name(id='directory', ctx=Load(), lineno=316, col_offset=42, end_lineno=316, end_col_offset=51), conversion=-1, lineno=316, col_offset=41, end_lineno=316, end_col_offset=52)], lineno=316, col_offset=18, end_lineno=316, end_col_offset=53), lineno=316, col_offset=12, end_lineno=316, end_col_offset=53), Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=317, col_offset=12, end_lineno=317, end_col_offset=18), attr='warning', ctx=Load(), lineno=317, col_offset=12, end_lineno=317, end_col_offset=26), args=[Name(id='msg', ctx=Load(), lineno=317, col_offset=27, end_lineno=317, end_col_offset=30)], lineno=317, col_offset=12, end_lineno=317, end_col_offset=31), lineno=317, col_offset=12, end_lineno=317, end_col_offset=31), Continue(lineno=318, col_offset=12, end_lineno=318, end_col_offset=20)], lineno=315, col_offset=8, end_lineno=318, end_col_offset=20), Assign(targets=[Tuple(elts=[Name(id='processed', ctx=Store(), lineno=320, col_offset=8, end_lineno=320, end_col_offset=17), Name(id='modified', ctx=Store(), lineno=320, col_offset=19, end_lineno=320, end_col_offset=27), Name(id='errors', ctx=Store(), lineno=320, col_offset=29, end_lineno=320, end_col_offset=35)], ctx=Store(), lineno=320, col_offset=8, end_lineno=320, end_col_offset=35)], value=Call(func=Name(id='process_directory', ctx=Load(), lineno=320, col_offset=38, end_lineno=320, end_col_offset=55), args=[Name(id='directory', ctx=Load(), lineno=321, col_offset=12, end_lineno=321, end_col_offset=21)], keywords=[keyword(arg='check_only', value=Name(id='check_only', ctx=Load(), lineno=322, col_offset=23, end_lineno=322, end_col_offset=33), lineno=322, col_offset=12, end_lineno=322, end_col_offset=33), keyword(arg='logger', value=Name(id='logger', ctx=Load(), lineno=323, col_offset=19, end_lineno=323, end_col_offset=25), lineno=323, col_offset=12, end_lineno=323, end_col_offset=25)], lineno=320, col_offset=38, end_lineno=324, end_col_offset=9), lineno=320, col_offset=8, end_lineno=324, end_col_offset=9), AugAssign(target=Name(id='total_processed', ctx=Store(), lineno=325, col_offset=8, end_lineno=325, end_col_offset=23), op=Add(), value=Name(id='processed', ctx=Load(), lineno=325, col_offset=27, end_lineno=325, end_col_offset=36), lineno=325, col_offset=8, end_lineno=325, end_col_offset=36), AugAssign(target=Name(id='total_modified', ctx=Store(), lineno=326, col_offset=8, end_lineno=326, end_col_offset=22), op=Add(), value=Name(id='modified', ctx=Load(), lineno=326, col_offset=26, end_lineno=326, end_col_offset=34), lineno=326, col_offset=8, end_lineno=326, end_col_offset=34), AugAssign(target=Name(id='total_errors', ctx=Store(), lineno=327, col_offset=8, end_lineno=327, end_col_offset=20), op=Add(), value=Name(id='errors', ctx=Load(), lineno=327, col_offset=24, end_lineno=327, end_col_offset=30), lineno=327, col_offset=8, end_lineno=327, end_col_offset=30)], lineno=314, col_offset=4, end_lineno=327, end_col_offset=30), Return(value=Tuple(elts=[Name(id='total_processed', ctx=Load(), lineno=329, col_offset=11, end_lineno=329, end_col_offset=26), Name(id='total_modified', ctx=Load(), lineno=329, col_offset=28, end_lineno=329, end_col_offset=42), Name(id='total_errors', ctx=Load(), lineno=329, col_offset=44, end_lineno=329, end_col_offset=56)], ctx=Load(), lineno=329, col_offset=11, end_lineno=329, end_col_offset=56), lineno=329, col_offset=4, end_lineno=329, end_col_offset=56)], returns=Subscript(value=Name(id='tuple', ctx=Load(), lineno=293, col_offset=5, end_lineno=293, end_col_offset=10), slice=Tuple(elts=[Name(id='int', ctx=Load(), lineno=293, col_offset=11, end_lineno=293, end_col_offset=14), Name(id='int', ctx=Load(), lineno=293, col_offset=16, end_lineno=293, end_col_offset=19), Name(id='int', ctx=Load(), lineno=293, col_offset=21, end_lineno=293, end_col_offset=24)], ctx=Load(), lineno=293, col_offset=11, end_lineno=293, end_col_offset=24), ctx=Load(), lineno=293, col_offset=5, end_lineno=293, end_col_offset=25), lineno=288, col_offset=0, end_lineno=329, end_col_offset=56), FunctionDef(name='process_directory', args=arguments(args=[arg(arg='root', annotation=Name(id='Path', ctx=Load(), lineno=333, col_offset=10, end_lineno=333, end_col_offset=14), lineno=333, col_offset=4, end_lineno=333, end_col_offset=14)], kwonlyargs=[arg(arg='check_only', annotation=Name(id='bool', ctx=Load(), lineno=335, col_offset=16, end_lineno=335, end_col_offset=20), lineno=335, col_offset=4, end_lineno=335, end_col_offset=20), arg(arg='logger', annotation=BinOp(left=Name(id='LoggerAdapter', ctx=Load(), lineno=336, col_offset=12, end_lineno=336, end_col_offset=25), op=BitOr(), right=Constant(value=None, lineno=336, col_offset=28, end_lineno=336, end_col_offset=32), lineno=336, col_offset=12, end_lineno=336, end_col_offset=32), lineno=336, col_offset=4, end_lineno=336, end_col_offset=32)], kw_defaults=[Constant(value=False, lineno=335, col_offset=23, end_lineno=335, end_col_offset=28), Constant(value=None, lineno=336, col_offset=35, end_lineno=336, end_col_offset=39)]), body=[Expr(value=Constant(value="Process all Python files in a directory.\n\n    Parameters\n    ----------\n    root : Path\n        Root directory to scan.\n    check_only : bool, optional\n        If True, don't modify files, only report (default: False).\n    logger : LoggerAdapter | None, optional\n        Logger instance (default: None).\n\n    Returns\n    -------\n    tuple[int, int, int]\n        (files_processed, files_modified, errors)\n    ", lineno=338, col_offset=4, end_lineno=353, end_col_offset=7), lineno=338, col_offset=4, end_lineno=353, end_col_offset=7), Assign(targets=[Name(id='active_logger', ctx=Store(), lineno=354, col_offset=4, end_lineno=354, end_col_offset=17)], value=BoolOp(op=Or(), values=[Name(id='logger', ctx=Load(), lineno=354, col_offset=20, end_lineno=354, end_col_offset=26), Call(func=Name(id='get_logger', ctx=Load(), lineno=354, col_offset=30, end_lineno=354, end_col_offset=40), args=[Name(id='__name__', ctx=Load(), lineno=354, col_offset=41, end_lineno=354, end_col_offset=49)], lineno=354, col_offset=30, end_lineno=354, end_col_offset=50)], lineno=354, col_offset=20, end_lineno=354, end_col_offset=50), lineno=354, col_offset=4, end_lineno=354, end_col_offset=50), Assign(targets=[Name(id='processed', ctx=Store(), lineno=356, col_offset=4, end_lineno=356, end_col_offset=13)], value=Constant(value=0, lineno=356, col_offset=16, end_lineno=356, end_col_offset=17), lineno=356, col_offset=4, end_lineno=356, end_col_offset=17), Assign(targets=[Name(id='modified', ctx=Store(), lineno=357, col_offset=4, end_lineno=357, end_col_offset=12)], value=Constant(value=0, lineno=357, col_offset=15, end_lineno=357, end_col_offset=16), lineno=357, col_offset=4, end_lineno=357, end_col_offset=16), Assign(targets=[Name(id='errors', ctx=Store(), lineno=358, col_offset=4, end_lineno=358, end_col_offset=10)], value=Constant(value=0, lineno=358, col_offset=13, end_lineno=358, end_col_offset=14), lineno=358, col_offset=4, end_lineno=358, end_col_offset=14), Assign(targets=[Name(id='py_files', ctx=Store(), lineno=360, col_offset=4, end_lineno=360, end_col_offset=12)], value=Call(func=Name(id='sorted', ctx=Load(), lineno=360, col_offset=15, end_lineno=360, end_col_offset=21), args=[Call(func=Attribute(value=Name(id='root', ctx=Load(), lineno=360, col_offset=22, end_lineno=360, end_col_offset=26), attr='rglob', ctx=Load(), lineno=360, col_offset=22, end_lineno=360, end_col_offset=32), args=[Constant(value='*.py', lineno=360, col_offset=33, end_lineno=360, end_col_offset=39)], lineno=360, col_offset=22, end_lineno=360, end_col_offset=40)], lineno=360, col_offset=15, end_lineno=360, end_col_offset=41), lineno=360, col_offset=4, end_lineno=360, end_col_offset=41), Assign(targets=[Name(id='msg', ctx=Store(), lineno=361, col_offset=4, end_lineno=361, end_col_offset=7)], value=JoinedStr(values=[Constant(value='Scanning ', lineno=361, col_offset=12, end_lineno=361, end_col_offset=21), FormattedValue(value=Call(func=Name(id='len', ctx=Load(), lineno=361, col_offset=22, end_lineno=361, end_col_offset=25), args=[Name(id='py_files', ctx=Load(), lineno=361, col_offset=26, end_lineno=361, end_col_offset=34)], lineno=361, col_offset=22, end_lineno=361, end_col_offset=35), conversion=-1, lineno=361, col_offset=21, end_lineno=361, end_col_offset=36), Constant(value=' Python files in ', lineno=361, col_offset=36, end_lineno=361, end_col_offset=53), FormattedValue(value=Name(id='root', ctx=Load(), lineno=361, col_offset=54, end_lineno=361, end_col_offset=58), conversion=-1, lineno=361, col_offset=53, end_lineno=361, end_col_offset=59)], lineno=361, col_offset=10, end_lineno=361, end_col_offset=60), lineno=361, col_offset=4, end_lineno=361, end_col_offset=60), Expr(value=Call(func=Attribute(value=Name(id='active_logger', ctx=Load(), lineno=362, col_offset=4, end_lineno=362, end_col_offset=17), attr='info', ctx=Load(), lineno=362, col_offset=4, end_lineno=362, end_col_offset=22), args=[Name(id='msg', ctx=Load(), lineno=362, col_offset=23, end_lineno=362, end_col_offset=26)], lineno=362, col_offset=4, end_lineno=362, end_col_offset=27), lineno=362, col_offset=4, end_lineno=362, end_col_offset=27), For(target=Name(id='fpath', ctx=Store(), lineno=364, col_offset=8, end_lineno=364, end_col_offset=13), iter=Name(id='py_files', ctx=Load(), lineno=364, col_offset=17, end_lineno=364, end_col_offset=25), body=[If(test=Call(func=Name(id='should_skip_file', ctx=Load(), lineno=365, col_offset=11, end_lineno=365, end_col_offset=27), args=[Name(id='fpath', ctx=Load(), lineno=365, col_offset=28, end_lineno=365, end_col_offset=33)], lineno=365, col_offset=11, end_lineno=365, end_col_offset=34), body=[Continue(lineno=366, col_offset=12, end_lineno=366, end_col_offset=20)], lineno=365, col_offset=8, end_lineno=366, end_col_offset=20), AugAssign(target=Name(id='processed', ctx=Store(), lineno=368, col_offset=8, end_lineno=368, end_col_offset=17), op=Add(), value=Constant(value=1, lineno=368, col_offset=21, end_lineno=368, end_col_offset=22), lineno=368, col_offset=8, end_lineno=368, end_col_offset=22), Try(body=[Assign(targets=[Name(id='changed', ctx=Store(), lineno=370, col_offset=12, end_lineno=370, end_col_offset=19)], value=Call(func=Name(id='rewrite_file', ctx=Load(), lineno=370, col_offset=22, end_lineno=370, end_col_offset=34), args=[Name(id='fpath', ctx=Load(), lineno=370, col_offset=35, end_lineno=370, end_col_offset=40)], keywords=[keyword(arg='check_only', value=Name(id='check_only', ctx=Load(), lineno=370, col_offset=53, end_lineno=370, end_col_offset=63), lineno=370, col_offset=42, end_lineno=370, end_col_offset=63)], lineno=370, col_offset=22, end_lineno=370, end_col_offset=64), lineno=370, col_offset=12, end_lineno=370, end_col_offset=64), If(test=Name(id='changed', ctx=Load(), lineno=372, col_offset=15, end_lineno=372, end_col_offset=22), body=[AugAssign(target=Name(id='modified', ctx=Store(), lineno=373, col_offset=16, end_lineno=373, end_col_offset=24), op=Add(), value=Constant(value=1, lineno=373, col_offset=28, end_lineno=373, end_col_offset=29), lineno=373, col_offset=16, end_lineno=373, end_col_offset=29), Assign(targets=[Name(id='relpath', ctx=Store(), lineno=374, col_offset=16, end_lineno=374, end_col_offset=23)], value=Call(func=Attribute(value=Name(id='fpath', ctx=Load(), lineno=374, col_offset=26, end_lineno=374, end_col_offset=31), attr='relative_to', ctx=Load(), lineno=374, col_offset=26, end_lineno=374, end_col_offset=43), args=[Name(id='root', ctx=Load(), lineno=374, col_offset=44, end_lineno=374, end_col_offset=48)], lineno=374, col_offset=26, end_lineno=374, end_col_offset=49), lineno=374, col_offset=16, end_lineno=374, end_col_offset=49), Expr(value=Call(func=Attribute(value=Name(id='active_logger', ctx=Load(), lineno=375, col_offset=16, end_lineno=375, end_col_offset=29), attr='info', ctx=Load(), lineno=375, col_offset=16, end_lineno=375, end_col_offset=34), args=[Constant(value='  %s: annotations added', lineno=375, col_offset=35, end_lineno=375, end_col_offset=60), Name(id='relpath', ctx=Load(), lineno=375, col_offset=62, end_lineno=375, end_col_offset=69)], lineno=375, col_offset=16, end_lineno=375, end_col_offset=70), lineno=375, col_offset=16, end_lineno=375, end_col_offset=70)], lineno=372, col_offset=12, end_lineno=375, end_col_offset=70)], handlers=[ExceptHandler(type=Name(id='Exception', ctx=Load(), lineno=376, col_offset=15, end_lineno=376, end_col_offset=24), body=[AugAssign(target=Name(id='errors', ctx=Store(), lineno=377, col_offset=12, end_lineno=377, end_col_offset=18), op=Add(), value=Constant(value=1, lineno=377, col_offset=22, end_lineno=377, end_col_offset=23), lineno=377, col_offset=12, end_lineno=377, end_col_offset=23), Assign(targets=[Name(id='relpath', ctx=Store(), lineno=378, col_offset=12, end_lineno=378, end_col_offset=19)], value=Call(func=Attribute(value=Name(id='fpath', ctx=Load(), lineno=378, col_offset=22, end_lineno=378, end_col_offset=27), attr='relative_to', ctx=Load(), lineno=378, col_offset=22, end_lineno=378, end_col_offset=39), args=[Name(id='root', ctx=Load(), lineno=378, col_offset=40, end_lineno=378, end_col_offset=44)], lineno=378, col_offset=22, end_lineno=378, end_col_offset=45), lineno=378, col_offset=12, end_lineno=378, end_col_offset=45), Expr(value=Call(func=Attribute(value=Name(id='active_logger', ctx=Load(), lineno=379, col_offset=12, end_lineno=379, end_col_offset=25), attr='exception', ctx=Load(), lineno=379, col_offset=12, end_lineno=379, end_col_offset=35), args=[Constant(value='  %s: failed', lineno=379, col_offset=36, end_lineno=379, end_col_offset=50), Name(id='relpath', ctx=Load(), lineno=379, col_offset=52, end_lineno=379, end_col_offset=59)], lineno=379, col_offset=12, end_lineno=379, end_col_offset=60), lineno=379, col_offset=12, end_lineno=379, end_col_offset=60)], lineno=376, col_offset=8, end_lineno=379, end_col_offset=60)], lineno=369, col_offset=8, end_lineno=379, end_col_offset=60)], lineno=364, col_offset=4, end_lineno=379, end_col_offset=60), Return(value=Tuple(elts=[Name(id='processed', ctx=Load(), lineno=381, col_offset=11, end_lineno=381, end_col_offset=20), Name(id='modified', ctx=Load(), lineno=381, col_offset=22, end_lineno=381, end_col_offset=30), Name(id='errors', ctx=Load(), lineno=381, col_offset=32, end_lineno=381, end_col_offset=38)], ctx=Load(), lineno=381, col_offset=11, end_lineno=381, end_col_offset=38), lineno=381, col_offset=4, end_lineno=381, end_col_offset=38)], returns=Subscript(value=Name(id='tuple', ctx=Load(), lineno=337, col_offset=5, end_lineno=337, end_col_offset=10), slice=Tuple(elts=[Name(id='int', ctx=Load(), lineno=337, col_offset=11, end_lineno=337, end_col_offset=14), Name(id='int', ctx=Load(), lineno=337, col_offset=16, end_lineno=337, end_col_offset=19), Name(id='int', ctx=Load(), lineno=337, col_offset=21, end_lineno=337, end_col_offset=24)], ctx=Load(), lineno=337, col_offset=11, end_lineno=337, end_col_offset=24), ctx=Load(), lineno=337, col_offset=5, end_lineno=337, end_col_offset=25), lineno=332, col_offset=0, end_lineno=381, end_col_offset=38), FunctionDef(name='main', args=arguments(args=[arg(arg='argv', annotation=BinOp(left=Subscript(value=Name(id='Sequence', ctx=Load(), lineno=384, col_offset=15, end_lineno=384, end_col_offset=23), slice=Name(id='str', ctx=Load(), lineno=384, col_offset=24, end_lineno=384, end_col_offset=27), ctx=Load(), lineno=384, col_offset=15, end_lineno=384, end_col_offset=28), op=BitOr(), right=Constant(value=None, lineno=384, col_offset=31, end_lineno=384, end_col_offset=35), lineno=384, col_offset=15, end_lineno=384, end_col_offset=35), lineno=384, col_offset=9, end_lineno=384, end_col_offset=35)], defaults=[Constant(value=None, lineno=384, col_offset=38, end_lineno=384, end_col_offset=42)]), body=[Expr(value=Constant(value='Apply postponed annotations to specified directories.\n\n    Parameters\n    ----------\n    argv : Sequence[str] | None, optional\n        Command-line arguments (directories or flags).\n        Flags: --check-only, --help\n\n    Returns\n    -------\n    int\n        Exit code (0 = success, non-zero = failure).\n    ', lineno=385, col_offset=4, end_lineno=397, end_col_offset=7), lineno=385, col_offset=4, end_lineno=397, end_col_offset=7), If(test=Compare(left=Name(id='argv', ctx=Load(), lineno=398, col_offset=7, end_lineno=398, end_col_offset=11), ops=[Is()], comparators=[Constant(value=None, lineno=398, col_offset=15, end_lineno=398, end_col_offset=19)], lineno=398, col_offset=7, end_lineno=398, end_col_offset=19), body=[Assign(targets=[Name(id='argv', ctx=Store(), lineno=399, col_offset=8, end_lineno=399, end_col_offset=12)], value=Subscript(value=Attribute(value=Name(id='sys', ctx=Load(), lineno=399, col_offset=15, end_lineno=399, end_col_offset=18), attr='argv', ctx=Load(), lineno=399, col_offset=15, end_lineno=399, end_col_offset=23), slice=Slice(lower=Constant(value=1, lineno=399, col_offset=24, end_lineno=399, end_col_offset=25), lineno=399, col_offset=24, end_lineno=399, end_col_offset=26), ctx=Load(), lineno=399, col_offset=15, end_lineno=399, end_col_offset=27), lineno=399, col_offset=8, end_lineno=399, end_col_offset=27)], lineno=398, col_offset=4, end_lineno=399, end_col_offset=27), Assign(targets=[Name(id='parser', ctx=Store(), lineno=401, col_offset=4, end_lineno=401, end_col_offset=10)], value=Call(func=Attribute(value=Name(id='argparse', ctx=Load(), lineno=401, col_offset=13, end_lineno=401, end_col_offset=21), attr='ArgumentParser', ctx=Load(), lineno=401, col_offset=13, end_lineno=401, end_col_offset=36), keywords=[keyword(arg='description', value=Constant(value='Apply postponed annotations (PEP 563) to Python modules.', lineno=402, col_offset=20, end_lineno=402, end_col_offset=78), lineno=402, col_offset=8, end_lineno=402, end_col_offset=78)], lineno=401, col_offset=13, end_lineno=403, end_col_offset=5), lineno=401, col_offset=4, end_lineno=403, end_col_offset=5), Expr(value=Call(func=Attribute(value=Name(id='parser', ctx=Load(), lineno=404, col_offset=4, end_lineno=404, end_col_offset=10), attr='add_argument', ctx=Load(), lineno=404, col_offset=4, end_lineno=404, end_col_offset=23), args=[Constant(value='directories', lineno=405, col_offset=8, end_lineno=405, end_col_offset=21)], keywords=[keyword(arg='nargs', value=Constant(value='*', lineno=406, col_offset=14, end_lineno=406, end_col_offset=17), lineno=406, col_offset=8, end_lineno=406, end_col_offset=17), keyword(arg='type', value=Name(id='Path', ctx=Load(), lineno=407, col_offset=13, end_lineno=407, end_col_offset=17), lineno=407, col_offset=8, end_lineno=407, end_col_offset=17), keyword(arg='help', value=Constant(value='Directories to process (default: src/)', lineno=408, col_offset=13, end_lineno=408, end_col_offset=53), lineno=408, col_offset=8, end_lineno=408, end_col_offset=53)], lineno=404, col_offset=4, end_lineno=409, end_col_offset=5), lineno=404, col_offset=4, end_lineno=409, end_col_offset=5), Expr(value=Call(func=Attribute(value=Name(id='parser', ctx=Load(), lineno=410, col_offset=4, end_lineno=410, end_col_offset=10), attr='add_argument', ctx=Load(), lineno=410, col_offset=4, end_lineno=410, end_col_offset=23), args=[Constant(value='--check-only', lineno=411, col_offset=8, end_lineno=411, end_col_offset=22)], keywords=[keyword(arg='action', value=Constant(value='store_true', lineno=412, col_offset=15, end_lineno=412, end_col_offset=27), lineno=412, col_offset=8, end_lineno=412, end_col_offset=27), keyword(arg='help', value=Constant(value='Check without modifying files', lineno=413, col_offset=13, end_lineno=413, end_col_offset=44), lineno=413, col_offset=8, end_lineno=413, end_col_offset=44)], lineno=410, col_offset=4, end_lineno=414, end_col_offset=5), lineno=410, col_offset=4, end_lineno=414, end_col_offset=5), Assign(targets=[Name(id='args', ctx=Store(), lineno=416, col_offset=4, end_lineno=416, end_col_offset=8)], value=Call(func=Attribute(value=Name(id='parser', ctx=Load(), lineno=416, col_offset=11, end_lineno=416, end_col_offset=17), attr='parse_args', ctx=Load(), lineno=416, col_offset=11, end_lineno=416, end_col_offset=28), args=[Name(id='argv', ctx=Load(), lineno=416, col_offset=29, end_lineno=416, end_col_offset=33)], lineno=416, col_offset=11, end_lineno=416, end_col_offset=34), lineno=416, col_offset=4, end_lineno=416, end_col_offset=34), Assign(targets=[Name(id='logger', ctx=Store(), lineno=417, col_offset=4, end_lineno=417, end_col_offset=10)], value=Call(func=Name(id='get_logger', ctx=Load(), lineno=417, col_offset=13, end_lineno=417, end_col_offset=23), args=[Name(id='__name__', ctx=Load(), lineno=417, col_offset=24, end_lineno=417, end_col_offset=32)], lineno=417, col_offset=13, end_lineno=417, end_col_offset=33), lineno=417, col_offset=4, end_lineno=417, end_col_offset=33), AnnAssign(target=Name(id='check_attr', ctx=Store(), lineno=419, col_offset=4, end_lineno=419, end_col_offset=14), annotation=Name(id='object', ctx=Load(), lineno=419, col_offset=16, end_lineno=419, end_col_offset=22), value=Call(func=Name(id='getattr', ctx=Load(), lineno=419, col_offset=25, end_lineno=419, end_col_offset=32), args=[Name(id='args', ctx=Load(), lineno=419, col_offset=33, end_lineno=419, end_col_offset=37), Constant(value='check_only', lineno=419, col_offset=39, end_lineno=419, end_col_offset=51), Constant(value=False, lineno=419, col_offset=53, end_lineno=419, end_col_offset=58)], lineno=419, col_offset=25, end_lineno=419, end_col_offset=59), simple=1, lineno=419, col_offset=4, end_lineno=419, end_col_offset=59), Assign(targets=[Name(id='check_flag', ctx=Store(), lineno=420, col_offset=4, end_lineno=420, end_col_offset=14)], value=Call(func=Name(id='bool', ctx=Load(), lineno=420, col_offset=17, end_lineno=420, end_col_offset=21), args=[Name(id='check_attr', ctx=Load(), lineno=420, col_offset=22, end_lineno=420, end_col_offset=32)], lineno=420, col_offset=17, end_lineno=420, end_col_offset=33), lineno=420, col_offset=4, end_lineno=420, end_col_offset=33), Assign(targets=[Name(id='raw_directories', ctx=Store(), lineno=422, col_offset=4, end_lineno=422, end_col_offset=19)], value=Call(func=Name(id='cast', ctx=Load(), lineno=422, col_offset=22, end_lineno=422, end_col_offset=26), args=[Constant(value='Sequence[Path]', lineno=422, col_offset=27, end_lineno=422, end_col_offset=43), Call(func=Name(id='getattr', ctx=Load(), lineno=422, col_offset=45, end_lineno=422, end_col_offset=52), args=[Name(id='args', ctx=Load(), lineno=422, col_offset=53, end_lineno=422, end_col_offset=57), Constant(value='directories', lineno=422, col_offset=59, end_lineno=422, end_col_offset=72), Tuple(ctx=Load(), lineno=422, col_offset=74, end_lineno=422, end_col_offset=76)], lineno=422, col_offset=45, end_lineno=422, end_col_offset=77)], lineno=422, col_offset=22, end_lineno=422, end_col_offset=78), lineno=422, col_offset=4, end_lineno=422, end_col_offset=78), Assign(targets=[Name(id='directories', ctx=Store(), lineno=423, col_offset=4, end_lineno=423, end_col_offset=15)], value=Call(func=Name(id='_normalize_directories', ctx=Load(), lineno=423, col_offset=18, end_lineno=423, end_col_offset=40), args=[Name(id='raw_directories', ctx=Load(), lineno=423, col_offset=41, end_lineno=423, end_col_offset=56)], lineno=423, col_offset=18, end_lineno=423, end_col_offset=57), lineno=423, col_offset=4, end_lineno=423, end_col_offset=57), Assign(targets=[Tuple(elts=[Name(id='total_processed', ctx=Store(), lineno=424, col_offset=4, end_lineno=424, end_col_offset=19), Name(id='total_modified', ctx=Store(), lineno=424, col_offset=21, end_lineno=424, end_col_offset=35), Name(id='total_errors', ctx=Store(), lineno=424, col_offset=37, end_lineno=424, end_col_offset=49)], ctx=Store(), lineno=424, col_offset=4, end_lineno=424, end_col_offset=49)], value=Call(func=Name(id='_aggregate_results', ctx=Load(), lineno=424, col_offset=52, end_lineno=424, end_col_offset=70), args=[Name(id='directories', ctx=Load(), lineno=425, col_offset=8, end_lineno=425, end_col_offset=19)], keywords=[keyword(arg='check_only', value=Name(id='check_flag', ctx=Load(), lineno=426, col_offset=19, end_lineno=426, end_col_offset=29), lineno=426, col_offset=8, end_lineno=426, end_col_offset=29), keyword(arg='logger', value=Name(id='logger', ctx=Load(), lineno=427, col_offset=15, end_lineno=427, end_col_offset=21), lineno=427, col_offset=8, end_lineno=427, end_col_offset=21)], lineno=424, col_offset=52, end_lineno=428, end_col_offset=5), lineno=424, col_offset=4, end_lineno=428, end_col_offset=5), Assign(targets=[Name(id='mode', ctx=Store(), lineno=431, col_offset=4, end_lineno=431, end_col_offset=8)], value=IfExp(test=Name(id='check_flag', ctx=Load(), lineno=431, col_offset=29, end_lineno=431, end_col_offset=39), body=Constant(value='(CHECK-ONLY)', lineno=431, col_offset=11, end_lineno=431, end_col_offset=25), orelse=Constant(value='(MODIFIED)', lineno=431, col_offset=45, end_lineno=431, end_col_offset=57), lineno=431, col_offset=11, end_lineno=431, end_col_offset=57), lineno=431, col_offset=4, end_lineno=431, end_col_offset=57), Assign(targets=[Name(id='summary_msg', ctx=Store(), lineno=432, col_offset=4, end_lineno=432, end_col_offset=15)], value=JoinedStr(values=[Constant(value='Summary ', lineno=433, col_offset=10, end_lineno=433, end_col_offset=18), FormattedValue(value=Name(id='mode', ctx=Load(), lineno=433, col_offset=19, end_lineno=433, end_col_offset=23), conversion=-1, lineno=433, col_offset=18, end_lineno=433, end_col_offset=24), Constant(value=': processed=', lineno=433, col_offset=24, end_lineno=433, end_col_offset=36), FormattedValue(value=Name(id='total_processed', ctx=Load(), lineno=433, col_offset=37, end_lineno=433, end_col_offset=52), conversion=-1, lineno=433, col_offset=36, end_lineno=433, end_col_offset=53), Constant(value=', modified=', lineno=433, col_offset=53, end_lineno=434, end_col_offset=19), FormattedValue(value=Name(id='total_modified', ctx=Load(), lineno=434, col_offset=20, end_lineno=434, end_col_offset=34), conversion=-1, lineno=434, col_offset=19, end_lineno=434, end_col_offset=35), Constant(value=', errors=', lineno=434, col_offset=35, end_lineno=434, end_col_offset=44), FormattedValue(value=Name(id='total_errors', ctx=Load(), lineno=434, col_offset=45, end_lineno=434, end_col_offset=57), conversion=-1, lineno=434, col_offset=44, end_lineno=434, end_col_offset=58)], lineno=433, col_offset=8, end_lineno=434, end_col_offset=59), lineno=432, col_offset=4, end_lineno=435, end_col_offset=5), Expr(value=Call(func=Attribute(value=Name(id='logger', ctx=Load(), lineno=436, col_offset=4, end_lineno=436, end_col_offset=10), attr='info', ctx=Load(), lineno=436, col_offset=4, end_lineno=436, end_col_offset=15), args=[Name(id='summary_msg', ctx=Load(), lineno=436, col_offset=16, end_lineno=436, end_col_offset=27)], lineno=436, col_offset=4, end_lineno=436, end_col_offset=28), lineno=436, col_offset=4, end_lineno=436, end_col_offset=28), Return(value=IfExp(test=Compare(left=Name(id='total_errors', ctx=Load(), lineno=438, col_offset=16, end_lineno=438, end_col_offset=28), ops=[Gt()], comparators=[Constant(value=0, lineno=438, col_offset=31, end_lineno=438, end_col_offset=32)], lineno=438, col_offset=16, end_lineno=438, end_col_offset=32), body=Constant(value=1, lineno=438, col_offset=11, end_lineno=438, end_col_offset=12), orelse=Constant(value=0, lineno=438, col_offset=38, end_lineno=438, end_col_offset=39), lineno=438, col_offset=11, end_lineno=438, end_col_offset=39), lineno=438, col_offset=4, end_lineno=438, end_col_offset=39)], returns=Name(id='int', ctx=Load(), lineno=384, col_offset=47, end_lineno=384, end_col_offset=50), lineno=384, col_offset=0, end_lineno=438, end_col_offset=39), If(test=Compare(left=Name(id='__name__', ctx=Load(), lineno=441, col_offset=3, end_lineno=441, end_col_offset=11), ops=[Eq()], comparators=[Constant(value='__main__', lineno=441, col_offset=15, end_lineno=441, end_col_offset=25)], lineno=441, col_offset=3, end_lineno=441, end_col_offset=25), body=[Raise(exc=Call(func=Name(id='SystemExit', ctx=Load(), lineno=442, col_offset=10, end_lineno=442, end_col_offset=20), args=[Call(func=Name(id='main', ctx=Load(), lineno=442, col_offset=21, end_lineno=442, end_col_offset=25), lineno=442, col_offset=21, end_lineno=442, end_col_offset=27)], lineno=442, col_offset=10, end_lineno=442, end_col_offset=28), lineno=442, col_offset=4, end_lineno=442, end_col_offset=28)], lineno=441, col_offset=0, end_lineno=442, end_col_offset=28)])