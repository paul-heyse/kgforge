Module(body=[Expr(value=Constant(value='Tests for docstring rendering utilities.', lineno=1, col_offset=0, end_lineno=1, end_col_offset=46), lineno=1, col_offset=0, end_lineno=1, end_col_offset=46), ImportFrom(module='pathlib', names=[alias(name='Path', lineno=3, col_offset=20, end_lineno=3, end_col_offset=24)], level=0, lineno=3, col_offset=0, end_lineno=3, end_col_offset=24), ImportFrom(module='tools.docstring_builder.render', names=[alias(name='render_docstring', lineno=5, col_offset=43, end_lineno=5, end_col_offset=59), alias(name='write_template_to', lineno=5, col_offset=61, end_lineno=5, end_col_offset=78)], level=0, lineno=5, col_offset=0, end_lineno=5, end_col_offset=78), ImportFrom(module='tools.docstring_builder.schema', names=[alias(name='DocstringSchema', lineno=6, col_offset=43, end_lineno=6, end_col_offset=58), alias(name='ParameterDoc', lineno=6, col_offset=60, end_lineno=6, end_col_offset=72)], level=0, lineno=6, col_offset=0, end_lineno=6, end_col_offset=72), FunctionDef(name='test_render_signature_includes_none_default', args=arguments(), body=[Expr(value=Constant(value='Parameters defaulting to ``None`` should surface in the signature.', lineno=10, col_offset=4, end_lineno=10, end_col_offset=76), lineno=10, col_offset=4, end_lineno=10, end_col_offset=76), Assign(targets=[Name(id='parameter', ctx=Store(), lineno=11, col_offset=4, end_lineno=11, end_col_offset=13)], value=Call(func=Name(id='ParameterDoc', ctx=Load(), lineno=11, col_offset=16, end_lineno=11, end_col_offset=28), keywords=[keyword(arg='name', value=Constant(value='value', lineno=12, col_offset=13, end_lineno=12, end_col_offset=20), lineno=12, col_offset=8, end_lineno=12, end_col_offset=20), keyword(arg='annotation', value=Constant(value='int | None', lineno=13, col_offset=19, end_lineno=13, end_col_offset=31), lineno=13, col_offset=8, end_lineno=13, end_col_offset=31), keyword(arg='description', value=Constant(value='Describe the value.', lineno=14, col_offset=20, end_lineno=14, end_col_offset=41), lineno=14, col_offset=8, end_lineno=14, end_col_offset=41), keyword(arg='optional', value=Constant(value=True, lineno=15, col_offset=17, end_lineno=15, end_col_offset=21), lineno=15, col_offset=8, end_lineno=15, end_col_offset=21), keyword(arg='default', value=Constant(value='None', lineno=16, col_offset=16, end_lineno=16, end_col_offset=22), lineno=16, col_offset=8, end_lineno=16, end_col_offset=22), keyword(arg='display_name', value=Constant(value='value', lineno=17, col_offset=21, end_lineno=17, end_col_offset=28), lineno=17, col_offset=8, end_lineno=17, end_col_offset=28), keyword(arg='kind', value=Constant(value='positional_or_keyword', lineno=18, col_offset=13, end_lineno=18, end_col_offset=36), lineno=18, col_offset=8, end_lineno=18, end_col_offset=36)], lineno=11, col_offset=16, end_lineno=19, end_col_offset=5), lineno=11, col_offset=4, end_lineno=19, end_col_offset=5), Assign(targets=[Name(id='schema', ctx=Store(), lineno=20, col_offset=4, end_lineno=20, end_col_offset=10)], value=Call(func=Name(id='DocstringSchema', ctx=Load(), lineno=20, col_offset=13, end_lineno=20, end_col_offset=28), keywords=[keyword(arg='summary', value=Constant(value='Summarize value.', lineno=20, col_offset=37, end_lineno=20, end_col_offset=55), lineno=20, col_offset=29, end_lineno=20, end_col_offset=55), keyword(arg='parameters', value=List(elts=[Name(id='parameter', ctx=Load(), lineno=20, col_offset=69, end_lineno=20, end_col_offset=78)], ctx=Load(), lineno=20, col_offset=68, end_lineno=20, end_col_offset=79), lineno=20, col_offset=57, end_lineno=20, end_col_offset=79)], lineno=20, col_offset=13, end_lineno=20, end_col_offset=80), lineno=20, col_offset=4, end_lineno=20, end_col_offset=80), Assign(targets=[Name(id='docstring', ctx=Store(), lineno=22, col_offset=4, end_lineno=22, end_col_offset=13)], value=Call(func=Name(id='render_docstring', ctx=Load(), lineno=22, col_offset=16, end_lineno=22, end_col_offset=32), args=[Name(id='schema', ctx=Load(), lineno=22, col_offset=33, end_lineno=22, end_col_offset=39)], keywords=[keyword(arg='marker', value=Constant(value='<!-- marker -->', lineno=22, col_offset=48, end_lineno=22, end_col_offset=65), lineno=22, col_offset=41, end_lineno=22, end_col_offset=65), keyword(arg='include_signature', value=Constant(value=True, lineno=22, col_offset=85, end_lineno=22, end_col_offset=89), lineno=22, col_offset=67, end_lineno=22, end_col_offset=89)], lineno=22, col_offset=16, end_lineno=22, end_col_offset=90), lineno=22, col_offset=4, end_lineno=22, end_col_offset=90), Assert(test=Compare(left=Constant(value='= None', lineno=24, col_offset=11, end_lineno=24, end_col_offset=19), ops=[In()], comparators=[Name(id='docstring', ctx=Load(), lineno=24, col_offset=23, end_lineno=24, end_col_offset=32)], lineno=24, col_offset=11, end_lineno=24, end_col_offset=32), lineno=24, col_offset=4, end_lineno=24, end_col_offset=32)], returns=Constant(value=None, lineno=9, col_offset=53, end_lineno=9, end_col_offset=57), lineno=9, col_offset=0, end_lineno=24, end_col_offset=32), FunctionDef(name='test_render_docstring_preserves_special_characters', args=arguments(), body=[Expr(value=Constant(value='Docstring rendering should not HTML-escape schema content.', lineno=28, col_offset=4, end_lineno=28, end_col_offset=68), lineno=28, col_offset=4, end_lineno=28, end_col_offset=68), Assign(targets=[Name(id='schema', ctx=Store(), lineno=29, col_offset=4, end_lineno=29, end_col_offset=10)], value=Call(func=Name(id='DocstringSchema', ctx=Load(), lineno=29, col_offset=13, end_lineno=29, end_col_offset=28), keywords=[keyword(arg='summary', value=Constant(value="Return <value> 'untouched'.", lineno=29, col_offset=37, end_lineno=29, end_col_offset=66), lineno=29, col_offset=29, end_lineno=29, end_col_offset=66)], lineno=29, col_offset=13, end_lineno=29, end_col_offset=67), lineno=29, col_offset=4, end_lineno=29, end_col_offset=67), Assign(targets=[Name(id='rendered', ctx=Store(), lineno=30, col_offset=4, end_lineno=30, end_col_offset=12)], value=Call(func=Name(id='render_docstring', ctx=Load(), lineno=30, col_offset=15, end_lineno=30, end_col_offset=31), keywords=[keyword(arg='schema', value=Name(id='schema', ctx=Load(), lineno=30, col_offset=39, end_lineno=30, end_col_offset=45), lineno=30, col_offset=32, end_lineno=30, end_col_offset=45), keyword(arg='marker', value=Constant(value='[generated]', lineno=30, col_offset=54, end_lineno=30, end_col_offset=67), lineno=30, col_offset=47, end_lineno=30, end_col_offset=67)], lineno=30, col_offset=15, end_lineno=30, end_col_offset=68), lineno=30, col_offset=4, end_lineno=30, end_col_offset=68), Assert(test=Compare(left=Constant(value='<value>', lineno=32, col_offset=11, end_lineno=32, end_col_offset=20), ops=[In()], comparators=[Name(id='rendered', ctx=Load(), lineno=32, col_offset=24, end_lineno=32, end_col_offset=32)], lineno=32, col_offset=11, end_lineno=32, end_col_offset=32), lineno=32, col_offset=4, end_lineno=32, end_col_offset=32), Assert(test=Compare(left=Constant(value="'untouched'", lineno=33, col_offset=11, end_lineno=33, end_col_offset=24), ops=[In()], comparators=[Name(id='rendered', ctx=Load(), lineno=33, col_offset=28, end_lineno=33, end_col_offset=36)], lineno=33, col_offset=11, end_lineno=33, end_col_offset=36), lineno=33, col_offset=4, end_lineno=33, end_col_offset=36)], returns=Constant(value=None, lineno=27, col_offset=60, end_lineno=27, end_col_offset=64), lineno=27, col_offset=0, end_lineno=33, end_col_offset=36), FunctionDef(name='test_render_docstring_includes_falsey_default', args=arguments(), body=[Expr(value=Constant(value='Docstring parameter sections must include empty-string defaults.', lineno=37, col_offset=4, end_lineno=37, end_col_offset=74), lineno=37, col_offset=4, end_lineno=37, end_col_offset=74), Assign(targets=[Name(id='parameter', ctx=Store(), lineno=38, col_offset=4, end_lineno=38, end_col_offset=13)], value=Call(func=Name(id='ParameterDoc', ctx=Load(), lineno=38, col_offset=16, end_lineno=38, end_col_offset=28), keywords=[keyword(arg='name', value=Constant(value='title', lineno=39, col_offset=13, end_lineno=39, end_col_offset=20), lineno=39, col_offset=8, end_lineno=39, end_col_offset=20), keyword(arg='annotation', value=Constant(value='str', lineno=40, col_offset=19, end_lineno=40, end_col_offset=24), lineno=40, col_offset=8, end_lineno=40, end_col_offset=24), keyword(arg='description', value=Constant(value='Title for the resource.', lineno=41, col_offset=20, end_lineno=41, end_col_offset=45), lineno=41, col_offset=8, end_lineno=41, end_col_offset=45), keyword(arg='optional', value=Constant(value=True, lineno=42, col_offset=17, end_lineno=42, end_col_offset=21), lineno=42, col_offset=8, end_lineno=42, end_col_offset=21), keyword(arg='default', value=Constant(value='', lineno=43, col_offset=16, end_lineno=43, end_col_offset=18), lineno=43, col_offset=8, end_lineno=43, end_col_offset=18)], lineno=38, col_offset=16, end_lineno=44, end_col_offset=5), lineno=38, col_offset=4, end_lineno=44, end_col_offset=5), Assign(targets=[Name(id='schema', ctx=Store(), lineno=45, col_offset=4, end_lineno=45, end_col_offset=10)], value=Call(func=Name(id='DocstringSchema', ctx=Load(), lineno=45, col_offset=13, end_lineno=45, end_col_offset=28), keywords=[keyword(arg='summary', value=Constant(value='Return a title.', lineno=45, col_offset=37, end_lineno=45, end_col_offset=54), lineno=45, col_offset=29, end_lineno=45, end_col_offset=54), keyword(arg='parameters', value=List(elts=[Name(id='parameter', ctx=Load(), lineno=45, col_offset=68, end_lineno=45, end_col_offset=77)], ctx=Load(), lineno=45, col_offset=67, end_lineno=45, end_col_offset=78), lineno=45, col_offset=56, end_lineno=45, end_col_offset=78)], lineno=45, col_offset=13, end_lineno=45, end_col_offset=79), lineno=45, col_offset=4, end_lineno=45, end_col_offset=79), Assign(targets=[Name(id='rendered', ctx=Store(), lineno=47, col_offset=4, end_lineno=47, end_col_offset=12)], value=Call(func=Name(id='render_docstring', ctx=Load(), lineno=47, col_offset=15, end_lineno=47, end_col_offset=31), keywords=[keyword(arg='schema', value=Name(id='schema', ctx=Load(), lineno=47, col_offset=39, end_lineno=47, end_col_offset=45), lineno=47, col_offset=32, end_lineno=47, end_col_offset=45), keyword(arg='marker', value=Constant(value='[generated]', lineno=47, col_offset=54, end_lineno=47, end_col_offset=67), lineno=47, col_offset=47, end_lineno=47, end_col_offset=67)], lineno=47, col_offset=15, end_lineno=47, end_col_offset=68), lineno=47, col_offset=4, end_lineno=47, end_col_offset=68), Assert(test=Compare(left=Constant(value=', by default ""', lineno=49, col_offset=11, end_lineno=49, end_col_offset=28), ops=[In()], comparators=[Name(id='rendered', ctx=Load(), lineno=49, col_offset=32, end_lineno=49, end_col_offset=40)], lineno=49, col_offset=11, end_lineno=49, end_col_offset=40), lineno=49, col_offset=4, end_lineno=49, end_col_offset=40)], returns=Constant(value=None, lineno=36, col_offset=55, end_lineno=36, end_col_offset=59), lineno=36, col_offset=0, end_lineno=49, end_col_offset=40), FunctionDef(name='test_render_signature_includes_empty_string_default', args=arguments(), body=[Expr(value=Constant(value='Signature rendering should quote empty-string defaults.', lineno=53, col_offset=4, end_lineno=53, end_col_offset=65), lineno=53, col_offset=4, end_lineno=53, end_col_offset=65), Assign(targets=[Name(id='parameter', ctx=Store(), lineno=54, col_offset=4, end_lineno=54, end_col_offset=13)], value=Call(func=Name(id='ParameterDoc', ctx=Load(), lineno=54, col_offset=16, end_lineno=54, end_col_offset=28), keywords=[keyword(arg='name', value=Constant(value='title', lineno=55, col_offset=13, end_lineno=55, end_col_offset=20), lineno=55, col_offset=8, end_lineno=55, end_col_offset=20), keyword(arg='annotation', value=Constant(value='str', lineno=56, col_offset=19, end_lineno=56, end_col_offset=24), lineno=56, col_offset=8, end_lineno=56, end_col_offset=24), keyword(arg='description', value=Constant(value='Title for the resource.', lineno=57, col_offset=20, end_lineno=57, end_col_offset=45), lineno=57, col_offset=8, end_lineno=57, end_col_offset=45), keyword(arg='optional', value=Constant(value=True, lineno=58, col_offset=17, end_lineno=58, end_col_offset=21), lineno=58, col_offset=8, end_lineno=58, end_col_offset=21), keyword(arg='default', value=Constant(value='', lineno=59, col_offset=16, end_lineno=59, end_col_offset=18), lineno=59, col_offset=8, end_lineno=59, end_col_offset=18), keyword(arg='kind', value=Constant(value='positional_or_keyword', lineno=60, col_offset=13, end_lineno=60, end_col_offset=36), lineno=60, col_offset=8, end_lineno=60, end_col_offset=36)], lineno=54, col_offset=16, end_lineno=61, end_col_offset=5), lineno=54, col_offset=4, end_lineno=61, end_col_offset=5), Assign(targets=[Name(id='schema', ctx=Store(), lineno=62, col_offset=4, end_lineno=62, end_col_offset=10)], value=Call(func=Name(id='DocstringSchema', ctx=Load(), lineno=62, col_offset=13, end_lineno=62, end_col_offset=28), keywords=[keyword(arg='summary', value=Constant(value='Return a title.', lineno=62, col_offset=37, end_lineno=62, end_col_offset=54), lineno=62, col_offset=29, end_lineno=62, end_col_offset=54), keyword(arg='parameters', value=List(elts=[Name(id='parameter', ctx=Load(), lineno=62, col_offset=68, end_lineno=62, end_col_offset=77)], ctx=Load(), lineno=62, col_offset=67, end_lineno=62, end_col_offset=78), lineno=62, col_offset=56, end_lineno=62, end_col_offset=78)], lineno=62, col_offset=13, end_lineno=62, end_col_offset=79), lineno=62, col_offset=4, end_lineno=62, end_col_offset=79), Assign(targets=[Name(id='rendered', ctx=Store(), lineno=64, col_offset=4, end_lineno=64, end_col_offset=12)], value=Call(func=Name(id='render_docstring', ctx=Load(), lineno=64, col_offset=15, end_lineno=64, end_col_offset=31), keywords=[keyword(arg='schema', value=Name(id='schema', ctx=Load(), lineno=64, col_offset=39, end_lineno=64, end_col_offset=45), lineno=64, col_offset=32, end_lineno=64, end_col_offset=45), keyword(arg='marker', value=Constant(value='[generated]', lineno=64, col_offset=54, end_lineno=64, end_col_offset=67), lineno=64, col_offset=47, end_lineno=64, end_col_offset=67), keyword(arg='include_signature', value=Constant(value=True, lineno=64, col_offset=87, end_lineno=64, end_col_offset=91), lineno=64, col_offset=69, end_lineno=64, end_col_offset=91)], lineno=64, col_offset=15, end_lineno=64, end_col_offset=92), lineno=64, col_offset=4, end_lineno=64, end_col_offset=92), Assert(test=Compare(left=Constant(value='= ""', lineno=66, col_offset=11, end_lineno=66, end_col_offset=17), ops=[In()], comparators=[Name(id='rendered', ctx=Load(), lineno=66, col_offset=21, end_lineno=66, end_col_offset=29)], lineno=66, col_offset=11, end_lineno=66, end_col_offset=29), lineno=66, col_offset=4, end_lineno=66, end_col_offset=29)], returns=Constant(value=None, lineno=52, col_offset=61, end_lineno=52, end_col_offset=65), lineno=52, col_offset=0, end_lineno=66, end_col_offset=29), FunctionDef(name='test_write_template_to_creates_parent_directories', args=arguments(args=[arg(arg='tmp_path', annotation=Name(id='Path', ctx=Load(), lineno=69, col_offset=64, end_lineno=69, end_col_offset=68), lineno=69, col_offset=54, end_lineno=69, end_col_offset=68)]), body=[Expr(value=Constant(value='Persisting the template should succeed even for nested destinations.', lineno=70, col_offset=4, end_lineno=70, end_col_offset=78), lineno=70, col_offset=4, end_lineno=70, end_col_offset=78), Assign(targets=[Name(id='destination', ctx=Store(), lineno=71, col_offset=4, end_lineno=71, end_col_offset=15)], value=BinOp(left=BinOp(left=Name(id='tmp_path', ctx=Load(), lineno=71, col_offset=18, end_lineno=71, end_col_offset=26), op=Div(), right=Constant(value='nested', lineno=71, col_offset=29, end_lineno=71, end_col_offset=37), lineno=71, col_offset=18, end_lineno=71, end_col_offset=37), op=Div(), right=Constant(value='template.jinja', lineno=71, col_offset=40, end_lineno=71, end_col_offset=56), lineno=71, col_offset=18, end_lineno=71, end_col_offset=56), lineno=71, col_offset=4, end_lineno=71, end_col_offset=56), Expr(value=Call(func=Name(id='write_template_to', ctx=Load(), lineno=73, col_offset=4, end_lineno=73, end_col_offset=21), args=[Name(id='destination', ctx=Load(), lineno=73, col_offset=22, end_lineno=73, end_col_offset=33)], lineno=73, col_offset=4, end_lineno=73, end_col_offset=34), lineno=73, col_offset=4, end_lineno=73, end_col_offset=34), Assert(test=Call(func=Attribute(value=Name(id='destination', ctx=Load(), lineno=75, col_offset=11, end_lineno=75, end_col_offset=22), attr='exists', ctx=Load(), lineno=75, col_offset=11, end_lineno=75, end_col_offset=29), lineno=75, col_offset=11, end_lineno=75, end_col_offset=31), lineno=75, col_offset=4, end_lineno=75, end_col_offset=31), Assign(targets=[Name(id='contents', ctx=Store(), lineno=76, col_offset=4, end_lineno=76, end_col_offset=12)], value=Call(func=Attribute(value=Name(id='destination', ctx=Load(), lineno=76, col_offset=15, end_lineno=76, end_col_offset=26), attr='read_text', ctx=Load(), lineno=76, col_offset=15, end_lineno=76, end_col_offset=36), keywords=[keyword(arg='encoding', value=Constant(value='utf-8', lineno=76, col_offset=46, end_lineno=76, end_col_offset=53), lineno=76, col_offset=37, end_lineno=76, end_col_offset=53)], lineno=76, col_offset=15, end_lineno=76, end_col_offset=54), lineno=76, col_offset=4, end_lineno=76, end_col_offset=54), Assert(test=Compare(left=Constant(value='{{ schema.summary }}', lineno=77, col_offset=11, end_lineno=77, end_col_offset=33), ops=[In()], comparators=[Name(id='contents', ctx=Load(), lineno=77, col_offset=37, end_lineno=77, end_col_offset=45)], lineno=77, col_offset=11, end_lineno=77, end_col_offset=45), lineno=77, col_offset=4, end_lineno=77, end_col_offset=45)], returns=Constant(value=None, lineno=69, col_offset=73, end_lineno=69, end_col_offset=77), lineno=69, col_offset=0, end_lineno=77, end_col_offset=45)])